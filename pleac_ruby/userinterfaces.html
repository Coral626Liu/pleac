<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>User Interfaces</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="PLEAC-Ruby"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="Database Access"
HREF="dbaccess.html"><LINK
REL="NEXT"
TITLE="Process Management and Communication"
HREF="processmanagementetc.html"><style type="text/css">td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }

  </style></head
><BODY TEXT="#cecece" BGCOLOR="#4f6f6f" LINK="#f5deb3" VLINK="#d5ae83"
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PLEAC-Ruby</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="dbaccess.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="processmanagementetc.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="USERINTERFACES"
>15. User Interfaces</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN792"
>Parsing Program Arguments</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp"># This test program demonstrates parsing program arguments.</span>
<span class="cp"># It uses the optparse library, which is included with ruby 1.8</span>
<span class="cp"># It handles classic unix style and gnu style options</span>
<span class="cp">require &#39;optparse&#39;</span>

<span class="cp">@debugmode = false</span>
<span class="cp">@verbose = false</span>

<span class="cp">ARGV.options do |opts|</span>
<span class="cp">    opts.banner = &quot;Usage: ruby #{$0} [OPTIONS] INPUTFILES&quot;</span>

<span class="cp">    opts.on(&quot;-h&quot;, &quot;--help&quot;, &quot;show this message&quot;) {</span>
<span class="cp">        puts opts</span>
<span class="cp">        exit</span>
<span class="cp">    }</span>
<span class="cp">    # The OptionParser#on method is called with a specification of short</span>
<span class="cp">    # options, of long options, a data type spezification and user help</span>
<span class="cp">    # messages for this option.</span>
<span class="cp">    # The method analyses the given parameter and decides what it is,</span>
<span class="cp">    # so you can leave out the long option if you don&#39;t need it</span>
<span class="cp">    opts.on(&quot;-v&quot;, &quot;--[no-]verbose=[FLAG]&quot;, TrueClass, &quot;run verbosly&quot;) {</span>
<span class="cp">        |@verbose|   # sets @verbose to true or false</span>
<span class="cp">    }</span>
<span class="cp">    opts.on(&quot;-D&quot;, &quot;--DEBUG&quot;, TrueClass, &quot;turns on debug mode&quot; ){</span>
<span class="cp">        |@debugmode|   # sets @debugmode to true</span>
<span class="cp">    }</span>
<span class="cp">    opts.on(&quot;-c&quot;, &quot;--count=NUMBER&quot;, Integer, &quot;how many times we do it&quot; ){</span>
<span class="cp">        |@count|      # sets @count to given integer</span>
<span class="cp">    }</span>
<span class="cp">    opts.on(&quot;-o&quot;, &quot;--output=FILE&quot;, String, &quot;file to write output to&quot;){</span>
<span class="cp">        |@outputfile|   # sets @outputfile to given string</span>
<span class="cp">    }</span>
<span class="cp">    opts.parse!</span>
<span class="cp">end</span>

<span class="cp"># example to use the options in the main program</span>
<span class="cp">puts &quot;Verbose is on&quot; if @verbose</span>
<span class="cp">puts &quot;Debugmode is on&quot; if @debugmode</span>
<span class="cp">puts &quot;Outfile is #{@outputfile}&quot; if defined? @outputfile</span>
<span class="cp">puts &quot;Count is #{@count}&quot; if defined? @count</span>
<span class="cp">ARGV.each { |param|</span>
<span class="cp">    puts &quot;Got parameter #{param}&quot;</span>
<span class="cp">}</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN795"
>Testing Whether a Program Is Running Interactively</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN798"
>Clearing the Screen</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN801"
>Determining Terminal or Window Size</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">buf = &quot;\0&quot; * 8</span>
<span class="cp">$stdout.ioctl(0x5413, buf)</span>
<span class="cp">ws_row, ws_col, ws_xpixel, ws_ypixel = buf.unpack(&quot;S4&quot;)</span>

<span class="cp">raise &quot;You must have at least 20 characters&quot; unless ws_col &gt;= 20</span>
<span class="cp">max = 0</span>
<span class="cp">values = (1..5).collect { rand(20) }  # generate an array[5] of rand values</span>
<span class="cp">for i in values</span>
<span class="cp">    max = i if max &lt; i</span>
<span class="cp">end</span>
<span class="cp">ratio = Float(ws_col-12)/max          # chars per unit</span>
<span class="cp">for i in values</span>
<span class="cp">    printf &quot;%8.1f %s\n&quot;, i, &quot;*&quot; * (ratio*i)</span>
<span class="cp">end</span>

<span class="cp"># gives, for example:</span>
<span class="cp">#   15.0 *******************************</span>
<span class="cp">#   10.0 *********************</span>
<span class="cp">#    5.0 **********</span>
<span class="cp">#   14.0 *****************************</span>
<span class="cp">#   18.0 **************************************</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN804"
>Changing Text Color</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp"># Ruby&#39;s standard distribution doesn&#39;t have an ANSI color module, but we can use</span>
<span class="cp"># Term::ANSIColor (http://term-ansicolor.rubyforge.org/) instead.</span>
<span class="cp">#-----------------------------</span>
<span class="cp">require &#39;term/ansicolor&#39;</span>
<span class="cp">include Term::ANSIColor</span>

<span class="cp"># Text can be colored using constants</span>
<span class="cp">print red, &quot;Danger Will Robinson!&quot;, reset, &quot;\n&quot;</span>
<span class="cp">print &quot;This is just normal text\n&quot;</span>
<span class="cp">print blink, &quot;Do you hurt yet?&quot;, reset, &quot;\n&quot;</span>
<span class="cp">#-----------------------------</span>
<span class="cp"># Or by using functions. Functions automatically reset colors at the end.</span>
<span class="cp">print red(&quot;Danger Will Ronbinson!&quot;), &quot;\n&quot;</span>
<span class="cp">print red( on_black( &quot;venom lack&quot; )), &quot;\n&quot;</span>
<span class="cp">print red( on_yellow( &quot;kill that fellow&quot; )), &quot;\n&quot;</span>
<span class="cp">print green( on_cyan( blink( &quot;garish!&quot; ))), &quot;\n&quot;</span>
<span class="cp">#-----------------------------</span>
<span class="cp"># Or by using block forms. Block forms automatically reset colors at the end.</span>
<span class="cp">print red { &quot;Danger Will Robinson!&quot; }, &quot;\n&quot;</span>
<span class="cp">print red { on_black { &quot;venom lack&quot; } }, &quot;\n&quot;</span>
<span class="cp">print red { on_yellow { &quot;kill that fellow&quot; } }, &quot;\n&quot;</span>
<span class="cp">#-----------------------------</span>
<span class="cp"># Or by using a String Mixin</span>
<span class="cp">class String</span>
<span class="cp">    include Term::ANSIColor</span>
<span class="cp">end</span>

<span class="cp">print &quot;Danger Will Robinson!&quot;.red, &quot;\n&quot;</span>
<span class="cp">print &quot;venom lack&quot;.red.on_black, &quot;\n&quot;</span>
<span class="cp">print &quot;kill that fellow&quot;.red.on_yellow, &quot;\n&quot;</span>

<span class="cp">#-----------------------------</span>
<span class="cp"># To color text without using a third party library, constants can be created</span>
<span class="cp"># manually using ANSI escape codes. (A complete list of all codes can be found</span>
<span class="cp"># at http://en.wikipedia.org/wiki/Ansi_escape_codes)</span>
<span class="cp"># Note that \e means \033 (The escape character)</span>
<span class="cp">#-----------------------------</span>
<span class="cp"># Foreground constants</span>
<span class="cp">BLACK = &quot;\e[30m&quot;</span>
<span class="cp">RED = &quot;\e[31m&quot;</span>
<span class="cp">GREEN = &quot;\e[32m&quot;</span>
<span class="cp">WHITE = &quot;\e[37m&quot;</span>

<span class="cp"># Background constants</span>
<span class="cp">ON_BLACK = &quot;\e[40m&quot;</span>
<span class="cp">ON_WHITE = &quot;\e[47m&quot;</span>
<span class="cp">ON_YELLOW = &quot;\e[43m&quot;</span>
<span class="cp">ON_CYAN = &quot;\e[46m&quot;</span>

<span class="cp"># Style constants</span>
<span class="cp">BLINK = &quot;\e[5m&quot;</span>
<span class="cp">NOBLINK = &quot;\e[25m&quot;</span>
<span class="cp">BOLD = &quot;\e[1m&quot;</span>
<span class="cp">NOBOLD = &quot;\e[22m&quot;</span>

<span class="cp">RESET = &quot;\e[0m&quot;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">puts &quot;#{RED}Danger Will Ronbinson!#{RESET}&quot;</span>
<span class="cp">puts &quot;This is just normal text.&quot;</span>
<span class="cp">puts &quot;#{BLINK}Do you hurt yet?#{NOBLINK}&quot;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">puts &quot;#{RED}Danger Will Ronbinson!#{RESET}&quot;</span>
<span class="cp">puts &quot;#{RED}#{ON_BLACK}venom lack&quot;</span>
<span class="cp">puts &quot;#{RED}#{ON_YELLOW}kill that fellow&quot;</span>
<span class="cp">puts &quot;#{GREEN}#{ON_CYAN}#{BLINK}garish!&quot;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">print BLACK, ON_WHITE, &quot;black on white\n&quot;</span>
<span class="cp">print WHITE, ON_BLACK, &quot;white on black\n&quot;</span>
<span class="cp">print GREEN, ON_CYAN, BLINK, &quot;garish!\n&quot;</span>

<span class="cp">print RESET</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN807"
>Reading from the Keyboard</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN810"
>Ringing the Terminal Bell</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN813"
>Using POSIX termios</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN816"
>Checking for Waiting Input</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN819"
>Reading Passwords</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN822"
>Editing Input</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN825"
>Managing the Screen</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN828"
>Controlling Another Program with Expect</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN831"
>Creating Menus with Tk</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN834"
>Creating Dialog Boxes with Tk</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN837"
>Responding to Tk Resize Events</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN840"
>Removing the DOS Shell Window with Windows Perl/Tk</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN843"
>Program: Small termcap program</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN846"
>Program: tkshufflepod</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="dbaccess.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="processmanagementetc.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Database Access</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Process Management and Communication</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>