<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Numbers</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="PLEAC-Objective CAML "
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="Strings"
HREF="strings.html"><LINK
REL="NEXT"
TITLE="Dates and Times"
HREF="datesandtimes.html"><style type="text/css">td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }

  </style></head
><BODY TEXT="#cecece" BGCOLOR="#4f6f6f" LINK="#f5deb3" VLINK="#d5ae83"
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PLEAC-Objective CAML </TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="strings.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="datesandtimes.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="NUMBERS"
>2. Numbers</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN73"
>Checking Whether a String Is a Valid Number</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span>
<span class="c">(* Something like this must be done differently in OCaml because of its</span>
<span class="c">* type-safety.  Some of the tests will use regular expressions, but most won&#39;t *)</span>
<span class="k">let</span> <span class="n">has_NonDigits</span> <span class="n">s</span> <span class="o">=</span>
  <span class="k">try</span> <span class="n">ignore</span> <span class="o">(</span><span class="n">search_forward</span> <span class="o">(</span><span class="n">regexp</span> <span class="s2">&quot;[^0-9]&quot;</span><span class="o">)</span> <span class="n">s</span><span class="o">);</span> <span class="bp">true</span>
  <span class="k">with</span> <span class="nc">Not_found</span> <span class="o">-&gt;</span> <span class="bp">true</span><span class="o">;;</span>
<span class="k">let</span> <span class="n">is_NaturalNumber</span> <span class="n">s</span> <span class="o">=</span>
  <span class="k">try</span> <span class="k">let</span> <span class="n">n</span> <span class="o">=</span> <span class="n">int_of_string</span> <span class="n">s</span> <span class="k">in</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">with</span> <span class="nc">Failure</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="bp">false</span><span class="o">;;</span>
<span class="k">let</span> <span class="n">is_Integer</span> <span class="n">s</span> <span class="o">=</span>
  <span class="k">try</span> <span class="n">ignore</span><span class="o">(</span><span class="n">int_of_string</span> <span class="n">s</span><span class="o">);</span> <span class="bp">true</span> <span class="k">with</span> <span class="nc">Failure</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="bp">false</span><span class="o">;;</span>
<span class="k">let</span> <span class="n">is_DecimalNumber</span> <span class="n">s</span> <span class="o">=</span>
  <span class="k">try</span> <span class="n">ignore</span><span class="o">(</span><span class="n">int_of_string</span> <span class="n">s</span><span class="o">);</span> <span class="bp">true</span> <span class="k">with</span> <span class="nc">Failure</span> <span class="o">_</span> <span class="o">-&gt;</span>
    <span class="k">try</span> <span class="k">let</span> <span class="n">n</span> <span class="o">=</span> <span class="n">float_of_string</span> <span class="n">s</span> <span class="k">in</span> <span class="o">(</span><span class="n">abs_float</span> <span class="n">f</span><span class="o">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="o">.</span>
    <span class="k">with</span> <span class="nc">Failure</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="bp">false</span><span class="o">;;</span>
<span class="k">let</span> <span class="n">is_CFloat</span> <span class="n">s</span> <span class="o">=</span>
  <span class="k">try</span> <span class="n">ignore</span><span class="o">(</span><span class="n">float_of_string</span> <span class="n">s</span><span class="o">);</span> <span class="bp">true</span>
  <span class="k">with</span> <span class="nc">Failure</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="bp">false</span><span class="o">;;</span>

<span class="c">(* One of the above predicates can then be used as needed *)</span>
<span class="k">if</span> <span class="n">predicate</span> <span class="n">s</span> <span class="k">then</span>
  <span class="c">(* is a number *)</span>
<span class="k">else</span>
  <span class="c">(* is not a number *)</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN76"
>Comparing Floating-Point Numbers</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">(*-----------------------------*)</span>
<span class="c">(* equalStr num1 num2 accuracy returns true if num1 and num2</span>
<span class="c">   are equal to accuracy decimal places *)</span>

<span class="c">(* done by converting to strings, a la the Perl example *)</span>
<span class="k">let</span> <span class="n">equalStr</span> <span class="n">num1</span> <span class="n">num2</span> <span class="n">accuracy</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">p</span> <span class="n">x</span> <span class="o">=</span> <span class="n">sprintf</span> <span class="s2">&quot;%.*f&quot;</span> <span class="n">accuracy</span> <span class="n">x</span> <span class="k">in</span>
  <span class="o">(</span><span class="n">p</span> <span class="n">num1</span><span class="o">)</span> <span class="o">=</span> <span class="o">(</span><span class="n">p</span> <span class="n">num2</span><span class="o">)</span>

<span class="c">(* Done in a more or less sane way, i.e. treating them as numbers *)</span>
<span class="k">let</span> <span class="n">equal</span> <span class="n">num1</span> <span class="n">num2</span> <span class="n">accuracy</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">chop</span> <span class="n">x</span> <span class="o">=</span> <span class="n">floor</span> <span class="o">(</span><span class="n">x</span> <span class="o">*.</span> <span class="o">(</span><span class="mi">10</span><span class="o">.</span> <span class="o">**</span> <span class="o">(</span><span class="kt">float</span> <span class="n">accuracy</span><span class="o">)))</span> <span class="k">in</span>
  <span class="o">(</span><span class="n">chop</span> <span class="n">num1</span><span class="o">)</span> <span class="o">=</span> <span class="o">(</span><span class="n">chop</span> <span class="n">num2</span><span class="o">);;</span>

<span class="c">(*-----------------------------*)</span>
<span class="k">let</span> <span class="n">wage</span> <span class="o">=</span> <span class="mi">536</span><span class="o">;;</span>
<span class="k">let</span> <span class="n">week</span> <span class="o">=</span> <span class="mi">40</span> <span class="o">*</span> <span class="n">wage</span><span class="o">;;</span>
<span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;One week&#39;s wage is %.2f</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">((</span><span class="kt">float</span> <span class="n">week</span><span class="o">)</span> <span class="o">/.</span> <span class="mi">100</span><span class="o">.);;</span>
<span class="c">(*-----------------------------*)</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN79"
>Rounding Floating-Point Numbers</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">(*-----------------------------*)</span>
<span class="k">let</span> <span class="n">rounded</span> <span class="n">digits</span> <span class="n">fl</span> <span class="o">=</span> <span class="n">float_of_string</span> <span class="o">(</span><span class="n">sprintf</span> <span class="s2">&quot;%.*f&quot;</span> <span class="n">digits</span> <span class="n">fl</span><span class="o">);;</span>
<span class="c">(*-----------------------------*)</span>
<span class="k">let</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="o">.</span><span class="mi">255</span><span class="o">;;</span>
<span class="k">let</span> <span class="n">b</span> <span class="o">=</span> <span class="n">float_of_string</span> <span class="o">(</span><span class="n">sprintf</span> <span class="s2">&quot;%.2f&quot;</span> <span class="n">a</span><span class="o">);;</span>
<span class="k">let</span> <span class="n">c</span> <span class="o">=</span> <span class="n">rounded</span> <span class="mi">2</span> <span class="n">a</span><span class="o">;;</span>
<span class="n">printf</span> <span class="s2">&quot;Unrounded %f</span><span class="se">\n</span><span class="s2">Rounded %f</span><span class="se">\n</span><span class="s2">Other rounded %f</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">;;</span>
<span class="n">printf</span> <span class="s2">&quot;Unrounded %f</span><span class="se">\n</span><span class="s2">Rounded %.2f</span><span class="se">\n</span><span class="s2">Other rounded %f</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">a</span> <span class="n">c</span> <span class="o">(</span><span class="n">rounded</span> <span class="mi">2</span> <span class="n">a</span><span class="o">);;</span>

<span class="c">(*</span>
<span class="c"> * Unrounded 0.255000</span>
<span class="c"> * Rounded 0.260000</span>
<span class="c"> * Other rounded 0.260000</span>
<span class="c"> * Unrounded 0.255000</span>
<span class="c"> * Rounded 0.26</span>
<span class="c"> * Other rounded 0.260000</span>
<span class="c"> *)</span>

<span class="c">(*-----------------------------*)</span>
<span class="c">(* To &quot;round&quot; to the nearest integer, use ceil, floor, or truncate.  Note that</span>
<span class="c">truncate converts the float to an integer, so a conversion back to a float is</span>
<span class="c">necessary *)</span>
<span class="k">let</span> <span class="n">fs</span> <span class="o">=</span> <span class="o">[</span><span class="mi">3</span><span class="o">.</span><span class="mi">3</span><span class="o">;</span> <span class="mi">3</span><span class="o">.</span><span class="mi">5</span><span class="o">;</span> <span class="mi">3</span><span class="o">.</span><span class="mi">7</span><span class="o">;</span> <span class="o">-.</span> <span class="mi">3</span><span class="o">.</span><span class="mi">3</span><span class="o">];;</span>
<span class="n">printf</span> <span class="s2">&quot;number</span><span class="se">\t</span><span class="s2">int</span><span class="se">\t</span><span class="s2">floor</span><span class="se">\t</span><span class="s2">ceil</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">;</span>
<span class="nn">List</span><span class="p">.</span><span class="n">iter</span>
  <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">printf</span> <span class="s2">&quot;%.1f</span><span class="se">\t</span><span class="s2">%.1f</span><span class="se">\t</span><span class="s2">%.1f</span><span class="se">\t</span><span class="s2">%.1f</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">x</span> <span class="o">(</span><span class="kt">float</span> <span class="o">(</span><span class="n">truncate</span> <span class="n">x</span><span class="o">))</span> <span class="o">(</span><span class="n">floor</span> <span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="n">ceil</span> <span class="n">x</span><span class="o">))</span>
  <span class="n">fs</span><span class="o">;;</span>

<span class="c">(*</span>
<span class="c"> * number	int	floor	ceil</span>
<span class="c"> * 3.3	3.0	3.0	4.0</span>
<span class="c"> * 3.5	3.0	3.0	4.0</span>
<span class="c"> * 3.7	3.0	3.0	4.0</span>
<span class="c"> * -3.3	-3.0	-4.0	-3.0</span>
<span class="c"> *)</span>

<span class="c">(* Or if you really want an integer in column 2 *)</span>
<span class="n">printf</span> <span class="s2">&quot;number</span><span class="se">\t</span><span class="s2">int</span><span class="se">\t</span><span class="s2">floor</span><span class="se">\t</span><span class="s2">ceil</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">;</span>
<span class="nn">List</span><span class="p">.</span><span class="n">iter</span>
  <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">printf</span> <span class="s2">&quot;%.1f</span><span class="se">\t</span><span class="s2">%d</span><span class="se">\t</span><span class="s2">%.1f</span><span class="se">\t</span><span class="s2">%.1f</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">x</span> <span class="o">(</span><span class="n">truncate</span> <span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="n">floor</span> <span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="n">ceil</span> <span class="n">x</span><span class="o">))</span>
  <span class="n">fs</span><span class="o">;;</span>

<span class="c">(*</span>
<span class="c"> * number	int	floor	ceil</span>
<span class="c"> * 3.3	3	3.0	4.0</span>
<span class="c"> * 3.5	3	3.0	4.0</span>
<span class="c"> * 3.7	3	3.0	4.0</span>
<span class="c"> * -3.3	-3	-4.0	-3.0</span>
<span class="c"> *)</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN82"
>Converting Between Binary and Decimal</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span>
<span class="c">(*-----------------------------*)</span>
<span class="c">(*</span>
<span class="c"> * Two versions in each direction -- one to deal with decimal strings,</span>
<span class="c"> * and the other to deal with decimal integers.  Binary numbers will</span>
<span class="c"> * always be strings</span>
<span class="c"> *)</span>

<span class="k">let</span> <span class="n">binStr_of_decInt</span> <span class="n">i</span> <span class="o">=</span>
  <span class="k">let</span> <span class="k">rec</span> <span class="n">strip_bits</span> <span class="n">i</span> <span class="n">s</span> <span class="o">=</span>
    <span class="k">match</span> <span class="n">i</span> <span class="k">with</span>
      <span class="mi">0</span> <span class="o">-&gt;</span> <span class="n">s</span>
    <span class="o">|</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="n">strip_bits</span> <span class="o">(</span><span class="n">i</span> <span class="n">lsr</span> <span class="mi">1</span><span class="o">)</span> <span class="o">((</span><span class="n">string_of_int</span> <span class="o">(</span><span class="n">i</span> <span class="ow">land</span> <span class="mh">0x01</span><span class="o">))</span> <span class="o">^</span> <span class="n">s</span><span class="o">)</span> <span class="k">in</span>
  <span class="n">strip_bits</span> <span class="n">i</span> <span class="s2">&quot;&quot;</span><span class="o">;;</span>

<span class="k">let</span> <span class="n">binStr_of_decStr</span> <span class="n">i</span> <span class="o">=</span>
  <span class="k">let</span> <span class="k">rec</span> <span class="n">strip_bits</span> <span class="n">i</span> <span class="n">s</span> <span class="o">=</span>
    <span class="k">match</span> <span class="n">i</span> <span class="k">with</span>
      <span class="mi">0</span> <span class="o">-&gt;</span> <span class="n">s</span>
    <span class="o">|</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="n">strip_bits</span> <span class="o">(</span><span class="n">i</span> <span class="n">lsr</span> <span class="mi">1</span><span class="o">)</span> <span class="o">((</span><span class="n">string_of_int</span> <span class="o">(</span><span class="n">i</span> <span class="ow">land</span> <span class="mh">0x01</span><span class="o">))</span> <span class="o">^</span> <span class="n">s</span><span class="o">)</span> <span class="k">in</span>
  <span class="n">strip_bits</span> <span class="o">(</span><span class="n">int_of_string</span> <span class="n">i</span><span class="o">)</span> <span class="s2">&quot;&quot;</span><span class="o">;;</span>
<span class="c">(* Of course if you have binStr_of_decInt already, it&#39;s easier to just call</span>
<span class="c">   binStr_of_decInt (int_of_string i) *)</span>

<span class="c">(*-----------------------------*)</span>
<span class="k">let</span> <span class="n">decInt_of_binStr</span> <span class="n">s</span> <span class="o">=</span>
  <span class="n">int_of_string</span> <span class="o">(</span><span class="s2">&quot;0b&quot;</span> <span class="o">^</span> <span class="n">s</span><span class="o">);;</span>

<span class="k">let</span> <span class="n">decStr_of_binStr</span> <span class="n">s</span> <span class="o">=</span>
  <span class="n">string_of_int</span> <span class="o">(</span><span class="n">int_of_string</span> <span class="o">(</span><span class="s2">&quot;0b&quot;</span> <span class="o">^</span> <span class="n">s</span><span class="o">));;</span>
<span class="c">(*-----------------------------*)</span>
<span class="k">let</span> <span class="n">numInt</span> <span class="o">=</span> <span class="n">decInt_of_binStr</span> <span class="s2">&quot;0110110&quot;</span><span class="o">;;</span> <span class="c">(* numInt = 54 *)</span>
<span class="k">let</span> <span class="n">numInt</span> <span class="o">=</span> <span class="n">decStr_of_binStr</span> <span class="s2">&quot;0110110&quot;</span><span class="o">;;</span> <span class="c">(* numInt = &quot;54&quot; *)</span>
<span class="k">let</span> <span class="n">bin1</span> <span class="o">=</span> <span class="n">binStr_of_decInt</span> <span class="mi">54</span><span class="o">;;</span>   <span class="c">(* bin1 = &quot;110110&quot; *)</span>
<span class="k">let</span> <span class="n">bin2</span> <span class="o">=</span> <span class="n">binStr_of_decStr</span> <span class="s2">&quot;54&quot;</span><span class="o">;;</span> <span class="c">(* bin2 = &quot;110110&quot; *)</span>
<span class="c">(*-----------------------------*)</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN85"
>Operating on a Series of Integers</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">(*-----------------------------*)</span>
<span class="c">(* The boring way is to use a for loop... *)</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="n">low</span> <span class="k">to</span> <span class="n">high</span> <span class="k">do</span>
  <span class="c">(* Do your stuff *)</span>
  <span class="c">(* Note, if what you want to do in the loop does not have have type unit, you</span>
<span class="c">     need to wrap it with ignore, e.g. ignore (2 * i) *)</span>
<span class="k">done</span>

<span class="c">(* Or you skip the syntactic sugar and write it recursively yourself *)</span>
<span class="k">let</span> <span class="k">rec</span> <span class="n">loop</span> <span class="n">low</span> <span class="n">high</span> <span class="n">f</span> <span class="o">=</span>
  <span class="k">if</span> <span class="n">low</span> <span class="o">&gt;</span> <span class="n">high</span> <span class="k">then</span>
    <span class="bp">()</span>
  <span class="k">else</span>
    <span class="k">begin</span>
      <span class="n">ignore</span> <span class="o">(</span><span class="n">f</span> <span class="n">low</span><span class="o">);</span>
      <span class="n">loop</span> <span class="o">(</span><span class="n">succ</span> <span class="n">low</span><span class="o">)</span> <span class="n">high</span> <span class="n">f</span>
    <span class="k">end</span><span class="o">;;</span>

<span class="c">(* and now with stepsize different from 1 *)</span>
<span class="k">let</span> <span class="k">rec</span> <span class="n">loopStep</span> <span class="n">low</span> <span class="n">high</span> <span class="n">step</span> <span class="n">f</span> <span class="o">=</span>
  <span class="k">if</span> <span class="n">low</span> <span class="o">&gt;</span> <span class="n">high</span> <span class="k">then</span>
    <span class="bp">()</span>
  <span class="k">else</span>
    <span class="k">begin</span>
      <span class="n">ignore</span> <span class="o">(</span><span class="n">f</span> <span class="n">low</span><span class="o">);</span>
      <span class="n">loopStep</span> <span class="o">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">step</span><span class="o">)</span> <span class="n">high</span> <span class="n">f</span>
    <span class="k">end</span><span class="o">;;</span>


<span class="c">(* Or, if you don&#39;t mind wasting space, you can use the useful iter functions</span>
<span class="c"> *)</span>
<span class="c">(* Array based *)</span>
<span class="k">let</span> <span class="n">makeArraySequence</span> <span class="n">lo</span> <span class="n">hi</span> <span class="o">=</span>
  <span class="nn">Array</span><span class="p">.</span><span class="n">init</span> <span class="o">(</span><span class="n">hi</span> <span class="o">-</span> <span class="n">lo</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="k">fun</span> <span class="n">i</span> <span class="o">-&gt;</span> <span class="n">i</span> <span class="o">+</span> <span class="n">lo</span><span class="o">);;</span>
<span class="nn">Array</span><span class="p">.</span><span class="n">iter</span> <span class="o">(</span> <span class="n">your</span> <span class="k">function</span> <span class="n">here</span> <span class="o">)</span> <span class="o">(</span><span class="n">makeArraySequence</span> <span class="n">lo</span> <span class="n">hi</span><span class="o">);;</span>

<span class="c">(* List based *)</span>
<span class="k">let</span> <span class="n">makeListSequence</span> <span class="n">lo</span> <span class="n">hi</span> <span class="o">=</span>
  <span class="k">let</span> <span class="k">rec</span> <span class="n">msHelper</span> <span class="n">lo</span> <span class="n">hi</span> <span class="n">l</span> <span class="o">=</span>
    <span class="k">match</span> <span class="o">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="o">)</span> <span class="k">with</span>
    <span class="mi">0</span> <span class="o">-&gt;</span> <span class="n">b</span><span class="o">::</span><span class="n">l</span>
	<span class="o">|</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="n">msHelper</span> <span class="n">a</span> <span class="o">(</span><span class="n">b</span><span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span><span class="o">::</span><span class="n">l</span><span class="o">)</span> <span class="k">in</span>
  <span class="n">msHelper</span> <span class="n">lo</span> <span class="n">hi</span> <span class="bp">[]</span><span class="o">;;</span>
<span class="nn">List</span><span class="p">.</span><span class="n">iter</span> <span class="o">(</span> <span class="n">your</span> <span class="k">function</span> <span class="n">here</span> <span class="o">)</span> <span class="o">(</span><span class="n">makeListSequence</span> <span class="n">lo</span> <span class="n">hi</span><span class="o">);;</span>
<span class="c">(*-----------------------------*)</span>
<span class="n">printf</span> <span class="s2">&quot;Infancy is: &quot;</span><span class="o">;</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">to</span> <span class="mi">2</span> <span class="k">do</span>
  <span class="n">printf</span> <span class="s2">&quot;%d &quot;</span> <span class="n">i</span>
<span class="k">done</span><span class="o">;;</span>

<span class="n">print_newline</span><span class="bp">()</span><span class="o">;;</span>

<span class="n">printf</span> <span class="s2">&quot;Toddling is: &quot;</span><span class="o">;</span>
<span class="n">loop</span> <span class="mi">3</span> <span class="mi">4</span> <span class="o">(</span><span class="k">fun</span> <span class="n">i</span> <span class="o">-&gt;</span> <span class="n">printf</span> <span class="s2">&quot;%d &quot;</span> <span class="n">i</span><span class="o">);;</span>

<span class="n">print_newline</span> <span class="bp">()</span><span class="o">;;</span>

<span class="n">printf</span> <span class="s2">&quot;Childhood is: &quot;</span><span class="o">;</span>
<span class="nn">Array</span><span class="p">.</span><span class="n">iter</span> <span class="o">(</span><span class="k">fun</span> <span class="n">i</span> <span class="o">-&gt;</span> <span class="n">printf</span> <span class="s2">&quot;%d &quot;</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">makeArraySequence</span> <span class="mi">5</span> <span class="mi">12</span><span class="o">);;</span>

<span class="n">print_newline</span><span class="bp">()</span><span class="o">;;</span>

<span class="c">(*</span>
<span class="c"> * Infancy is: 0 1 2</span>
<span class="c"> * Toddling is: 3 4</span>
<span class="c"> * Childhood is: 5 6 7 8 9 10 11 12</span>
<span class="c"> *)</span>
<span class="c">(*-----------------------------*)</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN88"
>Working with Roman Numerals</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">(* Based on Groovy version by Paul King. *)</span>

<span class="k">let</span> <span class="n">roman_map</span> <span class="o">=</span>
  <span class="o">[</span><span class="mi">1000</span><span class="o">,</span> <span class="s2">&quot;M&quot;</span><span class="o">;</span> <span class="mi">900</span><span class="o">,</span> <span class="s2">&quot;CM&quot;</span><span class="o">;</span> <span class="mi">500</span><span class="o">,</span> <span class="s2">&quot;D&quot;</span><span class="o">;</span> <span class="mi">400</span><span class="o">,</span> <span class="s2">&quot;CD&quot;</span><span class="o">;</span> <span class="mi">100</span><span class="o">,</span> <span class="s2">&quot;C&quot;</span><span class="o">;</span> <span class="mi">90</span><span class="o">,</span> <span class="s2">&quot;XC&quot;</span><span class="o">;</span>
   <span class="mi">50</span><span class="o">,</span>   <span class="s2">&quot;L&quot;</span><span class="o">;</span> <span class="mi">40</span><span class="o">,</span>  <span class="s2">&quot;XL&quot;</span><span class="o">;</span> <span class="mi">10</span><span class="o">,</span>  <span class="s2">&quot;X&quot;</span><span class="o">;</span> <span class="mi">9</span><span class="o">,</span>   <span class="s2">&quot;IX&quot;</span><span class="o">;</span> <span class="mi">5</span><span class="o">,</span>   <span class="s2">&quot;V&quot;</span><span class="o">;</span> <span class="mi">4</span><span class="o">,</span>  <span class="s2">&quot;IV&quot;</span><span class="o">;</span> <span class="mi">1</span><span class="o">,</span> <span class="s2">&quot;I&quot;</span><span class="o">]</span>

<span class="k">let</span> <span class="n">roman</span> <span class="n">arabic</span> <span class="o">=</span>
  <span class="k">let</span> <span class="k">rec</span> <span class="n">loop</span> <span class="n">remains</span> <span class="n">text</span> <span class="n">map</span> <span class="o">=</span>
    <span class="k">match</span> <span class="n">map</span> <span class="k">with</span>
      <span class="o">|</span> <span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="k">value</span><span class="o">)</span> <span class="o">::</span> <span class="n">rest</span> <span class="o">-&gt;</span>
          <span class="k">if</span> <span class="n">remains</span> <span class="o">&gt;=</span> <span class="n">key</span>
          <span class="k">then</span> <span class="n">loop</span> <span class="o">(</span><span class="n">remains</span> <span class="o">-</span> <span class="n">key</span><span class="o">)</span> <span class="o">(</span><span class="n">text</span> <span class="o">^</span> <span class="k">value</span><span class="o">)</span> <span class="n">map</span>
          <span class="k">else</span> <span class="n">loop</span> <span class="n">remains</span> <span class="n">text</span> <span class="n">rest</span>
      <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="n">text</span> <span class="k">in</span>
  <span class="n">loop</span> <span class="n">arabic</span> <span class="s2">&quot;&quot;</span> <span class="n">roman_map</span>

<span class="k">let</span> <span class="n">arabic</span> <span class="n">roman</span> <span class="o">=</span>
  <span class="k">let</span> <span class="k">rec</span> <span class="n">loop</span> <span class="n">text</span> <span class="n">sum</span> <span class="n">map</span> <span class="o">=</span>
    <span class="k">match</span> <span class="n">map</span> <span class="k">with</span>
      <span class="o">|</span> <span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="k">value</span><span class="o">)</span> <span class="o">::</span> <span class="n">rest</span> <span class="o">-&gt;</span>
          <span class="k">if</span> <span class="o">(</span><span class="nn">String</span><span class="p">.</span><span class="n">length</span> <span class="n">text</span> <span class="o">&gt;=</span> <span class="nn">String</span><span class="p">.</span><span class="n">length</span> <span class="k">value</span>
              <span class="o">&amp;&amp;</span> <span class="nn">String</span><span class="p">.</span><span class="n">sub</span> <span class="n">text</span> <span class="mi">0</span> <span class="o">(</span><span class="nn">String</span><span class="p">.</span><span class="n">length</span> <span class="k">value</span><span class="o">)</span> <span class="o">=</span> <span class="k">value</span><span class="o">)</span>
          <span class="k">then</span> <span class="o">(</span><span class="n">loop</span>
                  <span class="o">(</span><span class="nn">String</span><span class="p">.</span><span class="n">sub</span>
                     <span class="n">text</span>
                     <span class="o">(</span><span class="nn">String</span><span class="p">.</span><span class="n">length</span> <span class="k">value</span><span class="o">)</span>
                     <span class="o">(</span><span class="nn">String</span><span class="p">.</span><span class="n">length</span> <span class="n">text</span> <span class="o">-</span> <span class="nn">String</span><span class="p">.</span><span class="n">length</span> <span class="k">value</span><span class="o">))</span>
                  <span class="o">(</span><span class="n">sum</span> <span class="o">+</span> <span class="n">key</span><span class="o">)</span>
                  <span class="n">map</span><span class="o">)</span>
          <span class="k">else</span> <span class="n">loop</span> <span class="n">text</span> <span class="n">sum</span> <span class="n">rest</span>
      <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="n">sum</span> <span class="k">in</span>
  <span class="n">loop</span> <span class="o">(</span><span class="nn">String</span><span class="p">.</span><span class="n">uppercase</span> <span class="n">roman</span><span class="o">)</span> <span class="mi">0</span> <span class="n">roman_map</span>

<span class="c">(*-----------------------------*)</span>

<span class="c">(* Alternative version by Ken Wakita. *)</span>
<span class="k">let</span> <span class="n">roman</span> <span class="n">arabic</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">nstr</span> <span class="n">s</span> <span class="n">n</span> <span class="o">=</span> <span class="nn">String</span><span class="p">.</span><span class="n">concat</span> <span class="s2">&quot;&quot;</span> <span class="o">(</span><span class="nn">Array</span><span class="p">.</span><span class="n">to_list</span> <span class="o">(</span><span class="nn">Array</span><span class="p">.</span><span class="n">make</span> <span class="n">n</span> <span class="n">s</span><span class="o">))</span> <span class="k">in</span>
  <span class="n">snd</span> <span class="o">(</span><span class="nn">List</span><span class="p">.</span><span class="n">fold_left</span>
         <span class="o">(</span><span class="k">fun</span> <span class="o">(</span><span class="n">arabic</span><span class="o">,</span> <span class="n">roman</span><span class="o">)</span> <span class="o">(</span><span class="n">arab</span><span class="o">,</span> <span class="n">rom</span><span class="o">)</span> <span class="o">-&gt;</span>
           <span class="n">arabic</span> <span class="ow">mod</span> <span class="n">arab</span><span class="o">,</span> <span class="n">roman</span> <span class="o">^</span> <span class="o">(</span><span class="n">nstr</span> <span class="n">rom</span> <span class="o">(</span><span class="n">arabic</span> <span class="o">/</span> <span class="n">arab</span><span class="o">)))</span>
         <span class="o">(</span><span class="n">arabic</span><span class="o">,</span> <span class="s2">&quot;&quot;</span><span class="o">)</span>
         <span class="n">roman_map</span><span class="o">)</span>

<span class="c">(*-----------------------------*)</span>

<span class="k">let</span> <span class="bp">()</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">roman_fifteen</span> <span class="o">=</span> <span class="n">roman</span> <span class="mi">15</span> <span class="k">in</span>
  <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;Roman for fifteen is %s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">roman_fifteen</span><span class="o">;</span>
  <span class="k">let</span> <span class="n">arabic_fifteen</span> <span class="o">=</span> <span class="n">arabic</span> <span class="n">roman_fifteen</span> <span class="k">in</span>
  <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;Converted back, %s is %d</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">roman_fifteen</span> <span class="n">arabic_fifteen</span>

<span class="c">(* Roman for fifteen is XV</span>
<span class="c">   Converted back, XV is 15 *)</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN91"
>Generating Random Numbers</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">(*-----------------------------*)</span>
<span class="k">let</span> <span class="n">random_int</span> <span class="n">lo</span> <span class="n">hi</span> <span class="o">=</span>
  <span class="o">(</span><span class="nn">Random</span><span class="p">.</span><span class="n">int</span> <span class="o">(</span><span class="n">hi</span> <span class="o">-</span> <span class="n">lo</span> <span class="o">+</span> <span class="mi">1</span><span class="o">))</span> <span class="o">+</span> <span class="n">lo</span><span class="o">;;</span>

<span class="k">let</span> <span class="n">random_float</span> <span class="n">lo</span> <span class="n">hi</span> <span class="o">=</span>
  <span class="o">(</span><span class="nn">Random</span><span class="p">.</span><span class="n">float</span> <span class="o">(</span><span class="n">hi</span> <span class="o">-.</span> <span class="n">lo</span> <span class="o">+.</span> <span class="mi">1</span><span class="o">.))</span> <span class="o">+.</span> <span class="n">lo</span><span class="o">;;</span>
<span class="c">(*-----------------------------*)</span>
<span class="k">let</span> <span class="n">random_number</span> <span class="o">=</span> <span class="n">random_int</span> <span class="mi">25</span> <span class="mi">75</span> <span class="k">in</span>
  <span class="n">printf</span> <span class="s2">&quot;%d</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">random_number</span><span class="o">;;</span>
<span class="c">(*-----------------------------*)</span>
<span class="k">let</span> <span class="n">elem</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.(</span><span class="nn">Random</span><span class="p">.</span><span class="n">int</span> <span class="o">(</span><span class="nn">Arry</span><span class="p">.</span><span class="n">length</span> <span class="n">arr</span><span class="o">))</span>
<span class="c">(*-----------------------------*)</span>
<span class="k">let</span> <span class="n">uc</span> <span class="o">=</span> <span class="nn">Array</span><span class="p">.</span><span class="n">init</span> <span class="mi">26</span> <span class="o">(</span><span class="k">fun</span> <span class="n">i</span> <span class="o">-&gt;</span> <span class="nn">Char</span><span class="p">.</span><span class="n">chr</span> <span class="o">(</span><span class="n">i</span><span class="o">+</span> <span class="o">(</span><span class="nn">Char</span><span class="p">.</span><span class="n">code</span> <span class="sc">&#39;A&#39;</span><span class="o">)))</span>
<span class="ow">and</span> <span class="n">lc</span> <span class="o">=</span> <span class="nn">Array</span><span class="p">.</span><span class="n">init</span> <span class="mi">26</span> <span class="o">(</span><span class="k">fun</span> <span class="n">i</span> <span class="o">-&gt;</span> <span class="nn">Char</span><span class="p">.</span><span class="n">chr</span> <span class="o">(</span><span class="n">i</span><span class="o">+</span> <span class="o">(</span><span class="nn">Char</span><span class="p">.</span><span class="n">code</span> <span class="sc">&#39;a&#39;</span><span class="o">)))</span>
<span class="ow">and</span> <span class="n">nums</span> <span class="o">=</span> <span class="nn">Array</span><span class="p">.</span><span class="n">init</span> <span class="mi">10</span> <span class="o">(</span><span class="k">fun</span> <span class="n">i</span> <span class="o">-&gt;</span> <span class="nn">Char</span><span class="p">.</span><span class="n">chr</span> <span class="o">(</span><span class="n">i</span> <span class="o">+</span> <span class="o">(</span><span class="nn">Char</span><span class="p">.</span><span class="n">code</span> <span class="sc">&#39;0&#39;</span><span class="o">)))</span>
<span class="ow">and</span> <span class="n">puncs</span> <span class="o">=</span> <span class="o">[|</span> <span class="sc">&#39;!&#39;</span><span class="o">;</span> <span class="sc">&#39;@&#39;</span><span class="o">;</span> <span class="sc">&#39;$&#39;</span><span class="o">;</span> <span class="sc">&#39;%&#39;</span><span class="o">;</span> <span class="sc">&#39;^&#39;</span><span class="o">;</span> <span class="sc">&#39;&amp;&#39;</span><span class="o">;</span> <span class="sc">&#39;*&#39;</span> <span class="o">|];;</span>
<span class="k">let</span> <span class="n">chars</span> <span class="o">=</span> <span class="nn">Array</span><span class="p">.</span><span class="n">concat</span> <span class="o">[</span><span class="n">uc</span><span class="o">;</span> <span class="n">lc</span><span class="o">;</span> <span class="n">nums</span><span class="o">;</span> <span class="n">puncs</span><span class="o">];;</span>

<span class="c">(* to generate the random password as a char array *)</span>
<span class="k">let</span> <span class="n">password</span> <span class="o">=</span> <span class="nn">Array</span><span class="p">.</span><span class="n">init</span> <span class="mi">8</span> <span class="o">(</span><span class="k">fun</span> <span class="n">i</span> <span class="o">-&gt;</span> <span class="n">chars</span><span class="o">.(</span><span class="nn">Random</span><span class="p">.</span><span class="n">int</span> <span class="o">(</span><span class="nn">Array</span><span class="p">.</span><span class="n">length</span> <span class="n">chars</span><span class="o">)));;</span>
<span class="c">(* to generate the random password as a string *)</span>
<span class="k">let</span> <span class="n">passString</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">s</span> <span class="o">=</span> <span class="nn">String</span><span class="p">.</span><span class="n">make</span> <span class="mi">8</span> <span class="sc">&#39; &#39;</span> <span class="k">in</span>
  <span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span> <span class="k">to</span> <span class="mi">7</span> <span class="k">do</span>
	<span class="n">s</span><span class="o">.[</span><span class="n">i</span><span class="o">]</span> <span class="o">&lt;-</span> <span class="n">chars</span><span class="o">.(</span><span class="nn">Random</span><span class="p">.</span><span class="n">int</span> <span class="o">(</span><span class="nn">Array</span><span class="p">.</span><span class="n">length</span> <span class="n">chars</span><span class="o">))</span>
  <span class="k">done</span><span class="o">;</span>
  <span class="n">s</span><span class="o">;;</span>

<span class="c">(*-----------------------------*)</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN94"
>Generating Different Random Numbers</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">(* Seed the generator with an integer *)</span>
<span class="nn">Random</span><span class="p">.</span><span class="n">init</span> <span class="mi">5</span><span class="o">;;</span>

<span class="c">(* Seed the generator with an array of integers *)</span>
<span class="nn">Random</span><span class="p">.</span><span class="n">full_init</span> <span class="o">[|</span> <span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">178653</span><span class="o">;</span> <span class="o">-</span><span class="mi">62</span> <span class="o">|];;</span>

<span class="c">(* Automatically seed the generator in a system-dependant manner *)</span>
<span class="nn">Random</span><span class="p">.</span><span class="n">self_init</span> <span class="bp">()</span><span class="o">;;</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN97"
>Making Numbers Even More Random</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">(* This requires installation of the third party the cryptokit library... *)</span>
<span class="k">let</span> <span class="n">prng</span> <span class="o">=</span> <span class="nn">Cryptokit</span><span class="p">.</span><span class="nn">Random</span><span class="p">.</span><span class="n">secure_rng</span><span class="o">;;</span>
<span class="k">let</span> <span class="n">buf</span> <span class="o">=</span> <span class="nn">String</span><span class="p">.</span><span class="n">make</span> <span class="mi">10</span> <span class="sc">&#39; &#39;</span><span class="o">;;</span>
<span class="c">(* random_bytes buf pos len stores len random bytes in string buf, starting at position pos *)</span>
<span class="n">prng</span><span class="o">#</span><span class="n">random_bytes</span> <span class="n">buf</span> <span class="mi">0</span> <span class="mi">10</span><span class="o">;;</span>  <span class="c">(* buf now contains 10 random bytes *)</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN100"
>Generating Biased Random Numbers</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">(* Note that this will return just one of the numbers, as returning either one</span>
<span class="c">* or the other would requires always constructing an array or a list -- this</span>
<span class="c">* just returns a float *)</span>

<span class="k">let</span> <span class="n">gaussianRand</span> <span class="bp">()</span> <span class="o">=</span>
  <span class="k">let</span> <span class="k">rec</span> <span class="n">getW</span> <span class="bp">()</span> <span class="o">=</span>
    <span class="k">let</span> <span class="n">u1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">.</span> <span class="o">*.</span> <span class="o">(</span><span class="nn">Random</span><span class="p">.</span><span class="n">float</span> <span class="mi">1</span><span class="o">.)</span> <span class="o">-.</span> <span class="mi">1</span><span class="o">.</span>
    <span class="ow">and</span> <span class="n">u2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">.</span> <span class="o">*.</span> <span class="o">(</span><span class="nn">Random</span><span class="p">.</span><span class="n">float</span> <span class="mi">1</span><span class="o">.)</span> <span class="o">-.</span> <span class="mi">1</span><span class="o">.</span> <span class="k">in</span>
    <span class="k">let</span> <span class="n">w</span> <span class="o">=</span> <span class="n">u1</span> <span class="o">*.</span> <span class="n">u1</span> <span class="o">+.</span> <span class="n">u2</span> <span class="o">*.</span> <span class="n">u2</span> <span class="k">in</span>
    <span class="k">if</span> <span class="n">w</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">.</span> <span class="k">then</span> <span class="n">w</span><span class="o">,</span><span class="n">u1</span><span class="o">,</span><span class="n">u2</span> <span class="k">else</span> <span class="n">getW</span> <span class="bp">()</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">w</span><span class="o">,</span><span class="n">u1</span><span class="o">,</span><span class="n">u2</span> <span class="o">=</span> <span class="n">getW</span> <span class="bp">()</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">w</span> <span class="o">=</span> <span class="n">sqrt</span><span class="o">((-</span><span class="mi">2</span><span class="o">.</span> <span class="o">*.</span> <span class="o">(</span><span class="n">log</span> <span class="n">w</span><span class="o">))</span> <span class="o">/.</span> <span class="n">w</span><span class="o">)</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">g2</span> <span class="o">=</span> <span class="n">u1</span> <span class="o">*.</span> <span class="n">w</span>
  <span class="ow">and</span> <span class="n">g1</span> <span class="o">=</span> <span class="n">u2</span> <span class="o">*.</span> <span class="n">w</span> <span class="k">in</span>
  <span class="n">g1</span><span class="o">;;</span>


<span class="c">(* note that because of the way dist is used, it makes the most sense to return</span>
<span class="c">* it as a sorted associative list rather than another hash table *)</span>
<span class="k">let</span> <span class="n">weightToDist</span> <span class="n">whash</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">total</span> <span class="o">=</span> <span class="nn">Hashtbl</span><span class="p">.</span><span class="n">fold</span> <span class="o">(</span><span class="k">fun</span> <span class="n">k</span> <span class="n">v</span> <span class="n">b</span> <span class="o">-&gt;</span> <span class="n">b</span> <span class="o">+.</span> <span class="n">v</span><span class="o">)</span> <span class="n">whash</span> <span class="mi">0</span><span class="o">.</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">dist</span> <span class="o">=</span> <span class="nn">Hashtbl</span><span class="p">.</span><span class="n">fold</span> <span class="o">(</span><span class="k">fun</span> <span class="n">k</span> <span class="n">v</span> <span class="n">b</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">v</span><span class="o">,</span><span class="n">k</span><span class="o">)::</span><span class="n">b</span><span class="o">)</span> <span class="n">whash</span> <span class="bp">[]</span> <span class="k">in</span>
  <span class="nn">List</span><span class="p">.</span><span class="n">sort</span> <span class="n">compare</span> <span class="n">dist</span><span class="o">;;</span>

<span class="k">let</span> <span class="k">rec</span> <span class="n">weightedRand</span> <span class="n">dhash</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">r</span> <span class="o">=</span> <span class="n">ref</span> <span class="o">(</span><span class="nn">Random</span><span class="p">.</span><span class="n">float</span> <span class="mi">1</span><span class="o">.)</span> <span class="k">in</span>
  <span class="k">try</span>
    <span class="k">let</span> <span class="n">v</span><span class="o">,</span><span class="n">k</span> <span class="o">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">find</span> <span class="o">(</span><span class="k">fun</span> <span class="o">(</span><span class="n">v</span><span class="o">,</span><span class="n">k</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">r</span> <span class="o">:=</span> <span class="o">!</span><span class="n">r</span> <span class="o">-.</span> <span class="n">v</span><span class="o">;</span> <span class="o">!</span><span class="n">r</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">.)</span> <span class="n">dhash</span> <span class="k">in</span> <span class="n">k</span>
  <span class="k">with</span> <span class="nc">Not_found</span> <span class="o">-&gt;</span> <span class="n">weightedRand</span> <span class="n">dhash</span><span class="o">;;</span>

<span class="k">let</span> <span class="n">mean</span><span class="o">,</span><span class="n">dev</span> <span class="o">=</span> <span class="mi">25</span><span class="o">.,</span><span class="mi">2</span><span class="o">.</span> <span class="k">in</span>
<span class="k">let</span> <span class="n">salary</span> <span class="o">=</span> <span class="n">gaussianRand</span> <span class="bp">()</span> <span class="o">*.</span> <span class="n">sdev</span> <span class="o">+.</span> <span class="n">mean</span><span class="o">;;</span>
<span class="n">printf</span> <span class="s2">&quot;You have been hired at $%.2f</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">salary</span><span class="o">;;</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN103"
>Doing Trigonometry in Degrees, not Radians</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="k">let</span> <span class="n">pi</span> <span class="o">=</span> <span class="n">acos</span><span class="o">(-.</span> <span class="mi">1</span><span class="o">.);;</span>
<span class="k">let</span> <span class="n">degrees_of_radians</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">180</span><span class="o">.</span> <span class="o">*.</span> <span class="n">r</span> <span class="o">/.</span> <span class="n">pi</span><span class="o">;;</span>
<span class="k">let</span> <span class="n">radians_of_degrees</span> <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">*.</span> <span class="n">pi</span> <span class="o">/.</span> <span class="mi">180</span><span class="o">.;;</span>

<span class="k">let</span> <span class="n">sinDeg</span> <span class="n">d</span> <span class="o">=</span> <span class="n">sin</span> <span class="o">(</span><span class="n">radians_of_degrees</span> <span class="n">d</span><span class="o">);;</span>
<span class="k">let</span> <span class="n">cosDeg</span> <span class="n">d</span> <span class="o">=</span> <span class="n">cos</span> <span class="o">(</span><span class="n">radians_of_degrees</span> <span class="n">d</span><span class="o">);;</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN106"
>Calculating More Trigonometric Functions</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">(* cos, sin, tan, acos, asin, atan, sinh, cosh and tanh are all standard</span>
<span class="c">functions, but missing functions, such as secant can be construced in the usual</span>
<span class="c">way... *)</span>

<span class="k">let</span> <span class="n">sec</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="o">.</span> <span class="o">/.</span> <span class="o">(</span><span class="n">sin</span> <span class="n">x</span><span class="o">);;</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN109"
>Taking Logarithms</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span>
<span class="c">(* to take a natural log, use the log function *)</span>
<span class="k">let</span> <span class="n">log_e</span> <span class="o">=</span> <span class="n">log</span> <span class="mi">100</span><span class="o">.;;</span>

<span class="c">(* to take a log to base 10, use the log10 function *)</span>
<span class="k">let</span> <span class="n">log_10</span> <span class="o">=</span> <span class="n">log10</span> <span class="mi">100</span><span class="o">.;;</span>

<span class="c">(* to take a log to an arbitrary base, use traditional identities *)</span>
<span class="k">let</span> <span class="n">logB</span> <span class="n">base</span> <span class="n">x</span> <span class="o">=</span> <span class="o">(</span><span class="n">log</span> <span class="n">x</span><span class="o">)</span> <span class="o">/.</span> <span class="o">(</span><span class="n">log</span> <span class="n">base</span><span class="o">);;</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN112"
>Multiplying Matrices</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="k">let</span> <span class="n">mmult</span> <span class="n">m1</span> <span class="n">m2</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">dim</span> <span class="n">m</span> <span class="o">=</span>
    <span class="nn">Array</span><span class="p">.</span><span class="n">length</span> <span class="n">m</span><span class="o">,</span><span class="nn">Array</span><span class="p">.</span><span class="n">length</span> <span class="n">m</span><span class="o">.(</span><span class="mi">0</span><span class="o">)</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">r1</span><span class="o">,</span><span class="n">c1</span> <span class="o">=</span> <span class="n">dim</span> <span class="n">m1</span>
  <span class="ow">and</span> <span class="n">r2</span><span class="o">,</span><span class="n">c2</span> <span class="o">=</span> <span class="n">dim</span> <span class="n">m2</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">c1</span> <span class="o">&lt;&gt;</span> <span class="n">r2</span> <span class="k">then</span> <span class="k">raise</span> <span class="o">(</span><span class="nc">Invalid_argument</span> <span class="s2">&quot;Matrix dimensions don&#39;t match&quot;</span><span class="o">)</span>
  <span class="k">else</span>
    <span class="k">begin</span>
      <span class="k">let</span> <span class="n">dotP</span> <span class="n">v1</span> <span class="n">v2</span> <span class="o">=</span>
        <span class="k">let</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">ref</span> <span class="mi">0</span><span class="o">.</span> <span class="k">in</span>
        <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">to</span> <span class="nn">Array</span><span class="p">.</span><span class="n">length</span> <span class="n">v1</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">do</span>
          <span class="n">sum</span> <span class="o">:=</span> <span class="o">!</span><span class="n">sum</span> <span class="o">+.</span> <span class="o">(</span><span class="n">v1</span><span class="o">.(</span><span class="n">i</span><span class="o">)</span> <span class="o">*.</span> <span class="n">v2</span><span class="o">.(</span><span class="n">i</span><span class="o">))</span>
        <span class="k">done</span><span class="o">;</span>
        <span class="o">!</span><span class="n">sum</span> <span class="k">in</span>
      <span class="k">let</span> <span class="n">row</span> <span class="n">m</span> <span class="n">i</span> <span class="o">=</span> <span class="n">m</span><span class="o">.(</span><span class="n">i</span><span class="o">)</span>
      <span class="ow">and</span> <span class="n">col</span> <span class="n">m</span> <span class="n">i</span> <span class="o">=</span> <span class="nn">Array</span><span class="p">.</span><span class="n">init</span> <span class="o">(</span><span class="nn">Array</span><span class="p">.</span><span class="n">length</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="k">fun</span> <span class="n">r</span> <span class="o">-&gt;</span> <span class="n">m</span><span class="o">.(</span><span class="n">r</span><span class="o">).(</span><span class="n">i</span><span class="o">))</span> <span class="k">in</span>
      <span class="k">let</span> <span class="n">res</span> <span class="o">=</span> <span class="nn">Array</span><span class="p">.</span><span class="n">make_matrix</span> <span class="n">r1</span> <span class="n">c2</span> <span class="mi">0</span><span class="o">.</span> <span class="k">in</span>
      <span class="k">for</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">to</span> <span class="n">pred</span> <span class="n">r1</span> <span class="k">do</span>
        <span class="k">for</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">to</span> <span class="n">pred</span> <span class="n">c2</span> <span class="k">do</span>
          <span class="n">res</span><span class="o">.(</span><span class="n">r</span><span class="o">).(</span><span class="n">c</span><span class="o">)</span> <span class="o">&lt;-</span> <span class="n">dotP</span> <span class="o">(</span><span class="n">row</span> <span class="n">m1</span> <span class="n">r</span><span class="o">)</span> <span class="o">(</span><span class="n">col</span> <span class="n">m2</span> <span class="n">c</span><span class="o">)</span>
        <span class="k">done</span>
      <span class="k">done</span><span class="o">;</span>
      <span class="n">res</span>
    <span class="k">end</span><span class="o">;;</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN115"
>Using Complex Numbers</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">(*-----------------------------*)</span>
<span class="c">(* c = a * b manually *)</span>
<span class="k">type</span> <span class="n">cplx</span> <span class="o">=</span> <span class="o">{</span> <span class="n">real</span> <span class="o">:</span> <span class="kt">float</span><span class="o">;</span> <span class="n">imag</span> <span class="o">:</span> <span class="kt">float</span><span class="o">;</span> <span class="o">};;</span>
<span class="k">let</span> <span class="n">c</span> <span class="o">=</span> <span class="o">{</span><span class="n">real</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">real</span> <span class="o">*.</span> <span class="n">b</span><span class="o">.</span><span class="n">real</span> <span class="o">-.</span> <span class="n">a</span><span class="o">.</span><span class="n">imag</span> <span class="o">*.</span> <span class="n">b</span><span class="o">.</span><span class="n">imag</span><span class="o">;</span>
         <span class="n">imag</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">imag</span> <span class="o">*.</span> <span class="n">b</span><span class="o">.</span><span class="n">real</span> <span class="o">+.</span> <span class="n">b</span><span class="o">.</span><span class="n">imag</span> <span class="o">*.</span> <span class="n">a</span><span class="o">.</span><span class="n">real</span><span class="o">};;</span>
<span class="c">(*-----------------------------*)</span>

<span class="c">(* c = a * b using the Complex module *)</span>
<span class="k">open</span> <span class="nc">Complex</span><span class="o">;;</span>

<span class="k">let</span> <span class="n">c</span> <span class="o">=</span> <span class="nn">Complex</span><span class="p">.</span><span class="n">mul</span> <span class="n">a</span> <span class="n">b</span><span class="o">;;</span>
<span class="c">(* Note that we could have simply said let c = mul a b, but a later binding of a value to the</span>
<span class="c">   name mul would render the complex mul invisible after that, Complex.mul is</span>
<span class="c">   less ambiguous. *)</span>
<span class="c">(*-----------------------------*)</span>
<span class="k">let</span> <span class="n">a</span> <span class="o">=</span> <span class="o">{</span><span class="n">real</span><span class="o">=</span><span class="mi">3</span><span class="o">.;</span> <span class="n">imag</span><span class="o">=</span><span class="mi">5</span><span class="o">.};;</span>
<span class="k">let</span> <span class="n">b</span> <span class="o">=</span> <span class="o">{</span><span class="n">real</span><span class="o">=</span><span class="mi">2</span><span class="o">.;</span> <span class="n">imag</span><span class="o">=(-.</span> <span class="mi">2</span><span class="o">.);}</span>
<span class="k">let</span> <span class="n">c</span> <span class="o">=</span> <span class="o">{</span><span class="n">real</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">real</span> <span class="o">*.</span> <span class="n">b</span><span class="o">.</span><span class="n">real</span> <span class="o">-.</span> <span class="n">a</span><span class="o">.</span><span class="n">imag</span> <span class="o">*.</span> <span class="n">b</span><span class="o">.</span><span class="n">imag</span><span class="o">;</span>
         <span class="n">imag</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">imag</span> <span class="o">*.</span> <span class="n">b</span><span class="o">.</span><span class="n">real</span> <span class="o">+.</span> <span class="n">b</span><span class="o">.</span><span class="n">imag</span> <span class="o">*.</span> <span class="n">a</span><span class="o">.</span><span class="n">real</span><span class="o">};;</span>
<span class="n">printf</span> <span class="s2">&quot;c = %f+%fi</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">c</span><span class="o">.</span><span class="n">real</span> <span class="n">c</span><span class="o">.</span><span class="n">imag</span><span class="o">;;</span>

<span class="c">(* c = 16.000000+4.000000i *)</span>

<span class="k">let</span> <span class="n">a</span> <span class="o">=</span> <span class="o">{</span><span class="n">re</span><span class="o">=</span><span class="mi">3</span><span class="o">.;</span> <span class="n">im</span><span class="o">=</span><span class="mi">5</span><span class="o">.};;</span>
<span class="k">let</span> <span class="n">b</span> <span class="o">=</span> <span class="o">{</span><span class="n">re</span><span class="o">=</span><span class="mi">2</span><span class="o">.;</span> <span class="n">im</span><span class="o">=(-.</span> <span class="mi">2</span><span class="o">.);}</span>
<span class="k">let</span> <span class="n">c</span> <span class="o">=</span> <span class="n">mul</span> <span class="n">a</span> <span class="n">b</span><span class="o">;;</span>
<span class="n">printf</span> <span class="s2">&quot;c = %f+%fi</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">c</span><span class="o">.</span><span class="n">re</span> <span class="n">c</span><span class="o">.</span><span class="n">im</span><span class="o">;;</span>

<span class="c">(* c = 16.000000+4.000000i *)</span>

<span class="k">let</span> <span class="n">d</span> <span class="o">=</span> <span class="o">{</span><span class="n">re</span><span class="o">=</span><span class="mi">3</span><span class="o">.;</span> <span class="n">im</span><span class="o">=</span><span class="mi">4</span><span class="o">.};;</span>
<span class="k">let</span> <span class="n">s</span> <span class="o">=</span> <span class="n">sqrt</span> <span class="n">d</span> <span class="k">in</span>
<span class="n">printf</span> <span class="s2">&quot;sqrt(%.2f+%.2fi) = %.2f+%.2fi</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">d</span><span class="o">.</span><span class="n">re</span> <span class="n">d</span><span class="o">.</span><span class="n">im</span> <span class="n">s</span><span class="o">.</span><span class="n">re</span> <span class="n">s</span><span class="o">.</span><span class="n">im</span><span class="o">;;</span>

<span class="c">(* sqrt(3.00+4.00i) = 2.00+1.00i *)</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN118"
>Converting Between Octal and Hexadecimal</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">(* Since integers and strings are very different things in OCaml, we will</span>
<span class="c">   represent both octal and hexidecimal values as strings *)</span>

<span class="k">let</span> <span class="n">oct_of_hex</span> <span class="n">h</span> <span class="o">=</span>
  <span class="nn">Printf</span><span class="p">.</span><span class="n">sprintf</span> <span class="s2">&quot;%0o&quot;</span> <span class="o">(</span><span class="n">int_of_string</span> <span class="o">(</span><span class="s2">&quot;0x&quot;</span> <span class="o">^</span> <span class="n">h</span><span class="o">));;</span>
<span class="k">let</span> <span class="n">hex_of_oct</span> <span class="n">o</span> <span class="o">=</span>
  <span class="nn">Printf</span><span class="p">.</span><span class="n">sprintf</span> <span class="s2">&quot;%0x&quot;</span> <span class="o">(</span><span class="n">int_of_string</span> <span class="o">(</span><span class="s2">&quot;0o&quot;</span> <span class="o">^</span> <span class="n">o</span><span class="o">));;</span>

<span class="c">(* One small problem is that OCaml integers are 31 (or 63) bit values, if you need</span>
<span class="c">   something larger, you can use the following for a full 32 bits: *)</span>
<span class="k">let</span> <span class="n">oct_of_hex32</span> <span class="n">h</span> <span class="o">=</span>
  <span class="nn">Printf</span><span class="p">.</span><span class="n">sprintf</span> <span class="s2">&quot;%0lo&quot;</span> <span class="o">(</span><span class="nn">Int32</span><span class="p">.</span><span class="n">of_string</span> <span class="o">(</span><span class="s2">&quot;0x&quot;</span> <span class="o">^</span> <span class="n">h</span><span class="o">));;</span>
<span class="k">let</span> <span class="n">hex_of_oct32</span> <span class="n">o</span> <span class="o">=</span>
  <span class="nn">Printf</span><span class="p">.</span><span class="n">sprintf</span> <span class="s2">&quot;%0lx&quot;</span> <span class="o">(</span><span class="nn">Int32</span><span class="p">.</span><span class="n">of_string</span> <span class="o">(</span><span class="s2">&quot;0o&quot;</span> <span class="o">^</span> <span class="n">o</span><span class="o">));;</span>

<span class="c">(* Or this for 64 bits: *)</span>
<span class="k">let</span> <span class="n">oct_of_hex64</span> <span class="n">h</span> <span class="o">=</span>
  <span class="nn">Printf</span><span class="p">.</span><span class="n">sprintf</span> <span class="s2">&quot;%0Lo&quot;</span> <span class="o">(</span><span class="nn">Int64</span><span class="p">.</span><span class="n">of_string</span> <span class="o">(</span><span class="s2">&quot;0x&quot;</span> <span class="o">^</span> <span class="n">h</span><span class="o">));;</span>
<span class="k">let</span> <span class="n">hex_of_oct64</span> <span class="n">o</span> <span class="o">=</span>
  <span class="nn">Printf</span><span class="p">.</span><span class="n">sprintf</span> <span class="s2">&quot;%0Lx&quot;</span> <span class="o">(</span><span class="nn">Int64</span><span class="p">.</span><span class="n">of_string</span> <span class="o">(</span><span class="s2">&quot;0o&quot;</span> <span class="o">^</span> <span class="n">o</span><span class="o">));;</span>

<span class="c">(* For anything else you have to roll your own *)</span>
<span class="k">let</span> <span class="n">chopn</span> <span class="n">n</span> <span class="n">s</span> <span class="o">=</span>
  <span class="c">(* Chops strings into list of n byte substrings *)</span>
  <span class="k">match</span> <span class="n">s</span> <span class="k">with</span>
    <span class="s2">&quot;&quot;</span> <span class="o">-&gt;</span> <span class="o">[</span><span class="s2">&quot;&quot;</span><span class="o">]</span> <span class="c">(* avoids wierd edge case *)</span>
    <span class="o">|</span> <span class="o">_</span> <span class="o">-&gt;</span>
      <span class="k">let</span> <span class="n">ex</span> <span class="o">=</span> <span class="o">(</span><span class="nn">String</span><span class="p">.</span><span class="n">length</span> <span class="n">s</span><span class="o">)</span> <span class="ow">mod</span> <span class="n">n</span> <span class="k">in</span>
      <span class="k">let</span> <span class="n">ss</span> <span class="o">=</span> <span class="k">if</span> <span class="n">ex</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span> <span class="n">s</span> <span class="k">else</span> <span class="o">((</span><span class="nn">String</span><span class="p">.</span><span class="n">make</span> <span class="o">(</span><span class="n">n</span><span class="o">-</span><span class="n">ex</span><span class="o">)</span> <span class="sc">&#39;0&#39;</span><span class="o">)</span> <span class="o">^</span> <span class="n">s</span><span class="o">)</span> <span class="k">in</span>
      <span class="k">let</span> <span class="k">rec</span> <span class="n">schopn</span> <span class="n">x</span> <span class="n">s</span> <span class="n">l</span> <span class="o">=</span>
        <span class="k">match</span> <span class="n">x</span> <span class="k">with</span>
          <span class="mi">0</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="nn">String</span><span class="p">.</span><span class="n">sub</span> <span class="n">s</span> <span class="mi">0</span> <span class="n">n</span><span class="o">)::</span><span class="n">l</span>
          <span class="o">|</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="n">schopn</span> <span class="o">(</span><span class="n">x</span><span class="o">-</span><span class="n">n</span><span class="o">)</span> <span class="n">s</span> <span class="o">((</span><span class="nn">String</span><span class="p">.</span><span class="n">sub</span> <span class="n">s</span> <span class="n">x</span> <span class="n">n</span><span class="o">)::</span><span class="n">l</span><span class="o">)</span> <span class="k">in</span>
      <span class="n">schopn</span> <span class="o">(</span><span class="nn">String</span><span class="p">.</span><span class="n">length</span> <span class="n">ss</span> <span class="o">-</span> <span class="n">n</span><span class="o">)</span> <span class="n">ss</span> <span class="bp">[]</span><span class="o">;;</span>

<span class="k">let</span> <span class="n">long_oct_of_hex</span> <span class="n">h</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">choppedH</span> <span class="o">=</span> <span class="n">chopn</span> <span class="mi">6</span> <span class="n">h</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">f</span> <span class="n">x</span> <span class="o">=</span> <span class="n">int_of_string</span> <span class="o">(</span><span class="s2">&quot;0x&quot;</span> <span class="o">^</span> <span class="n">x</span><span class="o">)</span> <span class="k">in</span>
  <span class="nn">String</span><span class="p">.</span><span class="n">concat</span> <span class="s2">&quot;&quot;</span> <span class="o">(</span><span class="nn">List</span><span class="p">.</span><span class="n">map</span> <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="nn">Printf</span><span class="p">.</span><span class="n">sprintf</span> <span class="s2">&quot;%08o&quot;</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">))</span> <span class="n">choppedH</span><span class="o">);;</span>

<span class="k">let</span> <span class="n">long_hex_of_oct</span> <span class="n">o</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">choppedO</span> <span class="o">=</span> <span class="n">chopn</span> <span class="mi">8</span> <span class="n">o</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">f</span> <span class="n">x</span> <span class="o">=</span> <span class="n">int_of_string</span> <span class="o">(</span><span class="s2">&quot;0o&quot;</span> <span class="o">^</span> <span class="n">x</span><span class="o">)</span> <span class="k">in</span>
  <span class="nn">String</span><span class="p">.</span><span class="n">concat</span> <span class="s2">&quot;&quot;</span> <span class="o">(</span><span class="nn">List</span><span class="p">.</span><span class="n">map</span> <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="nn">Printf</span><span class="p">.</span><span class="n">sprintf</span> <span class="s2">&quot;%06x&quot;</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">))</span> <span class="n">choppedO</span><span class="o">);;</span>
<span class="c">(*-----------------------------*)</span>
<span class="c">(* Since octal, hex and decimal are all the same internally, we don&#39;t need to do</span>
<span class="c">    any explicit conversion *)</span>
<span class="n">printf</span> <span class="s2">&quot;Gimme a number in decimal, octal, or hex: &quot;</span><span class="o">;;</span>
<span class="k">let</span> <span class="n">num</span> <span class="o">=</span> <span class="n">read_int</span> <span class="bp">()</span><span class="o">;;</span>
<span class="n">printf</span> <span class="s2">&quot;%d %x %o</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">num</span> <span class="n">num</span> <span class="n">num</span><span class="o">;;</span>
<span class="c">(*-----------------------------*)</span>
<span class="n">printf</span> <span class="s2">&quot;Enter file permission in octal: &quot;</span><span class="o">;;</span>
<span class="k">let</span> <span class="n">permissions</span> <span class="o">=</span> <span class="k">try</span> <span class="n">read_int</span> <span class="bp">()</span>
<span class="k">with</span> <span class="nc">Failure</span> <span class="n">message</span> <span class="o">-&gt;</span> <span class="n">failwith</span> <span class="s2">&quot;Exiting...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">;;</span>
<span class="n">printf</span> <span class="s2">&quot;The decimal value is %d</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">permissions</span><span class="o">;;</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN121"
>Putting Commas in Numbers</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">(* This example requires the PCRE library, available at:</span>
<span class="c">   http://www.ocaml.info/home/ocaml_sources.html#pcre-ocaml *)</span>
<span class="o">#</span><span class="n">directory</span> <span class="s2">&quot;+pcre&quot;</span><span class="o">;;</span>
<span class="o">#</span><span class="n">load</span> <span class="s2">&quot;pcre.cma&quot;</span><span class="o">;;</span>

<span class="k">let</span> <span class="n">rev_string</span> <span class="n">s</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">s&#39;</span> <span class="o">=</span> <span class="nn">String</span><span class="p">.</span><span class="n">copy</span> <span class="n">s</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">i</span> <span class="o">=</span> <span class="n">ref</span> <span class="o">(</span><span class="nn">String</span><span class="p">.</span><span class="n">length</span> <span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span> <span class="k">in</span>
  <span class="nn">String</span><span class="p">.</span><span class="n">iter</span> <span class="o">(</span><span class="k">fun</span> <span class="n">c</span> <span class="o">-&gt;</span> <span class="n">s&#39;</span><span class="o">.[!</span><span class="n">i</span><span class="o">]</span> <span class="o">&lt;-</span> <span class="n">c</span><span class="o">;</span> <span class="n">decr</span> <span class="n">i</span><span class="o">)</span> <span class="n">s</span><span class="o">;</span>
  <span class="n">s&#39;</span>

<span class="k">let</span> <span class="n">commify</span> <span class="n">s</span> <span class="o">=</span>
  <span class="n">rev_string</span>
    <span class="o">(</span><span class="nn">Pcre</span><span class="p">.</span><span class="n">replace</span> <span class="o">~</span><span class="n">pat</span><span class="o">:</span><span class="s2">&quot;(</span><span class="se">\\</span><span class="s2">d</span><span class="se">\\</span><span class="s2">d</span><span class="se">\\</span><span class="s2">d)(?=</span><span class="se">\\</span><span class="s2">d)(?!</span><span class="se">\\</span><span class="s2">d*</span><span class="se">\\</span><span class="s2">.)&quot;</span> <span class="o">~</span><span class="n">templ</span><span class="o">:</span><span class="s2">&quot;$1,&quot;</span>
       <span class="o">(</span><span class="n">rev_string</span> <span class="n">s</span><span class="o">))</span>

<span class="c">(*-----------------------------*)</span>

<span class="c">(* more reasonable web counter :-) *)</span>
<span class="k">let</span> <span class="bp">()</span> <span class="o">=</span>
  <span class="nn">Random</span><span class="p">.</span><span class="n">self_init</span> <span class="bp">()</span><span class="o">;</span>
  <span class="k">let</span> <span class="n">hits</span> <span class="o">=</span> <span class="nn">Random</span><span class="p">.</span><span class="n">int32</span> <span class="mi">2147483647</span><span class="n">l</span> <span class="k">in</span>
  <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;Your web page received %s accesses last month.</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="o">(</span><span class="n">commify</span> <span class="o">(</span><span class="nn">Int32</span><span class="p">.</span><span class="n">to_string</span> <span class="n">hits</span><span class="o">))</span>
<span class="c">(* Your web page received 1,670,658,439 accesses last month. *)</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN124"
>Printing Correct Plurals</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">(* Hardcoded examples can be done as follows: *)</span>
<span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;It took %d hour%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">n</span> <span class="o">(</span><span class="k">if</span> <span class="n">n</span> <span class="o">&lt;&gt;</span> <span class="mi">1</span> <span class="k">then</span> <span class="s2">&quot;s&quot;</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="o">);;</span>
<span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;It took %d centur%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">n</span> <span class="o">(</span><span class="k">if</span> <span class="n">n</span> <span class="o">&lt;&gt;</span> <span class="mi">1</span> <span class="k">then</span> <span class="s2">&quot;ies&quot;</span> <span class="k">else</span> <span class="s2">&quot;y&quot;</span><span class="o">);;</span>

<span class="c">(* For a more general solution *)</span>
<span class="c">(* First define the rules *)</span>
<span class="c">(* Note: the OS needs to support dynamic loading of C libraries for this *)</span>
<span class="o">#</span><span class="n">load</span> <span class="s2">&quot;str.cma&quot;</span><span class="o">;;</span>

<span class="k">let</span> <span class="n">rules</span> <span class="o">=</span>
  <span class="nn">List</span><span class="p">.</span><span class="n">map</span> <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="nn">Str</span><span class="p">.</span><span class="n">regexp</span> <span class="o">(</span><span class="n">fst</span> <span class="n">x</span><span class="o">)),(</span><span class="n">snd</span> <span class="n">x</span><span class="o">))</span>
    <span class="o">[</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">([psc]h</span><span class="se">\\</span><span class="s2">)$</span><span class="se">\\</span><span class="s2">|z$&quot;</span><span class="o">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">0es&quot;</span><span class="o">;</span>
     <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">(ff</span><span class="se">\\</span><span class="s2">)$</span><span class="se">\\</span><span class="s2">|</span><span class="se">\\</span><span class="s2">(ey</span><span class="se">\\</span><span class="s2">)$&quot;</span><span class="o">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">0s&quot;</span><span class="o">;</span>
     <span class="s2">&quot;f$&quot;</span><span class="o">,</span><span class="s2">&quot;ves&quot;</span><span class="o">;</span>
     <span class="s2">&quot;y$&quot;</span><span class="o">,</span><span class="s2">&quot;ies&quot;</span><span class="o">;</span>
     <span class="s2">&quot;ix$&quot;</span><span class="o">,</span><span class="s2">&quot;ices&quot;</span><span class="o">;</span>
     <span class="s2">&quot;ius$&quot;</span><span class="o">,</span><span class="s2">&quot;ii&quot;</span><span class="o">;</span>
     <span class="s2">&quot;[sx]$&quot;</span><span class="o">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">0es&quot;</span><span class="o">;</span>
     <span class="s2">&quot;non&quot;</span><span class="o">,</span><span class="s2">&quot;na&quot;</span><span class="o">];;</span>

<span class="k">let</span> <span class="n">f</span> <span class="n">w</span> <span class="n">x</span> <span class="o">=</span>
  <span class="n">ignore</span><span class="o">(</span><span class="nn">Str</span><span class="p">.</span><span class="n">search_forward</span> <span class="o">(</span><span class="n">fst</span> <span class="n">x</span><span class="o">)</span> <span class="n">w</span> <span class="mi">0</span><span class="o">);</span>
  <span class="nn">Str</span><span class="p">.</span><span class="n">replace_first</span> <span class="o">(</span><span class="n">fst</span> <span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="n">snd</span> <span class="n">x</span><span class="o">)</span> <span class="n">w</span><span class="o">;;</span>

<span class="k">let</span> <span class="k">rec</span> <span class="n">exn_map</span> <span class="n">ex</span> <span class="n">fn1</span> <span class="n">fn2</span> <span class="n">l</span> <span class="o">=</span>
  <span class="k">match</span> <span class="n">l</span> <span class="k">with</span>
    <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="n">fn2</span>
  <span class="o">|</span> <span class="n">h</span><span class="o">::</span><span class="n">t</span> <span class="o">-&gt;</span> <span class="k">try</span> <span class="o">(</span><span class="n">fn1</span> <span class="n">h</span><span class="o">)</span> <span class="k">with</span> <span class="n">ex</span> <span class="o">-&gt;</span> <span class="n">exn_map</span> <span class="n">ex</span> <span class="n">fn1</span> <span class="n">fn2</span> <span class="n">t</span><span class="o">;;</span>

<span class="k">let</span> <span class="n">pluralize</span> <span class="n">x</span> <span class="o">=</span> <span class="c">(* &quot;wish&quot; in *)</span>
  <span class="n">exn_map</span> <span class="nc">Not_found</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">^</span> <span class="s2">&quot;s&quot;</span><span class="o">)</span> <span class="n">rules</span><span class="o">;;</span>

<span class="c">(* Note: This next example doesn&#39;t work on the odd cases *)</span>
<span class="k">let</span> <span class="n">nouns</span> <span class="o">=</span> <span class="o">[</span><span class="s2">&quot;fish&quot;</span><span class="o">;</span> <span class="s2">&quot;fly&quot;</span><span class="o">;</span> <span class="s2">&quot;ox&quot;</span><span class="o">;</span> <span class="s2">&quot;species&quot;</span><span class="o">;</span> <span class="s2">&quot;genus&quot;</span><span class="o">;</span> <span class="s2">&quot;phylum&quot;</span><span class="o">;</span> <span class="s2">&quot;cherub&quot;</span><span class="o">;</span>
             <span class="s2">&quot;radius&quot;</span><span class="o">;</span> <span class="s2">&quot;jockey&quot;</span><span class="o">;</span> <span class="s2">&quot;index&quot;</span><span class="o">;</span> <span class="s2">&quot;matrix&quot;</span><span class="o">;</span> <span class="s2">&quot;mythos&quot;</span><span class="o">;</span> <span class="s2">&quot;phenomenon&quot;</span><span class="o">;</span>
             <span class="s2">&quot;formula&quot;</span><span class="o">];;</span>
<span class="nn">List</span><span class="p">.</span><span class="n">iter</span> <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">printf</span> <span class="s2">&quot;One %s, two %s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">x</span> <span class="o">(</span><span class="n">pluralize</span> <span class="n">x</span><span class="o">))</span> <span class="n">nouns</span><span class="o">;;</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN127"
>Program: Calculating Prime Factors</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">(* Note: the OS needs to support dynamic loading of C libraries for this</span>
<span class="c">   otherwise you will need to link the nums library with the code at comple time *)</span>
<span class="o">#</span><span class="n">load</span> <span class="s2">&quot;nums.cma&quot;</span><span class="o">;;</span>
<span class="k">open</span> <span class="nc">Big_int</span><span class="o">;;</span>

<span class="k">let</span> <span class="n">cmd</span> <span class="o">=</span> <span class="o">[|</span><span class="s2">&quot;bigfact&quot;</span><span class="o">;</span> <span class="s2">&quot;8&quot;</span><span class="o">;</span> <span class="s2">&quot;9&quot;</span><span class="o">;</span> <span class="s2">&quot;96&quot;</span><span class="o">;</span> <span class="s2">&quot;2178&quot;</span><span class="o">;</span>
            <span class="s2">&quot;239322000000000000000000&quot;</span><span class="o">;</span> <span class="s2">&quot;25000000000000000000000000&quot;</span><span class="o">;</span> <span class="s2">&quot;17&quot;</span><span class="o">|];;</span>

<span class="c">(* This will raise an exception if a nonnumeric string is in the argument list</span>
<span class="c">*)</span>
<span class="k">let</span> <span class="n">argList</span> <span class="o">=</span>
  <span class="nn">Array</span><span class="p">.</span><span class="n">map</span> <span class="n">big_int_of_string</span> <span class="o">(</span><span class="nn">Array</span><span class="p">.</span><span class="n">sub</span> <span class="n">cmd</span> <span class="mi">1</span> <span class="o">((</span><span class="nn">Array</span><span class="p">.</span><span class="n">length</span> <span class="n">cmd</span><span class="o">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">));;</span>

<span class="k">let</span> <span class="n">factorize</span> <span class="n">num</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">two</span> <span class="o">=</span> <span class="n">big_int_of_int</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">four</span> <span class="o">=</span> <span class="n">big_int_of_int</span> <span class="mi">4</span> <span class="k">in</span>
  <span class="k">let</span> <span class="k">rec</span> <span class="n">genFactors</span> <span class="o">(</span><span class="n">i</span><span class="o">,</span><span class="n">sqi</span><span class="o">)</span> <span class="n">n</span> <span class="n">fList</span> <span class="o">=</span>
    <span class="k">if</span> <span class="n">eq_big_int</span> <span class="n">n</span> <span class="n">unit_big_int</span> <span class="k">then</span> <span class="n">fList</span> <span class="k">else</span>
    <span class="k">if</span> <span class="n">lt_big_int</span> <span class="n">n</span> <span class="n">sqi</span> <span class="k">then</span> <span class="o">((</span><span class="n">n</span><span class="o">,</span><span class="mi">1</span><span class="o">)::</span><span class="n">fList</span><span class="o">)</span> <span class="k">else</span>
      <span class="k">let</span> <span class="n">newn</span> <span class="o">=</span> <span class="n">ref</span> <span class="n">n</span> <span class="ow">and</span> <span class="n">fcount</span> <span class="o">=</span> <span class="n">ref</span> <span class="mi">0</span> <span class="k">in</span>
      <span class="k">while</span>  <span class="o">(</span><span class="n">eq_big_int</span> <span class="o">(</span><span class="n">mod_big_int</span> <span class="o">!</span><span class="n">newn</span> <span class="n">i</span><span class="o">)</span> <span class="n">zero_big_int</span><span class="o">)</span> <span class="k">do</span>
          <span class="n">newn</span> <span class="o">:=</span> <span class="n">div_big_int</span> <span class="o">!</span><span class="n">newn</span> <span class="n">i</span><span class="o">;</span>
          <span class="n">fcount</span> <span class="o">:=</span> <span class="o">!</span><span class="n">fcount</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
      <span class="k">done</span><span class="o">;</span>
      <span class="k">let</span> <span class="n">nexti</span><span class="o">,</span><span class="n">nextsqi</span> <span class="o">=</span>
          <span class="k">if</span> <span class="n">eq_big_int</span> <span class="n">i</span> <span class="n">two</span> <span class="k">then</span>
              <span class="o">(</span><span class="n">add_big_int</span> <span class="n">i</span> <span class="n">unit_big_int</span><span class="o">),</span>
                <span class="o">(</span><span class="n">add_big_int</span> <span class="n">sqi</span> <span class="o">(</span><span class="n">add_big_int</span> <span class="o">(</span><span class="n">mult_big_int</span> <span class="n">i</span> <span class="n">two</span><span class="o">)</span>
                 <span class="n">unit_big_int</span><span class="o">))</span>
          <span class="k">else</span>
              <span class="o">(</span><span class="n">add_big_int</span> <span class="n">i</span> <span class="n">two</span><span class="o">),</span>
                <span class="o">(</span><span class="n">add_big_int</span> <span class="n">sqi</span> <span class="o">(</span><span class="n">add_big_int</span> <span class="o">(</span><span class="n">mult_big_int</span> <span class="n">i</span> <span class="n">four</span><span class="o">)</span> <span class="n">two</span><span class="o">))</span> <span class="k">in</span>
      <span class="n">genFactors</span> <span class="o">(</span><span class="n">nexti</span><span class="o">,</span><span class="n">nextsqi</span><span class="o">)</span> <span class="o">!</span><span class="n">newn</span> <span class="o">(</span><span class="k">if</span> <span class="o">!</span><span class="n">fcount</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span> <span class="n">fList</span> <span class="k">else</span>
          <span class="o">((</span><span class="n">i</span><span class="o">,!</span><span class="n">fcount</span><span class="o">)::</span><span class="n">fList</span><span class="o">))</span> <span class="k">in</span>
   <span class="n">genFactors</span> <span class="o">(</span><span class="n">two</span><span class="o">,</span><span class="n">four</span><span class="o">)</span> <span class="n">num</span> <span class="bp">[]</span><span class="o">;;</span>

<span class="k">let</span> <span class="o">_</span> <span class="o">=</span>
  <span class="nn">Array</span><span class="p">.</span><span class="n">iter</span>
  <span class="o">(</span><span class="k">fun</span> <span class="n">n</span> <span class="o">-&gt;</span>
    <span class="k">let</span> <span class="n">l</span> <span class="o">=</span> <span class="n">factorize</span> <span class="n">n</span> <span class="k">in</span>
    <span class="k">match</span> <span class="n">l</span> <span class="k">with</span>
      <span class="o">[(</span><span class="n">x</span><span class="o">,</span><span class="mi">1</span><span class="o">)]</span> <span class="o">-&gt;</span> <span class="n">printf</span> <span class="s2">&quot;%s</span><span class="se">\t</span><span class="s2">Prime!</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">(</span><span class="n">string_of_big_int</span> <span class="n">x</span><span class="o">)</span>
    <span class="o">|</span> <span class="o">_</span> <span class="o">-&gt;</span>
        <span class="n">printf</span> <span class="s2">&quot;%s</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">(</span><span class="n">string_of_big_int</span> <span class="n">n</span><span class="o">);</span>
        <span class="nn">List</span><span class="p">.</span><span class="n">iter</span>
          <span class="o">(</span><span class="k">fun</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span><span class="n">count</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="k">let</span> <span class="n">sx</span> <span class="o">=</span> <span class="n">string_of_big_int</span> <span class="n">x</span> <span class="k">in</span>
            <span class="k">if</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">then</span> <span class="n">printf</span> <span class="s2">&quot;%s &quot;</span> <span class="n">sx</span>
            <span class="k">else</span> <span class="n">printf</span> <span class="s2">&quot;%s**%d &quot;</span> <span class="n">sx</span> <span class="n">count</span><span class="o">)</span>
          <span class="o">(</span><span class="nn">List</span><span class="p">.</span><span class="n">rev</span> <span class="n">l</span><span class="o">);</span>
    <span class="n">print_newline</span><span class="bp">()</span><span class="o">)</span> <span class="n">argList</span><span class="o">;;</span></PRE
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="strings.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="datesandtimes.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Strings</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Dates and Times</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>