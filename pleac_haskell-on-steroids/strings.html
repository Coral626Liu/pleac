<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Strings</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="PLEAC-Haskell"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="PLEAC-Haskell"
HREF="index.html"><LINK
REL="NEXT"
TITLE="Numbers"
HREF="numbers.html"><style type="text/css">td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }

  </style></head
><BODY TEXT="#cecece" BGCOLOR="#4f6f6f" LINK="#f5deb3" VLINK="#d5ae83"
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PLEAC-Haskell</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="index.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="numbers.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="STRINGS"
>1. Strings</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN14"
>Introduction</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span>
<span class="nf">str</span>  <span class="ow">=</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">n&quot;</span>                             <span class="c1">-- two characters, \ and an n</span>
<span class="nf">str2</span> <span class="ow">=</span> <span class="s">&quot;Jon &#39;Maddog&#39; Orwant&quot;</span>             <span class="c1">-- in haskell we can do string only with &quot;, no single quote</span>
<span class="nf">str3</span> <span class="ow">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>                              <span class="c1">-- a &quot;newline&quot; character</span>
<span class="nf">str4</span> <span class="ow">=</span> <span class="s">&quot;Jon </span><span class="se">\&quot;</span><span class="s">Maddog</span><span class="se">\&quot;</span><span class="s"> Orwant&quot;</span>           <span class="c1">-- literal double quotes</span>
<span class="c1">-- no q/qq/qw/.. stuff in haskell</span>
<span class="c1">-- no multiline, you can emulate it with ++ and \n, or unlines</span>
<span class="nf">str5</span> <span class="ow">=</span> <span class="s">&quot;This is a multiline here document</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">++</span>
       <span class="s">&quot;terminated by  on a line by itself</span><span class="se">\n</span><span class="s">&quot;</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN17"
>Accessing Substrings</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="nf">s</span>     <span class="ow">=</span> <span class="s">&quot;This is what you have&quot;</span>
<span class="nf">first</span> <span class="ow">=</span> <span class="n">s</span><span class="o">!!</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                            <span class="c1">-- &quot;T&quot;</span>
<span class="nf">start</span> <span class="ow">=</span> <span class="n">s</span><span class="o">!!</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>                          <span class="c1">-- &quot;is&quot;</span>
<span class="nf">rest</span>  <span class="ow">=</span> <span class="n">s</span><span class="o">!!</span><span class="p">[</span><span class="mi">13</span><span class="o">..</span><span class="p">]</span>                         <span class="c1">-- &quot;you have&quot;</span>
<span class="nf">las</span>   <span class="ow">=</span> <span class="n">s</span><span class="o">!!</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>                           <span class="c1">-- &quot;e&quot;</span>
<span class="nf">las2</span>  <span class="ow">=</span> <span class="n">s</span><span class="o">.</span><span class="n">last</span>                            <span class="c1">-- &#39;e&#39;</span>
<span class="nf">end</span>   <span class="ow">=</span> <span class="n">s</span><span class="o">!!</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span> <span class="o">..</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>                     <span class="c1">-- &quot;have&quot;</span>
<span class="nf">piece</span> <span class="ow">=</span> <span class="n">s</span><span class="o">!!</span><span class="p">[</span><span class="o">-</span><span class="mi">8</span> <span class="o">..</span> <span class="o">-</span><span class="mi">5</span><span class="p">]</span>                     <span class="c1">-- &quot;you&quot;</span>


<span class="p">[</span><span class="n">lead</span><span class="p">,</span><span class="n">ss1</span><span class="p">,</span><span class="n">ss2</span><span class="p">,</span><span class="n">trailing</span><span class="p">]</span>     <span class="ow">=</span> <span class="n">s</span><span class="o">.</span><span class="n">unpack</span> <span class="p">[</span><span class="kt">Grab</span> <span class="mi">2</span><span class="p">,</span> <span class="kt">Forward</span> <span class="mi">3</span><span class="p">,</span> <span class="kt">Grab</span> <span class="mi">1</span><span class="p">,</span> <span class="kt">Grab</span> <span class="mi">2</span><span class="p">,</span> <span class="kt">GrabAll</span><span class="p">]</span> 
<span class="c1">-- Regexp are better for this, why introduce extra concept (unpack)</span>
<span class="p">[</span><span class="n">lead2</span><span class="p">,</span><span class="n">ss12</span><span class="p">,</span><span class="n">ss22</span><span class="p">,</span><span class="n">trailing2</span><span class="p">]</span> <span class="ow">=</span> <span class="n">s</span><span class="o">.</span><span class="n">match</span> <span class="s">&quot;^(..)...(.)(..)(.*)&quot;</span>
<span class="p">[</span><span class="n">lead3</span><span class="p">,</span><span class="n">ss13</span><span class="p">,</span><span class="n">ss23</span><span class="p">,</span><span class="n">trailing3</span><span class="p">]</span> <span class="ow">=</span> <span class="n">s</span><span class="o">.</span><span class="n">match</span> <span class="s">&quot;^(.{2}).{3}(.)(.{2})(.*)&quot;</span> <span class="c1">-- just to show how to use repetition</span>

<span class="nf">fivers</span>                      <span class="ow">=</span> <span class="n">s</span><span class="o">.</span><span class="n">unpack</span> <span class="p">((</span><span class="kt">Grab</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">replicate</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">length</span> <span class="p">`</span><span class="n">div</span><span class="p">`</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1">-- in haskell string == [Char] =&gt; no need to do  unpack(&quot;A1&quot; x length($string), $string)</span>
<span class="nf">characters</span> <span class="ow">=</span> <span class="n">s</span>

<span class="c1">-- can&#39;t modify string in haskell</span>
<span class="nf">s&#39;</span>    <span class="ow">=</span> <span class="n">s</span><span class="o">.</span><span class="n">substr</span> <span class="mi">5</span> <span class="mi">2</span> <span class="s">&quot;wasn&#39;t&quot;</span>       <span class="c1">-- &quot;This wasn&#39;t what you have&quot;</span>
<span class="nf">s&#39;&#39;</span>   <span class="ow">=</span> <span class="n">s&#39;</span><span class="o">.</span><span class="n">substr2</span> <span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span> <span class="s">&quot;ondrous&quot;</span>  <span class="c1">-- &quot;This wasn&#39;t wondrous&quot;,note the () arount negative number :(</span>
<span class="nf">s&#39;&#39;&#39;</span>  <span class="ow">=</span> <span class="n">s&#39;&#39;</span><span class="o">.</span><span class="n">substr</span> <span class="mi">0</span> <span class="mi">1</span> <span class="s">&quot;&quot;</span>           <span class="c1">-- &quot;his wasn&#39;t wondrous&quot;, delete first character &lt;=&gt; tail</span>
<span class="nf">s&#39;&#39;&#39;&#39;</span> <span class="ow">=</span> <span class="n">s&#39;&#39;&#39;</span><span class="o">.</span><span class="n">substr2</span> <span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span> <span class="s">&quot;&quot;</span>       <span class="c1">-- &quot;his wasn&#39;&quot;  ,delete last 10 characters &lt;=&gt; reverse . drop 10 . reverse</span>

<span class="nf">m</span>     <span class="ow">=</span> <span class="kr">if</span> <span class="n">s</span><span class="o">!!</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span> <span class="o">..</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=~</span> <span class="s">&quot;have&quot;</span> 
	<span class="kr">then</span> <span class="n">putStrLn</span> <span class="s">&quot;Pattern matches in last 10 characters&quot;</span> 
	<span class="kr">else</span> <span class="n">return</span> <span class="nb">()</span>
<span class="nf">m&#39;</span>    <span class="ow">=</span> <span class="n">putStrLn</span> <span class="s">&quot;Pattern matches in last 10 characters&quot;</span> <span class="p">`</span><span class="n">when</span><span class="p">`</span> <span class="p">(</span><span class="n">s</span><span class="o">!!</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span> <span class="o">..</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=~</span> <span class="s">&quot;have&quot;</span> <span class="p">)</span>

<span class="c1">-- cant do as short as in perl cos cant use affection in haskell</span>
<span class="nf">news</span> <span class="ow">=</span> <span class="n">s</span><span class="o">!!</span><span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="p">(</span><span class="n">substS</span> <span class="s">&quot;is&quot;</span> <span class="s">&quot;at&quot;</span> <span class="p">[</span><span class="kt">Global_Match</span><span class="p">])</span> <span class="o">++</span> <span class="n">s</span><span class="o">!!</span><span class="p">[</span><span class="mi">6</span><span class="o">..</span><span class="p">]</span> <span class="c1">-- &quot;That at what you have&quot;</span>

<span class="nf">a1</span>  <span class="ow">=</span> <span class="s">&quot;make a hat&quot;</span>
<span class="nf">a1&#39;</span> <span class="ow">=</span> <span class="n">a1</span><span class="o">!!</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">++</span> <span class="n">a1</span><span class="o">!!</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span><span class="mi">2</span><span class="p">)]</span> <span class="o">++</span> <span class="n">a1</span><span class="o">!!</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">-- &quot;take a ham&quot;</span>

<span class="nf">b1</span> <span class="ow">=</span> <span class="s">&quot;to be or not to be&quot;</span>
<span class="nf">b2</span>      <span class="ow">=</span> <span class="n">b1</span><span class="o">.</span><span class="n">unpack</span> <span class="p">[</span><span class="kt">Forward</span> <span class="mi">6</span><span class="p">,</span> <span class="kt">Grab</span> <span class="mi">6</span><span class="p">]</span>  <span class="c1">-- &quot;or not&quot;</span>
<span class="p">[</span><span class="n">b3</span><span class="p">,</span><span class="n">c3</span><span class="p">]</span> <span class="ow">=</span> <span class="n">b1</span><span class="o">.</span><span class="n">unpack</span> <span class="p">[</span><span class="kt">Forward</span> <span class="mi">6</span><span class="p">,</span> <span class="kt">Grab</span> <span class="mi">2</span><span class="p">,</span> <span class="kt">Backward</span> <span class="mi">5</span><span class="p">,</span> <span class="kt">Grab</span> <span class="mi">2</span><span class="p">]</span> <span class="c1">-- [&quot;or&quot;,&quot;be&quot;]</span>

<span class="nf">cut2fmt</span> <span class="n">xs</span> <span class="ow">=</span> <span class="n">xs</span><span class="o">.</span><span class="n">foldl</span> <span class="n">aux</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="kt">[]</span><span class="p">)</span><span class="o">.</span><span class="n">snd</span><span class="o">.</span><span class="p">(</span><span class="kt">GrabAll:</span><span class="p">)</span><span class="o">.</span><span class="n">reverse</span> 
    <span class="kr">where</span> <span class="n">aux</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="n">i</span> <span class="ow">=</span> <span class="p">(</span><span class="n">i</span><span class="p">,(</span><span class="kt">Grab</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">n</span><span class="p">))</span> <span class="kt">:</span> <span class="n">l</span><span class="p">)</span>
<span class="nf">fmt</span> <span class="ow">=</span> <span class="n">cut2fmt</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">30</span><span class="p">]</span> <span class="c1">-- [Grab 7,Grab 6,Grab 6,Grab 6,Grab 4,GrabAll]</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN20"
>Establishing a Default Value</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span>
<span class="nf">v3</span> <span class="ow">=</span> <span class="s">&quot;a&quot;</span> <span class="o">|||</span> <span class="s">&quot;b&quot;</span> <span class="c1">-- -&gt; &quot;a&quot;</span>
<span class="nf">v4</span> <span class="ow">=</span> <span class="s">&quot;&quot;</span>  <span class="o">|||</span> <span class="s">&quot;b&quot;</span> <span class="c1">-- -&gt; &quot;b&quot;</span>

<span class="c1">-- force to put the type :(</span>
<span class="nf">v5</span> <span class="ow">=</span> <span class="p">(</span><span class="mi">2</span><span class="ow">::</span><span class="kt">Int</span><span class="p">)</span> <span class="o">&amp;&amp;&amp;</span> <span class="s">&quot;ee&quot;</span> <span class="c1">-- -&gt; &quot;ee&quot;</span>
<span class="nf">v6</span> <span class="ow">=</span> <span class="p">(</span><span class="mi">0</span><span class="ow">::</span><span class="kt">Int</span><span class="p">)</span> <span class="o">&amp;&amp;&amp;</span> <span class="s">&quot;ee&quot;</span> <span class="c1">-- -&gt; &quot;&quot;</span>

<span class="c1">-- no x ||= y</span>
<span class="nf">v3&#39;</span> <span class="ow">=</span> <span class="n">v3</span> <span class="o">|||</span> <span class="n">v4</span>

<span class="nf">dir</span>  <span class="ow">=</span> <span class="n">argv</span> <span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="nf">\</span><span class="n">x</span> <span class="ow">-&gt;</span> <span class="p">(</span><span class="n">x</span> <span class="o">|||</span> <span class="p">[</span><span class="s">&quot;/tmp&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">head</span><span class="p">)</span>
<span class="nf">dir&#39;</span> <span class="ow">=</span> <span class="n">argv</span> <span class="o">&gt;&gt;&gt;</span> <span class="p">((</span><span class="o">|||</span> <span class="p">[</span><span class="s">&quot;/tmp&quot;</span><span class="p">])</span> <span class="o">$</span> <span class="n">head</span><span class="p">)</span> <span class="c1">-- or even more cryptic</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN23"
>Exchanging Values Without Using Temporary Variables</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">-- no side effect in haskell =&gt; swap is a nosense</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN26"
>Converting Between ASCII Characters and Values</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="nf">i1</span> <span class="ow">=</span> <span class="n">ord</span> <span class="n">&#39;a&#39;</span>
<span class="nf">c1</span> <span class="ow">=</span> <span class="n">chr</span> <span class="mi">97</span>

<span class="c1">-- ascii = string.unpack(&quot;C*&quot;), string = ascii.pack(&quot;C*&quot;), no need in haskell, String = [Char]</span>
<span class="c1">--  there is also packedString that are more efficient but less cool cos not list anymore</span>
<span class="nf">ibm</span> <span class="ow">=</span> <span class="s">&quot;HAL&quot;</span><span class="o">.</span><span class="n">map</span> <span class="n">next_char</span>                   <span class="c1">-- &quot;IBM&quot;</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN29"
>Processing a String One Character at a Time</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="nf">s1</span> <span class="ow">=</span> <span class="s">&quot;unique chars are: &quot;</span> <span class="o">++</span> <span class="p">(</span><span class="s">&quot;an apple a day&quot;</span><span class="o">.</span><span class="n">unique</span><span class="o">.</span><span class="n">sort</span><span class="p">)</span>
<span class="nf">sum1</span> <span class="ow">=</span> <span class="p">(</span><span class="s">&quot;sum is &quot;</span> <span class="o">^</span> <span class="n">s1</span><span class="o">.</span><span class="n">map</span> <span class="n">ord</span><span class="o">.</span><span class="n">sum</span><span class="p">)</span><span class="o">.</span><span class="n">putStrLn</span>

<span class="c1">-- TODO, script.hs HERE</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN32"
>Reversing a String by Word or Character</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="nf">s2</span> <span class="ow">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">reverse</span>

<span class="c1">-- can do: s3 = (unwords . reverse . words) s1</span>
<span class="c1">--         s3 = (words $ reverse $ unwords) s1</span>
<span class="nf">s3</span> <span class="ow">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">words</span><span class="o">.</span><span class="n">reverse</span><span class="o">.</span><span class="n">unwords</span> 

<span class="nf">s3&#39;</span> <span class="ow">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">split</span> <span class="s">&quot; &quot;</span><span class="o">.</span><span class="n">reverse</span><span class="o">.</span><span class="n">join</span> <span class="s">&quot; &quot;</span> <span class="c1">-- not the same, cos words = split &quot;\s+&quot;</span>
<span class="nf">s3&#39;&#39;</span><span class="ow">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">split</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">s+&quot;</span><span class="o">.</span><span class="n">reverse</span><span class="o">.</span><span class="n">join</span> <span class="s">&quot; &quot;</span> 

<span class="c1">-- eval long_palindromes or long_palindromes &gt;&gt;= (mapM putStrLn)</span>
<span class="nf">long_palindromes</span> <span class="ow">=</span> <span class="n">cat</span> <span class="s">&quot;/usr/share/dict/words&quot;</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">filter</span><span class="p">(</span><span class="nf">\</span><span class="n">s</span> <span class="ow">-&gt;</span> <span class="n">s</span> <span class="o">==</span> <span class="n">s</span><span class="o">.</span><span class="n">reverse</span> <span class="o">&amp;&amp;</span> <span class="n">s</span><span class="o">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">)</span> </PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN35"
>Expanding and Compressing Tabs</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">-- TODO, must do: \s if s == [] then [] else foldr1 .... ? must make a foldr1sure</span>
<span class="nf">expand_tabs</span> <span class="ow">=</span> <span class="n">split</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span> <span class="o">$</span> <span class="p">(</span><span class="n">foldr1</span> <span class="p">(</span><span class="nf">\</span><span class="n">a</span> <span class="n">b</span> <span class="ow">-&gt;</span> <span class="n">a</span> <span class="o">++</span> <span class="p">(</span><span class="n">times</span> <span class="p">(</span><span class="mi">8</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">length</span> <span class="p">`</span><span class="n">mod</span><span class="p">`</span> <span class="mi">8</span><span class="p">)</span> <span class="sc">&#39; &#39;</span><span class="p">)</span> <span class="o">++</span> <span class="n">b</span><span class="p">))</span> <span class="c1">-- more efficient</span>
<span class="c1">-- expand_tabs = fixpoint (break_char &#39;\t&#39; (\a b -&gt; a ++ (&#39; &#39;.times (8 - a.length `mod` 8)) ++ b))</span>
				</PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN38"
>Expanding Variables in User Input</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">-- cant do eval in haskell, too meta, too reflexif</span>

<span class="nf">s4</span> <span class="ow">=</span> <span class="s">&quot;I am 17 years old&quot;</span><span class="o">.</span><span class="n">subst</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">d+&quot;</span> <span class="p">(</span><span class="nf">\</span><span class="n">n</span> <span class="ow">-&gt;</span> <span class="n">show</span> <span class="p">((</span><span class="n">read</span> <span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN41"
>Controlling Case</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="nf">s5</span> <span class="ow">=</span> <span class="s">&quot;bo beep&quot;</span><span class="o">.</span><span class="n">upcase</span>
<span class="nf">s6</span> <span class="ow">=</span> <span class="n">s5</span><span class="o">.</span><span class="n">downcase</span>
<span class="nf">s7</span> <span class="ow">=</span> <span class="n">s6</span><span class="o">.</span><span class="n">capitalize</span>

<span class="nf">s8</span> <span class="ow">=</span> <span class="s">&quot;thIS is a loNG liNE&quot;</span><span class="o">.</span><span class="n">words</span><span class="o">.</span><span class="n">map</span> <span class="n">capitalize</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN44"
>Interpolating Functions and Expressions Within Strings</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">-- s9 = &quot;I have &quot; ++ (show (10+1)) ++ &quot; guanacos.&quot;</span>
<span class="nf">s9</span> <span class="ow">=</span> <span class="s">&quot;I have &quot;</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="mi">1</span><span class="o">^</span><span class="s">&quot; guanacos.&quot;</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN47"
>Indenting Here Documents</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">-- cant put lines at beginning of line cos of layout pb</span>
<span class="c1">-- Multi_line is to say that ^ match beginning of every line, not of the string</span>
<span class="nf">multi</span> <span class="ow">=</span> <span class="p">(</span><span class="n">substS</span> <span class="s">&quot;^</span><span class="se">\\</span><span class="s">s+&quot;</span> <span class="s">&quot;&quot;</span> <span class="p">[</span><span class="kt">Global_Match</span><span class="p">,</span><span class="kt">Multi_Line</span><span class="p">]</span> <span class="err">°</span> <span class="n">unlines</span><span class="p">)</span> <span class="p">[</span>
 <span class="s">&quot;       This is a multiline here document&quot;</span><span class="p">,</span>
 <span class="s">&quot;       terminated by nothing&quot;</span>
 <span class="p">]</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN50"
>Reformatting Paragraphs</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">-- in fact this fonction is wrong, cos it insert a space at the front of the sentence (must use a foldl1)</span>
<span class="nf">wrap</span> <span class="n">width</span> <span class="n">s</span> <span class="ow">=</span> <span class="kr">let</span> <span class="p">(</span><span class="n">all</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span> <span class="ow">=</span> <span class="p">(</span><span class="n">words</span> <span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">foldl</span> <span class="p">(</span><span class="nf">\</span> <span class="p">(</span><span class="n">all</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span> <span class="n">w</span> <span class="ow">-&gt;</span> 
					    <span class="kr">if</span> <span class="p">(</span><span class="n">line</span><span class="o">++</span><span class="s">&quot; &quot;</span><span class="o">++</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="n">width</span> 
					    <span class="kr">then</span> <span class="p">(</span><span class="n">all</span><span class="o">++</span><span class="p">[</span><span class="n">line</span><span class="p">],</span> <span class="n">w</span><span class="p">)</span>
					    <span class="kr">else</span> <span class="p">(</span><span class="n">all</span><span class="p">,</span> <span class="n">line</span><span class="o">++</span><span class="s">&quot; &quot;</span><span class="o">++</span><span class="n">w</span><span class="p">)</span>
					    <span class="p">)</span> <span class="p">(</span><span class="kt">[]</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="kr">in</span>
	       <span class="n">join</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">(</span><span class="n">all</span><span class="o">++</span><span class="p">[</span><span class="n">line</span><span class="p">])</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN53"
>Escaping Characters</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="nf">escaping</span> <span class="ow">=</span> <span class="s">&quot;Mom Said, </span><span class="se">\&quot;</span><span class="s">Don&#39;t do that.</span><span class="se">\&quot;</span><span class="s">&quot;</span>
<span class="nf">esc1</span> <span class="ow">=</span> <span class="n">escaping</span><span class="o">.</span><span class="n">gsubst</span> <span class="s">&quot;[&#39;</span><span class="se">\&quot;</span><span class="s">]&quot;</span> <span class="p">(</span><span class="s">&quot;</span><span class="se">\\</span><span class="s">&quot;</span><span class="o">++</span><span class="p">)</span> <span class="c1">-- section, &lt;=&gt; (\x -&gt; &quot;\\&quot; ++ x)</span>
<span class="nf">esc3</span> <span class="ow">=</span> <span class="n">escaping</span><span class="o">.</span><span class="n">gsubst</span> <span class="s">&quot;[^A-Z]&quot;</span> <span class="p">(</span><span class="s">&quot;</span><span class="se">\\</span><span class="s">&quot;</span><span class="o">++</span><span class="p">)</span>
<span class="nf">esc4</span> <span class="ow">=</span> <span class="n">escaping</span><span class="o">.</span><span class="n">gsubst</span> <span class="s">&quot;[^</span><span class="se">\\</span><span class="s">w]&quot;</span> <span class="p">(</span><span class="s">&quot;</span><span class="se">\\</span><span class="s">&quot;</span><span class="o">++</span><span class="p">)</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN56"
>Trimming Blanks from the Ends of a String</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="nf">s10</span> <span class="ow">=</span> <span class="s">&quot;    titi&quot;</span><span class="o">.</span><span class="n">substS</span> <span class="s">&quot;^</span><span class="se">\\</span><span class="s">s+&quot;</span> <span class="s">&quot;&quot;</span> <span class="kt">[]</span>
<span class="nf">s11</span> <span class="ow">=</span> <span class="s">&quot;  titi  &quot;</span><span class="o">.</span><span class="n">substS</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">s+$&quot;</span> <span class="s">&quot;&quot;</span> <span class="kt">[]</span>

<span class="nf">trim</span> <span class="ow">=</span> <span class="n">substS</span> <span class="s">&quot;^</span><span class="se">\\</span><span class="s">s+&quot;</span> <span class="s">&quot;&quot;</span> <span class="kt">[]</span> <span class="err">°</span> <span class="n">substS</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">s+$&quot;</span> <span class="s">&quot;&quot;</span> <span class="kt">[]</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN59"
>Parsing Comma-Separated Data</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="nf">parse_csv</span> <span class="n">s</span> <span class="ow">=</span> <span class="kr">let</span> <span class="n">re</span> <span class="ow">=</span> <span class="p">[</span><span class="s">&quot;</span><span class="se">\&quot;</span><span class="s">([^</span><span class="se">\&quot;\\\\</span><span class="s">]*(</span><span class="se">\\\\</span><span class="s">.[^</span><span class="se">\&quot;\\\\</span><span class="s">]*)*)</span><span class="se">\&quot;</span><span class="s">,?&quot;</span> <span class="c1">-- &quot;toto,titi&quot;</span>
		       <span class="p">,</span><span class="s">&quot;([^,]+),?&quot;</span> <span class="c1">-- something that not start with &quot; can not contain any , =&gt; go until next ,</span>
		       <span class="p">,</span><span class="s">&quot;,&quot;</span>
                       <span class="p">]</span><span class="o">.</span><span class="n">join</span> <span class="s">&quot;|&quot;</span>
                  <span class="n">xxs</span>  <span class="ow">=</span> <span class="n">s</span><span class="o">.</span><span class="n">gmatch</span> <span class="n">re</span> <span class="kr">in</span>
	       <span class="n">xxs</span><span class="o">.</span><span class="n">map</span> <span class="p">(</span><span class="nf">\</span><span class="n">xs</span> <span class="ow">-&gt;</span> <span class="p">(</span><span class="n">xs</span><span class="o">!</span><span class="p">(</span><span class="mi">0</span><span class="ow">::</span><span class="kt">Int</span><span class="p">))</span> <span class="o">|||</span> <span class="p">(</span><span class="n">xs</span><span class="o">!</span><span class="p">(</span><span class="mi">2</span><span class="ow">::</span><span class="kt">Int</span><span class="p">)))</span>
			 
<span class="nf">testline</span> <span class="ow">=</span> <span class="s">&quot;XYZZY,</span><span class="se">\&quot;\&quot;</span><span class="s">,</span><span class="se">\&quot;</span><span class="s">O&#39;Reilly, Inc</span><span class="se">\&quot;</span><span class="s">,</span><span class="se">\&quot;</span><span class="s">Wall, Larry</span><span class="se">\&quot;</span><span class="s">,</span><span class="se">\&quot;</span><span class="s">a </span><span class="se">\\\&quot;</span><span class="s">glug</span><span class="se">\\\&quot;</span><span class="s"> bit,</span><span class="se">\&quot;</span><span class="s">,5,</span><span class="se">\&quot;</span><span class="s">Error, Core Dumped</span><span class="se">\&quot;</span><span class="s">&quot;</span>
<span class="nf">mparse</span> <span class="ow">=</span> <span class="n">testline</span><span class="o">.</span><span class="n">parse_csv</span><span class="o">.</span><span class="n">foldM</span><span class="p">(</span><span class="nf">\</span><span class="n">i</span> <span class="n">x</span> <span class="ow">-&gt;</span> <span class="n">putStrLn</span> <span class="p">(</span><span class="n">i</span><span class="o">^</span><span class="s">&quot; : &quot;</span><span class="o">^</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="nf">\</span><span class="kr">_</span> <span class="ow">-&gt;</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="mi">0</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN62"
>Soundex Matching</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">-- from explanation from http://www.myatt.demon.co.uk/sxalg.htm</span>
<span class="nf">soundex</span> <span class="n">s</span> <span class="ow">=</span> <span class="n">x</span><span class="kt">:</span><span class="sc">&#39;-&#39;</span><span class="kt">:</span><span class="p">((</span><span class="n">res</span><span class="o">++</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">take</span> <span class="mi">3</span><span class="o">.</span><span class="n">map</span> <span class="n">show</span><span class="o">.</span><span class="n">concat</span><span class="p">)</span> <span class="c1">-- note that as haskell is lazy, this code is efficient</span>
    <span class="kr">where</span> <span class="n">group</span>      <span class="ow">=</span>  <span class="p">[(</span><span class="s">&quot;AEIOUYHW&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
			<span class="p">,(</span><span class="s">&quot;BFPV&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
			<span class="p">,(</span><span class="s">&quot;CGJKQSXZ&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
			<span class="p">,(</span><span class="s">&quot;DT&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
			<span class="p">,(</span><span class="s">&quot;L&quot;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
			<span class="p">,(</span><span class="s">&quot;MN&quot;</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
			<span class="p">,(</span><span class="s">&quot;R&quot;</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
			<span class="p">]</span>
	  <span class="n">code</span> <span class="n">x</span> <span class="ow">=</span> <span class="n">group</span><span class="o">.</span><span class="n">find</span> <span class="p">(</span><span class="nf">\</span><span class="p">(</span><span class="n">letters</span><span class="p">,</span><span class="kr">_</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="n">x</span> <span class="p">`</span><span class="n">elem</span><span class="p">`</span> <span class="n">letters</span><span class="p">)</span><span class="o">.</span><span class="n">just</span><span class="o">.</span><span class="n">snd</span>
	  <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span> <span class="ow">=</span> <span class="n">s</span><span class="o">.</span><span class="n">upcase</span><span class="o">.</span><span class="n">substS</span> <span class="s">&quot;[^</span><span class="se">\\</span><span class="s">w]&quot;</span> <span class="s">&quot;&quot;</span> <span class="p">[</span><span class="kt">Global_Match</span><span class="p">]</span>
	  <span class="c1">-- A consonant immediately following an initial letter from the same code group is ignored</span>
	  <span class="n">xs&#39;</span>    <span class="ow">=</span> <span class="kr">if</span> <span class="n">xs</span><span class="o">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">xs</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">code</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="o">.</span><span class="n">code</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="kr">then</span> <span class="n">xs</span><span class="o">.</span><span class="n">tail</span> <span class="kr">else</span> <span class="n">xs</span>
	  <span class="n">trim</span> <span class="n">xs</span> <span class="ow">=</span> <span class="n">xs</span><span class="o">.</span><span class="n">dropWhile</span> <span class="p">(</span><span class="nf">\</span><span class="n">x</span> <span class="ow">-&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
	  <span class="n">next_code</span> <span class="n">xs</span> <span class="ow">=</span> <span class="n">xs</span><span class="o">.</span><span class="n">trim</span><span class="o">.</span><span class="p">(</span><span class="nf">\</span><span class="n">xs</span> <span class="ow">-&gt;</span> <span class="kr">if</span> <span class="n">length</span> <span class="n">xs</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="kr">then</span> <span class="n">xs</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">code</span> <span class="kr">else</span> <span class="mi">0</span><span class="p">)</span>
	  <span class="n">aux</span> <span class="n">xs</span> <span class="ow">=</span> <span class="kr">case</span> <span class="n">trim</span> <span class="n">xs</span> <span class="kr">of</span>
		   <span class="kt">[]</span>     <span class="ow">-&gt;</span> <span class="kt">[]</span>
		   <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="kr">if</span> <span class="n">x</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="n">xs</span><span class="o">.</span><span class="n">next_code</span> <span class="kr">then</span> <span class="n">aux</span> <span class="n">xs</span> <span class="kr">else</span> <span class="n">x</span><span class="o">.</span><span class="n">code</span><span class="kt">:</span><span class="n">aux</span> <span class="n">xs</span>
	  <span class="n">res</span>    <span class="ow">=</span> <span class="n">aux</span> <span class="n">xs&#39;</span>
	  
<span class="nf">soundexes</span>     <span class="ow">=</span>  <span class="p">[</span><span class="s">&quot;holmes&quot;</span>           <span class="c1">-- H-452</span>
		  <span class="p">,</span><span class="s">&quot;adomomi&quot;</span>         <span class="c1">-- A-350 -- 355</span>
		  <span class="p">,</span><span class="s">&quot;vonderlehr&quot;</span>      <span class="c1">-- V-536</span>
		  <span class="p">,</span><span class="s">&quot;ball&quot;</span>            <span class="c1">-- B-400</span>
		  <span class="p">,</span><span class="s">&quot;shaw&quot;</span>            <span class="c1">-- S-000</span>
		  <span class="p">,</span><span class="s">&quot;jackson&quot;</span>         <span class="c1">-- J-250</span>
		  <span class="p">,</span><span class="s">&quot;scanlon&quot;</span>         <span class="c1">-- S-545</span>
		  <span class="p">,</span><span class="s">&quot;saintjohn&quot;</span>       <span class="c1">-- S-532</span>
		  <span class="p">,</span><span class="s">&quot;kingsmith&quot;</span>       <span class="c1">-- K-525</span>
		  <span class="p">,</span><span class="s">&quot;booth-davis&quot;</span>     <span class="c1">-- B-312</span>
		  <span class="p">,</span><span class="s">&quot;Knuth&quot;</span>           <span class="c1">-- K-530</span>
		  <span class="p">,</span><span class="s">&quot;Kant&quot;</span>            <span class="c1">-- K-530</span>
		  <span class="p">,</span><span class="s">&quot;Lloyd&quot;</span>           <span class="c1">-- L-300</span>
		  <span class="p">,</span><span class="s">&quot;Ladd&quot;</span>            <span class="c1">-- L-300</span>
		  <span class="p">]</span><span class="o">.</span><span class="n">map</span> <span class="n">soundex</span>	     
<span class="c1">-- TODO, not complete ($quota,$comment,$gcos,$expire) = getpw*</span>
<span class="kr">data</span> <span class="kt">Passwd_entry</span> <span class="ow">=</span> <span class="kt">Passwd_entry</span> <span class="p">{</span><span class="n">pw_name</span><span class="p">,</span><span class="n">pw_passwd</span><span class="p">,</span><span class="n">pw_comment</span><span class="p">,</span><span class="n">pw_dir</span><span class="p">,</span><span class="n">pw_shell</span><span class="ow">::</span><span class="kt">String</span><span class="p">,</span> <span class="n">pw_uid</span><span class="p">,</span><span class="n">pw_gid</span><span class="ow">::</span><span class="kt">Int</span><span class="p">}</span>
		  <span class="kr">deriving</span> <span class="p">(</span><span class="kt">Eq</span><span class="p">,</span><span class="kt">Show</span><span class="p">)</span>
<span class="nf">getpwent</span> <span class="n">s</span> <span class="ow">=</span> <span class="kr">let</span> <span class="p">[</span><span class="n">name1</span><span class="p">,</span><span class="n">passwd1</span><span class="p">,</span><span class="n">uid1</span><span class="p">,</span><span class="n">gid1</span><span class="p">,</span><span class="n">comment1</span><span class="p">,</span><span class="n">dir1</span><span class="p">,</span><span class="n">shell1</span><span class="p">]</span> <span class="ow">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span> <span class="s">&quot;:&quot;</span> <span class="kr">in</span>
		 <span class="kt">Passwd_entry</span> <span class="p">{</span><span class="n">pw_name</span><span class="ow">=</span><span class="n">name1</span><span class="p">,</span><span class="n">pw_passwd</span><span class="ow">=</span><span class="n">passwd1</span><span class="p">,</span><span class="n">pw_uid</span><span class="ow">=</span><span class="n">read</span> <span class="n">uid1</span><span class="p">,</span><span class="n">pw_gid</span><span class="ow">=</span><span class="n">read</span> <span class="n">gid1</span><span class="p">,</span>
			       <span class="n">pw_comment</span><span class="ow">=</span><span class="n">comment1</span><span class="p">,</span><span class="n">pw_dir</span><span class="ow">=</span><span class="n">dir1</span><span class="p">,</span><span class="n">pw_shell</span><span class="ow">=</span><span class="n">shell1</span><span class="p">}</span> 

<span class="nf">msoundex</span> <span class="ow">=</span> <span class="kr">do</span> <span class="n">putStr</span> <span class="s">&quot;Lookup user: &quot;</span>
	      <span class="n">user</span>  <span class="ow">&lt;-</span> <span class="n">getLine</span>
	      <span class="n">cat</span> <span class="s">&quot;/etc/passwd&quot;</span> <span class="o">&gt;&gt;=</span>
		  <span class="n">each</span> <span class="p">(</span><span class="nf">\</span><span class="n">l</span> <span class="ow">-&gt;</span> <span class="kr">let</span> <span class="kt">Passwd_entry</span> <span class="p">{</span><span class="n">pw_name</span><span class="ow">=</span><span class="n">name</span><span class="p">,</span><span class="n">pw_comment</span><span class="ow">=</span><span class="n">comment</span><span class="p">}</span> <span class="ow">=</span> <span class="n">l</span><span class="o">.</span><span class="n">getpwent</span>
			          <span class="p">[</span><span class="n">firstname</span><span class="p">,</span><span class="n">lastname</span><span class="p">]</span> <span class="ow">=</span> <span class="n">comment</span><span class="o">.</span><span class="n">match</span> <span class="s">&quot;(</span><span class="se">\\</span><span class="s">w+)[^,]*</span><span class="se">\\</span><span class="s">b(</span><span class="se">\\</span><span class="s">w+)&quot;</span>
			          <span class="n">soundex&#39;</span> <span class="n">xs</span> <span class="ow">=</span> <span class="kr">if</span> <span class="n">xs</span> <span class="o">==</span> <span class="kt">[]</span> <span class="kr">then</span> <span class="s">&quot;&quot;</span> <span class="kr">else</span> <span class="n">xs</span><span class="o">.</span><span class="n">soundex</span> <span class="kr">in</span>
			       <span class="kr">if</span> <span class="n">user</span><span class="o">.</span><span class="n">soundex&#39;</span> <span class="p">`</span><span class="n">elem</span><span class="p">`</span> <span class="p">(</span><span class="n">map</span> <span class="n">soundex&#39;</span> <span class="p">[</span><span class="n">name</span><span class="p">,</span><span class="n">firstname</span><span class="p">,</span><span class="n">lastname</span><span class="p">])</span>
			       <span class="kr">then</span> <span class="n">putStrLn</span> <span class="p">(</span><span class="n">name</span><span class="o">++</span><span class="s">&quot;: &quot;</span><span class="o">++</span><span class="n">firstname</span><span class="o">++</span><span class="s">&quot; &quot;</span><span class="o">++</span><span class="n">lastname</span><span class="p">)</span>
			       <span class="kr">else</span> <span class="n">return</span> <span class="nb">()</span>
			<span class="p">)</span>
			 
<span class="c1">-- TODO, pstyle and psgrep			 </span>
			 
<span class="c1">----------------------------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN65"
>Program: fixstyle</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN68"
>Program: psgrep</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="numbers.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>PLEAC-Haskell</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Numbers</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>