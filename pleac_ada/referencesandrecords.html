<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>References and Records</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="PLEAC-Ada"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="Subroutines"
HREF="subroutines.html"><LINK
REL="NEXT"
TITLE="Packages, Libraries, and Modules"
HREF="packagesetc.html"><style type="text/css">td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }

  </style></head
><BODY TEXT="#cecece" BGCOLOR="#4f6f6f" LINK="#f5deb3" VLINK="#d5ae83"
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PLEAC-Ada</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="subroutines.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="packagesetc.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="REFERENCESANDRECORDS"
>11. References and Records</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN592"
>Introduction</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">------------------------------------------------------------------------------</span>
<span class="kd">type</span> <span class="kt">Int_Ptr</span> <span class="kr">is</span> <span class="kr">access</span> <span class="kr">all</span> <span class="kt">Integer</span><span class="p">;</span>
<span class="n">ref</span> <span class="p">:</span> <span class="n">Int_Ptr</span><span class="p">;</span>
<span class="n">num</span> <span class="p">:</span> <span class="kr">aliased</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="mi">5</span><span class="p">;</span>
<span class="n">ref</span> <span class="p">:=</span> <span class="n">num</span><span class="p">&#39;</span><span class="na">Access</span><span class="p">;</span>

<span class="n">Put</span><span class="p">(</span><span class="n">Item</span> <span class="p">=&gt;</span> <span class="n">ref</span><span class="p">.</span><span class="kr">all</span><span class="p">);</span> <span class="c1">-- Print the value ref refers to</span>
<span class="n">ref</span><span class="p">.</span><span class="kr">all</span> <span class="p">:=</span> <span class="mi">3</span><span class="p">;</span>         <span class="c1">-- Assign to ref&#39;s referant</span>
<span class="c1">-------------------------------</span>
<span class="kd">type</span> <span class="kt">Flt_Ptr</span> <span class="kr">is</span> <span class="kr">access</span> <span class="kr">all</span> <span class="kt">Float</span><span class="p">;</span>
<span class="n">ref</span> <span class="p">:</span> <span class="n">Flt_Ptr</span><span class="p">;</span>
<span class="n">pi</span> <span class="p">:</span> <span class="kt">Float</span> <span class="p">:=</span> <span class="mf">3.14159</span><span class="p">;</span>
<span class="n">pi</span><span class="p">&#39;</span><span class="na">Access</span> <span class="p">:=</span> <span class="mi">4</span><span class="p">;</span> <span class="c1">-- Compile time error. The Access attribute cannot be used</span>
                <span class="c1">-- on the left hand side of an assignment.</span>
                <span class="c1">-- Also, &quot;pi&quot; is not defined as &quot;aliased&quot;. This will also</span>
                <span class="c1">-- generate a compiler error</span>
<span class="c1">-------------------------------</span>
<span class="c1">-- There is no direct relationship between arrays and references in Ada.</span>
<span class="c1">-- An array is a collection of like objects. An array name is NOT an</span>
<span class="c1">-- access or reference to the first element of the array as in C.</span>
<span class="c1">-------------------------------</span>
<span class="c1">-- Ada provides two kinds of access types, general access types and</span>
<span class="c1">-- pool-specific acess types. Referants for pool-specific access types</span>
<span class="c1">-- must always be dynamically allocated. Referants for general access</span>
<span class="c1">-- types may be dynamically allocated, or may refer to aliased objects</span>
<span class="c1">-- generated on the stack.</span>
<span class="kd">type</span> <span class="kt">Pool_Ptr</span> <span class="kr">is</span> <span class="kr">access</span> <span class="kt">Float</span><span class="p">;</span> <span class="c1">-- Pool specific access type</span>
<span class="kd">type</span> <span class="kt">Gen_Ptr</span> <span class="kr">is</span> <span class="kr">access</span> <span class="kr">all</span> <span class="kt">Float</span><span class="p">;</span> <span class="c1">-- General access type</span>
<span class="c1">------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN595"
>Taking References to Arrays</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">------------------------------------------------------------------------------</span>
<span class="kd">type</span> <span class="kt">Sales</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="kt">Integer</span> <span class="kr">range</span> <span class="mf">1.</span><span class="p">.</span><span class="mi">7</span><span class="p">)</span> <span class="kr">of</span> <span class="kt">Float</span><span class="p">;</span>
<span class="kd">type</span> <span class="kt">Sales_Access</span> <span class="kr">is</span> <span class="kr">access</span> <span class="n">Sales</span><span class="p">;</span> <span class="c1">-- Pool specific example</span>

<span class="n">Weekly_Sales</span> <span class="p">:</span> <span class="n">Sales_Access</span> <span class="p">:=</span> <span class="kr">new</span> <span class="n">Sales</span><span class="p">;</span> <span class="c1">-- dynamically allocate</span>
                                          <span class="c1">-- the Sales array</span>
                                          <span class="c1">-- and assign its reference to</span>
                                          <span class="c1">-- Weekly_Sales</span>
<span class="c1">-------------------------------</span>
<span class="n">last_index</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="n">Sales</span><span class="p">&#39;</span><span class="na">Last</span><span class="p">;</span>
<span class="n">first_index</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="n">Sales</span><span class="p">&#39;</span><span class="na">First</span><span class="p">;</span>
<span class="n">num_items</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="n">Sales</span><span class="p">&#39;</span><span class="na">Length</span><span class="p">;</span>
<span class="c1">-------------------------------</span>
<span class="c1">-- Ada arrays are all fixed size. They cannot be enlarged after creation</span>
<span class="c1">-- Ada array types may be unconstrained in size, allowing the size of a</span>
<span class="c1">-- particular instance to be specified upon creation.</span>

<span class="kd">type</span> <span class="kt">String</span> <span class="kr">is</span> <span class="kr">array</span><span class="p">(</span><span class="kt">Positive</span> <span class="kr">range</span> <span class="p">&lt;&gt;)</span> <span class="kr">of</span> <span class="kt">Character</span><span class="p">;</span>
<span class="n">s1</span> <span class="p">:</span> <span class="kt">String</span><span class="p">(</span><span class="mf">1.</span><span class="p">.</span><span class="mi">10</span><span class="p">);</span> <span class="c1">-- s1 is a 10 element string</span>
<span class="n">s2</span> <span class="p">:</span> <span class="kt">String</span><span class="p">(</span><span class="mf">1.</span><span class="p">.</span><span class="mi">34</span><span class="p">);</span> <span class="c1">-- s2 is a 34 element string</span>
<span class="n">s3</span> <span class="p">:</span> <span class="kt">String</span><span class="p">(</span><span class="mf">11.</span><span class="p">.</span><span class="mi">20</span><span class="p">);</span> <span class="c1">-- s3 is a 10 element string with a</span>
                     <span class="c1">-- a starting index of 11</span>
<span class="c1">-------------------------------</span>
<span class="kd">type</span> <span class="kt">String_Ref</span> <span class="kr">is</span> <span class="kr">access</span> <span class="kt">String</span><span class="p">;</span>
<span class="n">r1</span> <span class="p">:</span> <span class="n">String_Ref</span><span class="p">;</span>

<span class="n">r1</span> <span class="p">:=</span> <span class="kr">new</span> <span class="kt">String</span><span class="p">(</span><span class="mf">1.</span><span class="p">.</span><span class="mi">20</span><span class="p">);</span> <span class="c1">-- Dynamically allocate an array</span>
<span class="n">Put</span><span class="p">(</span><span class="n">r1</span><span class="p">(</span><span class="n">N</span><span class="p">));</span> <span class="c1">-- Print the character at index N</span>
<span class="c1">-------------------------------</span>
<span class="n">r1</span><span class="p">(</span><span class="mf">3.</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>  <span class="c1">-- Array slice</span>
<span class="c1">-------------------------------</span>
<span class="n">r1</span><span class="p">(</span><span class="mf">3.</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span> <span class="p">:=</span> <span class="n">r1</span><span class="p">(</span><span class="mf">9.</span><span class="p">.</span><span class="mi">11</span><span class="p">);</span>
<span class="c1">-------------------------------</span>
<span class="c1">-- Ada provides no way to make a reference to a slice</span>
<span class="c1">-------------------------------</span>
<span class="kr">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">r1</span><span class="p">&#39;</span><span class="na">Range</span> <span class="kr">loop</span>
  <span class="c1">-- iterate through all elements in the array</span>
  <span class="c1">-- referenced by r1</span>
<span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="c1">-------------------------------</span>
<span class="kr">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">s1</span><span class="p">&#39;</span><span class="na">Range</span> <span class="kr">loop</span>
   <span class="c1">-- iterate through all elements in array s1</span>
<span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="c1">------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN598"
>Making Hashes of Arrays</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">------------------------------------------------------------------------------</span>
<span class="c1">-- Ada provides no standard implementation of hashes</span>
<span class="c1">------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN601"
>Taking References to Hashes</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">------------------------------------------------------------------------------</span>
<span class="c1">-- Ada provides no standard implemenation of hashes</span>
<span class="c1">------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN604"
>Taking References to Functions</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">------------------------------------------------------------------------------</span>
<span class="c1">-- Define an access type to a function taking two integer parameters and</span>
<span class="c1">-- returning a boolean</span>
<span class="kd">type</span> <span class="kt">func_ref</span> <span class="kr">is</span> <span class="kr">access</span> <span class="kd">function</span> <span class="p">(</span><span class="nv">A</span><span class="p">,</span> <span class="nv">B</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Boolean</span><span class="p">;</span>

<span class="c1">-- Define an access type to a procedure taking no parameters</span>
<span class="kd">type</span> <span class="kt">proc_ref</span> <span class="kr">is</span> <span class="kr">access</span> <span class="kd">procedure</span><span class="p">;</span>

<span class="c1">-- Define a function taking two integers and returning a boolean</span>
<span class="kd">function</span> <span class="nf">Less_Than</span><span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="nv">Y</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Boolean</span><span class="p">;</span>

<span class="c1">-- Define an instance of the func_ref access type</span>
<span class="n">compare</span> <span class="p">:</span> <span class="n">func_ref</span><span class="p">;</span>

<span class="n">compare</span> <span class="p">:=</span> <span class="n">Less_Than</span><span class="p">&#39;</span><span class="na">Access</span><span class="p">;</span> <span class="c1">-- Less than matches the signature defined in</span>
                             <span class="c1">-- the func_ref type declaration</span>
<span class="c1">-- Calling the function through the referenc</span>
<span class="kr">if</span> <span class="n">compare</span><span class="p">(</span><span class="n">num1</span><span class="p">,</span> <span class="n">num2</span><span class="p">)</span> <span class="kr">then</span>
   <span class="p">...</span>  <span class="c1">-- act on the comparison</span>
<span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>

<span class="c1">-- Define a procedure taking no parameters</span>
<span class="kd">procedure</span> <span class="nf">Print_Header</span><span class="p">;</span>

<span class="c1">-- Define an instance of proc_ref access type</span>

<span class="n">action</span> <span class="p">:</span> <span class="n">proc_ref</span> <span class="p">:=</span> <span class="n">Print_Header</span><span class="p">&#39;</span><span class="na">Access</span><span class="p">;</span>

<span class="c1">-- Call the parameter-less procedure</span>
<span class="n">action</span><span class="p">.</span><span class="kr">all</span><span class="p">;</span>
<span class="c1">-------------------------------</span>
<span class="c1">-- Ada does not provide closures, or functions with static data</span>
<span class="c1">-- The same effect can be produced using Ada tasks.</span>
<span class="kd">package</span> <span class="nc">counters</span> <span class="kr">is</span>
   <span class="kd">task</span> <span class="kd">type</span> <span class="kt">Counter_Maker</span> <span class="kr">is</span>
      <span class="kd">entry</span> <span class="nf">Get_Count</span><span class="p">(</span><span class="nv">Num</span> <span class="p">: </span><span class="nv">out</span> <span class="nv">Integer</span><span class="p">);</span>
   <span class="kr">end</span> <span class="nf">Counter_Maker</span>
   <span class="nf">type</span> <span class="nf">Counter_Ref</span> <span class="nf">is</span> <span class="nf">access</span> <span class="nf">Counter_Maker</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">counters</span><span class="p">;</span>

<span class="kd">package</span> <span class="kd">body</span> <span class="nc">counters</span> <span class="kr">is</span>
   <span class="kd">task</span> <span class="kr">body</span> <span class="n">Counter_Maker</span> <span class="kr">is</span>
      <span class="n">start</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="kr">begin</span>
      <span class="kr">loop</span>
         <span class="kr">accept</span> <span class="n">Get_Count</span><span class="p">(</span><span class="n">Num</span> <span class="p">:</span> <span class="kr">out</span> <span class="kt">Integer</span><span class="p">)</span>
         <span class="kr">do</span>
            <span class="n">Num</span> <span class="p">:=</span> <span class="n">start</span><span class="p">;</span>
         <span class="kr">end</span> <span class="nf">Get_Count</span><span class="p">;</span>
         <span class="n">start</span> <span class="p">:=</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
      <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Counter_Maker</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">counters</span><span class="p">;</span>

<span class="n">counter1</span> <span class="p">:</span> <span class="n">Counter_Ref</span> <span class="p">:=</span> <span class="kr">new</span> <span class="n">Counter</span><span class="p">;</span>
<span class="n">the_count</span> <span class="p">:</span> <span class="kt">Integer</span><span class="p">;</span>

<span class="kr">for</span> <span class="n">iter</span> <span class="ow">in</span> <span class="mf">0.</span><span class="p">.</span><span class="mi">4</span> <span class="kr">loop</span>
   <span class="n">counter1</span><span class="p">.</span><span class="n">Get_Count</span><span class="p">(</span><span class="n">the_count</span><span class="p">);</span>
   <span class="n">Put_Line</span><span class="p">(</span><span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span><span class="p">(</span><span class="n">the_count</span><span class="p">));</span>
<span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="c1">-------------------------------</span>
<span class="n">counter1</span> <span class="p">:</span> <span class="n">Counter_Ref</span> <span class="p">:=</span> <span class="kr">new</span> <span class="n">Counter</span><span class="p">;</span>
<span class="n">counter2</span> <span class="p">:</span> <span class="n">Counter_Ref</span> <span class="p">:=</span> <span class="kr">new</span> <span class="n">Counter</span><span class="p">;</span>
<span class="n">count1</span><span class="p">,</span> <span class="n">count2</span> <span class="p">:</span> <span class="kt">Integer</span><span class="p">;</span>

<span class="kr">for</span> <span class="n">iter</span> <span class="ow">in</span> <span class="mf">0.</span><span class="p">.</span><span class="mi">4</span> <span class="kr">loop</span>
   <span class="n">counter1</span><span class="p">.</span><span class="n">Get_Count</span><span class="p">(</span><span class="n">count1</span><span class="p">);</span>
   <span class="n">Put_Line</span><span class="p">(</span><span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span><span class="p">(</span><span class="n">count1</span><span class="p">));</span>
<span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="n">counter1</span><span class="p">.</span><span class="n">Get_Count</span><span class="p">(</span><span class="n">count1</span><span class="p">);</span>
<span class="n">counter2</span><span class="p">.</span><span class="n">Get_Count</span><span class="p">(</span><span class="n">count2</span><span class="p">);</span>
<span class="n">Put_Line</span><span class="p">(</span><span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span><span class="p">(</span><span class="n">count1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; &quot;</span> <span class="o">&amp;</span>
         <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span><span class="p">(</span><span class="n">count2</span><span class="p">));</span>
<span class="mi">0</span>
<span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
<span class="mi">4</span>
<span class="mi">5</span> <span class="mi">0</span>
<span class="c1">-------------------------------</span>
<span class="kd">function</span> <span class="nf">Time_Diff</span><span class="p">(</span><span class="nv">Base_Time</span> <span class="p">: </span><span class="nv">Time</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Duration</span> <span class="kr">is</span>
   <span class="n">Now</span> <span class="p">:</span> <span class="n">Time</span> <span class="p">:=</span> <span class="n">Clock</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="kr">return</span> <span class="n">Now</span> <span class="o">-</span> <span class="n">Base_Time</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Time_Diff</span><span class="p">;</span>

<span class="n">early</span> <span class="p">:</span> <span class="n">Time</span><span class="p">;</span>
<span class="n">later</span> <span class="p">:</span> <span class="n">Time</span><span class="p">;</span>

<span class="n">early</span> <span class="p">:=</span> <span class="n">Clock</span><span class="p">;</span>
<span class="kr">delay</span> <span class="mf">20.0</span><span class="p">;</span>
<span class="n">later</span> <span class="p">:=</span> <span class="n">Clock</span><span class="p">;</span>
<span class="kr">delay</span> <span class="mf">10.0</span><span class="p">;</span>
<span class="n">Put_Line</span><span class="p">(</span><span class="s">&quot;It&#39;s been &quot;</span> <span class="o">&amp;</span> <span class="kt">Duration</span><span class="p">&#39;</span><span class="na">Image</span><span class="p">(</span><span class="n">Time_Diff</span><span class="p">(</span><span class="n">early</span><span class="p">))</span> <span class="o">&amp;</span>
         <span class="s">&quot; seconds since early.&quot;</span><span class="p">);</span>
<span class="n">Put_Line</span><span class="p">(</span><span class="s">&quot;It&#39;s been &quot;</span> <span class="o">&amp;</span> <span class="kt">Duration</span><span class="p">&#39;</span><span class="na">Image</span><span class="p">(</span><span class="n">Time_Diff</span><span class="p">(</span><span class="n">later</span><span class="p">))</span> <span class="o">&amp;</span>
         <span class="s">&quot; seconds since later&quot;</span><span class="p">);</span>
<span class="c1">-- It&#39;s been  30.007172430 seconds since early.</span>
<span class="c1">-- It&#39;s been  10.003749644 seconds since later.</span>
<span class="c1">------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN607"
>Taking References to Scalars</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">------------------------------------------------------------------------------</span>
<span class="c1">-- Ada does not provide special syntax for obtaining reference to scalars</span>
<span class="c1">-- compared to vectors.</span>
<span class="c1">------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN610"
>Creating Arrays of Scalar References</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">------------------------------------------------------------------------------</span>
<span class="kd">type</span> <span class="kt">Num_Ref</span> <span class="kr">is</span> <span class="kr">access</span> <span class="kr">all</span> <span class="kt">Integer</span><span class="p">;</span>
<span class="kd">type</span> <span class="kt">Ref_Array</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="mf">1.</span><span class="p">.</span><span class="mi">10</span><span class="p">)</span> <span class="kr">of</span> <span class="n">Num_Ref</span><span class="p">;</span>
<span class="c1">-------------------------------</span>
<span class="n">array_of_refs</span> <span class="p">:</span> <span class="n">Ref_Array</span><span class="p">;</span>
<span class="n">array_of_refs</span> <span class="p">:=</span> <span class="p">(</span><span class="kr">Others</span> <span class="p">=&gt;</span> <span class="kc">null</span><span class="p">);</span> <span class="c1">-- Set all values to null references</span>

<span class="kr">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">Ref_Array</span><span class="p">&#39;</span><span class="na">Range</span> <span class="kr">loop</span>
   <span class="n">array_of_refs</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="p">:=</span> <span class="kr">new</span> <span class="kt">Integer</span><span class="p">&#39;(</span><span class="n">index</span><span class="p">);</span>
<span class="kr">end</span> <span class="kr">loop</span>
<span class="err">-------------------------------</span>
<span class="nf">for</span> <span class="nf">index</span> <span class="nf">in</span> <span class="nf">Ref_Array</span><span class="err">&#39;</span><span class="nf">Range</span> <span class="kr">loop</span>
   <span class="nf">Put_Line</span><span class="err">(</span><span class="nf">Integer</span><span class="err">&#39;</span><span class="nf">Image</span><span class="err">(</span><span class="nf">array_of_refs</span><span class="err">(</span><span class="nf">index</span><span class="err">)</span><span class="nf">.all</span><span class="err">))</span><span class="p">;</span>
<span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="c1">-------------------------------</span>
<span class="kr">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">Ref_Array</span><span class="p">&#39;</span><span class="na">Range</span> <span class="kr">loop</span>
   <span class="n">array_of_refs</span><span class="p">(</span><span class="n">index</span><span class="p">).</span><span class="kr">all</span> <span class="p">:=</span> <span class="n">index</span> <span class="o">*</span> <span class="mi">10</span><span class="p">;</span>
<span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="c1">------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN613"
>Using Closures Instead of Objects</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN616"
>Creating References to Methods</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN619"
>Constructing Records</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN622"
>Reading and Writing Hash Records to Text Files</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN625"
>Printing Data Structures</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN628"
>Copying Data Structures</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN631"
>Storing Data Structures to Disk</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN634"
>Transparently Persistent Data Structures</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN637"
>Program: Binary Trees</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">------------------------------------------------------------------------------</span>
<span class="c1">-------------------------------------------------------------------------------</span>
<span class="c1">-- Binary Tree Example</span>
<span class="c1">-------------------------------------------------------------------------------</span>

<span class="kd">package</span> <span class="nc">Binary_Trees</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Tree</span> <span class="kr">is</span> <span class="kd">private</span><span class="p">;</span>
   <span class="kd">procedure</span> <span class="nf">insert</span><span class="p">(</span><span class="nv">Item</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">Integer</span><span class="p">;</span> <span class="nv">Into</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Tree</span><span class="p">);</span>
   <span class="kd">procedure</span> <span class="nf">in_order</span><span class="p">(</span><span class="nv">Item</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">Tree</span><span class="p">);</span>
   <span class="kd">procedure</span> <span class="nf">pre_order</span><span class="p">(</span><span class="nv">Item</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">Tree</span><span class="p">);</span>
   <span class="kd">procedure</span> <span class="nf">post_order</span><span class="p">(</span><span class="nv">Item</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">Tree</span><span class="p">);</span>
   <span class="kd">function</span> <span class="nf">search</span><span class="p">(</span><span class="nv">Item</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">Integer</span><span class="p">;</span> <span class="nv">From</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">Tree</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">boolean</span><span class="p">;</span>
<span class="kd">private</span>
   <span class="kd">type</span> <span class="kt">node</span><span class="p">;</span>
   <span class="kd">type</span> <span class="kt">Tree</span> <span class="kr">is</span> <span class="kr">access</span> <span class="n">Node</span><span class="p">;</span>
   <span class="kd">type</span> <span class="kt">Node</span> <span class="kr">is</span> <span class="kr">record</span>
      <span class="n">Value</span> <span class="p">:</span> <span class="kt">Integer</span><span class="p">;</span>
      <span class="n">Left</span>  <span class="p">:</span> <span class="n">Tree</span> <span class="p">:=</span> <span class="kc">Null</span><span class="p">;</span>
      <span class="n">Right</span> <span class="p">:</span> <span class="n">Tree</span> <span class="p">:=</span> <span class="kc">Null</span><span class="p">;</span>
   <span class="kr">end record</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Binary_Trees</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Ada.Text_Io</span><span class="p">;</span>

<span class="kd">package</span> <span class="kd">body</span> <span class="nc">Binary_Trees</span> <span class="kr">is</span>

   <span class="kd">procedure</span> <span class="nf">insert</span><span class="p">(</span><span class="nv">Item</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">Integer</span><span class="p">;</span> <span class="nv">Into</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Tree</span><span class="p">)</span> <span class="kr">is</span>
   <span class="kr">begin</span>
     <span class="kr">if</span> <span class="n">Into</span> <span class="o">/=</span> <span class="kc">null</span> <span class="kr">then</span>
        <span class="kr">if</span> <span class="n">Into</span><span class="p">.</span><span class="n">Value</span> <span class="o">&gt;</span> <span class="n">Item</span> <span class="kr">then</span>
           <span class="n">insert</span><span class="p">(</span><span class="n">Item</span><span class="p">,</span> <span class="n">Into</span><span class="p">.</span><span class="n">Left</span><span class="p">);</span>
        <span class="kr">elsif</span> <span class="n">Into</span><span class="p">.</span><span class="n">Value</span> <span class="o">&lt;</span> <span class="n">Item</span> <span class="kr">then</span>
           <span class="n">insert</span><span class="p">(</span><span class="n">Item</span><span class="p">,</span> <span class="n">Into</span><span class="p">.</span><span class="n">Right</span><span class="p">);</span>
        <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span> <span class="c1">-- Do nothing if duplicate</span>
     <span class="kr">else</span>
        <span class="n">Into</span> <span class="p">:=</span> <span class="kr">new</span> <span class="n">Node</span><span class="p">;</span>
        <span class="n">Into</span><span class="p">.</span><span class="n">Value</span> <span class="p">:=</span> <span class="n">Item</span><span class="p">;</span>
     <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>
        <span class="kr">end</span> <span class="nf">insert</span><span class="p">;</span>

   <span class="kd">procedure</span> <span class="nf">in_order</span><span class="p">(</span><span class="nv">Item</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">Tree</span><span class="p">)</span> <span class="kr">is</span>
   <span class="kr">begin</span>
     <span class="kr">if</span> <span class="n">Item</span> <span class="o">=</span> <span class="kc">null</span> <span class="kr">then</span>
        <span class="kr">return</span><span class="p">;</span>
     <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>
     <span class="n">in_order</span><span class="p">(</span><span class="n">Item</span><span class="p">.</span><span class="n">Left</span><span class="p">);</span>
     <span class="n">Put</span><span class="p">(</span><span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span><span class="p">(</span><span class="n">Item</span><span class="p">.</span><span class="n">Value</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; &quot;</span><span class="p">);</span>
     <span class="n">in_order</span><span class="p">(</span><span class="n">Item</span><span class="p">.</span><span class="n">Right</span><span class="p">);</span>
   <span class="kr">end</span> <span class="nf">in_order</span><span class="p">;</span>

   <span class="kd">procedure</span> <span class="nf">pre_order</span><span class="p">(</span><span class="nv">Item</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">Tree</span><span class="p">)</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="kr">if</span> <span class="n">Item</span> <span class="o">=</span> <span class="kc">null</span> <span class="kr">then</span>
         <span class="kr">return</span><span class="p">;</span>
      <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>
      <span class="n">Put</span><span class="p">(</span><span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span><span class="p">(</span><span class="n">Item</span><span class="p">.</span><span class="n">Value</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; &quot;</span><span class="p">);</span>
      <span class="n">pre_order</span><span class="p">(</span><span class="n">Item</span><span class="p">.</span><span class="n">Left</span><span class="p">);</span>
      <span class="n">pre_order</span><span class="p">(</span><span class="n">Item</span><span class="p">.</span><span class="n">Right</span><span class="p">);</span>
   <span class="kr">end</span> <span class="nf">pre_order</span><span class="p">;</span>

   <span class="kd">procedure</span> <span class="nf">post_order</span><span class="p">(</span><span class="nv">Item</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">Tree</span><span class="p">)</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="kr">if</span> <span class="n">Item</span> <span class="o">=</span> <span class="kc">null</span> <span class="kr">then</span>
         <span class="kr">return</span><span class="p">;</span>
      <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>
      <span class="n">post_order</span><span class="p">(</span><span class="n">Item</span><span class="p">.</span><span class="n">Left</span><span class="p">);</span>
      <span class="n">post_order</span><span class="p">(</span><span class="n">Item</span><span class="p">.</span><span class="n">Right</span><span class="p">);</span>
      <span class="n">Put</span><span class="p">(</span><span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span><span class="p">(</span><span class="n">Item</span><span class="p">.</span><span class="n">Value</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; &quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="nf">post_order</span><span class="p">;</span>

   <span class="kd">function</span> <span class="nf">search</span><span class="p">(</span><span class="nv">Item</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">;</span> <span class="nv">From</span> <span class="p">: </span><span class="nv">Tree</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Boolean</span> <span class="kr">is</span>
      <span class="n">Result</span> <span class="p">:</span> <span class="kt">Boolean</span><span class="p">;</span>
   <span class="kr">begin</span>
      <span class="kr">if</span> <span class="n">From</span> <span class="o">/=</span> <span class="kc">null</span> <span class="kr">then</span>
         <span class="kr">if</span> <span class="n">From</span><span class="p">.</span><span class="n">Value</span> <span class="o">=</span> <span class="n">Item</span> <span class="kr">then</span>
            <span class="n">Result</span> <span class="p">:=</span> <span class="kc">True</span><span class="p">;</span>
         <span class="kr">elsif</span> <span class="n">From</span><span class="p">.</span><span class="n">Value</span> <span class="o">&gt;</span> <span class="n">Item</span> <span class="kr">then</span>
            <span class="n">Result</span> <span class="p">:=</span> <span class="n">search</span><span class="p">(</span><span class="n">Item</span><span class="p">,</span> <span class="n">From</span><span class="p">.</span><span class="n">Left</span><span class="p">);</span>
         <span class="kr">else</span>
            <span class="n">Result</span> <span class="p">:=</span> <span class="n">search</span><span class="p">(</span><span class="n">Item</span><span class="p">,</span> <span class="n">From</span><span class="p">.</span><span class="n">Right</span><span class="p">);</span>
         <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>
      <span class="kr">else</span>
         <span class="n">Result</span> <span class="p">:=</span> <span class="kc">False</span><span class="p">;</span>
      <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>
      <span class="kr">return</span> <span class="n">Result</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">search</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Binary_Trees</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Binary_Trees</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Binary_Trees</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Numerics.Discrete_Random</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Text_Io</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_Io</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Integer_Text_Io</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Integer_Text_Io</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Tree_Test</span> <span class="kr">is</span>
   <span class="kd">package</span> <span class="nc">Rand_Num</span> <span class="kr">is new</span> <span class="nc">Ada.Numerics.Discrete_Random</span><span class="p">(</span>Integer<span class="p">);</span>
   <span class="kn">use</span> <span class="nn">Rand_Num</span><span class="p">;</span>
   <span class="n">Seed</span> <span class="p">:</span> <span class="kt">Generator</span><span class="p">;</span>
   <span class="n">Val</span>  <span class="p">:</span> <span class="kt">Integer</span><span class="p">;</span>
   <span class="n">The_Tree</span> <span class="p">:</span> <span class="n">Tree</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Reset</span><span class="p">(</span><span class="n">Seed</span><span class="p">);</span>
   <span class="kr">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="mf">1.</span><span class="p">.</span><span class="mi">20</span> <span class="kr">loop</span>
      <span class="n">Val</span> <span class="p">:=</span> <span class="n">Random</span><span class="p">(</span><span class="n">Seed</span><span class="p">);</span>
      <span class="n">insert</span><span class="p">(</span><span class="n">Item</span> <span class="p">=&gt;</span> <span class="n">Val</span><span class="p">,</span> <span class="n">Into</span> <span class="p">=&gt;</span> <span class="n">The_Tree</span><span class="p">);</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
        <span class="c1">-- now dump out the tree all three ways</span>
   <span class="n">Put</span><span class="p">(</span><span class="s">&quot;Pre Order: &quot;</span><span class="p">);</span>
   <span class="n">pre_order</span><span class="p">(</span><span class="n">The_Tree</span><span class="p">);</span>
   <span class="n">New_Line</span><span class="p">;</span>
   <span class="n">Put</span><span class="p">(</span><span class="s">&quot;In order: &quot;</span><span class="p">);</span>
   <span class="n">in_order</span><span class="p">(</span><span class="n">The_Tree</span><span class="p">);</span>
   <span class="n">New_Line</span><span class="p">;</span>
   <span class="n">Put</span><span class="p">(</span><span class="s">&quot;Post_Order: &quot;</span><span class="p">);</span>
   <span class="n">post_order</span><span class="p">(</span><span class="n">The_Tree</span><span class="p">);</span>
   <span class="n">New_Line</span><span class="p">;</span>

        <span class="c1">-- prompt until EOF</span>
   <span class="kr">loop</span>
      <span class="n">Put</span><span class="p">(</span><span class="s">&quot;Search? &quot;</span><span class="p">);</span>
      <span class="kr">exit</span> <span class="kr">when</span> <span class="n">Ada</span><span class="p">.</span><span class="n">Text_IO</span><span class="p">.</span><span class="n">End_Of_File</span><span class="p">;</span>
      <span class="n">Get</span><span class="p">(</span><span class="n">Val</span><span class="p">);</span> <span class="c1">-- read input as an integer</span>
      <span class="kr">if</span> <span class="n">search</span><span class="p">(</span><span class="n">Item</span> <span class="p">=&gt;</span> <span class="n">Val</span><span class="p">,</span> <span class="n">From</span> <span class="p">=&gt;</span> <span class="n">The_Tree</span><span class="p">)</span> <span class="kr">then</span>
         <span class="n">Put_Line</span><span class="p">(</span><span class="s">&quot;Found &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span><span class="p">(</span><span class="n">Val</span><span class="p">));</span>
      <span class="kr">else</span>
         <span class="n">Put_Line</span><span class="p">(</span><span class="s">&quot;No &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span><span class="p">(</span><span class="n">Val</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; in tree&quot;</span><span class="p">);</span>
      <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Tree_Test</span><span class="p">;</span></PRE
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="subroutines.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="packagesetc.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Subroutines</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Packages, Libraries, and Modules</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>