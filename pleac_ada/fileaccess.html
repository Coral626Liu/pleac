<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>File Access</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="PLEAC-Ada"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="Pattern Matching"
HREF="patternmatching.html"><LINK
REL="NEXT"
TITLE="File Contents"
HREF="filecontents.html"><style type="text/css">td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }

  </style></head
><BODY TEXT="#cecece" BGCOLOR="#4f6f6f" LINK="#f5deb3" VLINK="#d5ae83"
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PLEAC-Ada</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="patternmatching.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="filecontents.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="FILEACCESS"
>7. File Access</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN359"
>Introduction</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">------------------------------------------------------------------------------</span>
<span class="c1">-- Normal textual input and output is accomplished using the pacakge</span>
<span class="c1">-- Ada.Text_IO. The following I/O routines are taken from that package</span>

<span class="n">file</span> <span class="p">:</span> <span class="kt">File_Type</span><span class="p">;</span>

<span class="kr">begin</span>
   <span class="n">Open</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">file</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=&gt;</span> <span class="s">&quot;/usr/local/widgets/data&quot;</span><span class="p">,</span> <span class="n">Mode</span> <span class="p">=&gt;</span> <span class="n">In_File</span><span class="p">);</span>
<span class="kr">exception</span>
   <span class="kr">when</span> <span class="n">Name_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span> <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;File name not found.&quot;</span><span class="p">);</span>
   <span class="kr">when</span> <span class="n">Status_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span> <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;File already open.&quot;</span><span class="p">);</span>
   <span class="kr">when</span> <span class="n">Use_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span>
          <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;You do not have permission to open the file&quot;</span><span class="p">);</span>
<span class="kr">end</span><span class="p">;</span>
<span class="c1">-------------------------------</span>
<span class="n">file</span> <span class="p">:</span> <span class="kt">File_Type</span><span class="p">;</span>
<span class="n">length</span> <span class="p">:</span> <span class="kt">Natural</span><span class="p">;</span>
<span class="n">line</span>   <span class="p">:</span> <span class="kt">String</span><span class="p">(</span><span class="mf">1.</span><span class="p">.</span><span class="mi">1024</span><span class="p">);</span> <span class="c1">-- some string large enough to hold any line in</span>
                          <span class="c1">-- the file</span>
<span class="kr">begin</span>
   <span class="n">Open</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">file</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=&gt;</span> <span class="s">&quot;/usr/local/widgets/data&quot;</span><span class="p">,</span> <span class="n">Mode</span> <span class="p">=&gt;</span> <span class="n">In_File</span><span class="p">);</span>
   <span class="kr">while</span> <span class="ow">not</span> <span class="n">End_Of_File</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="kr">loop</span>
      <span class="n">Get_Line</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">file</span><span class="p">,</span> <span class="n">Item</span> <span class="p">=&gt;</span> <span class="n">line</span><span class="p">,</span> <span class="n">Last</span> <span class="p">=&gt;</span> <span class="n">length</span><span class="p">);</span>
      <span class="n">Put_Line</span><span class="p">(</span><span class="n">Item</span> <span class="p">=&gt;</span> <span class="n">line</span><span class="p">(</span><span class="mf">1.</span><span class="p">.</span><span class="n">length</span><span class="p">));</span> <span class="c1">-- writes to stdout</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="n">Close</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<span class="kr">exception</span>
   <span class="kr">when</span> <span class="n">Name_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span> <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;File name not found.&quot;</span><span class="p">);</span>
   <span class="kr">when</span> <span class="n">Status_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span> <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;File already open.&quot;</span><span class="p">);</span>
   <span class="kr">when</span> <span class="n">Use_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span>  <span class="c1">-- writes to stderr</span>
          <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;You do not have permission to open the file&quot;</span><span class="p">);</span>
<span class="kr">end</span><span class="p">;</span>
<span class="c1">-------------------------------</span>
<span class="n">num</span> <span class="p">:</span> <span class="kt">float</span><span class="p">;</span>

<span class="kr">while</span> <span class="ow">not</span> <span class="n">End_Of_File</span> <span class="kr">loop</span>
   <span class="kr">begin</span>
      <span class="n">Get</span><span class="p">(</span><span class="n">Item</span> <span class="p">=&gt;</span> <span class="n">num</span><span class="p">);</span> <span class="c1">-- read a float from stdin</span>
      <span class="n">Put_Line</span><span class="p">(</span><span class="kt">float</span><span class="p">&#39;</span><span class="na">Image</span><span class="p">(</span><span class="n">num</span><span class="p">));</span> <span class="c1">-- write to stdout</span>
   <span class="kr">exception</span>
      <span class="kr">when</span> <span class="n">Data_Error</span> <span class="o">=</span><span class="p">.</span>
         <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span> <span class="c1">-- write to stderr</span>
             <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;File contains non-numeric data&quot;</span><span class="p">);</span>
         <span class="n">Skip_Line</span><span class="p">;</span> <span class="c1">-- skip the rest of the current input line</span>
   <span class="kr">end</span><span class="p">;</span>
<span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="c1">-------------------------------</span>
<span class="n">logfile</span> <span class="p">:</span> <span class="kt">File_Type</span><span class="p">;</span>

<span class="kr">begin</span>
   <span class="n">Open</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">logfile</span><span class="p">,</span>
        <span class="n">Name</span> <span class="p">=&gt;</span> <span class="s">&quot;/tmp/log&quot;</span><span class="p">,</span>
        <span class="n">Mode</span> <span class="p">=&gt;</span> <span class="n">Out_File</span><span class="p">);</span>  <span class="c1">-- open for output</span>
<span class="kr">exception</span>
   <span class="kr">when</span> <span class="n">Name_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span> <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;File name not found.&quot;</span><span class="p">);</span>
   <span class="kr">when</span> <span class="n">Status_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span> <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;File already open.&quot;</span><span class="p">);</span>
   <span class="kr">when</span> <span class="n">Use_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span>  <span class="c1">-- writes to stderr</span>
          <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;You do not have permission to open the file&quot;</span><span class="p">);</span>
<span class="kr">end</span><span class="p">;</span>
<span class="c1">-------------------------------</span>
<span class="n">oldfile</span> <span class="p">:</span> <span class="kt">File_Type</span><span class="p">;</span>

<span class="n">oldfile</span> <span class="p">:=</span> <span class="n">Current_Output</span><span class="p">;</span> <span class="c1">-- save old file handle</span>
<span class="n">Set_Output</span><span class="p">(</span><span class="n">logfile</span><span class="p">);</span> <span class="c1">-- switch standard output</span>
<span class="n">Put_Line</span><span class="p">(</span><span class="s">&quot;Countdown initiated ...&quot;</span><span class="p">);</span>
<span class="n">Set_Output</span><span class="p">(</span><span class="n">oldfile</span><span class="p">);</span> <span class="c1">-- return to original output</span>
<span class="n">Put_Line</span><span class="p">(</span><span class="s">&quot;You have 30 seconds to reach maximum safety distance.&quot;</span><span class="p">);</span>
<span class="c1">------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN362"
>Opening a File</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">------------------------------------------------------------------------------</span>
<span class="n">source</span> <span class="p">:</span> <span class="kt">file_type</span><span class="p">;</span>
<span class="n">sink</span>   <span class="p">:</span> <span class="kt">file_type</span><span class="p">;</span>

<span class="c1">-- open file for reading</span>
<span class="kr">begin</span>
   <span class="n">Open</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">source</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=&gt;</span> <span class="n">path</span><span class="p">,</span> <span class="n">Mode</span> <span class="p">=&gt;</span> <span class="n">In_File</span><span class="p">);</span>
<span class="kr">exception</span>
   <span class="kr">when</span> <span class="n">Name_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span> <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;File name not found.&quot;</span><span class="p">);</span>
   <span class="kr">when</span> <span class="n">Status_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span> <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;File already open.&quot;</span><span class="p">);</span>
   <span class="kr">when</span> <span class="n">Use_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span>
          <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;You do not have permission to open the file&quot;</span><span class="p">);</span>
<span class="kr">end</span><span class="p">;</span>

<span class="c1">-- open file for writing</span>
<span class="kr">begin</span>
   <span class="n">Open</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">sink</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=&gt;</span> <span class="n">path</span><span class="p">,</span> <span class="n">Mode</span> <span class="p">=&gt;</span> <span class="n">Out_File</span><span class="p">);</span>
<span class="kr">exception</span>
   <span class="kr">when</span> <span class="n">Name_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span> <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;File name not found.&quot;</span><span class="p">);</span>
   <span class="kr">when</span> <span class="n">Status_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span> <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;File already open.&quot;</span><span class="p">);</span>
   <span class="kr">when</span> <span class="n">Use_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span>
          <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;You do not have permission to open the file&quot;</span><span class="p">);</span>
<span class="kr">end</span><span class="p">;</span>

<span class="c1">-- Open file for writing, creating a new file</span>
<span class="kr">begin</span>
   <span class="n">Create</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">sink</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=&gt;</span> <span class="n">path</span><span class="p">);</span>
<span class="kr">exception</span>
   <span class="kr">when</span> <span class="n">Name_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span> <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;File name not found.&quot;</span><span class="p">);</span>
   <span class="kr">when</span> <span class="n">Status_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span> <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;File already open.&quot;</span><span class="p">);</span>
   <span class="kr">when</span> <span class="n">Use_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span>
          <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;You do not have permission to open the file&quot;</span><span class="p">);</span>
<span class="kr">end</span><span class="p">;</span>
<span class="c1">-------------------------------</span>
<span class="c1">-- You must instantiate the package Ada.Direct_Io to perform both input</span>
<span class="c1">-- and output on a file.</span>
<span class="kd">package</span> <span class="nc">dir_text</span> <span class="kr">is new</span> <span class="nc">Ada.Direct_Io</span><span class="p">(</span>Character<span class="p">);</span>
<span class="kn">use</span> <span class="nn">dir_text</span><span class="p">;</span>

<span class="n">direct</span> <span class="p">:</span> <span class="kt">File_Type</span><span class="p">;</span>

<span class="kr">begin</span>
   <span class="n">Open</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">direct</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=&gt;</span> <span class="n">path</span><span class="p">,</span> <span class="n">Mode</span> <span class="p">=&gt;</span> <span class="n">InOut_File</span><span class="p">);</span>
<span class="kr">exception</span>
   <span class="kr">when</span> <span class="n">Name_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span> <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;File name not found.&quot;</span><span class="p">);</span>
   <span class="kr">when</span> <span class="n">Status_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span> <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;File already open.&quot;</span><span class="p">);</span>
   <span class="kr">when</span> <span class="n">Use_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span>
          <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;You do not have permission to open the file&quot;</span><span class="p">);</span>
<span class="kr">end</span><span class="p">;</span>
<span class="c1">-------------------------------</span>
<span class="n">sink</span> <span class="p">:</span> <span class="kt">File_Type</span><span class="p">;</span>

<span class="kr">begin</span>
   <span class="n">Open</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">sink</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=&gt;</span> <span class="n">path</span><span class="p">,</span> <span class="n">Mode</span> <span class="p">=&gt;</span> <span class="n">Append_File</span><span class="p">);</span>
<span class="kr">exception</span>
   <span class="kr">when</span> <span class="n">Name_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span> <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;File name not found.&quot;</span><span class="p">);</span>
   <span class="kr">when</span> <span class="n">Status_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span> <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;File already open.&quot;</span><span class="p">);</span>
   <span class="kr">when</span> <span class="n">Use_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span>
          <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;You do not have permission to open the file&quot;</span><span class="p">);</span>
<span class="kr">end</span><span class="p">;</span>
<span class="c1">------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN365"
>Opening Files with Unusual Filenames</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">------------------------------------------------------------------------------</span>
<span class="c1">-- Ada does not provide any rules about file names. Unusual file names are</span>
<span class="c1">-- opened the same as common file names.</span>
<span class="c1">------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN368"
>Expanding Tildes in Filenames</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">------------------------------------------------------------------------------</span>
<span class="c1">-- Ada provides no facilities for expanding tildes in file names.</span>
<span class="c1">------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN371"
>Making Perl Report Filenames in Errors</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">------------------------------------------------------------------------------</span>
<span class="c1">-- (The Ada equivalent)</span>
<span class="n">sink</span> <span class="p">:</span> <span class="kt">File_Type</span><span class="p">;</span>

<span class="kr">begin</span>
   <span class="n">Open</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">sink</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=&gt;</span> <span class="n">path</span><span class="p">,</span> <span class="n">Mode</span> <span class="p">=&gt;</span> <span class="n">Append_File</span><span class="p">);</span>
<span class="kr">exception</span>
   <span class="kr">when</span> <span class="n">Name_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span> <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;File &quot;</span> <span class="o">&amp;</span> <span class="n">path</span> <span class="s">&quot; not found.&quot;</span><span class="p">);</span>
   <span class="kr">when</span> <span class="n">Status_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span> <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;File &quot;</span> <span class="o">&amp;</span> <span class="n">path</span> <span class="o">&amp;</span> <span class="s">&quot; already open.&quot;</span><span class="p">);</span>
   <span class="kr">when</span> <span class="n">Use_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span>
          <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;You do not have permission to open file &quot;</span> <span class="o">&amp;</span> <span class="n">path</span><span class="p">);</span>
<span class="kr">end</span><span class="p">;</span>
<span class="c1">------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN374"
>Creating Temporary Files</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">------------------------------------------------------------------------------</span>
<span class="c1">-- Passing in a null string for the file name creates a temporary file</span>

<span class="kr">begin</span>
   <span class="n">Create</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">sink</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=&gt;</span> <span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="kr">exception</span>
   <span class="kr">when</span> <span class="n">Use_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span>
          <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;You do not have permission to open the file&quot;</span><span class="p">);</span>
<span class="kr">end</span><span class="p">;</span>
<span class="c1">------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN377"
>Storing Files Inside Your Program Text</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">------------------------------------------------------------------------------</span>
<span class="c1">-- Not allowed in Ada.</span>
<span class="c1">------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN380"
>Writing a Filter</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">------------------------------------------------------------------------------</span>
<span class="n">line</span> <span class="p">:</span> <span class="kt">String</span><span class="p">(</span><span class="mf">1.</span><span class="p">.</span><span class="mi">256</span><span class="p">);</span>
<span class="n">length</span> <span class="p">:</span> <span class="kt">Natural</span><span class="p">;</span>

<span class="kr">while</span> <span class="ow">not</span> <span class="n">End_Of_File</span> <span class="kr">loop</span>
   <span class="n">Get_Line</span><span class="p">(</span><span class="n">Item</span> <span class="p">=&gt;</span> <span class="n">line</span><span class="p">,</span> <span class="n">Last</span> <span class="p">=&gt;</span> <span class="n">length</span><span class="p">);</span>
   <span class="c1">-- ...  -- do something with the input line</span>
<span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="c1">-------------------------------</span>
<span class="c1">-- The GNAT extension package Gnat.Command_Line provides some high level</span>
<span class="c1">-- command line parsing capabilities.</span>
<span class="c1">-- Simple command line parsing is provided by the standard package</span>
<span class="c1">-- Ada.Command_Line.</span>

<span class="n">source</span> <span class="p">:</span> <span class="kt">File_Type</span><span class="p">;</span>
<span class="kr">for</span> <span class="n">argnum</span> <span class="ow">in</span> <span class="mf">1.</span><span class="p">.</span><span class="n">Argument_Count</span> <span class="kr">loop</span>
   <span class="kr">begin</span>
      <span class="n">Open</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Source</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=&gt;</span> <span class="n">Argument</span><span class="p">(</span><span class="n">argnum</span><span class="p">),</span>
           <span class="n">Mode</span> <span class="p">=&gt;</span> <span class="n">In_File</span><span class="p">);</span>
      <span class="kr">while</span> <span class="ow">not</span> <span class="n">End_Of_File</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="kr">loop</span>
         <span class="c1">-- process the file from the command line</span>
      <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="kr">exception</span>
      <span class="kr">when</span> <span class="n">Name_Error</span> <span class="p">=&gt;</span>
         <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span> <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;File name not found.&quot;</span><span class="p">);</span>
      <span class="kr">when</span> <span class="n">Status_Error</span> <span class="p">=&gt;</span>
         <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span> <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;File already open.&quot;</span><span class="p">);</span>
      <span class="kr">when</span> <span class="n">Use_Error</span> <span class="p">=&gt;</span>
         <span class="n">Put</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Standard_Error</span><span class="p">,</span>
             <span class="n">Item</span> <span class="p">=&gt;</span> <span class="s">&quot;You do not have permission to open the file&quot;</span><span class="p">);</span>
   <span class="kr">end</span><span class="p">;</span>
<span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="c1">-------------------------------</span>
<span class="c1">-- arg demo 1: Process optional -c flag</span>
<span class="kr">loop</span>
   <span class="kr">case</span> <span class="n">GetOpt</span><span class="p">(</span><span class="s">&quot;-c&quot;</span><span class="p">)</span> <span class="kr">is</span>
      <span class="kr">when</span> <span class="n">ASCII</span><span class="p">.</span><span class="n">NUL</span> <span class="p">=&gt;</span>
         <span class="kr">exit</span><span class="p">;</span> <span class="c1">-- exit loop</span>
      <span class="kr">when</span> <span class="p">&#39;</span><span class="na">c</span><span class="p">&#39;</span> <span class="p">=&gt;</span>
         <span class="c1">-- set whatever internal flag corresponds to the &quot;-c&quot; option</span>
      <span class="kr">when</span> <span class="kr">Others</span> <span class="p">=&gt;</span>
         <span class="kr">raise</span> <span class="n">Program_Error</span><span class="p">;</span> <span class="c1">-- cannot occur!</span>
   <span class="kr">end</span> <span class="kr">case</span><span class="p">;</span>
<span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="c1">-------------------------------</span>
<span class="c1">-- arg demo 2: Process optional -NUMBER flag</span>
<span class="kr">loop</span>
   <span class="kr">case</span> <span class="n">GetOpt</span><span class="p">(</span><span class="s">&quot;1 2 3 4 5 6 7 8 9&quot;</span><span class="p">)</span> <span class="kr">is</span>
      <span class="kr">when</span> <span class="n">ASCII</span><span class="p">.</span><span class="n">NUL</span> <span class="p">=&gt;</span>
         <span class="kr">exit</span><span class="p">;</span>
      <span class="kr">when</span> <span class="p">&#39;</span><span class="na">1</span><span class="p">&#39;</span> <span class="p">=&gt;</span>
         <span class="c1">-- process 1</span>
      <span class="kr">when</span> <span class="p">&#39;</span><span class="na">2</span><span class="p">&#39;</span> <span class="p">=&gt;</span>
         <span class="c1">-- process 2</span>
      <span class="kr">when</span> <span class="p">&#39;</span><span class="na">3</span><span class="p">&#39;</span> <span class="p">=&gt;</span>
         <span class="c1">-- process 3</span>
      <span class="kr">when</span> <span class="p">&#39;</span><span class="na">4</span><span class="p">&#39;</span> <span class="p">=&gt;</span>
         <span class="c1">-- process 4</span>
      <span class="kr">when</span> <span class="p">&#39;</span><span class="na">5</span><span class="p">&#39;</span> <span class="p">=&gt;</span>
         <span class="c1">-- process 5</span>
      <span class="kr">when</span> <span class="p">&#39;</span><span class="na">6</span><span class="p">&#39;</span> <span class="p">=&gt;</span>
         <span class="c1">-- process 6</span>
      <span class="kr">when</span> <span class="p">&#39;</span><span class="na">7</span><span class="p">&#39;</span> <span class="p">=&gt;</span>
         <span class="c1">-- process 7</span>
      <span class="kr">when</span> <span class="p">&#39;</span><span class="na">8</span><span class="p">&#39;</span> <span class="p">=&gt;</span>
         <span class="c1">-- process 8</span>
      <span class="kr">when</span> <span class="p">&#39;</span><span class="na">9</span><span class="p">&#39;</span> <span class="p">=&gt;</span>
         <span class="c1">-- process 9</span>
      <span class="kr">when</span> <span class="kr">Others</span> <span class="p">=&gt;</span>
         <span class="kr">raise</span> <span class="n">Program_Error</span><span class="p">;</span>
   <span class="kr">end</span> <span class="kr">case</span><span class="p">;</span>
<span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="c1">-------------------------------</span>
<span class="c1">-- arg demo 3: Process clustering -a, -i, -n, or -u flags</span>

<span class="kr">loop</span>
   <span class="kr">case</span> <span class="n">Get_Opt</span><span class="p">(</span><span class="s">&quot;a i n u&quot;</span><span class="p">)</span> <span class="kr">is</span>
      <span class="kr">when</span> <span class="n">ASCII</span><span class="p">.</span><span class="n">NUL</span> <span class="p">=&gt;</span>
         <span class="kr">exit</span><span class="p">;</span>
      <span class="kr">when</span> <span class="p">&#39;</span><span class="na">a</span><span class="p">&#39;</span> <span class="p">=&gt;</span>
         <span class="n">append</span> <span class="p">:=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="kr">when</span> <span class="p">&#39;</span><span class="na">i</span><span class="p">&#39;</span> <span class="p">=&gt;</span>
         <span class="n">ignore_ints</span> <span class="p">:=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="kr">when</span> <span class="p">&#39;</span><span class="na">n</span><span class="p">&#39;</span> <span class="p">=&gt;</span>
         <span class="n">nostdout</span> <span class="p">:=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="kr">when</span> <span class="p">&#39;</span><span class="na">u</span><span class="p">&#39;</span> <span class="p">=&gt;</span>
         <span class="n">unbuffer</span> <span class="p">:=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="kr">when</span> <span class="kr">Others</span> <span class="p">=&gt;</span>
         <span class="kr">raise</span> <span class="n">Program_Error</span><span class="p">;</span>
   <span class="kr">end</span> <span class="kr">case</span><span class="p">;</span>
<span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="c1">------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN383"
>Modifying a File in Place with Temporary File</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">------------------------------------------------------------------------------</span>
<span class="c1">-- Ada has no &quot;rename&quot; built in. It can, however, call existing programs</span>
<span class="c1">-- to achieve the same purpose.</span>
<span class="kn">with</span> <span class="nn">Interfaces.C</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Interfaces.C</span><span class="p">;</span>
<span class="kd">procedure</span> <span class="nf">Rename_File</span><span class="p">(</span><span class="nv">From</span><span class="p">,</span> <span class="nv">To</span> <span class="p">: </span><span class="nv">String</span><span class="p">)</span> <span class="kr">is</span>
   <span class="kd">function</span> <span class="nf">system</span><span class="p">(</span><span class="nv">Command</span> <span class="p">: </span><span class="nv">Char_Array</span><span class="p">)</span> <span class="kr">return</span> <span class="n">Int</span><span class="p">;</span>
   <span class="kr">pragma</span> <span class="cp">Import</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="s">&quot;system&quot;</span><span class="p">);</span>
   <span class="n">rc</span> <span class="p">:</span> <span class="n">Int</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">rc</span> <span class="p">:=</span> <span class="n">system</span><span class="p">(</span><span class="n">To_C</span><span class="p">(</span><span class="s">&quot;mv &quot;</span> <span class="o">&amp;</span> <span class="n">From</span> <span class="o">&amp;</span> <span class="s">&quot; &quot;</span> <span class="o">&amp;</span> <span class="n">To</span><span class="p">));</span>
<span class="kr">end</span> <span class="nf">Rename_File</span><span class="p">;</span>
<span class="c1">-------------------------------</span>
<span class="n">Open</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Old</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=&gt;</span> <span class="n">old_file</span><span class="p">,</span> <span class="n">Mode</span> <span class="p">=&gt;</span> <span class="n">In_File</span><span class="p">);</span>
<span class="n">Create</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="kr">New</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=&gt;</span> <span class="n">new_file</span><span class="p">);</span>
<span class="kr">while</span> <span class="ow">not</span> <span class="n">End_Of_File</span><span class="p">(</span><span class="n">Old</span><span class="p">)</span> <span class="kr">loop</span>
   <span class="n">Get_Line</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="n">Old</span><span class="p">,</span> <span class="n">Item</span> <span class="p">=&gt;</span> <span class="n">Line</span><span class="p">,</span> <span class="n">Last</span> <span class="p">=&gt;</span> <span class="n">Length</span><span class="p">);</span>
   <span class="c1">-- process the data in Line</span>
   <span class="n">Put_Line</span><span class="p">(</span><span class="n">File</span> <span class="p">=&gt;</span> <span class="kr">New</span><span class="p">,</span> <span class="n">Item</span> <span class="p">=&gt;</span> <span class="n">Line</span><span class="p">(</span><span class="mf">1.</span><span class="p">.</span><span class="n">Length</span><span class="p">));</span>
<span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="n">Close</span><span class="p">(</span><span class="n">Old</span><span class="p">);</span>
<span class="n">Close</span><span class="p">(</span><span class="kr">New</span><span class="p">);</span>
<span class="n">Rename_File</span><span class="p">(</span><span class="n">old_file</span><span class="p">,</span> <span class="n">old_file</span> <span class="o">&amp;</span> <span class="s">&quot;.orig&quot;</span><span class="p">);</span>
<span class="n">Rename_File</span><span class="p">(</span><span class="n">new_file</span><span class="p">,</span> <span class="n">old_file</span><span class="p">);</span>
<span class="c1">------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN386"
>Modifying a File in Place with -i Switch</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN389"
>Modifying a File in Place Without a Temporary File</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN392"
>Locking a File</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN395"
>Flushing Output</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN398"
>Reading from Many Filehandles Without Blocking</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN401"
>Doing Non-Blocking I/O</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN404"
>Determining the Number of Bytes to Read</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN407"
>Storing Filehandles in Variables</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN410"
>Caching Open Output Filehandles</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN413"
>Printing to Many Filehandles Simultaneously</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN416"
>Opening and Closing File Descriptors by Number</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN419"
>Copying Filehandles</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN422"
>Program: netlock</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN425"
>Program: lockarea</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="patternmatching.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="filecontents.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Pattern Matching</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>File Contents</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>