<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Strings</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="PLEAC-Perl"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="PLEAC-Perl"
HREF="index.html"><LINK
REL="NEXT"
TITLE="Numbers"
HREF="numbers.html"><style type="text/css">td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }

  </style></head
><BODY TEXT="#cecece" BGCOLOR="#4f6f6f" LINK="#f5deb3" VLINK="#d5ae83"
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PLEAC-Perl</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="index.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="numbers.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="STRINGS"
>1. Strings</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN14"
>Introduction</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">#-----------------------------</span>
<span class="nv">$string</span> <span class="o">=</span> <span class="s">&#39;\n&#39;</span><span class="p">;</span>                     <span class="c1"># two characters, \ and an n</span>
<span class="nv">$string</span> <span class="o">=</span> <span class="s">&#39;Jon \&#39;Maddog\&#39; Orwant&#39;</span><span class="p">;</span>  <span class="c1"># literal single quotes</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$string</span> <span class="o">=</span> <span class="s">&quot;\n&quot;</span><span class="p">;</span>                     <span class="c1"># a &quot;newline&quot; character</span>
<span class="nv">$string</span> <span class="o">=</span> <span class="s">&quot;Jon \&quot;Maddog\&quot; Orwant&quot;</span><span class="p">;</span>  <span class="c1"># literal double quotes</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$string</span> <span class="o">=</span> <span class="sx">q/Jon &#39;Maddog&#39; Orwant/</span><span class="p">;</span>   <span class="c1"># literal single quotes</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$string</span> <span class="o">=</span> <span class="sx">q[Jon &#39;Maddog&#39; Orwant]</span><span class="p">;</span>   <span class="c1"># literal single quotes</span>
<span class="nv">$string</span> <span class="o">=</span> <span class="sx">q{Jon &#39;Maddog&#39; Orwant}</span><span class="p">;</span>   <span class="c1"># literal single quotes</span>
<span class="nv">$string</span> <span class="o">=</span> <span class="sx">q(Jon &#39;Maddog&#39; Orwant)</span><span class="p">;</span>   <span class="c1"># literal single quotes</span>
<span class="nv">$string</span> <span class="o">=</span> <span class="sx">q&lt;Jon &#39;Maddog&#39; Orwant&gt;</span><span class="p">;</span>   <span class="c1"># literal single quotes</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$a</span> <span class="o">=</span> <span class="s">&lt;&lt;&quot;EOF&quot;;</span>
<span class="s">This is a multiline here document</span>
<span class="s">terminated by EOF on a line by itself</span>
<span class="s">EOF</span>
<span class="c1">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN17"
>Accessing Substrings</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">#-----------------------------</span>
<span class="nv">$value</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$string</span><span class="p">,</span> <span class="nv">$offset</span><span class="p">,</span> <span class="nv">$count</span><span class="p">);</span>
<span class="nv">$value</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$string</span><span class="p">,</span> <span class="nv">$offset</span><span class="p">);</span>

<span class="nb">substr</span><span class="p">(</span><span class="nv">$string</span><span class="p">,</span> <span class="nv">$offset</span><span class="p">,</span> <span class="nv">$count</span><span class="p">)</span> <span class="o">=</span> <span class="nv">$newstring</span><span class="p">;</span>
<span class="nb">substr</span><span class="p">(</span><span class="nv">$string</span><span class="p">,</span> <span class="nv">$offset</span><span class="p">)</span>         <span class="o">=</span> <span class="nv">$newtail</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="c1"># get a 5-byte string, skip 3, then grab 2 8-byte strings, then the rest</span>
<span class="p">(</span><span class="nv">$leading</span><span class="p">,</span> <span class="nv">$s1</span><span class="p">,</span> <span class="nv">$s2</span><span class="p">,</span> <span class="nv">$trailing</span><span class="p">)</span> <span class="o">=</span>
    <span class="nb">unpack</span><span class="p">(</span><span class="s">&quot;A5 x3 A8 A8 A*&quot;</span><span class="p">,</span> <span class="nv">$data</span><span class="p">);</span>

<span class="c1"># split at five byte boundaries</span>
<span class="nv">@fivers</span> <span class="o">=</span> <span class="nb">unpack</span><span class="p">(</span><span class="s">&quot;A5&quot;</span> <span class="n">x</span> <span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="nv">$string</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">),</span> <span class="nv">$string</span><span class="p">);</span>

<span class="c1"># chop string into individual characters</span>
<span class="nv">@chars</span>  <span class="o">=</span> <span class="nb">unpack</span><span class="p">(</span><span class="s">&quot;A1&quot;</span> <span class="n">x</span> <span class="nb">length</span><span class="p">(</span><span class="nv">$string</span><span class="p">),</span> <span class="nv">$string</span><span class="p">);</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$string</span> <span class="o">=</span> <span class="s">&quot;This is what you have&quot;</span><span class="p">;</span>
<span class="c1">#         +012345678901234567890  Indexing forwards  (left to right)</span>
<span class="c1">#          109876543210987654321- Indexing backwards (right to left)</span>
<span class="c1">#           note that 0 means 10 or 20, etc. above</span>

<span class="nv">$first</span>  <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$string</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>  <span class="c1"># &quot;T&quot;</span>
<span class="nv">$start</span>  <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$string</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>  <span class="c1"># &quot;is&quot;</span>
<span class="nv">$rest</span>   <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$string</span><span class="p">,</span> <span class="mi">13</span><span class="p">);</span>    <span class="c1"># &quot;you have&quot;</span>
<span class="nv">$last</span>   <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$string</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>    <span class="c1"># &quot;e&quot;</span>
<span class="nv">$end</span>    <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$string</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">);</span>    <span class="c1"># &quot;have&quot;</span>
<span class="nv">$piece</span>  <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$string</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="c1"># &quot;you&quot;</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$string</span> <span class="o">=</span> <span class="s">&quot;This is what you have&quot;</span><span class="p">;</span>
<span class="k">print</span> <span class="nv">$string</span><span class="p">;</span>
<span class="c1">#This is what you have</span>

<span class="nb">substr</span><span class="p">(</span><span class="nv">$string</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="s">&quot;wasn&#39;t&quot;</span><span class="p">;</span> <span class="c1"># change &quot;is&quot; to &quot;wasn&#39;t&quot;</span>
<span class="c1">#This wasn&#39;t what you have</span>

<span class="nb">substr</span><span class="p">(</span><span class="nv">$string</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">)</span>  <span class="o">=</span> <span class="s">&quot;ondrous&quot;</span><span class="p">;</span><span class="c1"># replace last 12 characters</span>
<span class="c1">#This wasn&#39;t wondrous</span>

<span class="nb">substr</span><span class="p">(</span><span class="nv">$string</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">;</span>       <span class="c1"># delete first character</span>
<span class="c1">#his wasn&#39;t wondrous</span>

<span class="nb">substr</span><span class="p">(</span><span class="nv">$string</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">)</span>  <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">;</span>       <span class="c1"># delete last 10 characters</span>
<span class="c1">#his wasn&#39;</span>
<span class="c1">#-----------------------------</span>
<span class="c1"># you can test substrings with =~</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$string</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">)</span> <span class="o">=~</span><span class="sr"> /pattern/</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s">&quot;Pattern matches in last 10 characters\n&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1"># substitute &quot;at&quot; for &quot;is&quot;, restricted to first five characters</span>
<span class="nb">substr</span><span class="p">(</span><span class="nv">$string</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">=~</span> <span class="sr">s/is/at/g</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="c1"># exchange the first and last letters in a string</span>
<span class="nv">$a</span> <span class="o">=</span> <span class="s">&quot;make a hat&quot;</span><span class="p">;</span>
<span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">=</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span>
<span class="k">print</span> <span class="nv">$a</span><span class="p">;</span>
<span class="c1"># take a ham</span>
<span class="c1">#-----------------------------</span>
<span class="c1"># extract column with unpack</span>
<span class="nv">$a</span> <span class="o">=</span> <span class="s">&quot;To be or not to be&quot;</span><span class="p">;</span>
<span class="nv">$b</span> <span class="o">=</span> <span class="nb">unpack</span><span class="p">(</span><span class="s">&quot;x6 A6&quot;</span><span class="p">,</span> <span class="nv">$a</span><span class="p">);</span>  <span class="c1"># skip 6, grab 6</span>
<span class="k">print</span> <span class="nv">$b</span><span class="p">;</span>
<span class="c1"># or not</span>

<span class="p">(</span><span class="nv">$b</span><span class="p">,</span> <span class="nv">$c</span><span class="p">)</span> <span class="o">=</span> <span class="nb">unpack</span><span class="p">(</span><span class="s">&quot;x6 A2 X5 A2&quot;</span><span class="p">,</span> <span class="nv">$a</span><span class="p">);</span> <span class="c1"># forward 6, grab 2; backward 5, grab 2</span>
<span class="k">print</span> <span class="s">&quot;$b\n$c\n&quot;</span><span class="p">;</span>
<span class="c1"># or</span>
<span class="c1">#</span>
<span class="c1"># be</span>
<span class="c1">#-----------------------------</span>
<span class="k">sub </span><span class="nf">cut2fmt</span> <span class="p">{</span>
    <span class="k">my</span><span class="p">(</span><span class="nv">@positions</span><span class="p">)</span> <span class="o">=</span> <span class="nv">@_</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$template</span>   <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$lastpos</span>    <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">foreach</span> <span class="nv">$place</span> <span class="p">(</span><span class="nv">@positions</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$template</span> <span class="o">.=</span> <span class="s">&quot;A&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$place</span> <span class="o">-</span> <span class="nv">$lastpos</span><span class="p">)</span> <span class="o">.</span> <span class="s">&quot; &quot;</span><span class="p">;</span>
        <span class="nv">$lastpos</span>   <span class="o">=</span> <span class="nv">$place</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nv">$template</span> <span class="o">.=</span> <span class="s">&quot;A*&quot;</span><span class="p">;</span>
    <span class="k">return</span> <span class="nv">$template</span><span class="p">;</span>
<span class="p">}</span>

<span class="nv">$fmt</span> <span class="o">=</span> <span class="n">cut2fmt</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
<span class="k">print</span> <span class="s">&quot;$fmt\n&quot;</span><span class="p">;</span>
<span class="c1"># A7 A6 A6 A6 A4 A*</span>
<span class="c1">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN20"
>Establishing a Default Value</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">#-----------------------------</span>
<span class="c1"># use $b if $b is true, else $c</span>
<span class="nv">$a</span> <span class="o">=</span> <span class="nv">$b</span> <span class="o">||</span> <span class="nv">$c</span><span class="p">;</span>              

<span class="c1"># set $x to $y unless $x is already true</span>
<span class="nv">$x</span> <span class="o">||=</span> <span class="nv">$y</span>
<span class="c1">#-----------------------------</span>
<span class="c1"># use $b if $b is defined, else $c</span>
<span class="nv">$a</span> <span class="o">=</span> <span class="nb">defined</span><span class="p">(</span><span class="nv">$b</span><span class="p">)</span> <span class="p">?</span> <span class="nv">$b</span> <span class="p">:</span> <span class="nv">$c</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$foo</span> <span class="o">=</span> <span class="nv">$bar</span> <span class="o">||</span> <span class="s">&quot;DEFAULT VALUE&quot;</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$dir</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">(</span><span class="nv">@ARGV</span><span class="p">)</span> <span class="o">||</span> <span class="s">&quot;/tmp&quot;</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$dir</span> <span class="o">=</span> <span class="nv">$ARGV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">||</span> <span class="s">&quot;/tmp&quot;</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$dir</span> <span class="o">=</span> <span class="nb">defined</span><span class="p">(</span><span class="nv">$ARGV</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">?</span> <span class="nb">shift</span><span class="p">(</span><span class="nv">@ARGV</span><span class="p">)</span> <span class="p">:</span> <span class="s">&quot;/tmp&quot;</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$dir</span> <span class="o">=</span> <span class="nv">@ARGV</span> <span class="p">?</span> <span class="nv">$ARGV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="s">&quot;/tmp&quot;</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$count</span><span class="p">{</span> <span class="nv">$shell</span> <span class="o">||</span> <span class="s">&quot;/bin/sh&quot;</span> <span class="p">}</span><span class="o">++</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="c1"># find the user name on Unix systems</span>
<span class="nv">$user</span> <span class="o">=</span> <span class="nv">$ENV</span><span class="p">{</span><span class="n">USER</span><span class="p">}</span>
     <span class="o">||</span> <span class="nv">$ENV</span><span class="p">{</span><span class="n">LOGNAME</span><span class="p">}</span>
     <span class="o">||</span> <span class="nb">getlogin</span><span class="p">()</span>
     <span class="o">||</span> <span class="p">(</span><span class="nb">getpwuid</span><span class="p">(</span><span class="vg">$&lt;</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
     <span class="o">||</span> <span class="s">&quot;Unknown uid number $&lt;&quot;</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$starting_point</span> <span class="o">||=</span> <span class="s">&quot;Greenwich&quot;</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="nv">@a</span> <span class="o">=</span> <span class="nv">@b</span> <span class="k">unless</span> <span class="nv">@a</span><span class="p">;</span>          <span class="c1"># copy only if empty</span>
<span class="nv">@a</span> <span class="o">=</span> <span class="nv">@b</span> <span class="p">?</span> <span class="nv">@b</span> <span class="p">:</span> <span class="nv">@c</span><span class="p">;</span>          <span class="c1"># assign @b if nonempty, else @c</span>
<span class="c1">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN23"
>Exchanging Values Without Using Temporary Variables</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">#-----------------------------</span>
<span class="p">(</span><span class="nv">$VAR1</span><span class="p">,</span> <span class="nv">$VAR2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$VAR2</span><span class="p">,</span> <span class="nv">$VAR1</span><span class="p">);</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$temp</span>    <span class="o">=</span> <span class="nv">$a</span><span class="p">;</span>
<span class="nv">$a</span>       <span class="o">=</span> <span class="nv">$b</span><span class="p">;</span>
<span class="nv">$b</span>       <span class="o">=</span> <span class="nv">$temp</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$a</span>       <span class="o">=</span> <span class="s">&quot;alpha&quot;</span><span class="p">;</span>
<span class="nv">$b</span>       <span class="o">=</span> <span class="s">&quot;omega&quot;</span><span class="p">;</span>
<span class="p">(</span><span class="nv">$a</span><span class="p">,</span> <span class="nv">$b</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$b</span><span class="p">,</span> <span class="nv">$a</span><span class="p">);</span>        <span class="c1"># the first shall be last -- and versa vice</span>
<span class="c1">#-----------------------------</span>
<span class="p">(</span><span class="nv">$alpha</span><span class="p">,</span> <span class="nv">$beta</span><span class="p">,</span> <span class="nv">$production</span><span class="p">)</span> <span class="o">=</span> <span class="sx">qw(January March August)</span><span class="p">;</span>
<span class="c1"># move beta       to alpha,</span>
<span class="c1"># move production to beta,</span>
<span class="c1"># move alpha      to production</span>
<span class="p">(</span><span class="nv">$alpha</span><span class="p">,</span> <span class="nv">$beta</span><span class="p">,</span> <span class="nv">$production</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$beta</span><span class="p">,</span> <span class="nv">$production</span><span class="p">,</span> <span class="nv">$alpha</span><span class="p">);</span>
<span class="c1">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN26"
>Converting Between ASCII Characters and Values</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">#-----------------------------</span>
<span class="nv">$num</span>  <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="nv">$char</span><span class="p">);</span>
<span class="nv">$char</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="nv">$num</span><span class="p">);</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$char</span> <span class="o">=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s">&quot;%c&quot;</span><span class="p">,</span> <span class="nv">$num</span><span class="p">);</span>                <span class="c1"># slower than chr($num)</span>
<span class="nb">printf</span><span class="p">(</span><span class="s">&quot;Number %d is character %c\n&quot;</span><span class="p">,</span> <span class="nv">$num</span><span class="p">,</span> <span class="nv">$num</span><span class="p">);</span>
<span class="n">Number</span> <span class="mi">101</span> <span class="n">is</span> <span class="n">character</span> <span class="n">e</span>
<span class="c1">#-----------------------------</span>
<span class="nv">@ASCII</span> <span class="o">=</span> <span class="nb">unpack</span><span class="p">(</span><span class="s">&quot;C*&quot;</span><span class="p">,</span> <span class="nv">$string</span><span class="p">);</span>
<span class="nv">$STRING</span> <span class="o">=</span> <span class="nb">pack</span><span class="p">(</span><span class="s">&quot;C*&quot;</span><span class="p">,</span> <span class="nv">@ascii</span><span class="p">);</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$ascii_value</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="s">&quot;e&quot;</span><span class="p">);</span>    <span class="c1"># now 101</span>
<span class="nv">$character</span>   <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">101</span><span class="p">);</span>    <span class="c1"># now &quot;e&quot;</span>
<span class="c1">#-----------------------------</span>
<span class="nb">printf</span><span class="p">(</span><span class="s">&quot;Number %d is character %c\n&quot;</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">101</span><span class="p">);</span>
<span class="c1">#-----------------------------</span>
<span class="nv">@ascii_character_numbers</span> <span class="o">=</span> <span class="nb">unpack</span><span class="p">(</span><span class="s">&quot;C*&quot;</span><span class="p">,</span> <span class="s">&quot;sample&quot;</span><span class="p">);</span>
<span class="k">print</span> <span class="s">&quot;@ascii_character_numbers\n&quot;</span><span class="p">;</span>
<span class="mi">115</span> <span class="mi">97</span> <span class="mi">109</span> <span class="mi">112</span> <span class="mi">108</span> <span class="mi">101</span>


<span class="nv">$word</span> <span class="o">=</span> <span class="nb">pack</span><span class="p">(</span><span class="s">&quot;C*&quot;</span><span class="p">,</span> <span class="nv">@ascii_character_numbers</span><span class="p">);</span>
<span class="nv">$word</span> <span class="o">=</span> <span class="nb">pack</span><span class="p">(</span><span class="s">&quot;C*&quot;</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">101</span><span class="p">);</span>   <span class="c1"># same</span>
<span class="k">print</span> <span class="s">&quot;$word\n&quot;</span><span class="p">;</span>
<span class="n">sample</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$hal</span> <span class="o">=</span> <span class="s">&quot;HAL&quot;</span><span class="p">;</span>
<span class="nv">@ascii</span> <span class="o">=</span> <span class="nb">unpack</span><span class="p">(</span><span class="s">&quot;C*&quot;</span><span class="p">,</span> <span class="nv">$hal</span><span class="p">);</span>
<span class="k">foreach</span> <span class="nv">$val</span> <span class="p">(</span><span class="nv">@ascii</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$val</span><span class="o">++</span><span class="p">;</span>                 <span class="c1"># add one to each ASCII value</span>
<span class="p">}</span>
<span class="nv">$ibm</span> <span class="o">=</span> <span class="nb">pack</span><span class="p">(</span><span class="s">&quot;C*&quot;</span><span class="p">,</span> <span class="nv">@ascii</span><span class="p">);</span>
<span class="k">print</span> <span class="s">&quot;$ibm\n&quot;</span><span class="p">;</span>             <span class="c1"># prints &quot;IBM&quot;</span>
<span class="c1">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN29"
>Processing a String One Character at a Time</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">#-----------------------------</span>
<span class="nv">@array</span> <span class="o">=</span> <span class="nb">split</span><span class="p">(</span><span class="sr">//</span><span class="p">,</span> <span class="nv">$string</span><span class="p">);</span>

<span class="nv">@array</span> <span class="o">=</span> <span class="nb">unpack</span><span class="p">(</span><span class="s">&quot;C*&quot;</span><span class="p">,</span> <span class="nv">$string</span><span class="p">);</span>
<span class="c1">#-----------------------------</span>
    <span class="k">while</span> <span class="p">(</span><span class="sr">/(.)/g</span><span class="p">)</span> <span class="p">{</span> <span class="c1"># . is never a newline here</span>
        <span class="c1"># do something with $1</span>
    <span class="p">}</span>
<span class="c1">#-----------------------------</span>
<span class="nv">%seen</span> <span class="o">=</span> <span class="p">();</span>
<span class="nv">$string</span> <span class="o">=</span> <span class="s">&quot;an apple a day&quot;</span><span class="p">;</span>
<span class="k">foreach</span> <span class="nv">$byte</span> <span class="p">(</span><span class="nb">split</span> <span class="sr">//</span><span class="p">,</span> <span class="nv">$string</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$seen</span><span class="p">{</span><span class="nv">$byte</span><span class="p">}</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">print</span> <span class="s">&quot;unique chars are: &quot;</span><span class="p">,</span> <span class="nb">sort</span><span class="p">(</span><span class="nb">keys</span> <span class="nv">%seen</span><span class="p">),</span> <span class="s">&quot;\n&quot;</span><span class="p">;</span>
<span class="n">unique</span> <span class="n">chars</span> <span class="n">are:</span>  <span class="n">adelnpy</span>
<span class="c1">#-----------------------------</span>
<span class="nv">%seen</span> <span class="o">=</span> <span class="p">();</span>
<span class="nv">$string</span> <span class="o">=</span> <span class="s">&quot;an apple a day&quot;</span><span class="p">;</span>
<span class="k">while</span> <span class="p">(</span><span class="nv">$string</span> <span class="o">=~</span><span class="sr"> /(.)/g</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$seen</span><span class="p">{</span><span class="nv">$1</span><span class="p">}</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">print</span> <span class="s">&quot;unique chars are: &quot;</span><span class="p">,</span> <span class="nb">sort</span><span class="p">(</span><span class="nb">keys</span> <span class="nv">%seen</span><span class="p">),</span> <span class="s">&quot;\n&quot;</span><span class="p">;</span>
<span class="n">unique</span> <span class="n">chars</span> <span class="n">are:</span>  <span class="n">adelnpy</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">foreach</span> <span class="nv">$ascval</span> <span class="p">(</span><span class="nb">unpack</span><span class="p">(</span><span class="s">&quot;C*&quot;</span><span class="p">,</span> <span class="nv">$string</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$sum</span> <span class="o">+=</span> <span class="nv">$ascval</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">print</span> <span class="s">&quot;sum is $sum\n&quot;</span><span class="p">;</span>
<span class="c1"># prints &quot;1248&quot; if $string was &quot;an apple a day&quot;</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$sum</span> <span class="o">=</span> <span class="nb">unpack</span><span class="p">(</span><span class="s">&quot;%32C*&quot;</span><span class="p">,</span> <span class="nv">$string</span><span class="p">);</span>
<span class="c1">#-----------------------------</span>
<span class="c1"># <font size="-1"><a href="http://pleac.sourceforge.net/include/perl/ch01/sum</span>">download the following standalone program</a></font>
<span class="c1">#!/usr/bin/perl</span>
<span class="c1"># sum - compute 16-bit checksum of all input files</span>
<span class="nv">$checksum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">while</span> <span class="p">(</span><span class="o">&lt;&gt;</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$checksum</span> <span class="o">+=</span> <span class="nb">unpack</span><span class="p">(</span><span class="s">&quot;%16C*&quot;</span><span class="p">,</span> <span class="nv">$_</span><span class="p">)</span> <span class="p">}</span>
<span class="nv">$checksum</span> <span class="nv">%</span><span class="err">=</span> <span class="err">(</span><span class="nv">2</span> <span class="o">**</span> <span class="mi">16</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">print</span> <span class="s">&quot;$checksum\n&quot;</span><span class="p">;</span>

<span class="c1">#-----------------------------</span>
<span class="c1">#% perl sum /etc/termcap</span>
<span class="c1">#1510</span>
<span class="c1">#-----------------------------</span>
<span class="c1">#% sum --sysv /etc/termcap</span>
<span class="c1">#1510 851 /etc/termcap</span>
<span class="c1">#-----------------------------</span>
<span class="c1"># <font size="-1"><a href="http://pleac.sourceforge.net/include/perl/ch01/slowcat</span>">download the following standalone program</a></font>
<span class="c1">#!/usr/bin/perl</span>
<span class="c1"># slowcat - emulate a   s l o w   line printer</span>
<span class="c1"># usage: slowcat [-DELAY] [files ...]</span>
<span class="nv">$DELAY</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$ARGV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=~</span><span class="sr"> /^-([.\d]+)/</span><span class="p">)</span> <span class="p">?</span> <span class="p">(</span><span class="nb">shift</span><span class="p">,</span> <span class="nv">$1</span><span class="p">)</span> <span class="p">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="vg">$|</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">while</span> <span class="p">(</span><span class="o">&lt;&gt;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="nb">split</span><span class="p">(</span><span class="sr">//</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">print</span><span class="p">;</span>
        <span class="nb">select</span><span class="p">(</span><span class="nb">undef</span><span class="p">,</span><span class="nb">undef</span><span class="p">,</span><span class="nb">undef</span><span class="p">,</span> <span class="mf">0.005</span> <span class="o">*</span> <span class="nv">$DELAY</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN32"
>Reversing a String by Word or Character</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">#-----------------------------</span>
<span class="nv">$revbytes</span> <span class="o">=</span> <span class="nb">reverse</span><span class="p">(</span><span class="nv">$string</span><span class="p">);</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$revwords</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">,</span> <span class="nb">reverse</span> <span class="nb">split</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">,</span> <span class="nv">$string</span><span class="p">));</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$gnirts</span>   <span class="o">=</span> <span class="nb">reverse</span><span class="p">(</span><span class="nv">$string</span><span class="p">);</span>       <span class="c1"># reverse letters in $string</span>

<span class="nv">@sdrow</span>    <span class="o">=</span> <span class="nb">reverse</span><span class="p">(</span><span class="nv">@words</span><span class="p">);</span>        <span class="c1"># reverse elements in @words</span>

<span class="nv">$confused</span> <span class="o">=</span> <span class="nb">reverse</span><span class="p">(</span><span class="nv">@words</span><span class="p">);</span>        <span class="c1"># reverse letters in join(&quot;&quot;, @words)</span>
<span class="c1">#-----------------------------</span>
<span class="c1"># reverse word order</span>
<span class="nv">$string</span> <span class="o">=</span> <span class="s">&#39;Yoda said, &quot;can you see this?&quot;&#39;</span><span class="p">;</span>
<span class="nv">@allwords</span>    <span class="o">=</span> <span class="nb">split</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">,</span> <span class="nv">$string</span><span class="p">);</span>
<span class="nv">$revwords</span>    <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">,</span> <span class="nb">reverse</span> <span class="nv">@allwords</span><span class="p">);</span>
<span class="k">print</span> <span class="nv">$revwords</span><span class="p">,</span> <span class="s">&quot;\n&quot;</span><span class="p">;</span>
<span class="n">this</span><span class="p">?</span><span class="s">&quot; see you &quot;</span><span class="n">can</span> <span class="n">said</span><span class="p">,</span> <span class="n">Yoda</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$revwords</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">,</span> <span class="nb">reverse</span> <span class="nb">split</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">,</span> <span class="nv">$string</span><span class="p">));</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$revwords</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nb">reverse</span> <span class="nb">split</span><span class="p">(</span><span class="sr">/(\s+)/</span><span class="p">,</span> <span class="nv">$string</span><span class="p">));</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$word</span> <span class="o">=</span> <span class="s">&quot;reviver&quot;</span><span class="p">;</span>
<span class="nv">$is_palindrome</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$word</span> <span class="ow">eq</span> <span class="nb">reverse</span><span class="p">(</span><span class="nv">$word</span><span class="p">));</span>
<span class="c1">#-----------------------------</span>
<span class="c1">#% perl -nle &#39;print if $_ eq reverse &amp;&amp; length &gt; 5&#39; /usr/dict/words</span>
<span class="c1">#deedeed</span>
<span class="c1">#</span>
<span class="c1">#degged</span>
<span class="c1">#</span>
<span class="c1">#deified</span>
<span class="c1">#</span>
<span class="c1">#denned</span>
<span class="c1">#</span>
<span class="c1">#hallah</span>
<span class="c1">#</span>
<span class="c1">#kakkak</span>
<span class="c1">#</span>
<span class="c1">#murdrum</span>
<span class="c1">#</span>
<span class="c1">#redder</span>
<span class="c1">#</span>
<span class="c1">#repaper</span>
<span class="c1">#</span>
<span class="c1">#retter</span>
<span class="c1">#</span>
<span class="c1">#reviver</span>
<span class="c1">#</span>
<span class="c1">#rotator</span>
<span class="c1">#</span>
<span class="c1">#sooloos</span>
<span class="c1">#</span>
<span class="c1">#tebbet</span>
<span class="c1">#</span>
<span class="c1">#terret</span>
<span class="c1">#</span>
<span class="c1">#tut-tut</span>
<span class="c1">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN35"
>Expanding and Compressing Tabs</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">#-----------------------------</span>
<span class="k">while</span> <span class="p">(</span><span class="nv">$string</span> <span class="o">=~</span> <span class="sr">s/\t+/&#39; &#39; x (length($&amp;) * 8 - length($`) % 8)/e</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1"># spin in empty loop until substitution finally fails</span>
<span class="p">}</span>
<span class="c1">#-----------------------------</span>
<span class="k">use</span> <span class="nn">Text::</span><span class="n">Tabs</span><span class="p">;</span>
<span class="nv">@expanded_lines</span>  <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="nv">@lines_with_tabs</span><span class="p">);</span>
<span class="nv">@tabulated_lines</span> <span class="o">=</span> <span class="n">unexpand</span><span class="p">(</span><span class="nv">@lines_without_tabs</span><span class="p">);</span>
<span class="c1">#-----------------------------</span>
<span class="k">while</span> <span class="p">(</span><span class="o">&lt;&gt;</span><span class="p">)</span> <span class="p">{</span>
    <span class="mi">1</span> <span class="k">while</span> <span class="sr">s/\t+/&#39; &#39; x (length($&amp;) * 8 - length($`) % 8)/e</span><span class="p">;</span>
    <span class="k">print</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">#-----------------------------</span>
<span class="k">use</span> <span class="nn">Text::</span><span class="n">Tabs</span><span class="p">;</span>
<span class="nv">$tabstop</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
<span class="k">while</span> <span class="p">(</span><span class="o">&lt;&gt;</span><span class="p">)</span> <span class="p">{</span> <span class="k">print</span> <span class="n">expand</span><span class="p">(</span><span class="nv">$_</span><span class="p">)</span> <span class="p">}</span>
<span class="c1">#-----------------------------</span>
<span class="k">use</span> <span class="nn">Text::</span><span class="n">Tabs</span><span class="p">;</span>
<span class="k">while</span> <span class="p">(</span><span class="o">&lt;&gt;</span><span class="p">)</span> <span class="p">{</span> <span class="k">print</span> <span class="n">unexpand</span><span class="p">(</span><span class="nv">$_</span><span class="p">)</span> <span class="p">}</span>
<span class="c1">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN38"
>Expanding Variables in User Input</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">#-----------------------------</span>
<span class="c1">#You owe $debt to me.</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$text</span> <span class="o">=~</span> <span class="sr">s/\$(\w+)/${$1}/g</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$text</span> <span class="o">=~</span> <span class="sr">s/(\$\w+)/$1/gee</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="k">use</span> <span class="n">vars</span> <span class="sx">qw($rows $cols)</span><span class="p">;</span>
<span class="nb">no</span> <span class="n">strict</span> <span class="s">&#39;refs&#39;</span><span class="p">;</span>                   <span class="c1"># for ${$1}/g below</span>
<span class="k">my</span> <span class="nv">$text</span><span class="p">;</span>

<span class="p">(</span><span class="nv">$rows</span><span class="p">,</span> <span class="nv">$cols</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">80</span><span class="p">);</span>
<span class="nv">$text</span> <span class="o">=</span> <span class="sx">q(I am $rows high and $cols long)</span><span class="p">;</span>  <span class="c1"># like single quotes!</span>
<span class="nv">$text</span> <span class="o">=~</span> <span class="sr">s/\$(\w+)/${$1}/g</span><span class="p">;</span>
<span class="k">print</span> <span class="nv">$text</span><span class="p">;</span>
<span class="n">I</span> <span class="n">am</span> <span class="mi">24</span> <span class="n">high</span> <span class="ow">and</span> <span class="mi">80</span> <span class="n">long</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$text</span> <span class="o">=</span> <span class="s">&quot;I am 17 years old&quot;</span><span class="p">;</span>
<span class="nv">$text</span> <span class="o">=~</span> <span class="sr">s/(\d+)/2 * $1/eg</span><span class="p">;</span> 
<span class="c1">#-----------------------------</span>
<span class="mi">2</span> <span class="o">*</span> <span class="mi">17</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$text</span> <span class="o">=</span> <span class="s">&#39;I am $AGE years old&#39;</span><span class="p">;</span>      <span class="c1"># note single quotes</span>
<span class="nv">$text</span> <span class="o">=~</span> <span class="sr">s/(\$\w+)/$1/eg</span><span class="p">;</span>           <span class="c1"># WRONG</span>
<span class="c1">#-----------------------------</span>
<span class="s">&#39;$AGE&#39;</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$text</span> <span class="o">=~</span> <span class="sr">s/(\$\w+)/$1/eeg</span><span class="p">;</span>          <span class="c1"># finds my() variables</span>
<span class="c1">#-----------------------------</span>
<span class="c1"># expand variables in $text, but put an error message in</span>
<span class="c1"># if the variable isn&#39;t defined</span>
<span class="nv">$text</span> <span class="o">=~</span> <span class="sr">s{</span>
<span class="sr">     \$                         # find a literal dollar sign</span>
<span class="sr">    (\w+)                       # find a &quot;word&quot; and store it in $1</span>
<span class="sr">}{</span>
<span class="sr">    no strict &#39;refs&#39;;           # for $$1 below</span>
<span class="sr">    if (defined ${$1}</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$</span><span class="p">{</span><span class="nv">$1</span><span class="p">};</span>                  <span class="c1"># expand global variables only</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="s">&quot;[NO VARIABLE: \$$1]&quot;</span><span class="p">;</span>  <span class="c1"># error msg</span>
    <span class="p">}</span>
<span class="p">}</span><span class="n">egx</span><span class="p">;</span>
<span class="c1">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN41"
>Controlling Case</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">#-----------------------------</span>
<span class="k">use</span> <span class="n">locale</span><span class="p">;</span>                     <span class="c1"># needed in 5.004 or above</span>

<span class="nv">$big</span> <span class="o">=</span> <span class="nb">uc</span><span class="p">(</span><span class="nv">$little</span><span class="p">);</span>             <span class="c1"># &quot;bo peep&quot; -&gt; &quot;BO PEEP&quot;</span>
<span class="nv">$little</span> <span class="o">=</span> <span class="nb">lc</span><span class="p">(</span><span class="nv">$big</span><span class="p">);</span>             <span class="c1"># &quot;JOHN&quot;    -&gt; &quot;john&quot;</span>
<span class="nv">$big</span> <span class="o">=</span> <span class="s">&quot;\U$little&quot;</span><span class="p">;</span>             <span class="c1"># &quot;bo peep&quot; -&gt; &quot;BO PEEP&quot;</span>
<span class="nv">$little</span> <span class="o">=</span> <span class="s">&quot;\L$big&quot;</span><span class="p">;</span>             <span class="c1"># &quot;JOHN&quot;    -&gt; &quot;john&quot;</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$big</span> <span class="o">=</span> <span class="s">&quot;\u$little&quot;</span><span class="p">;</span>             <span class="c1"># &quot;bo&quot;      -&gt; &quot;Bo&quot;</span>
<span class="nv">$little</span> <span class="o">=</span> <span class="s">&quot;\l$big&quot;</span><span class="p">;</span>             <span class="c1"># &quot;BoPeep&quot;    -&gt; &quot;boPeep&quot; </span>
<span class="c1">#-----------------------------</span>
<span class="k">use</span> <span class="n">locale</span><span class="p">;</span>                     <span class="c1"># needed in 5.004 or above</span>

<span class="nv">$beast</span>   <span class="o">=</span> <span class="s">&quot;dromedary&quot;</span><span class="p">;</span>
<span class="c1"># capitalize various parts of $beast</span>
<span class="nv">$capit</span>   <span class="o">=</span> <span class="nb">ucfirst</span><span class="p">(</span><span class="nv">$beast</span><span class="p">);</span>         <span class="c1"># Dromedary</span>
<span class="nv">$capit</span>   <span class="o">=</span> <span class="s">&quot;\u\L$beast&quot;</span><span class="p">;</span>            <span class="c1"># (same)</span>
<span class="nv">$capall</span>  <span class="o">=</span> <span class="nb">uc</span><span class="p">(</span><span class="nv">$beast</span><span class="p">);</span>              <span class="c1"># DROMEDARY</span>
<span class="nv">$capall</span>  <span class="o">=</span> <span class="s">&quot;\U$beast&quot;</span><span class="p">;</span>              <span class="c1"># (same)</span>
<span class="nv">$caprest</span> <span class="o">=</span> <span class="nb">lcfirst</span><span class="p">(</span><span class="nb">uc</span><span class="p">(</span><span class="nv">$beast</span><span class="p">));</span>     <span class="c1"># dROMEDARY</span>
<span class="nv">$caprest</span> <span class="o">=</span> <span class="s">&quot;\l\U$beast&quot;</span><span class="p">;</span>            <span class="c1"># (same)</span>
<span class="c1">#-----------------------------</span>
<span class="c1"># capitalize each word&#39;s first character, downcase the rest</span>
<span class="nv">$text</span> <span class="o">=</span> <span class="s">&quot;thIS is a loNG liNE&quot;</span><span class="p">;</span>
<span class="nv">$text</span> <span class="o">=~</span> <span class="sr">s/(\w+)/\u\L$1/g</span><span class="p">;</span>
<span class="k">print</span> <span class="nv">$text</span><span class="p">;</span>
<span class="n">This</span> <span class="n">Is</span> <span class="n">A</span> <span class="n">Long</span> <span class="n">Line</span>
<span class="c1">#-----------------------------</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">uc</span><span class="p">(</span><span class="nv">$a</span><span class="p">)</span> <span class="ow">eq</span> <span class="nb">uc</span><span class="p">(</span><span class="nv">$b</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s">&quot;a and b are the same\n&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">#-----------------------------</span>
<span class="c1"># <font size="-1"><a href="http://pleac.sourceforge.net/include/perl/ch01/randcap</span>">download the following standalone program</a></font>
<span class="c1">#!/usr/bin/perl -p</span>
<span class="c1"># randcap: filter to randomly capitalize 20% of the letters</span>
<span class="c1"># call to srand() is unnecessary in 5.004</span>
<span class="k">BEGIN</span> <span class="p">{</span> <span class="nb">srand</span><span class="p">(</span><span class="nb">time</span><span class="p">()</span> <span class="o">^</span> <span class="p">(</span><span class="vg">$$</span> <span class="o">+</span> <span class="p">(</span><span class="vg">$$</span> <span class="o">&lt;&lt;</span> <span class="mi">15</span><span class="p">)))</span> <span class="p">}</span>
<span class="k">sub </span><span class="nf">randcase</span> <span class="p">{</span> <span class="nb">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">20</span> <span class="p">?</span> <span class="s">&quot;\u$_[0]&quot;</span> <span class="p">:</span> <span class="s">&quot;\l$_[0]&quot;</span> <span class="p">}</span>
<span class="sr">s/(\w)/randcase($1)/ge</span><span class="p">;</span>


<span class="c1">#% randcap &lt; genesis | head -9</span>
<span class="c1">#boOk 01 genesis</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#001:001 in the BEginning goD created the heaven and tHe earTh.</span>
<span class="c1">#</span>
<span class="c1">#    </span>
<span class="c1">#</span>
<span class="c1">#001:002 and the earth wAS without ForM, aND void; AnD darkneSS was</span>
<span class="c1">#</span>
<span class="c1">#	 upon The Face of the dEEp. and the spIrit of GOd movEd upOn</span>
<span class="c1">#</span>
<span class="c1">#	 tHe face of the Waters.</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#001:003 and god Said, let there be ligHt: and therE wAs LigHt.</span>
<span class="c1">#-----------------------------</span>
<span class="k">sub </span><span class="nf">randcase</span> <span class="p">{</span>
    <span class="nb">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">20</span> <span class="p">?</span> <span class="p">(</span><span class="s">&quot;\040&quot;</span> <span class="o">^</span> <span class="nv">$_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">:</span> <span class="nv">$_</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$string</span> <span class="o">&amp;=</span> <span class="s">&quot;\177&quot;</span> <span class="n">x</span> <span class="nb">length</span><span class="p">(</span><span class="nv">$string</span><span class="p">);</span>
<span class="c1">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN44"
>Interpolating Functions and Expressions Within Strings</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">#-----------------------------</span>
<span class="nv">$answer</span> <span class="o">=</span> <span class="nv">$var1</span> <span class="o">.</span> <span class="n">func</span><span class="p">()</span> <span class="o">.</span> <span class="nv">$var2</span><span class="p">;</span>   <span class="c1"># scalar only</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$answer</span> <span class="o">=</span> <span class="s">&quot;STRING @{[ LIST EXPR ]} MORE STRING&quot;</span><span class="p">;</span>
<span class="nv">$answer</span> <span class="o">=</span> <span class="s">&quot;STRING ${\( SCALAR EXPR )} MORE STRING&quot;</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$phrase</span> <span class="o">=</span> <span class="s">&quot;I have &quot;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">.</span> <span class="s">&quot; guanacos.&quot;</span><span class="p">;</span>
<span class="nv">$phrase</span> <span class="o">=</span> <span class="s">&quot;I have ${\($n + 1)} guanacos.&quot;</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="k">print</span> <span class="s">&quot;I have &quot;</span><span class="p">,</span>  <span class="nv">$n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot; guanacos.\n&quot;</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="n">some_func</span><span class="p">(</span><span class="s">&quot;What you want is @{[ split /:/, $rec ]} items&quot;</span><span class="p">);</span>
<span class="c1">#-----------------------------</span>
<span class="nb">die</span> <span class="s">&quot;Couldn&#39;t send mail&quot;</span> <span class="k">unless</span> <span class="n">send_mail</span><span class="p">(</span><span class="o">&lt;&lt;</span><span class="s">&quot;EOTEXT&quot;</span><span class="p">,</span> <span class="nv">$target</span><span class="p">);</span>
<span class="n">To:</span> <span class="nv">$naughty</span>
<span class="n">From:</span> <span class="n">Your</span> <span class="n">Bank</span>
<span class="n">Cc:</span> <span class="nv">@</span><span class="p">{</span> <span class="n">get_manager_list</span><span class="p">(</span><span class="nv">$naughty</span><span class="p">)</span> <span class="p">}</span>
<span class="n">Date:</span> <span class="nv">@</span><span class="p">{[</span> <span class="k">do</span> <span class="p">{</span> <span class="k">my</span> <span class="nv">$now</span> <span class="o">=</span> <span class="sb">`date`</span><span class="p">;</span> <span class="nb">chomp</span> <span class="nv">$now</span><span class="p">;</span> <span class="nv">$now</span> <span class="p">}</span> <span class="p">]}</span> <span class="p">(</span><span class="n">today</span><span class="p">)</span>

<span class="n">Dear</span> <span class="nv">$naughty</span><span class="p">,</span>

<span class="n">Today</span><span class="p">,</span> <span class="n">you</span> <span class="n">bounced</span> <span class="n">check</span> <span class="n">number</span> <span class="nv">@</span><span class="p">{[</span> <span class="mi">500</span> <span class="o">+</span> <span class="nb">int</span> <span class="nb">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="p">]}</span> <span class="n">to</span> <span class="n">us</span><span class="o">.</span>
<span class="n">Your</span> <span class="n">account</span> <span class="n">is</span> <span class="n">now</span> <span class="n">closed</span><span class="o">.</span>

<span class="n">Sincerely</span><span class="p">,</span>
<span class="n">the</span> <span class="n">management</span>
<span class="n">EOTEXT</span>
<span class="c1">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN47"
>Indenting Here Documents</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">#-----------------------------</span>
<span class="c1"># all in one</span>
<span class="p">(</span><span class="nv">$var</span> <span class="o">=</span> <span class="o">&lt;&lt;</span><span class="n">HERE_TARGET</span><span class="p">)</span> <span class="o">=~</span> <span class="sr">s/^\s+//gm</span><span class="p">;</span>
    <span class="n">your</span> <span class="n">text</span>
    <span class="n">goes</span> <span class="n">here</span>
<span class="n">HERE_TARGET</span>

<span class="c1"># or with two steps</span>
<span class="nv">$var</span> <span class="o">=</span> <span class="s">&lt;&lt;HERE_TARGET;</span>
<span class="s">    your text</span>
<span class="s">    goes here</span>
<span class="s">HERE_TARGET</span>
<span class="nv">$var</span> <span class="o">=~</span> <span class="sr">s/^\s+//gm</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="p">(</span><span class="nv">$definition</span> <span class="o">=</span> <span class="o">&lt;&lt;</span><span class="s">&#39;FINIS&#39;</span><span class="p">)</span> <span class="o">=~</span> <span class="sr">s/^\s+//gm</span><span class="p">;</span>
    <span class="n">The</span> <span class="n">five</span> <span class="n">varieties</span> <span class="n">of</span> <span class="n">camelids</span>
    <span class="n">are</span> <span class="n">the</span> <span class="n">familiar</span> <span class="n">camel</span><span class="p">,</span> <span class="n">his</span> <span class="n">friends</span>
    <span class="n">the</span> <span class="n">llama</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">alpaca</span><span class="p">,</span> <span class="ow">and</span> <span class="n">the</span>
    <span class="n">rather</span> <span class="n">less</span> <span class="n">well</span><span class="o">-</span><span class="n">known</span> <span class="n">guanaco</span>
    <span class="ow">and</span> <span class="n">vicu</span><span class="err"></span><span class="n">a</span><span class="o">.</span>
<span class="n">FINIS</span>
<span class="c1">#-----------------------------</span>
<span class="k">sub </span><span class="nf">fix</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$string</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span>
    <span class="nv">$string</span> <span class="o">=~</span> <span class="sr">s/^\s+//gm</span><span class="p">;</span>
    <span class="k">return</span> <span class="nv">$string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">print</span> <span class="n">fix</span><span class="p">(</span><span class="o">&lt;&lt;</span><span class="s">&quot;END&quot;</span><span class="p">);</span>
    <span class="n">My</span> <span class="n">stuff</span> <span class="n">goes</span> <span class="n">here</span>
<span class="k">END</span>

<span class="c1"># With function predeclaration, you can omit the parens:</span>
<span class="k">print</span> <span class="n">fix</span> <span class="s">&lt;&lt;&quot;END&quot;;</span>
<span class="s">    My stuff goes here</span>
<span class="s">END</span>
<span class="c1">#-----------------------------</span>
<span class="p">(</span><span class="nv">$quote</span> <span class="o">=</span> <span class="o">&lt;&lt;</span><span class="s">&#39;    FINIS&#39;</span><span class="p">)</span> <span class="o">=~</span> <span class="sr">s/^\s+//gm</span><span class="p">;</span>
        <span class="o">...</span><span class="n">we</span> <span class="n">will</span> <span class="n">have</span> <span class="n">peace</span><span class="p">,</span> <span class="n">when</span> <span class="n">you</span> <span class="ow">and</span> <span class="n">all</span> <span class="n">your</span> <span class="n">works</span> <span class="n">have</span>
        <span class="n">perished</span><span class="o">--</span><span class="ow">and</span> <span class="n">the</span> <span class="n">works</span> <span class="n">of</span> <span class="n">your</span> <span class="n">dark</span> <span class="n">master</span> <span class="n">to</span> <span class="n">whom</span> <span class="n">you</span> <span class="n">would</span>
        <span class="n">deliver</span> <span class="n">us</span><span class="o">.</span> <span class="n">You</span> <span class="n">are</span> <span class="n">a</span> <span class="n">liar</span><span class="p">,</span> <span class="n">Saruman</span><span class="p">,</span> <span class="ow">and</span> <span class="n">a</span> <span class="n">corrupter</span> <span class="n">of</span> <span class="n">mens</span>
        <span class="n">hearts</span><span class="o">.</span>  <span class="o">--</span><span class="n">Theoden</span> <span class="n">in</span> <span class="sr">/usr/s</span><span class="n">rc</span><span class="sr">/perl/</span><span class="n">taint</span><span class="o">.</span><span class="n">c</span>
    <span class="n">FINIS</span>
<span class="nv">$quote</span> <span class="o">=~</span> <span class="sr">s/\s+--/\n--/</span><span class="p">;</span>      <span class="c1">#move attribution to line of its own</span>
<span class="c1">#-----------------------------</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$REMEMBER_THE_MAIN</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$perl_main_C</span> <span class="o">=</span> <span class="n">dequote</span><span class="o">&lt;&lt;</span><span class="s">&#39;    MAIN_INTERPRETER_LOOP&#39;</span><span class="p">;</span>
        <span class="nv">@@@</span> <span class="nv">int</span>
        <span class="nv">@@@</span> <span class="nv">runops</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">@@@</span>     <span class="nv">SAVEI32</span><span class="p">(</span><span class="n">runlevel</span><span class="p">);</span>
        <span class="nv">@@@</span>     <span class="nv">runlevel</span><span class="o">++</span><span class="p">;</span>
        <span class="nv">@@@</span>     <span class="nv">while</span> <span class="p">(</span> <span class="n">op</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">op</span><span class="o">-&gt;</span><span class="n">op_ppaddr</span><span class="p">)()</span> <span class="p">)</span> <span class="p">;</span>
        <span class="nv">@@@</span>     <span class="nv">TAINT_NOT</span><span class="p">;</span>
        <span class="nv">@@@</span>     <span class="nv">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nv">@@@</span> <span class="err">}</span>
    <span class="nv">MAIN_INTERPRETER_LOOP</span>
    <span class="c1"># add more code here if you want</span>
<span class="p">}</span>
<span class="c1">#-----------------------------</span>
<span class="k">sub </span><span class="nf">dequote</span><span class="p">;</span>
<span class="p">$poem = dequote&lt;&lt;EVER_ON_AND_ON;</span>
<span class="p">       Now far ahead the Road has gone,</span>
<span class="p">          And I must follow, if I can,</span>
<span class="p">       Pursuing it with eager feet,</span>
<span class="p">          Until it joins some larger way</span>
<span class="p">       Where many paths and errands meet.</span>
<span class="p">          And whither then? I cannot say.</span>
<span class="p">                --Bilbo in /usr/src/perl/pp_ctl.c</span>
<span class="p">EVER_ON_AND_ON</span>
<span class="p">print &quot;Here&#39;s your poem:\n\n$poem\n&quot;;</span>
<span class="p">#-----------------------------</span>
<span class="p">#Here&#39;s your poem:  </span>
<span class="p">#</span>
<span class="p">#Now far ahead the Road has gone,</span>
<span class="p">#</span>
<span class="p">#   And I must follow, if I can,</span>
<span class="p">#</span>
<span class="p">#Pursuing it with eager feet,</span>
<span class="p">#</span>
<span class="p">#   Until it joins some larger way</span>
<span class="p">#</span>
<span class="p">#Where many paths and errands meet.</span>
<span class="p">#</span>
<span class="p">#   And whither then? I cannot say.</span>
<span class="p">#</span>
<span class="p">#	  --Bilbo in /usr/src/perl/pp_ctl.c</span>
<span class="p">#-----------------------------</span>
<span class="p">sub dequote {</span>
    <span class="nb">local</span> <span class="nv">$_</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span>
    <span class="k">my</span> <span class="p">(</span><span class="nv">$white</span><span class="p">,</span> <span class="nv">$leader</span><span class="p">);</span>  <span class="c1"># common whitespace and common leading string</span>
    <span class="k">if</span> <span class="p">(</span><span class="sr">/^\s*(?:([^\w\s]+)(\s*).*\n)(?:\s*\1\2?.*\n)+$/</span><span class="p">)</span> <span class="p">{</span>
        <span class="p">(</span><span class="nv">$white</span><span class="p">,</span> <span class="nv">$leader</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$2</span><span class="p">,</span> <span class="nb">quotemeta</span><span class="p">(</span><span class="nv">$1</span><span class="p">));</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="p">(</span><span class="nv">$white</span><span class="p">,</span> <span class="nv">$leader</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="sr">/^(\s+)/</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="sr">s/^\s*?$leader(?:$white)?//gm</span><span class="p">;</span>
    <span class="k">return</span> <span class="nv">$_</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">#-----------------------------</span>
    <span class="k">if</span> <span class="p">(</span><span class="sr">m{</span>
<span class="sr">            ^                       # start of line</span>
<span class="sr">            \s *                    # 0 or more whitespace chars</span>
<span class="sr">            (?:                     # begin first non-remembered grouping</span>
<span class="sr">                 (                  #   begin save buffer $1</span>
<span class="sr">                    [^\w\s]         #     one byte neither space nor word</span>
<span class="sr">                    +               #     1 or more of such</span>
<span class="sr">                 )                  #   end save buffer $1</span>
<span class="sr">                 ( \s* )            #   put 0 or more white in buffer $2</span>
<span class="sr">                 .* \n              #   match through the end of first line</span>
<span class="sr">             )                      # end of first grouping</span>
<span class="sr">             (?:                    # begin second non-remembered grouping</span>
<span class="sr">                \s *                #   0 or more whitespace chars</span>
<span class="sr">                \1                  #   whatever string is destined for $1</span>
<span class="sr">                \2 ?                #   what&#39;ll be in $2, but optionally</span>
<span class="sr">                .* \n               #   match through the end of the line</span>
<span class="sr">             ) +                    # now repeat that group idea 1 or more</span>
<span class="sr">             $                      # until the end of the line</span>
<span class="sr">          }x</span>
       <span class="p">)</span>
    <span class="p">{</span>
        <span class="p">(</span><span class="nv">$white</span><span class="p">,</span> <span class="nv">$leader</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$2</span><span class="p">,</span> <span class="nb">quotemeta</span><span class="p">(</span><span class="nv">$1</span><span class="p">));</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="p">(</span><span class="nv">$white</span><span class="p">,</span> <span class="nv">$leader</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="sr">/^(\s+)/</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="sr">s{</span>
<span class="sr">         ^                          # start of each line (due to /m)</span>
<span class="sr">         \s *                       # any amount of leading whitespace</span>
<span class="sr">            ?                       #   but minimally matched</span>
<span class="sr">         $leader                    # our quoted, saved per-line leader</span>
<span class="sr">         (?:                        # begin unremembered grouping</span>
<span class="sr">            $white                  #    the same amount</span>
<span class="sr">         ) ?                        # optionalize in case EOL after leader</span>
<span class="sr">    }{}xgm</span><span class="p">;</span>
<span class="c1">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN50"
>Reformatting Paragraphs</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">#-----------------------------</span>
<span class="k">use</span> <span class="nn">Text::</span><span class="n">Wrap</span><span class="p">;</span>
<span class="nv">@OUTPUT</span> <span class="o">=</span> <span class="n">wrap</span><span class="p">(</span><span class="nv">$LEADTAB</span><span class="p">,</span> <span class="nv">$NEXTTAB</span><span class="p">,</span> <span class="nv">@PARA</span><span class="p">);</span>
<span class="c1">#-----------------------------</span>
<span class="c1"># <font size="-1"><a href="http://pleac.sourceforge.net/include/perl/ch01/wrapdemo</span>">download the following standalone program</a></font>
<span class="c1">#!/usr/bin/perl -w</span>
<span class="c1"># wrapdemo - show how Text::Wrap works</span>

<span class="nv">@input</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Folding and splicing is the work of an editor,&quot;</span><span class="p">,</span>
          <span class="s">&quot;not a mere collection of silicon&quot;</span><span class="p">,</span>
          <span class="s">&quot;and&quot;</span><span class="p">,</span>
          <span class="s">&quot;mobile electrons!&quot;</span><span class="p">);</span>

<span class="k">use</span> <span class="nn">Text::</span><span class="n">Wrap</span> <span class="sx">qw($columns &amp;wrap)</span><span class="p">;</span>

<span class="nv">$columns</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
<span class="k">print</span> <span class="s">&quot;0123456789&quot;</span> <span class="n">x</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&quot;\n&quot;</span><span class="p">;</span>
<span class="k">print</span> <span class="n">wrap</span><span class="p">(</span><span class="s">&quot;    &quot;</span><span class="p">,</span> <span class="s">&quot;  &quot;</span><span class="p">,</span> <span class="nv">@input</span><span class="p">),</span> <span class="s">&quot;\n&quot;</span><span class="p">;</span>

<span class="c1">#-----------------------------</span>
<span class="mo">01234567</span><span class="mi">890123456789</span>

    <span class="n">Folding</span> <span class="ow">and</span>

  <span class="n">splicing</span> <span class="n">is</span> <span class="n">the</span>

  <span class="n">work</span> <span class="n">of</span> <span class="n">an</span>

  <span class="n">editor</span><span class="p">,</span> <span class="ow">not</span> <span class="n">a</span>

  <span class="n">mere</span> <span class="n">collection</span>

  <span class="n">of</span> <span class="n">silicon</span> <span class="ow">and</span>

  <span class="n">mobile</span> <span class="n">electrons</span><span class="o">!</span>
<span class="c1">#-----------------------------</span>
<span class="c1"># merge multiple lines into one, then wrap one long line</span>
<span class="k">use</span> <span class="nn">Text::</span><span class="n">Wrap</span><span class="p">;</span>
<span class="nb">undef</span> <span class="vg">$/</span><span class="p">;</span>
<span class="k">print</span> <span class="n">wrap</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">,</span> <span class="nb">split</span><span class="p">(</span><span class="sr">/\s*\n\s*/</span><span class="p">,</span> <span class="o">&lt;&gt;</span><span class="p">));</span>
<span class="c1">#-----------------------------</span>
<span class="k">use</span> <span class="nn">Text::</span><span class="n">Wrap</span>      <span class="sx">qw(&amp;wrap $columns)</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">Term::</span><span class="n">ReadKey</span>   <span class="sx">qw(GetTerminalSize)</span><span class="p">;</span>
<span class="p">(</span><span class="nv">$columns</span><span class="p">)</span> <span class="o">=</span> <span class="n">GetTerminalSize</span><span class="p">();</span>
<span class="p">(</span><span class="vg">$/</span><span class="p">,</span> <span class="vg">$\</span><span class="p">)</span>  <span class="o">=</span> <span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&quot;\n\n&quot;</span><span class="p">);</span>   <span class="c1"># read by paragraph, output 2 newlines</span>
<span class="k">while</span> <span class="p">(</span><span class="o">&lt;&gt;</span><span class="p">)</span> <span class="p">{</span>                <span class="c1"># grab a full paragraph</span>
    <span class="sr">s/\s*\n\s*/ /g</span><span class="p">;</span>         <span class="c1"># convert intervening newlines to spaces</span>
    <span class="k">print</span> <span class="n">wrap</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">,</span> <span class="nv">$_</span><span class="p">);</span> <span class="c1"># and format</span>
<span class="p">}</span>
<span class="c1">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN53"
>Escaping Characters</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">#-----------------------------</span>
<span class="c1"># backslash</span>
<span class="nv">$var</span> <span class="o">=~</span> <span class="sr">s/([CHARLIST])/\\$1/g</span><span class="p">;</span>

<span class="c1"># double</span>
<span class="nv">$var</span> <span class="o">=~</span> <span class="sr">s/([CHARLIST])/$1$1/g</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$string</span> <span class="o">=~</span> <span class="sr">s/%/%%/g</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$string</span> <span class="o">=</span> <span class="sx">q(Mom said, &quot;Don&#39;t do that.&quot;)</span><span class="p">;</span> <span class="c1">#&#39;</span>
<span class="nv">$string</span> <span class="o">=~</span> <span class="sr">s/([&#39;&quot;])/\\$1/g</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$string</span> <span class="o">=</span> <span class="sx">q(Mom said, &quot;Don&#39;t do that.&quot;)</span><span class="p">;</span>
<span class="nv">$string</span> <span class="o">=~</span> <span class="sr">s/([&#39;&quot;])/$1$1/g</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$string</span> <span class="o">=~</span> <span class="sr">s/([^A-Z])/\\$1/g</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$string</span> <span class="o">=</span> <span class="s">&quot;this \Qis a test!\E&quot;</span><span class="p">;</span>
<span class="nv">$string</span> <span class="o">=</span> <span class="s">&quot;this is\\ a\\ test\\!&quot;</span><span class="p">;</span>
<span class="nv">$string</span> <span class="o">=</span> <span class="s">&quot;this &quot;</span> <span class="o">.</span> <span class="nb">quotemeta</span><span class="p">(</span><span class="s">&quot;is a test!&quot;</span><span class="p">);</span>
<span class="c1">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN56"
>Trimming Blanks from the Ends of a String</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">#-----------------------------</span>
<span class="nv">$string</span> <span class="o">=~</span> <span class="sr">s/^\s+//</span><span class="p">;</span>
<span class="nv">$string</span> <span class="o">=~</span> <span class="sr">s/\s+$//</span><span class="p">;</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$string</span> <span class="o">=</span> <span class="n">trim</span><span class="p">(</span><span class="nv">$string</span><span class="p">);</span>
<span class="nv">@many</span>   <span class="o">=</span> <span class="n">trim</span><span class="p">(</span><span class="nv">@many</span><span class="p">);</span>

<span class="k">sub </span><span class="nf">trim</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">@out</span> <span class="o">=</span> <span class="nv">@_</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="nv">@out</span><span class="p">)</span> <span class="p">{</span>
        <span class="sr">s/^\s+//</span><span class="p">;</span>
        <span class="sr">s/\s+$//</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">wantarray</span> <span class="p">?</span> <span class="nv">@out</span> <span class="p">:</span> <span class="nv">$out</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span>
<span class="c1">#-----------------------------</span>
<span class="c1"># print what&#39;s typed, but surrounded by &gt;&lt; symbols</span>
<span class="k">while</span><span class="p">(</span><span class="sr">&lt;STDIN&gt;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">chomp</span><span class="p">;</span>
    <span class="k">print</span> <span class="s">&quot;&gt;$_&lt;\n&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN59"
>Parsing Comma-Separated Data</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">#-----------------------------</span>
<span class="k">sub </span><span class="nf">parse_csv</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$text</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span>      <span class="c1"># record containing comma-separated values</span>
    <span class="k">my</span> <span class="nv">@new</span>  <span class="o">=</span> <span class="p">();</span>
    <span class="nb">push</span><span class="p">(</span><span class="nv">@new</span><span class="p">,</span> <span class="vg">$+</span><span class="p">)</span> <span class="k">while</span> <span class="nv">$text</span> <span class="o">=~</span> <span class="sr">m{</span>
<span class="sr">        # the first part groups the phrase inside the quotes.</span>
<span class="sr">        # see explanation of this pattern in MRE</span>
<span class="sr">        &quot;([^\&quot;\\]*(?:\\.[^\&quot;\\]*)*)&quot;,?</span>
<span class="sr">           |  ([^,]+),?</span>
<span class="sr">           | ,</span>
<span class="sr">       }gx</span><span class="p">;</span>
       <span class="nb">push</span><span class="p">(</span><span class="nv">@new</span><span class="p">,</span> <span class="nb">undef</span><span class="p">)</span> <span class="k">if</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$text</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="ow">eq</span> <span class="s">&#39;,&#39;</span><span class="p">;</span>
       <span class="k">return</span> <span class="nv">@new</span><span class="p">;</span>      <span class="c1"># list of values that were comma-separated</span>
<span class="p">}</span>
<span class="c1">#-----------------------------</span>
<span class="k">use</span>
<span class="nn">Text::</span><span class="n">ParseWords</span><span class="p">;</span>

<span class="k">sub </span><span class="nf">parse_csv</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">quoteword</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="nv">$_</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="p">}</span>
<span class="c1">#-----------------------------</span>
<span class="nv">$line</span> <span class="o">=</span> <span class="sx">q&lt;XYZZY,&quot;&quot;,&quot;O&#39;Reilly, Inc&quot;,&quot;Wall, Larry&quot;,&quot;a \&quot;glug\&quot; bit,&quot;,5,</span>
<span class="sx">    &quot;Error, Core Dumped&quot;&gt;</span><span class="p">;</span>
<span class="nv">@fields</span> <span class="o">=</span> <span class="n">parse_csv</span><span class="p">(</span><span class="nv">$line</span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">@fields</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s">&quot;$i : $fields[$i]\n&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">#0 : XYZZY</span>
<span class="c1">#</span>
<span class="c1">#1 :</span>
<span class="c1">#</span>
<span class="c1">#2 : O&#39;Reilly, Inc</span>
<span class="c1">#</span>
<span class="c1">#3 : Wall, Larry</span>
<span class="c1">#</span>
<span class="c1">#4 : a \&quot;glug\&quot; bit,</span>
<span class="c1">#</span>
<span class="c1">#5 : 5</span>
<span class="c1">#</span>
<span class="c1">#6 : Error, Core Dumped</span>
<span class="c1">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN62"
>Soundex Matching</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">#-----------------------------</span>
 <span class="k">use</span> <span class="nn">Text::</span><span class="n">Soundex</span><span class="p">;</span>

 <span class="nv">$CODE</span>  <span class="o">=</span> <span class="n">soundex</span><span class="p">(</span><span class="nv">$STRING</span><span class="p">);</span>
 <span class="nv">@CODES</span> <span class="o">=</span> <span class="n">soundex</span><span class="p">(</span><span class="nv">@LIST</span><span class="p">);</span>
<span class="c1">#-----------------------------</span>
<span class="k">use</span> <span class="nn">Text::</span><span class="n">Soundex</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">User::</span><span class="n">pwent</span><span class="p">;</span>

<span class="k">print</span> <span class="s">&quot;Lookup user: &quot;</span><span class="p">;</span>
<span class="nb">chomp</span><span class="p">(</span><span class="nv">$user</span> <span class="o">=</span> <span class="sr">&lt;STDIN&gt;</span><span class="p">);</span>
<span class="nb">exit</span> <span class="k">unless</span> <span class="nb">defined</span> <span class="nv">$user</span><span class="p">;</span>
<span class="nv">$name_code</span> <span class="o">=</span> <span class="n">soundex</span><span class="p">(</span><span class="nv">$user</span><span class="p">);</span>

<span class="k">while</span> <span class="p">(</span><span class="nv">$uent</span> <span class="o">=</span> <span class="nb">getpwent</span><span class="p">())</span> <span class="p">{</span>
    <span class="p">(</span><span class="nv">$firstname</span><span class="p">,</span> <span class="nv">$lastname</span><span class="p">)</span> <span class="o">=</span> <span class="nv">$uent</span><span class="o">-&gt;</span><span class="n">gecos</span> <span class="o">=~</span><span class="sr"> /(\w+)[^,]*\b(\w+)/</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$name_code</span> <span class="ow">eq</span> <span class="n">soundex</span><span class="p">(</span><span class="nv">$uent</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">)</span> <span class="o">||</span>
        <span class="nv">$name_code</span> <span class="ow">eq</span> <span class="n">soundex</span><span class="p">(</span><span class="nv">$lastname</span><span class="p">)</span>   <span class="o">||</span>
        <span class="nv">$name_code</span> <span class="ow">eq</span> <span class="n">soundex</span><span class="p">(</span><span class="nv">$firstname</span><span class="p">)</span>  <span class="p">)</span>
    <span class="p">{</span>
        <span class="nb">printf</span> <span class="s">&quot;%s: %s %s\n&quot;</span><span class="p">,</span> <span class="nv">$uent</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="nv">$firstname</span><span class="p">,</span> <span class="nv">$lastname</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN65"
>Program: fixstyle</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">#-----------------------------</span>
<span class="c1"># <font size="-1"><a href="http://pleac.sourceforge.net/include/perl/ch01/fixstyle</span>">download the following standalone program</a></font>
<span class="c1">#!/usr/bin/perl -w</span>
<span class="c1"># fixstyle - switch first set of &lt;DATA&gt; strings to second set</span>
<span class="c1">#   usage: $0 [-v] [files ...]</span>
<span class="k">use</span> <span class="n">strict</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$verbose</span> <span class="o">=</span> <span class="p">(</span><span class="nv">@ARGV</span> <span class="o">&amp;&amp;</span> <span class="nv">$ARGV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">eq</span> <span class="s">&#39;-v&#39;</span> <span class="o">&amp;&amp;</span> <span class="nb">shift</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">@ARGV</span><span class="p">)</span> <span class="p">{</span>
    <span class="vg">$^I</span> <span class="o">=</span> <span class="s">&quot;.orig&quot;</span><span class="p">;</span>          <span class="c1"># preserve old files</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nb">warn</span> <span class="s">&quot;$0: Reading from stdin\n&quot;</span> <span class="k">if</span> <span class="o">-</span><span class="n">t</span> <span class="bp">STDIN</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">my</span> <span class="nv">$code</span> <span class="o">=</span> <span class="s">&quot;while (&lt;&gt;) {\n&quot;</span><span class="p">;</span>
<span class="c1"># read in config, build up code to eval</span>
<span class="k">while</span> <span class="p">(</span><span class="sr">&lt;DATA&gt;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">chomp</span><span class="p">;</span>
    <span class="k">my</span> <span class="p">(</span><span class="nv">$in</span><span class="p">,</span> <span class="nv">$out</span><span class="p">)</span> <span class="o">=</span> <span class="nb">split</span> <span class="sr">/\s*=&gt;\s*/</span><span class="p">;</span>
    <span class="k">next</span> <span class="k">unless</span> <span class="nv">$in</span> <span class="o">&amp;&amp;</span> <span class="nv">$out</span><span class="p">;</span>
    <span class="nv">$code</span> <span class="o">.=</span> <span class="s">&quot;s{\\Q$in\\E}{$out}g&quot;</span><span class="p">;</span>
    <span class="nv">$code</span> <span class="o">.=</span> <span class="s">&quot;&amp;&amp; printf STDERR qq($in =&gt; $out at \$ARGV line \$.\\n)&quot;</span> 
                                                        <span class="k">if</span> <span class="nv">$verbose</span><span class="p">;</span>
    <span class="nv">$code</span> <span class="o">.=</span> <span class="s">&quot;;\n&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="nv">$code</span> <span class="o">.=</span> <span class="s">&quot;print;\n}\n&quot;</span><span class="p">;</span>

<span class="nb">eval</span> <span class="s">&quot;{ $code } 1&quot;</span> <span class="o">||</span> <span class="nb">die</span><span class="p">;</span>

<span class="cp">__END__</span>
<span class="cp">analysed        =&gt; analyzed</span>
<span class="cp">built-in        =&gt; builtin</span>
<span class="cp">chastized       =&gt; chastised</span>
<span class="cp">commandline     =&gt; command-line</span>
<span class="cp">de-allocate     =&gt; deallocate</span>
<span class="cp">dropin          =&gt; drop-in</span>
<span class="cp">hardcode        =&gt; hard-code</span>
<span class="cp">meta-data       =&gt; metadata</span>
<span class="cp">multicharacter  =&gt; multi-character</span>
<span class="cp">multiway        =&gt; multi-way</span>
<span class="cp">non-empty       =&gt; nonempty</span>
<span class="cp">non-profit      =&gt; nonprofit</span>
<span class="cp">non-trappable   =&gt; nontrappable</span>
<span class="cp">pre-define      =&gt; predefine</span>
<span class="cp">preextend       =&gt; pre-extend</span>
<span class="cp">re-compiling    =&gt; recompiling</span>
<span class="cp">reenter         =&gt; re-enter</span>
<span class="cp">turnkey         =&gt; turn-key</span>

<span class="cp">#analysed        =&gt; analyzed</span>
<span class="cp">#built-in        =&gt; builtin</span>
<span class="cp">#chastized       =&gt; chastised</span>
<span class="cp">#commandline     =&gt; command-line</span>
<span class="cp">#de-allocate     =&gt; deallocate</span>
<span class="cp">#dropin          =&gt; drop-in</span>
<span class="cp">#hardcode        =&gt; hard-code</span>
<span class="cp">#meta-data       =&gt; metadata</span>
<span class="cp">#multicharacter  =&gt; multi-character</span>
<span class="cp">#multiway        =&gt; multi-way</span>
<span class="cp">#non-empty       =&gt; nonempty</span>
<span class="cp">#non-profit      =&gt; nonprofit</span>
<span class="cp">#non-trappable   =&gt; nontrappable</span>
<span class="cp">#pre-define      =&gt; predefine</span>
<span class="cp">#preextend       =&gt; pre-extend</span>
<span class="cp">#re-compiling    =&gt; recompiling</span>
<span class="cp">#reenter         =&gt; re-enter</span>
<span class="cp">#turnkey         =&gt; turn-key</span>
<span class="cp">#-----------------------------</span>
<span class="cp"># <font size="-1"><a href="http://pleac.sourceforge.net/include/perl/ch01/fixstyle2</span>">download the following standalone program</a></font>
<span class="cp">#!/usr/bin/perl -w</span>
<span class="cp"># fixstyle2 - like fixstyle but faster for many many matches</span>
<span class="cp">use strict;</span>
<span class="cp">my $verbose = (@ARGV &amp;&amp; $ARGV[0] eq &#39;-v&#39; &amp;&amp; shift);</span>
<span class="cp">my %change = ();</span>
<span class="cp">while (&lt;DATA&gt;) { </span>
<span class="cp">    chomp;</span>
<span class="cp">    my ($in, $out) = split /\s*=&gt;\s*/;</span>
<span class="cp">    next unless $in &amp;&amp; $out;</span>
<span class="cp">    $change{$in} = $out;</span>
<span class="cp">}</span>

<span class="cp">if (@ARGV) { </span>
<span class="cp">    $^I = &quot;.orig&quot;;</span>
<span class="cp">} else { </span>
<span class="cp">    warn &quot;$0: Reading from stdin\n&quot; if -t STDIN;</span>
<span class="cp">}</span>

<span class="cp">while (&lt;&gt;) { </span>
<span class="cp">    my $i = 0;</span>
<span class="cp">    s/^(\s+)// &amp;&amp; print $1;         # emit leading whitespace</span>
<span class="cp">    for (split /(\s+)/, $_, -1) {   # preserve trailing whitespace</span>
<span class="cp">        print( ($i++ &amp; 1) ? $_ : ($change{$_} || $_));</span>
<span class="cp">    } </span>
<span class="cp">}</span>

<span class="cp">__END__</span>
<span class="cp">analysed        =&gt; analyzed</span>
<span class="cp">built-in        =&gt; builtin</span>
<span class="cp">chastized       =&gt; chastised</span>
<span class="cp">commandline     =&gt; command-line</span>
<span class="cp">de-allocate     =&gt; deallocate</span>
<span class="cp">dropin          =&gt; drop-in</span>
<span class="cp">hardcode        =&gt; hard-code</span>
<span class="cp">meta-data       =&gt; metadata</span>
<span class="cp">multicharacter  =&gt; multi-character</span>
<span class="cp">multiway        =&gt; multi-way</span>
<span class="cp">non-empty       =&gt; nonempty</span>
<span class="cp">non-profit      =&gt; nonprofit</span>
<span class="cp">non-trappable   =&gt; nontrappable</span>
<span class="cp">pre-define      =&gt; predefine</span>
<span class="cp">preextend       =&gt; pre-extend</span>
<span class="cp">re-compiling    =&gt; recompiling</span>
<span class="cp">reenter         =&gt; re-enter</span>
<span class="cp">turnkey         =&gt; turn-key</span>

<span class="cp">#analysed        =&gt; analyzed</span>
<span class="cp">#built-in        =&gt; builtin</span>
<span class="cp">#chastized       =&gt; chastised</span>
<span class="cp">#commandline     =&gt; command-line</span>
<span class="cp">#de-allocate     =&gt; deallocate</span>
<span class="cp">#dropin          =&gt; drop-in</span>
<span class="cp">#hardcode        =&gt; hard-code</span>
<span class="cp">#meta-data       =&gt; metadata</span>
<span class="cp">#multicharacter  =&gt; multi-character</span>
<span class="cp">#multiway        =&gt; multi-way</span>
<span class="cp">#non-empty       =&gt; nonempty</span>
<span class="cp">#non-profit      =&gt; nonprofit</span>
<span class="cp">#non-trappable   =&gt; nontrappable</span>
<span class="cp">#pre-define      =&gt; predefine</span>
<span class="cp">#preextend       =&gt; pre-extend</span>
<span class="cp">#re-compiling    =&gt; recompiling</span>
<span class="cp">#reenter         =&gt; re-enter</span>
<span class="cp">#turnkey         =&gt; turn-key</span>
<span class="cp">#-----------------------------</span>
<span class="cp"># very fast, but whitespace collapse</span>
<span class="cp">while (&lt;&gt;) { </span>
<span class="cp">    for (split) { </span>
<span class="cp">        print $change{$_} || $_, &quot; &quot;;</span>
<span class="cp">    }</span>
<span class="cp">    print &quot;\n&quot;;</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">my $pid = open(STDOUT, &quot;|-&quot;);</span>
<span class="cp">die &quot;cannot fork: $!&quot; unless defined $pid;</span>
<span class="cp">unless ($pid) {             # child</span>
<span class="cp">        while (&lt;STDIN&gt;) {</span>
<span class="cp">        s/ $//;</span>
<span class="cp">        print;</span>
<span class="cp">    }</span>
<span class="cp">    exit;</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN68"
>Program: psgrep</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">#% psgrep &#39;/sh\b/&#39;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">#% psgrep &#39;command =~ /sh$/&#39;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">#% psgrep &#39;uid &lt; 10&#39;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">#% psgrep &#39;command =~ /^-/&#39; &#39;tty ne &quot;?&quot;&#39;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">#% psgrep &#39;tty =~ /^[p-t]/&#39;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">#% psgrep &#39;uid &amp;&amp; tty eq &quot;?&quot;&#39;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">#% psgrep &#39;size &gt; 10 * 2**10&#39; &#39;uid != 0&#39;</span>
<span class="cp">#-----------------------------</span>
<span class="cp"># FLAGS   UID   PID  PPID PRI  NI   SIZE   RSS WCHAN     STA TTY TIME COMMAND</span>
<span class="cp">#</span>
<span class="cp">#     0   101  9751     1   0   0  14932  9652 do_select S   p1  0:25 netscape</span>
<span class="cp">#</span>
<span class="cp">#100000   101  9752  9751   0   0  10636   812 do_select S   p1  0:00 (dns helper)</span>
<span class="cp">#-----------------------------</span>
<span class="cp"># <font size="-1"><a href="http://pleac.sourceforge.net/include/perl/ch01/psgrep</span>">download the following standalone program</a></font>
<span class="cp">#!/usr/bin/perl -w</span>
<span class="cp"># psgrep - print selected lines of ps output by</span>
<span class="cp">#          compiling user queries into code</span>

<span class="cp">use strict;</span>

<span class="cp"># each field from the PS header</span>
<span class="cp">my @fieldnames = qw(FLAGS UID PID PPID PRI NICE SIZE</span>
<span class="cp">                    RSS WCHAN STAT TTY TIME COMMAND);</span>

<span class="cp"># determine the unpack format needed (hard-coded for Linux ps)</span>
<span class="cp">my $fmt = cut2fmt(8, 14, 20, 26, 30, 34, 41, 47, 59, 63, 67, 72);</span>

<span class="cp">my %fields;                         # where the data will store</span>

<span class="cp">die &lt;&lt;Thanatos unless @ARGV;</span>
<span class="cp">usage: $0 criterion ...</span>
<span class="cp">    Each criterion is a Perl expression involving:</span>
<span class="cp">     @fieldnames</span>
<span class="cp">    All criteria must be met for a line to be printed.</span>
<span class="cp">Thanatos</span>

<span class="cp"># Create function aliases for uid, size, UID, SIZE, etc.</span>
<span class="cp"># Empty parens on closure args needed for void prototyping.</span>
<span class="cp">for my $name (@fieldnames) {</span>
<span class="cp">    no strict &#39;refs&#39;;</span>
<span class="cp">    *$name = *{lc $name} = sub () { $fields{$name} };</span>
<span class="cp">}</span>

<span class="cp">my $code = &quot;sub is_desirable { &quot; . join(&quot; and &quot;, @ARGV) . &quot; } &quot;;</span>
<span class="cp">unless (eval $code.1) {</span>
<span class="cp">    die &quot;Error in code: $@\n\t$code\n&quot;;</span>
<span class="cp">}</span>

<span class="cp">open(PS, &quot;ps wwaxl |&quot;)              || die &quot;cannot fork: $!&quot;;</span>
<span class="cp">print scalar &lt;PS&gt;;                  # emit header line</span>
<span class="cp">while (&lt;PS&gt;) {</span>
<span class="cp">    @fields{@fieldnames} = trim(unpack($fmt, $_));</span>
<span class="cp">    print if is_desirable();        # line matches their criteria</span>
<span class="cp">}</span>
<span class="cp">close(PS)                           || die &quot;ps failed!&quot;;</span>

<span class="cp"># convert cut positions to unpack format</span>
<span class="cp">sub cut2fmt {</span>
<span class="cp">    my(@positions) = @_;</span>
<span class="cp">    my $template  = &#39;&#39;;</span>
<span class="cp">    my $lastpos   = 1;</span>
<span class="cp">    for my $place (@positions) {</span>
<span class="cp">        $template .= &quot;A&quot; . ($place - $lastpos) . &quot; &quot;;</span>
<span class="cp">        $lastpos   = $place;</span>
<span class="cp">    }</span>
<span class="cp">    $template .= &quot;A*&quot;;</span>
<span class="cp">    return $template;</span>
<span class="cp">}</span>

<span class="cp">sub trim {</span>
<span class="cp">    my @strings = @_;</span>
<span class="cp">    for (@strings) {</span>
<span class="cp">        s/^\s+//;</span>
<span class="cp">        s/\s+$//;</span>
<span class="cp">    }</span>
<span class="cp">    return wantarray ? @strings : $strings[0];</span>
<span class="cp">}</span>

<span class="cp"># the following was used to determine column cut points.</span>
<span class="cp"># sample input data follows</span>
<span class="cp">#123456789012345678901234567890123456789012345678901234567890123456789012345</span>
<span class="cp">#         1         2         3         4         5         6         7</span>
<span class="cp"># Positioning:</span>
<span class="cp">#       8     14    20    26  30  34     41    47          59  63  67   72</span>
<span class="cp">#       |     |     |     |   |   |      |     |           |   |   |    |</span>
<span class="cp">__END__</span>
<span class="cp"> FLAGS   UID   PID  PPID PRI  NI   SIZE   RSS WCHAN       STA TTY TIME COMMAND</span>
<span class="cp">   100     0     1     0   0   0    760   432 do_select   S   ?   0:02 init</span>
<span class="cp">   140     0   187     1   0   0    784   452 do_select   S   ?   0:02 syslogd</span>
<span class="cp">100100   101   428     1   0   0   1436   944 do_exit     S    1  0:00 /bin/login</span>
<span class="cp">100140    99 30217   402   0   0   1552  1008 posix_lock_ S   ?   0:00 httpd</span>
<span class="cp">     0   101   593   428   0   0   1780  1260 copy_thread S    1  0:00 -tcsh</span>
<span class="cp">100000   101 30639  9562  17   0    924   496             R   p1  0:00 ps axl</span>
<span class="cp">     0   101 25145  9563   0   0   2964  2360 idetape_rea S   p2  0:06 trn</span>
<span class="cp">100100     0 10116  9564   0   0   1412   928 setup_frame T   p3  0:00 ssh -C www</span>
<span class="cp">100100     0 26560 26554   0   0   1076   572 setup_frame T   p2  0:00 less</span>
<span class="cp">100000   101 19058  9562   0   0   1396   900 setup_frame T   p1  0:02 nvi /tmp/a</span>

<span class="cp"># the following was used to determine column cut points.</span>
<span class="cp"># sample input data follows</span>
<span class="cp"># 123456789012345678901234567890123456789012345678901234567890123456789012345</span>
<span class="cp">#          1         2         3         4         5         6         7</span>
<span class="cp">#  Positioning:</span>
<span class="cp">#        8     14    20    26  30  34     41    47          59  63  67   72</span>
<span class="cp">#        |     |     |     |   |   |      |     |           |   |   |    |</span>
<span class="cp"># __END__</span>
<span class="cp">#  FLAGS   UID   PID  PPID PRI  NI   SIZE   RSS WCHAN       STA TTY TIME COMMAND</span>
<span class="cp"># </span>
<span class="cp">#    100     0     1     0   0   0    760   432 do_select   S   ?   0:02 init</span>
<span class="cp"># </span>
<span class="cp">#    140     0   187     1   0   0    784   452 do_select   S   ?   0:02 syslogd</span>
<span class="cp"># </span>
<span class="cp"># 100100   101   428     1   0   0   1436   944 do_exit     S    1  0:00 /bin/login</span>
<span class="cp"># </span>
<span class="cp"># 100140    99 30217   402   0   0   1552  1008 posix_lock_ S   ?   0:00 httpd</span>
<span class="cp"># </span>
<span class="cp">#      0   101   593   428   0   0   1780  1260 copy_thread S    1  0:00 -tcsh</span>
<span class="cp"># </span>
<span class="cp"># 100000   101 30639  9562  17   0    924   496             R   p1  0:00 ps axl</span>
<span class="cp"># </span>
<span class="cp">#      0   101 25145  9563   0   0   2964  2360 idetape_rea S   p2  0:06 trn</span>
<span class="cp"># </span>
<span class="cp"># 100100     0 10116  9564   0   0   1412   928 setup_frame T   p3  0:00 ssh -C www</span>
<span class="cp"># </span>
<span class="cp"># 100100     0 26560 26554   0   0   1076   572 setup_frame T   p2  0:00 less</span>
<span class="cp"># </span>
<span class="cp"># 100000   101 19058  9562   0   0   1396   900 setup_frame T   p1  0:02 nvi /tmp/a</span>
<span class="cp">#-----------------------------</span>
<span class="cp">eval &quot;sub is_desirable { uid &lt; 10 } &quot; . 1;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">#% psgrep &#39;no strict &quot;vars&quot;;</span>
<span class="cp">#          BEGIN { $id = getpwnam(&quot;nobody&quot;) }</span>
<span class="cp">#          uid == $id &#39;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub id()         { $_-&gt;{ID}   }</span>
<span class="cp">sub title()      { $_-&gt;{TITLE} }</span>
<span class="cp">sub executive()  { title =~ /(?:vice-)?president/i }</span>

<span class="cp"># user search criteria go in the grep clause</span>
<span class="cp">@slowburners = grep { id &lt; 10 &amp;&amp; !executive } @employees;</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="numbers.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>PLEAC-Perl</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Numbers</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>