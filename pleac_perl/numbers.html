<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Numbers</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="PLEAC-Perl"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="Strings"
HREF="strings.html"><LINK
REL="NEXT"
TITLE="Dates and Times"
HREF="datesandtimes.html"><style type="text/css">td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }

  </style></head
><BODY TEXT="#cecece" BGCOLOR="#4f6f6f" LINK="#f5deb3" VLINK="#d5ae83"
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PLEAC-Perl</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="strings.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="datesandtimes.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="NUMBERS"
>2. Numbers</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN73"
>Checking Whether a String Is a Valid Number</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">if ($string =~ /PATTERN/) {</span>
<span class="cp">    # is a number</span>
<span class="cp">} else {</span>
<span class="cp">    # is not</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">warn &quot;has nondigits&quot;        if     /\D/;</span>
<span class="cp">warn &quot;not a natural number&quot; unless /^\d+$/;             # rejects -3</span>
<span class="cp">warn &quot;not an integer&quot;       unless /^-?\d+$/;           # rejects +3</span>
<span class="cp">warn &quot;not an integer&quot;       unless /^[+-]?\d+$/;</span>
<span class="cp">warn &quot;not a decimal number&quot; unless /^-?\d+\.?\d*$/;     # rejects .2</span>
<span class="cp">warn &quot;not a decimal number&quot; unless /^-?(?:\d+(?:\.\d*)?|\.\d+)$/;</span>
<span class="cp">warn &quot;not a C float&quot;</span>
<span class="cp">       unless /^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub getnum {</span>
<span class="cp">    use POSIX qw(strtod);</span>
<span class="cp">    my $str = shift;</span>
<span class="cp">    $str =~ s/^\s+//;</span>
<span class="cp">    $str =~ s/\s+$//;</span>
<span class="cp">    $! = 0;</span>
<span class="cp">    my($num, $unparsed) = strtod($str);</span>
<span class="cp">    if (($str eq &#39;&#39;) || ($unparsed != 0) || $!) {</span>
<span class="cp">        return;</span>
<span class="cp">    } else {</span>
<span class="cp">        return $num;</span>
<span class="cp">    } </span>
<span class="cp">} </span>

<span class="cp">sub is_numeric { defined scalar &amp;getnum } </span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN76"
>Comparing Floating-Point Numbers</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp"># equal(NUM1, NUM2, ACCURACY) : returns true if NUM1 and NUM2 are</span>
<span class="cp"># equal to ACCURACY number of decimal places</span>

<span class="cp">sub equal {</span>
<span class="cp">    my ($A, $B, $dp) = @_;</span>

<span class="cp">    return sprintf(&quot;%.${dp}g&quot;, $A) eq sprintf(&quot;%.${dp}g&quot;, $B);</span>
<span class="cp">  }</span>
<span class="cp">#-----------------------------</span>
<span class="cp">$wage = 536;                # $5.36/hour</span>
<span class="cp">$week = 40 * $wage;         # $214.40</span>
<span class="cp">printf(&quot;One week&#39;s wage is: \$%.2f\n&quot;, $week/100);</span>
<span class="cp">#</span>
<span class="cp">#One week&#39;s wage is: $214.40</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN79"
>Rounding Floating-Point Numbers</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">$rounded = sprintf(&quot;%FORMATf&quot;, $unrounded);</span>
<span class="cp">#-----------------------------</span>
<span class="cp">$a = 0.255;</span>
<span class="cp">$b = sprintf(&quot;%.2f&quot;, $a);</span>
<span class="cp">print &quot;Unrounded: $a\nRounded: $b\n&quot;;</span>
<span class="cp">printf &quot;Unrounded: $a\nRounded: %.2f\n&quot;, $a;</span>

<span class="cp"># Unrounded: 0.255</span>
<span class="cp"># </span>
<span class="cp"># Rounded: 0.26</span>
<span class="cp"># </span>
<span class="cp"># Unrounded: 0.255</span>
<span class="cp"># </span>
<span class="cp"># Rounded: 0.26</span>
<span class="cp">#-----------------------------</span>
<span class="cp">use POSIX;</span>
<span class="cp">print &quot;number\tint\tfloor\tceil\n&quot;;</span>
<span class="cp">@a = ( 3.3 , 3.5 , 3.7, -3.3 );</span>
<span class="cp">foreach (@a) {</span>
<span class="cp">    printf( &quot;%.1f\t%.1f\t%.1f\t%.1f\n&quot;, </span>
<span class="cp">        $_, int($_), floor($_), ceil($_) );</span>
<span class="cp">}</span>

<span class="cp"># number  int     floor   ceil</span>
<span class="cp"># </span>
<span class="cp">#  3.3     3.0     3.0     4.0</span>
<span class="cp"># </span>
<span class="cp">#  3.5     3.0     3.0     4.0</span>
<span class="cp"># </span>
<span class="cp">#  3.7     3.0     3.0     4.0</span>
<span class="cp"># </span>
<span class="cp"># -3.3    -3.0    -4.0    -3.0</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN82"
>Converting Between Binary and Decimal</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">sub dec2bin {</span>
<span class="cp">    my $str = unpack(&quot;B32&quot;, pack(&quot;N&quot;, shift));</span>
<span class="cp">    $str =~ s/^0+(?=\d)//;   # otherwise you&#39;ll get leading zeros</span>
<span class="cp">    return $str;</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub bin2dec {</span>
<span class="cp">    return unpack(&quot;N&quot;, pack(&quot;B32&quot;, substr(&quot;0&quot; x 32 . shift, -32)));</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">$num = bin2dec(&#39;0110110&#39;);  # $num is 54</span>
<span class="cp">$binstr = dec2bin(54);      # $binstr is 110110</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN85"
>Operating on a Series of Integers</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">foreach ($X .. $Y) {</span>
<span class="cp">    # $_ is set to every integer from X to Y, inclusive</span>
<span class="cp">}</span>

<span class="cp">foreach $i ($X .. $Y) {</span>
<span class="cp">    # $i is set to every integer from X to Y, inclusive</span>
<span class="cp">    }</span>

<span class="cp">for ($i = $X; $i &lt;= $Y; $i++) {</span>
<span class="cp">    # $i is set to every integer from X to Y, inclusive</span>
<span class="cp">}</span>

<span class="cp">for ($i = $X; $i &lt;= $Y; $i += 7) {</span>
<span class="cp">    # $i is set to every integer from X to Y, stepsize = 7</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">print &quot;Infancy is: &quot;;</span>
<span class="cp">foreach (0 .. 2) {</span>
<span class="cp">    print &quot;$_ &quot;;</span>
<span class="cp">}</span>
<span class="cp">print &quot;\n&quot;;</span>

<span class="cp">print &quot;Toddling is: &quot;;</span>
<span class="cp">foreach $i (3 .. 4) {</span>
<span class="cp">    print &quot;$i &quot;;</span>
<span class="cp">}</span>
<span class="cp">print &quot;\n&quot;;</span>

<span class="cp">print &quot;Childhood is: &quot;;</span>
<span class="cp">for ($i = 5; $i &lt;= 12; $i++) {</span>
<span class="cp">    print &quot;$i &quot;;</span>
<span class="cp">}</span>
<span class="cp">print &quot;\n&quot;;</span>

<span class="cp"># Infancy is: 0 1 2 </span>
<span class="cp"># </span>
<span class="cp"># Toddling is: 3 4 </span>
<span class="cp"># </span>
<span class="cp"># Childhood is: 5 6 7 8 9 10 11 12 </span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN88"
>Working with Roman Numerals</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">use Roman;</span>
<span class="cp">$roman = roman($arabic);                        # convert to roman numerals</span>
<span class="cp">$arabic = arabic($roman) if isroman($roman);    # convert from roman numerals</span>
<span class="cp">#-----------------------------</span>
<span class="cp">use Roman;</span>
<span class="cp">$roman_fifteen = roman(15);                         # &quot;xv&quot;</span>
<span class="cp">print &quot;Roman for fifteen is $roman_fifteen\n&quot;;</span>
<span class="cp">$arabic_fifteen = arabic($roman_fifteen);</span>
<span class="cp">print &quot;Converted back, $roman_fifteen is $arabic_fifteen\n&quot;;</span>

<span class="cp">Roman for fifteen is xv</span>

<span class="cp">Converted back, xv is 15</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN91"
>Generating Random Numbers</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">$random = int( rand( $Y-$X+1 ) ) + $X;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">$random = int( rand(51)) + 25;</span>
<span class="cp">print &quot;$random\n&quot;;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">$elt = $array[ rand @array ];</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@chars = ( &quot;A&quot; .. &quot;Z&quot;, &quot;a&quot; .. &quot;z&quot;, 0 .. 9, qw(! @ $ % ^ &amp; *) );</span>
<span class="cp">$password = join(&quot;&quot;, @chars[ map { rand @chars } ( 1 .. 8 ) ]);</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN94"
>Generating Different Random Numbers</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">srand EXPR;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">srand( &lt;STDIN&gt; );</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN97"
>Making Numbers Even More Random</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">use Math::TrulyRandom;</span>
<span class="cp">$random = truly_random_value();</span>

<span class="cp">use Math::Random;</span>
<span class="cp">$random = random_uniform();</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN100"
>Generating Biased Random Numbers</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">sub gaussian_rand {</span>
<span class="cp">    my ($u1, $u2);  # uniformly distributed random numbers</span>
<span class="cp">    my $w;          # variance, then a weight</span>
<span class="cp">    my ($g1, $g2);  # gaussian-distributed numbers</span>

<span class="cp">    do {</span>
<span class="cp">        $u1 = 2 * rand() - 1;</span>
<span class="cp">        $u2 = 2 * rand() - 1;</span>
<span class="cp">        $w = $u1*$u1 + $u2*$u2;</span>
<span class="cp">    } while ( $w &gt;= 1 );</span>

<span class="cp">    $w = sqrt( (-2 * log($w))  / $w );</span>
<span class="cp">    $g2 = $u1 * $w;</span>
<span class="cp">    $g1 = $u2 * $w;</span>
<span class="cp">    # return both if wanted, else just one</span>
<span class="cp">    return wantarray ? ($g1, $g2) : $g1;</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp"># weight_to_dist: takes a hash mapping key to weight and returns</span>
<span class="cp"># a hash mapping key to probability</span>
<span class="cp">sub weight_to_dist {</span>
<span class="cp">    my %weights = @_;</span>
<span class="cp">    my %dist    = ();</span>
<span class="cp">    my $total   = 0;</span>
<span class="cp">    my ($key, $weight);</span>
<span class="cp">    local $_;</span>

<span class="cp">    foreach (values %weights) {</span>
<span class="cp">        $total += $_;</span>
<span class="cp">    }</span>

<span class="cp">    while ( ($key, $weight) = each %weights ) {</span>
<span class="cp">        $dist{$key} = $weight/$total;</span>
<span class="cp">    }</span>

<span class="cp">    return %dist;</span>
<span class="cp">}</span>

<span class="cp"># weighted_rand: takes a hash mapping key to probability, and</span>
<span class="cp"># returns the corresponding element</span>
<span class="cp">sub weighted_rand {</span>
<span class="cp">    my %dist = @_;</span>
<span class="cp">    my ($key, $weight);</span>

<span class="cp">    while (1) {                     # to avoid floating point inaccuracies</span>
<span class="cp">        my $rand = rand;</span>
<span class="cp">        while ( ($key, $weight) = each %dist ) {</span>
<span class="cp">            return $key if ($rand -= $weight) &lt; 0;</span>
<span class="cp">        }</span>
<span class="cp">    }</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp"># gaussian_rand as above</span>
<span class="cp">$mean = 25;</span>
<span class="cp">$sdev = 2;</span>
<span class="cp">$salary = gaussian_rand() * $sdev + $mean;</span>
<span class="cp">printf(&quot;You have been hired at \$%.2f\n&quot;, $salary);</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN103"
>Doing Trigonometry in Degrees, not Radians</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">BEGIN {</span>
<span class="cp">    use constant PI =&gt; 3.14159265358979;</span>

<span class="cp">    sub deg2rad {</span>
<span class="cp">        my $degrees = shift;</span>
<span class="cp">        return ($degrees / 180) * PI;</span>
<span class="cp">    }</span>

<span class="cp">    sub rad2deg {</span>
<span class="cp">        my $radians = shift;</span>
<span class="cp">        return ($radians / PI) * 180;</span>
<span class="cp">    }</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">use Math::Trig;</span>

<span class="cp">$radians = deg2rad($degrees);</span>
<span class="cp">$degrees = rad2deg($radians);</span>
<span class="cp">#-----------------------------</span>
<span class="cp"># deg2rad and rad2deg defined either as above or from Math::Trig</span>
<span class="cp">sub degree_sine {</span>
<span class="cp">    my $degrees = shift;</span>
<span class="cp">    my $radians = deg2rad($degrees);</span>
<span class="cp">    my $result = sin($radians);</span>

<span class="cp">    return $result;</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN106"
>Calculating More Trigonometric Functions</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">sub tan {</span>
<span class="cp">    my $theta = shift;</span>

<span class="cp">    return sin($theta)/cos($theta);</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">use POSIX;</span>

<span class="cp">$y = acos(3.7);</span>
<span class="cp">#-----------------------------</span>
<span class="cp">use Math::Trig;</span>

<span class="cp">$y = acos(3.7);</span>
<span class="cp">#-----------------------------</span>
<span class="cp">eval {</span>
<span class="cp">    $y = tan($pi/2);</span>
<span class="cp">} or return undef;</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN109"
>Taking Logarithms</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">$log_e = log(VALUE);</span>
<span class="cp">#-----------------------------</span>
<span class="cp">use POSIX qw(log10);</span>
<span class="cp">$log_10 = log10(VALUE);</span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub log_base {</span>
<span class="cp">    my ($base, $value) = @_;</span>
<span class="cp">    return log($value)/log($base);</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp"># log_base defined as above</span>
<span class="cp">$answer = log_base(10, 10_000);</span>
<span class="cp">print &quot;log10(10,000) = $answer\n&quot;;</span>
<span class="cp"># log10(10,000) = 4</span>
<span class="cp">#-----------------------------</span>
<span class="cp">use Math::Complex;</span>
<span class="cp">printf &quot;log2(1024) = %lf\n&quot;, logn(1024, 2); # watch out for argument order!</span>
<span class="cp"># log2(1024) = 10.000000</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN112"
>Multiplying Matrices</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">use PDL;</span>
<span class="cp"># $a and $b are both pdl objects</span>
<span class="cp">$c = $a * $b;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub mmult {</span>
<span class="cp">    my ($m1,$m2) = @_;</span>
<span class="cp">    my ($m1rows,$m1cols) = matdim($m1);</span>
<span class="cp">    my ($m2rows,$m2cols) = matdim($m2);</span>

<span class="cp">    unless ($m1cols == $m2rows) {  # raise exception</span>
<span class="cp">        die &quot;IndexError: matrices don&#39;t match: $m1cols != $m2rows&quot;;</span>
<span class="cp">    }</span>

<span class="cp">    my $result = [];</span>
<span class="cp">    my ($i, $j, $k);</span>

<span class="cp">    for $i (range($m1rows)) {</span>
<span class="cp">        for $j (range($m2cols)) {</span>
<span class="cp">            for $k (range($m1cols)) {</span>
<span class="cp">                $result-&gt;[$i][$j] += $m1-&gt;[$i][$k] * $m2-&gt;[$k][$j];</span>
<span class="cp">            }</span>
<span class="cp">        }</span>
<span class="cp">    }</span>
<span class="cp">    return $result;</span>
<span class="cp">}</span>

<span class="cp">sub range { 0 .. ($_[0] - 1) }</span>

<span class="cp">sub veclen {</span>
<span class="cp">    my $ary_ref = $_[0];</span>
<span class="cp">    my $type = ref $ary_ref;</span>
<span class="cp">    if ($type ne &quot;ARRAY&quot;) { die &quot;$type is bad array ref for $ary_ref&quot; }</span>
<span class="cp">    return scalar(@$ary_ref);</span>
<span class="cp">}</span>

<span class="cp">sub matdim {</span>
<span class="cp">    my $matrix = $_[0];</span>
<span class="cp">    my $rows = veclen($matrix);</span>
<span class="cp">    my $cols = veclen($matrix-&gt;[0]);</span>
<span class="cp">    return ($rows, $cols);</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">use PDL;</span>

<span class="cp">$a = pdl [</span>
<span class="cp">    [ 3, 2, 3 ],</span>
<span class="cp">    [ 5, 9, 8 ],</span>
<span class="cp">];</span>

<span class="cp">$b = pdl [</span>
<span class="cp">    [ 4, 7 ],</span>
<span class="cp">    [ 9, 3 ],</span>
<span class="cp">    [ 8, 1 ],</span>
<span class="cp">];</span>

<span class="cp">$c = $a x $b;  # x overload</span>
<span class="cp">#-----------------------------</span>
<span class="cp"># mmult() and other subroutines as above</span>

<span class="cp">$x = [</span>
<span class="cp">       [ 3, 2, 3 ],</span>
<span class="cp">       [ 5, 9, 8 ],</span>
<span class="cp">];</span>

<span class="cp">$y = [</span>
<span class="cp">       [ 4, 7 ],</span>
<span class="cp">       [ 9, 3 ],</span>
<span class="cp">       [ 8, 1 ],</span>
<span class="cp">];</span>

<span class="cp">$z = mmult($x, $y);</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN115"
>Using Complex Numbers</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp"># $c = $a * $b manually</span>
<span class="cp">$c_real = ( $a_real * $b_real ) - ( $a_imaginary * $b_imaginary );</span>
<span class="cp">$c_imaginary = ( $a_real * $b_imaginary ) + ( $b_real * $a_imaginary );</span>
<span class="cp">#-----------------------------</span>
<span class="cp"># $c = $a * $b using Math::Complex</span>
<span class="cp">use Math::Complex;</span>
<span class="cp">$c = $a * $b;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">$a_real = 3; $a_imaginary = 5;              # 3 + 5i;</span>
<span class="cp">$b_real = 2; $b_imaginary = -2;             # 2 - 2i;</span>
<span class="cp">$c_real = ( $a_real * $b_real ) - ( $a_imaginary * $b_imaginary );</span>
<span class="cp">$c_imaginary = ( $a_real * $b_imaginary ) + ( $b_real * $a_imaginary );</span>
<span class="cp">print &quot;c = ${c_real}+${c_imaginary}i\n&quot;;</span>

<span class="cp">c = 16+4i</span>
<span class="cp">#-----------------------------</span>
<span class="cp">use Math::Complex;</span>
<span class="cp">$a = Math::Complex-&gt;new(3,5);               # or Math::Complex-&gt;new(3,5);</span>
<span class="cp">$b = Math::Complex-&gt;new(2,-2);</span>
<span class="cp">$c = $a * $b;</span>
<span class="cp">print &quot;c = $c\n&quot;;</span>

<span class="cp">c = 16+4i</span>
<span class="cp">#-----------------------------</span>
<span class="cp">use Math::Complex;</span>
<span class="cp">$c = cplx(3,5) * cplx(2,-2);                # easier on the eye</span>
<span class="cp">$d = 3 + 4*i;                               # 3 + 4i</span>
<span class="cp">printf &quot;sqrt($d) = %s\n&quot;, sqrt($d);</span>

<span class="cp"># sqrt(3+4i) = 2+i</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN118"
>Converting Between Octal and Hexadecimal</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">$number = hex($hexadecimal);         # hexadecimal</span>
<span class="cp">$number = oct($octal);               # octal</span>
<span class="cp">#-----------------------------</span>
<span class="cp">print &quot;Gimme a number in decimal, octal, or hex: &quot;;</span>
<span class="cp">$num = &lt;STDIN&gt;;</span>
<span class="cp">chomp $num;</span>
<span class="cp">exit unless defined $num;</span>
<span class="cp">$num = oct($num) if $num =~ /^0/; # does both oct and hex</span>
<span class="cp">printf &quot;%d %x %o\n&quot;, $num, $num, $num;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">print &quot;Enter file permission in octal: &quot;;</span>
<span class="cp">$permissions = &lt;STDIN&gt;;</span>
<span class="cp">die &quot;Exiting ...\n&quot; unless defined $permissions;</span>
<span class="cp">chomp $permissions;</span>
<span class="cp">$permissions = oct($permissions);   # permissions always octal</span>
<span class="cp">print &quot;The decimal value is $permissions\n&quot;;</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN121"
>Putting Commas in Numbers</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">sub commify {</span>
<span class="cp">    my $text = reverse $_[0];</span>
<span class="cp">    $text =~ s/(\d\d\d)(?=\d)(?!\d*\.)/$1,/g;</span>
<span class="cp">    return scalar reverse $text;</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp"># more reasonable web counter :-)</span>
<span class="cp">use Math::TrulyRandom;</span>
<span class="cp">$hits = truly_random_value();       # negative hits!</span>
<span class="cp">$output = &quot;Your web page received $hits accesses last month.\n&quot;;</span>
<span class="cp">print commify($output);</span>
<span class="cp">Your web page received -1,740,525,205 accesses last month.</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN124"
>Printing Correct Plurals</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">printf &quot;It took %d hour%s\n&quot;, $time, $time == 1 ? &quot;&quot; : &quot;s&quot;;</span>

<span class="cp">printf &quot;%d hour%s %s enough.\n&quot;, $time, </span>
<span class="cp">        $time == 1 ? &quot;&quot;   : &quot;s&quot;,</span>
<span class="cp">        $time == 1 ? &quot;is&quot; : &quot;are&quot;;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">printf &quot;It took %d centur%s&quot;, $time, $time == 1 ? &quot;y&quot; : &quot;ies&quot;;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub noun_plural {</span>
<span class="cp">    local $_ = shift;</span>
<span class="cp">    # order really matters here!</span>
<span class="cp">    s/ss$/sses/                             ||</span>
<span class="cp">    s/([psc]h)$/${1}es/                     ||</span>
<span class="cp">    s/z$/zes/                               ||</span>
<span class="cp">    s/ff$/ffs/                              ||</span>
<span class="cp">    s/f$/ves/                               ||</span>
<span class="cp">    s/ey$/eys/                              ||</span>
<span class="cp">    s/y$/ies/                               ||</span>
<span class="cp">    s/ix$/ices/                             ||</span>
<span class="cp">    s/([sx])$/$1es/                         ||</span>
<span class="cp">    s/$/s/                                  ||</span>
<span class="cp">                die &quot;can&#39;t get here&quot;;</span>
<span class="cp">    return $_;</span>
<span class="cp">}</span>
<span class="cp">*verb_singular = \&amp;noun_plural;   # make function alias</span>
<span class="cp">#-----------------------------</span>
<span class="cp">use Lingua::EN::Inflect qw(PL classical);</span>
<span class="cp">classical(1);               # why isn&#39;t this the default?</span>
<span class="cp">while (&lt;DATA&gt;) {            # each line in the data</span>
<span class="cp">    for (split) {           # each word on the line</span>
<span class="cp">        print &quot;One $_, two &quot;, PL($_), &quot;.\n&quot;;</span>
<span class="cp">    }</span>
<span class="cp">} </span>
<span class="cp"># plus one more</span>
<span class="cp">$_ = &#39;secretary general&#39;;</span>
<span class="cp">print &quot;One $_, two &quot;, PL($_), &quot;.\n&quot;;</span>

<span class="cp">#__END__</span>
<span class="cp">#fish fly ox </span>
<span class="cp">#species genus phylum </span>
<span class="cp">#cherub radius jockey </span>
<span class="cp">#index matrix mythos</span>
<span class="cp">#phenomenon formula </span>
<span class="cp">#-----------------------------</span>
<span class="cp">#One fish, two fish.</span>
<span class="cp">#</span>
<span class="cp">#One fly, two flies.</span>
<span class="cp">#</span>
<span class="cp">#One ox, two oxen.</span>
<span class="cp">#</span>
<span class="cp">#One species, two species.</span>
<span class="cp">#</span>
<span class="cp">#One genus, two genera.</span>
<span class="cp">#</span>
<span class="cp">#One phylum, two phyla.</span>
<span class="cp">#</span>
<span class="cp">#One cherub, two cherubim.</span>
<span class="cp">#</span>
<span class="cp">#One radius, two radii.</span>
<span class="cp">#</span>
<span class="cp">#One jockey, two jockeys.</span>
<span class="cp">#</span>
<span class="cp">#One index, two indices.</span>
<span class="cp">#</span>
<span class="cp">#One matrix, two matrices.</span>
<span class="cp">#</span>
<span class="cp">#One mythos, two mythoi.</span>
<span class="cp">#</span>
<span class="cp">#One phenomenon, two phenomena.</span>
<span class="cp">#</span>
<span class="cp">#One formula, two formulae.</span>
<span class="cp">#</span>
<span class="cp">#One secretary general, two secretaries general.</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN127"
>Program: Calculating Prime Factors</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">#% bigfact 8 9 96 2178</span>
<span class="cp">#8          2**3</span>
<span class="cp">#</span>
<span class="cp">#9          3**2</span>
<span class="cp">#</span>
<span class="cp">#96         2**5 3</span>
<span class="cp">#</span>
<span class="cp">#2178       2 3**2 11**2</span>
<span class="cp">#-----------------------------</span>
<span class="cp">#% bigfact 239322000000000000000000</span>
<span class="cp">#+239322000000000000000000 2**19 3 5**18 +39887 </span>
<span class="cp">#</span>
<span class="cp">#</span>
<span class="cp">#% bigfact 25000000000000000000000000</span>
<span class="cp">#+25000000000000000000000000 2**24 5**26</span>
<span class="cp">#-----------------------------</span>
<span class="cp"># <font size="-1"><a href="http://pleac.sourceforge.net/include/perl/ch02/bigfact</span>">download the following standalone program</a></font>
<span class="cp">#!/usr/bin/perl</span>
<span class="cp"># bigfact - calculate prime factors</span>
<span class="cp">use strict;</span>
<span class="cp">use integer;</span>

<span class="cp">use vars qw{ $opt_b $opt_d };</span>
<span class="cp">use Getopt::Std;</span>

<span class="cp">@ARGV &amp;&amp; getopts(&#39;bd&#39;)        or die &quot;usage: $0 [-b] number ...&quot;;</span>

<span class="cp">load_biglib() if $opt_b;</span>

<span class="cp">ARG: foreach my $orig ( @ARGV ) {</span>
<span class="cp">    my ($n, $root, %factors, $factor);</span>
<span class="cp">    $n = $opt_b ? Math::BigInt-&gt;new($orig) : $orig;</span>
<span class="cp">    if ($n + 0 ne $n) { # don&#39;t use -w for this</span>
<span class="cp">        printf STDERR &quot;bignum: %s would become %s\n&quot;, $n, $n+0 if $opt_d;</span>
<span class="cp">        load_biglib();</span>
<span class="cp">        $n = Math::BigInt-&gt;new($orig);</span>
<span class="cp">    }</span>
<span class="cp">    printf &quot;%-10s &quot;, $n;</span>

<span class="cp">    # Here $sqi will be the square of $i. We will take advantage</span>
<span class="cp">    # of the fact that ($i + 1) ** 2 == $i ** 2 + 2 * $i + 1.</span>
<span class="cp">    for (my ($i, $sqi) = (2, 4); $sqi &lt;= $n; $sqi += 2 * $i ++ + 1) {</span>
<span class="cp">        while ($n % $i == 0) {</span>
<span class="cp">            $n /= $i;</span>
<span class="cp">            print STDERR &quot;&lt;$i&gt;&quot; if $opt_d;</span>
<span class="cp">            $factors {$i} ++;</span>
<span class="cp">        }</span>
<span class="cp">    }</span>

<span class="cp">    if ($n != 1 &amp;&amp; $n != $orig) { $factors{$n}++ }</span>
<span class="cp">    if (! %factors) {</span>
<span class="cp">        print &quot;PRIME\n&quot;;</span>
<span class="cp">        next ARG;</span>
<span class="cp">    }</span>
<span class="cp">    for $factor ( sort { $a &lt;=&gt; $b } keys %factors ) {</span>
<span class="cp">            print &quot;$factor&quot;;</span>
<span class="cp">        if ($factors{$factor} &gt; 1) {</span>
<span class="cp">        print &quot;**$factors{$factor}&quot;;</span>
<span class="cp">        }</span>
<span class="cp">        print &quot; &quot;;</span>
<span class="cp">    }</span>
<span class="cp">    print &quot;\n&quot;;</span>
<span class="cp">}</span>

<span class="cp"># this simulates a use, but at run time</span>
<span class="cp">sub load_biglib {</span>
<span class="cp">    require Math::BigInt;</span>
<span class="cp">    Math::BigInt-&gt;import();          #immaterial?</span>
<span class="cp">}</span>

<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="strings.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="datesandtimes.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Strings</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Dates and Times</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>