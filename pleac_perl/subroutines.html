<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Subroutines</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="PLEAC-Perl"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="Directories"
HREF="directories.html"><LINK
REL="NEXT"
TITLE="References and Records"
HREF="referencesandrecords.html"><style type="text/css">td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }

  </style></head
><BODY TEXT="#cecece" BGCOLOR="#4f6f6f" LINK="#f5deb3" VLINK="#d5ae83"
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PLEAC-Perl</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="directories.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="referencesandrecords.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="SUBROUTINES"
>10. Subroutines</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN536"
>Introduction</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">sub hello { </span>
<span class="cp">    $greeted++;          # global variable </span>
<span class="cp">    print &quot;hi there!\n&quot;;</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">hello();                 # call subroutine hello with no arguments/parameters</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN539"
>Accessing Subroutine Arguments</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">sub hypotenuse {</span>
<span class="cp">    return sqrt( ($_[0] ** 2) + ($_[1] ** 2) );</span>
<span class="cp">}</span>

<span class="cp">$diag = hypotenuse(3,4);  # $diag is 5</span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub hypotenuse {</span>
<span class="cp">    my ($side1, $side2) = @_;</span>
<span class="cp">    return sqrt( ($side1 ** 2) + ($side2 ** 2) );</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">print hypotenuse(3, 4), &quot;\n&quot;;               # prints 5</span>

<span class="cp">@a = (3, 4);</span>
<span class="cp">print hypotenuse(@a), &quot;\n&quot;;                 # prints 5</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@both = (@men, @women);</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@nums = (1.4, 3.5, 6.7);</span>
<span class="cp">@ints = int_all(@nums);        # @nums unchanged</span>
<span class="cp">sub int_all {</span>
<span class="cp">    my @retlist = @_;          # make safe copy for return</span>
<span class="cp">    for my $n (@retlist) { $n = int($n) } </span>
<span class="cp">    return @retlist;</span>
<span class="cp">} </span>
<span class="cp">#-----------------------------</span>
<span class="cp">@nums = (1.4, 3.5, 6.7);</span>
<span class="cp">trunc_em(@nums);               # @nums now (1,3,6)</span>
<span class="cp">sub trunc_em {</span>
<span class="cp">    for (@_) { $_ = int($_) }  # truncate each argument</span>
<span class="cp">} </span>
<span class="cp">#-----------------------------</span>
<span class="cp">$line = chomp(&lt;&gt;);                  # WRONG</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN542"
>Making Variables Private to a Function</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">sub somefunc {</span>
<span class="cp">    my $variable;                 # $variable is invisible outside somefunc()</span>
<span class="cp">    my ($another, @an_array, %a_hash);     # declaring many variables at once</span>

<span class="cp">    # ...</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">my ($name, $age) = @ARGV;</span>
<span class="cp">my $start        = fetch_time();</span>
<span class="cp">#-----------------------------</span>
<span class="cp">my ($a, $b) = @pair;</span>
<span class="cp">my $c = fetch_time();</span>

<span class="cp">sub check_x {</span>
<span class="cp">    my $x = $_[0];       </span>
<span class="cp">    my $y = &quot;whatever&quot;;  </span>
<span class="cp">    run_check();</span>
<span class="cp">    if ($condition) {</span>
<span class="cp">        print &quot;got $x\n&quot;;</span>
<span class="cp">    }</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub save_array {</span>
<span class="cp">    my @arguments = @_;</span>
<span class="cp">    push(@Global_Array, \@arguments);</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN545"
>Creating Persistent Private Variables</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">{</span>
<span class="cp">    my $variable;</span>
<span class="cp">    sub mysub {</span>
<span class="cp">        # ... accessing $variable</span>
<span class="cp">    }</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">BEGIN {</span>
<span class="cp">    my $variable = 1;                       # initial value</span>
<span class="cp">    sub othersub {                          # ... accessing $variable</span>
<span class="cp">    }</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">{</span>
<span class="cp">    my $counter;</span>
<span class="cp">    sub next_counter { return ++$counter }</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">BEGIN {</span>
<span class="cp">    my $counter = 42;</span>
<span class="cp">    sub next_counter { return ++$counter }</span>
<span class="cp">    sub prev_counter { return --$counter }</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN548"
>Determining Current Function Name</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">$this_function = (caller(0))[3];</span>
<span class="cp">#-----------------------------</span>
<span class="cp">($package, $filename, $line, $subr, $has_args, $wantarray )= caller($i);</span>
<span class="cp">#   0         1         2       3       4          5</span>
<span class="cp">#-----------------------------</span>
<span class="cp">$me  = whoami();</span>
<span class="cp">$him = whowasi();</span>

<span class="cp">sub whoami  { (caller(1))[3] }</span>
<span class="cp">sub whowasi { (caller(2))[3] }</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN551"
>Passing Arrays and Hashes by Reference</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">array_diff( \@array1, \@array2 );</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@a = (1, 2);</span>
<span class="cp">@b = (5, 8);</span>
<span class="cp">@c = add_vecpair( \@a, \@b );</span>
<span class="cp">print &quot;@c\n&quot;;</span>
<span class="cp">6 10</span>
<span class="cp"> </span>

<span class="cp">sub add_vecpair {       # assumes both vectors the same length</span>
<span class="cp">    my ($x, $y) = @_;   # copy in the array references</span>
<span class="cp">    my @result;</span>

<span class="cp">    for (my $i=0; $i &lt; @$x; $i++) {</span>
<span class="cp">      $result[$i] = $x-&gt;[$i] + $y-&gt;[$i];</span>
<span class="cp">    }</span>

<span class="cp">    return @result;</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">unless (@_ == 2 &amp;&amp; ref($x) eq &#39;ARRAY&#39; &amp;&amp; ref($y) eq &#39;ARRAY&#39;) {</span>
<span class="cp">    die &quot;usage: add_vecpair ARRAYREF1 ARRAYREF2&quot;;</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN554"
>Detecting Return Context</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">if (wantarray()) {</span>
<span class="cp">    # list context</span>
<span class="cp">} </span>
<span class="cp">elsif (defined wantarray()) {</span>
<span class="cp">    # scalar context</span>
<span class="cp">} </span>
<span class="cp">else {</span>
<span class="cp">    # void context</span>
<span class="cp">} </span>
<span class="cp">#-----------------------------</span>
<span class="cp">if (wantarray()) {</span>
<span class="cp">    print &quot;In list context\n&quot;;</span>
<span class="cp">    return @many_things;</span>
<span class="cp">} elsif (defined wantarray()) {</span>
<span class="cp">    print &quot;In scalar context\n&quot;;</span>
<span class="cp">    return $one_thing;</span>
<span class="cp">} else {</span>
<span class="cp">    print &quot;In void context\n&quot;;</span>
<span class="cp">    return;  # nothing</span>
<span class="cp">}</span>

<span class="cp">mysub();                    # void context</span>

<span class="cp">$a = mysub();               # scalar context</span>
<span class="cp">if (mysub()) {  }           # scalar context</span>

<span class="cp">@a = mysub();               # list context</span>
<span class="cp">print mysub();              # list context</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN557"
>Passing by Named Parameter</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">thefunc(INCREMENT =&gt; &quot;20s&quot;, START =&gt; &quot;+5m&quot;, FINISH =&gt; &quot;+30m&quot;);</span>
<span class="cp">thefunc(START =&gt; &quot;+5m&quot;, FINISH =&gt; &quot;+30m&quot;);</span>
<span class="cp">thefunc(FINISH =&gt; &quot;+30m&quot;);</span>
<span class="cp">thefunc(START =&gt; &quot;+5m&quot;, INCREMENT =&gt; &quot;15s&quot;);</span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub thefunc {</span>
<span class="cp">    my %args = ( </span>
<span class="cp">        INCREMENT   =&gt; &#39;10s&#39;, </span>
<span class="cp">        FINISH      =&gt; 0, </span>
<span class="cp">        START       =&gt; 0, </span>
<span class="cp">        @_,         # argument pair list goes here</span>
<span class="cp">    );</span>
<span class="cp">    if ($args{INCREMENT}  =~ /m$/ ) { ..... }</span>
<span class="cp">} </span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN560"
>Skipping Selected Return Values</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">($a, undef, $c) = func();</span>
<span class="cp">#-----------------------------</span>
<span class="cp">($a, $c) = (func())[0,2];</span>
<span class="cp">#-----------------------------</span>
<span class="cp">($dev,$ino,$DUMMY,$DUMMY,$uid) = stat($filename);</span>
<span class="cp">#-----------------------------</span>
<span class="cp">($dev,$ino,undef,undef,$uid)   = stat($filename);</span>
<span class="cp">#-----------------------------</span>
<span class="cp">($dev,$ino,$uid,$gid)   = (stat($filename))[0,1,4,5];</span>
<span class="cp">#-----------------------------</span>
<span class="cp">() = some_function();</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN563"
>Returning More Than One Array or Hash</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">($array_ref, $hash_ref) = somefunc();</span>

<span class="cp">sub somefunc {</span>
<span class="cp">    my @array;</span>
<span class="cp">    my %hash;</span>

<span class="cp">    # ...</span>

<span class="cp">    return ( \@array, \%hash );</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub fn { </span>
<span class="cp">    .....</span>
<span class="cp">    return (\%a, \%b, \%c); # or                           </span>
<span class="cp">    return \(%a,  %b,  %c); # same thing</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">(%h0, %h1, %h2)  = fn();    # WRONG!</span>
<span class="cp">@array_of_hashes = fn();    # eg: $array_of_hashes[2]-&gt;{&quot;keystring&quot;}</span>
<span class="cp">($r0, $r1, $r2)  = fn();    # eg: $r2-&gt;{&quot;keystring&quot;}</span>

<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN566"
>Returning Failure</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">return;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub empty_retval {</span>
<span class="cp">    return ( wantarray ? () : undef );</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">if (@a = yourfunc()) { ... }</span>
<span class="cp">#-----------------------------</span>
<span class="cp">unless ($a = sfunc()) { die &quot;sfunc failed&quot; }</span>
<span class="cp">unless (@a = afunc()) { die &quot;afunc failed&quot; }</span>
<span class="cp">unless (%a = hfunc()) { die &quot;hfunc failed&quot; }</span>
<span class="cp">#-----------------------------</span>
<span class="cp">ioctl(....) or die &quot;can&#39;t ioctl: $!&quot;;</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN569"
>Prototyping Functions</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">@results = myfunc 3, 5;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@results = myfunc(3, 5);</span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub myfunc($);</span>
<span class="cp">@results = myfunc 3, 5;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@results = ( myfunc(3), 5 );</span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub LOCK_SH () { 1 }</span>
<span class="cp">sub LOCK_EX () { 2 }</span>
<span class="cp">sub LOCK_UN () { 4 }</span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub mypush (\@@) {</span>
<span class="cp">  my $array_ref = shift;</span>
<span class="cp">  my @remainder = @_;</span>

<span class="cp">  # ...</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp"> mypush( $x &gt; 10 ? @a : @b , 3, 5 );          # WRONG</span>
<span class="cp">#-----------------------------</span>
<span class="cp"> mypush( @{ $x &gt; 10 ? \@a : \@b }, 3, 5 );    # RIGHT</span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub hpush(\%@) {</span>
<span class="cp">    my $href = shift;</span>
<span class="cp">    while ( my ($k, $v) = splice(@_, 0, 2) ) {</span>
<span class="cp">        $href-&gt;{$k} = $v;</span>
<span class="cp">    } </span>
<span class="cp">} </span>
<span class="cp">hpush(%pieces, &quot;queen&quot; =&gt; 9, &quot;rook&quot; =&gt; 5);</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN572"
>Handling Exceptions</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">die &quot;some message&quot;;         # raise exception</span>
<span class="cp">#-----------------------------</span>
<span class="cp">eval { func() };</span>
<span class="cp">if ($@) {</span>
<span class="cp">    warn &quot;func raised an exception: $@&quot;;</span>
<span class="cp">} </span>
<span class="cp">#-----------------------------</span>
<span class="cp">eval { $val = func() };</span>
<span class="cp">warn &quot;func blew up: $@&quot; if $@;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">eval { $val = func() };</span>
<span class="cp">if ($@ &amp;&amp; $@ !~ /Full moon!/) {</span>
<span class="cp">    die;    # re-raise unknown errors</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">if (defined wantarray()) {</span>
<span class="cp">        return;</span>
<span class="cp">} else {</span>
<span class="cp">    die &quot;pay attention to my error!&quot;;</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN575"
>Saving Global Values</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">$age = 18;          # global variable</span>
<span class="cp">if (CONDITION) {</span>
<span class="cp">    local $age = 23;</span>
<span class="cp">    func();         # sees temporary value of 23</span>
<span class="cp">} # restore old value at block exit</span>
<span class="cp">#-----------------------------</span>
<span class="cp">$para = get_paragraph(*FH);        # pass filehandle glob </span>
<span class="cp">$para = get_paragraph(\*FH);       # pass filehandle by glob reference</span>
<span class="cp">$para = get_paragraph(*IO{FH});    # pass filehandle by IO reference</span>
<span class="cp">sub get_paragraph {</span>
<span class="cp">    my $fh = shift;  </span>
<span class="cp">    local $/ = &#39;&#39;;        </span>
<span class="cp">    my $paragraph = &lt;$fh&gt;;</span>
<span class="cp">    chomp($paragraph);</span>
<span class="cp">    return $paragraph;</span>
<span class="cp">} </span>
<span class="cp">#-----------------------------</span>
<span class="cp">$contents = get_motd();</span>
<span class="cp">sub get_motd {</span>
<span class="cp">    local *MOTD;</span>
<span class="cp">    open(MOTD, &quot;/etc/motd&quot;)        or die &quot;can&#39;t open motd: $!&quot;;</span>
<span class="cp">    local $/ = undef;  # slurp full file;</span>
<span class="cp">    local $_ = &lt;MOTD&gt;;</span>
<span class="cp">    close (MOTD);</span>
<span class="cp">    return $_;</span>
<span class="cp">} </span>
<span class="cp">#-----------------------------</span>
<span class="cp">return *MOTD;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">my @nums = (0 .. 5);</span>
<span class="cp">sub first { </span>
<span class="cp">    local $nums[3] = 3.14159;</span>
<span class="cp">    second();</span>
<span class="cp">}</span>
<span class="cp">sub second {</span>
<span class="cp">    print &quot;@nums\n&quot;;</span>
<span class="cp">} </span>
<span class="cp">second();</span>
<span class="cp">0 1 2 3 4 5</span>

<span class="cp">first();</span>
<span class="cp">0 1 2 3.14159 4 5</span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub first {</span>
<span class="cp">    local $SIG{INT} = &#39;IGNORE&#39;;</span>
<span class="cp">    second();</span>
<span class="cp">} </span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub func {</span>
<span class="cp">    local($x, $y) = @_;</span>
<span class="cp">    #....</span>
<span class="cp">} </span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub func {</span>
<span class="cp">    my($x, $y) = @_;</span>
<span class="cp">    #....</span>
<span class="cp">} </span>
<span class="cp">#-----------------------------</span>
<span class="cp">&amp;func(*Global_Array);</span>
<span class="cp">sub func {</span>
<span class="cp">    local(*aliased_array) = shift;</span>
<span class="cp">    for (@aliased_array) { .... }</span>
<span class="cp">} </span>
<span class="cp">#-----------------------------</span>
<span class="cp">func(\@Global_Array);</span>
<span class="cp">sub func {</span>
<span class="cp">    my $array_ref  = shift;</span>
<span class="cp">    for (@$array_ref) { .... }</span>
<span class="cp">} </span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN578"
>Redefining a Function</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">undef &amp;grow;                # silence -w complaints of redefinition</span>
<span class="cp">*grow = \&amp;expand;           </span>
<span class="cp">grow();                     # calls expand()</span>

<span class="cp">{</span>
<span class="cp">    local *grow = \&amp;shrink;         # only until this block exists</span>
<span class="cp">        grow();                 # calls shrink()</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">*one::var = \%two::Table;   # make %one::var alias for %two::Table</span>
<span class="cp">*one::big = \&amp;two::small;   # make &amp;one::big alias for &amp;two::small</span>
<span class="cp">#-----------------------------</span>
<span class="cp">local *fred = \&amp;barney;     # temporarily alias &amp;fred to &amp;barney</span>
<span class="cp">#-----------------------------</span>
<span class="cp">$string =  red(&quot;careful here&quot;);</span>
<span class="cp">print $string;</span>
<span class="cp">&lt;FONT COLOR=&#39;red&#39;&gt;careful here&lt;/FONT&gt;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub red { &quot;&lt;FONT COLOR=&#39;red&#39;&gt;@_&lt;/FONT&gt;&quot; }</span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub color_font {</span>
<span class="cp">    my $color = shift;</span>
<span class="cp">    return &quot;&lt;FONT COLOR=&#39;$color&#39;&gt;@_&lt;/FONT&gt;&quot;;</span>
<span class="cp">}</span>
<span class="cp">sub red    { color_font(&quot;red&quot;, @_)     }</span>
<span class="cp">sub green  { color_font(&quot;green&quot;, @_)   }</span>
<span class="cp">sub blue   { color_font(&quot;blue&quot;, @_)    }</span>
<span class="cp">sub purple { color_font(&quot;purple&quot;, @_)  }</span>
<span class="cp"># etc</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@colors = qw(red blue green yellow orange purple violet);</span>
<span class="cp">for my $name (@colors) {</span>
<span class="cp">    no strict &#39;refs&#39;;</span>
<span class="cp">    *$name = sub { &quot;&lt;FONT COLOR=&#39;$name&#39;&gt;@_&lt;/FONT&gt;&quot; };</span>
<span class="cp">} </span>
<span class="cp">#-----------------------------</span>
<span class="cp">*$name = sub ($) { &quot;&lt;FONT COLOR=&#39;$name&#39;&gt;$_[0]&lt;/FONT&gt;&quot; };</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN581"
>Trapping Undefined Function Calls with AUTOLOAD</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">sub AUTOLOAD {</span>
<span class="cp">    use vars qw($AUTOLOAD);</span>
<span class="cp">    my $color = $AUTOLOAD;</span>
<span class="cp">    $color =~ s/.*:://;</span>
<span class="cp">    return &quot;&lt;FONT COLOR=&#39;$color&#39;&gt;@_&lt;/FONT&gt;&quot;;</span>
<span class="cp">} </span>
<span class="cp">#note: sub chartreuse isn&#39;t defined.</span>
<span class="cp">print chartreuse(&quot;stuff&quot;);</span>
<span class="cp">#-----------------------------</span>
<span class="cp">{</span>
<span class="cp">    local *yellow = \&amp;violet;  </span>
<span class="cp">    local (*red, *green) = (\&amp;green, \&amp;red);</span>
<span class="cp">    print_stuff();</span>
<span class="cp">} </span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN584"
>Nesting Subroutines</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">sub outer {</span>
<span class="cp">    my $x = $_[0] + 35;</span>
<span class="cp">    sub inner { return $x * 19 }   # WRONG</span>
<span class="cp">    return $x + inner();</span>
<span class="cp">} </span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub outer {</span>
<span class="cp">    my $x = $_[0] + 35;</span>
<span class="cp">    local *inner = sub { return $x * 19 };</span>
<span class="cp">    return $x + inner();</span>
<span class="cp">} </span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN587"
>Program: Sorting Your Mail</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp"># <font size="-1"><a href="http://pleac.sourceforge.net/include/perl/ch10/bysub1</span>">download the following standalone program</a></font>
<span class="cp">#!/usr/bin/perl </span>
<span class="cp"># bysub1 - simple sort by subject</span>
<span class="cp">my(@msgs, @sub);</span>
<span class="cp">my $msgno = -1;</span>
<span class="cp">$/ = &#39;&#39;;                    # paragraph reads</span>
<span class="cp">while (&lt;&gt;) {</span>
<span class="cp">    if (/^From/m) {</span>
<span class="cp">        /^Subject:\s*(?:Re:\s*)*(.*)/mi;</span>
<span class="cp">        $sub[++$msgno] = lc($1) || &#39;&#39;;</span>
<span class="cp">    }</span>
<span class="cp">    $msgs[$msgno] .= $_;</span>
<span class="cp">} </span>
<span class="cp">for my $i (sort { $sub[$a] cmp $sub[$b] || $a &lt;=&gt; $b } (0 .. $#msgs)) {</span>
<span class="cp">    print $msgs[$i];</span>
<span class="cp">}</span>

<span class="cp">#-----------------------------</span>
<span class="cp"># <font size="-1"><a href="http://pleac.sourceforge.net/include/perl/ch10/bysub2</span>">download the following standalone program</a></font>
<span class="cp">#!/usr/bin/perl -n00</span>
<span class="cp"># bysub2 - awkish sort-by-subject</span>
<span class="cp">BEGIN { $msgno = -1 }</span>
<span class="cp">$sub[++$msgno] = (/^Subject:\s*(?:Re:\s*)*(.*)/mi)[0] if /^From/m;</span>
<span class="cp">$msg[$msgno] .= $_;</span>
<span class="cp">END { print @msg[ sort { $sub[$a] cmp $sub[$b] || $a &lt;=&gt; $b } (0 .. $#msg) ] }</span>

<span class="cp">#-----------------------------</span>
<span class="cp"># <font size="-1"><a href="http://pleac.sourceforge.net/include/perl/ch10/bysub3</span>">download the following standalone program</a></font>
<span class="cp">#!/usr/bin/perl -00</span>
<span class="cp"># bysub3 - sort by subject using hash records</span>
<span class="cp">use strict;</span>
<span class="cp">my @msgs = ();</span>
<span class="cp">while (&lt;&gt;) {</span>
<span class="cp">    push @msgs, {</span>
<span class="cp">        SUBJECT =&gt; /^Subject:\s*(?:Re:\s*)*(.*)/mi,</span>
<span class="cp">        NUMBER  =&gt; scalar @msgs,   # which msgno this is</span>
<span class="cp">        TEXT    =&gt; &#39;&#39;,</span>
<span class="cp">    } if /^From/m;</span>
<span class="cp">    $msgs[-1]{TEXT} .= $_;</span>
<span class="cp">} </span>

<span class="cp">for my $msg (sort {     </span>
<span class="cp">                        $a-&gt;{SUBJECT} cmp $b-&gt;{SUBJECT} </span>
<span class="cp">                                       || </span>
<span class="cp">                        $a-&gt;{NUMBER}  &lt;=&gt; $b-&gt;{NUMBER} </span>
<span class="cp">                  } @msgs</span>
<span class="cp">         )</span>
<span class="cp">{</span>
<span class="cp">    print $msg-&gt;{TEXT};</span>
<span class="cp">} </span>

<span class="cp">#-----------------------------</span>
<span class="cp"># <font size="-1"><a href="http://pleac.sourceforge.net/include/perl/ch10/datesort</span>">download the following standalone program</a></font>
<span class="cp">#!/usr/bin/perl -00</span>
<span class="cp"># datesort - sort mbox by subject then date</span>
<span class="cp">use strict;</span>
<span class="cp">use Date::Manip;</span>
<span class="cp">my @msgs = ();</span>
<span class="cp">while (&lt;&gt;) {</span>
<span class="cp">    next unless /^From/m;</span>
<span class="cp">    my $date = &#39;&#39;;</span>
<span class="cp">    if (/^Date:\s*(.*)/m) {</span>
<span class="cp">        ($date = $1) =~ s/\s+\(.*//;  # library hates (MST)</span>
<span class="cp">        $date = ParseDate($date);</span>
<span class="cp">    } </span>
<span class="cp">    push @msgs, {</span>
<span class="cp">        SUBJECT =&gt; /^Subject:\s*(?:Re:\s*)*(.*)/mi,</span>
<span class="cp">        DATE    =&gt; $date,</span>
<span class="cp">        NUMBER  =&gt; scalar @msgs,</span>
<span class="cp">        TEXT    =&gt; &#39;&#39;,</span>
<span class="cp">    }; </span>
<span class="cp">} continue {</span>
<span class="cp">    $msgs[-1]{TEXT} .= $_;</span>
<span class="cp">}</span>

<span class="cp">for my $msg (sort {     </span>
<span class="cp">                        $a-&gt;{SUBJECT} cmp $b-&gt;{SUBJECT} </span>
<span class="cp">                                       || </span>
<span class="cp">                        $a-&gt;{DATE}    cmp $b-&gt;{DATE} </span>
<span class="cp">                                       || </span>
<span class="cp">                        $a-&gt;{NUMBER}  &lt;=&gt; $b-&gt;{NUMBER} </span>
<span class="cp">                  } @msgs</span>
<span class="cp">         )</span>
<span class="cp">{</span>
<span class="cp">    print $msg-&gt;{TEXT};</span>
<span class="cp">}</span>

<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="directories.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="referencesandrecords.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Directories</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>References and Records</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>