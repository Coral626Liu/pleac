<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Arrays</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="PLEAC-Perl"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="Dates and Times"
HREF="datesandtimes.html"><LINK
REL="NEXT"
TITLE="Hashes"
HREF="hashes.html"><style type="text/css">td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }

  </style></head
><BODY TEXT="#cecece" BGCOLOR="#4f6f6f" LINK="#f5deb3" VLINK="#d5ae83"
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PLEAC-Perl</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="datesandtimes.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="hashes.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="ARRAYS"
>4. Arrays</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN170"
>Introduction</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">@nested = (&quot;this&quot;, &quot;that&quot;, &quot;the&quot;, &quot;other&quot;);</span>
<span class="cp">@nested = (&quot;this&quot;, &quot;that&quot;, (&quot;the&quot;, &quot;other&quot;));</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@tune = ( &quot;The&quot;, &quot;Star-Spangled&quot;, &quot;Banner&quot; );</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN173"
>Specifying a List In Your Program</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">@a = (&quot;quick&quot;, &quot;brown&quot;, &quot;fox&quot;);</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@a = qw(Why are you teasing me?);</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@lines = (&lt;&lt;&quot;END_OF_HERE_DOC&quot; =~ m/^\s*(.+)/gm);</span>
<span class="cp">    The boy stood on the burning deck,</span>
<span class="cp">    It was as hot as glass.</span>
<span class="cp">END_OF_HERE_DOC</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@bigarray = ();</span>
<span class="cp">open(DATA, &quot;&lt; mydatafile&quot;)       or die &quot;Couldn&#39;t read from datafile: $!\n&quot;;</span>
<span class="cp">while (&lt;DATA&gt;) {</span>
<span class="cp">    chomp;</span>
<span class="cp">    push(@bigarray, $_);</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">$banner = &#39;The Mines of Moria&#39;;</span>
<span class="cp">$banner = q(The Mines of Moria);</span>
<span class="cp">#-----------------------------</span>
<span class="cp">$name   =  &quot;Gandalf&quot;;</span>
<span class="cp">$banner = &quot;Speak, $name, and enter!&quot;;</span>
<span class="cp">$banner = qq(Speak, $name, and welcome!);</span>
<span class="cp">#-----------------------------</span>
<span class="cp">$his_host   = &#39;www.perl.com&#39;;</span>
<span class="cp">$host_info  = `nslookup $his_host`; # expand Perl variable</span>

<span class="cp">$perl_info  = qx(ps $$);            # that&#39;s Perl&#39;s $$</span>
<span class="cp">$shell_info = qx&#39;ps $$&#39;;            # that&#39;s the new shell&#39;s $$</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@banner = (&#39;Costs&#39;, &#39;only&#39;, &#39;$4.95&#39;);</span>
<span class="cp">@banner = qw(Costs only $4.95);</span>
<span class="cp">@banner = split(&#39; &#39;, &#39;Costs only $4.95&#39;);</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@brax   = qw! ( ) &lt; &gt; { } [ ] !;</span>
<span class="cp">@rings  = qw(Nenya Narya Vilya);</span>
<span class="cp">@tags   = qw&lt;LI TABLE TR TD A IMG H1 P&gt;;</span>
<span class="cp">@sample = qw(The vertical bar (|) looks and behaves like a pipe.);</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@banner = qw|The vertical bar (\|) looks and behaves like a pipe.|;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@ships  = qw(Niсa Pinta Santa Marнa);               # WRONG</span>
<span class="cp">@ships  = (&#39;Niсa&#39;, &#39;Pinta&#39;, &#39;Santa Marнa&#39;);         # right</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN176"
>Printing a List with Commas</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">sub commify_series {</span>
<span class="cp">    (@_ == 0) ? &#39;&#39;                                      :</span>
<span class="cp">    (@_ == 1) ? $_[0]                                   :</span>
<span class="cp">    (@_ == 2) ? join(&quot; and &quot;, @_)                       :</span>
<span class="cp">                join(&quot;, &quot;, @_[0 .. ($#_-1)], &quot;and $_[-1]&quot;);</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@array = (&quot;red&quot;, &quot;yellow&quot;, &quot;green&quot;);</span>
<span class="cp">print &quot;I have &quot;, @array, &quot; marbles.\n&quot;;</span>
<span class="cp">print &quot;I have @array marbles.\n&quot;;</span>
<span class="cp">I have redyellowgreen marbles.</span>

<span class="cp">I have red yellow green marbles.</span>
<span class="cp">#-----------------------------</span>
<span class="cp"># <font size="-1"><a href="http://pleac.sourceforge.net/include/perl/ch04/commify_series</span>">download the following standalone program</a></font>
<span class="cp">#!/usr/bin/perl -w</span>
<span class="cp"># commify_series - show proper comma insertion in list output</span>

<span class="cp">@lists = (</span>
<span class="cp">    [ &#39;just one thing&#39; ],</span>
<span class="cp">    [ qw(Mutt Jeff) ],</span>
<span class="cp">    [ qw(Peter Paul Mary) ],</span>
<span class="cp">    [ &#39;To our parents&#39;, &#39;Mother Theresa&#39;, &#39;God&#39; ],</span>
<span class="cp">    [ &#39;pastrami&#39;, &#39;ham and cheese&#39;, &#39;peanut butter and jelly&#39;, &#39;tuna&#39; ],</span>
<span class="cp">    [ &#39;recycle tired, old phrases&#39;, &#39;ponder big, happy thoughts&#39; ],</span>
<span class="cp">    [ &#39;recycle tired, old phrases&#39;, </span>
<span class="cp">      &#39;ponder big, happy thoughts&#39;, </span>
<span class="cp">      &#39;sleep and dream peacefully&#39; ],</span>
<span class="cp">    );</span>

<span class="cp">foreach $aref (@lists) {</span>
<span class="cp">    print &quot;The list is: &quot; . commify_series(@$aref) . &quot;.\n&quot;;</span>
<span class="cp">} </span>

<span class="cp">sub commify_series {</span>
<span class="cp">    my $sepchar = grep(/,/ =&gt; @_) ? &quot;;&quot; : &quot;,&quot;;</span>
<span class="cp">    (@_ == 0) ? &#39;&#39;                                      :</span>
<span class="cp">    (@_ == 1) ? $_[0]                                   :</span>
<span class="cp">    (@_ == 2) ? join(&quot; and &quot;, @_)                       :</span>
<span class="cp">                join(&quot;$sepchar &quot;, @_[0 .. ($#_-1)], &quot;and $_[-1]&quot;);</span>
<span class="cp">}</span>

<span class="cp">#-----------------------------</span>
<span class="cp">#The list is: just one thing.</span>
<span class="cp">#</span>
<span class="cp">#The list is: Mutt and Jeff.</span>
<span class="cp">#</span>
<span class="cp">#The list is: Peter, Paul, and Mary.</span>
<span class="cp">#</span>
<span class="cp">#The list is: To our parents, Mother Theresa, and God.</span>
<span class="cp">#</span>
<span class="cp">#The list is: pastrami, ham and cheese, peanut butter and jelly, and tuna.</span>
<span class="cp">#</span>
<span class="cp">#The list is: recycle tired, old phrases and ponder big, happy thoughts.</span>
<span class="cp">#</span>
<span class="cp">#The list is: recycle tired, old phrases; ponder </span>
<span class="cp">#</span>
<span class="cp">#   big, happy thoughts; and sleep and dream peacefully.</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN179"
>Changing Array Size</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp"># grow or shrink @ARRAY</span>
<span class="cp">$#ARRAY = $NEW_LAST_ELEMENT_INDEX_NUMBER;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">$ARRAY[$NEW_LAST_ELEMENT_INDEX_NUMBER] = $VALUE;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub what_about_that_array {</span>
<span class="cp">    print &quot;The array now has &quot;, scalar(@people), &quot; elements.\n&quot;;</span>
<span class="cp">    print &quot;The index of the last element is $#people.\n&quot;;</span>
<span class="cp">    print &quot;Element #3 is `$people[3]&#39;.\n&quot;;</span>
<span class="cp">}</span>

<span class="cp">@people = qw(Crosby Stills Nash Young);</span>
<span class="cp">what_about_that_array();</span>
<span class="cp">#-----------------------------</span>
<span class="cp">The array now has 4 elements.</span>

<span class="cp">The index of the last element is 3.</span>

<span class="cp">Element #3 is `Young&#39;.</span>
<span class="cp">#-----------------------------</span>
<span class="cp">$#people--;</span>
<span class="cp">what_about_that_array();</span>
<span class="cp">#-----------------------------</span>
<span class="cp">The array now has 3 elements.</span>

<span class="cp">The index of the last element is 2.</span>

<span class="cp">Element #3 is `&#39;.</span>
<span class="cp">#-----------------------------</span>
<span class="cp">$#people = 10_000;</span>
<span class="cp">what_about_that_array();</span>
<span class="cp">#-----------------------------</span>
<span class="cp">The array now has 10001 elements.</span>

<span class="cp">The index of the last element is 10000.</span>

<span class="cp">Element #3 is `&#39;.</span>
<span class="cp">#-----------------------------</span>
<span class="cp">$people[10_000] = undef;</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN182"
>Doing Something with Every Element in a List</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">foreach $item (LIST) {</span>
<span class="cp">    # do something with $item</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">foreach $user (@bad_users) {</span>
<span class="cp">        complain($user);</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">foreach $var (sort keys %ENV) {</span>
<span class="cp">    print &quot;$var=$ENV{$var}\n&quot;;</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">foreach $user (@all_users) {</span>
<span class="cp">    $disk_space = get_usage($user);     # find out how much disk space in use</span>
<span class="cp">    if ($disk_space &gt; $MAX_QUOTA) {     # if it&#39;s more than we want ...</span>
<span class="cp">        complain($user);                # ... then object vociferously</span>
<span class="cp">    }</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">foreach (`who`) {</span>
<span class="cp">    if (/tchrist/) {</span>
<span class="cp">        print;</span>
<span class="cp">    }</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">while (&lt;FH&gt;) {              # $_ is set to the line just read</span>
<span class="cp">    chomp;                  # $_ has a trailing \n removed, if it had one</span>
<span class="cp">    foreach (split) {       # $_ is split on whitespace, into @_</span>
<span class="cp">                            # then $_ is set to each chunk in turn</span>
<span class="cp">        $_ = reverse;       # the characters in $_ are reversed</span>
<span class="cp">        print;              # $_ is printed</span>
<span class="cp">    }</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">foreach my $item (@array) {</span>
<span class="cp">    print &quot;i = $item\n&quot;;</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@array = (1,2,3);</span>
<span class="cp">foreach $item (@array) {</span>
<span class="cp">    $item--;</span>
<span class="cp">}</span>
<span class="cp">print &quot;@array\n&quot;;</span>
<span class="cp">0 1 2</span>


<span class="cp"># multiply everything in @a and @b by seven</span>
<span class="cp">@a = ( .5, 3 ); @b =( 0, 1 );</span>
<span class="cp">foreach $item (@a, @b) {</span>
<span class="cp">    $item *= 7;</span>
<span class="cp">}</span>
<span class="cp">print &quot;@a @b\n&quot;;</span>
<span class="cp">3.5 21 0 7</span>
<span class="cp">#-----------------------------</span>
<span class="cp"># trim whitespace in the scalar, the array, and all the values</span>
<span class="cp"># in the hash</span>
<span class="cp">foreach ($scalar, @array, @hash{keys %hash}) {</span>
<span class="cp">    s/^\s+//;</span>
<span class="cp">    s/\s+$//;</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">for $item (@array) {  # same as foreach $item (@array)</span>
<span class="cp">    # do something</span>
<span class="cp">}</span>

<span class="cp">for (@array)      {   # same as foreach $_ (@array)</span>
<span class="cp">    # do something</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN185"
>Iterating Over an Array by Reference</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp"># iterate over elements of array in $ARRAYREF</span>
<span class="cp">foreach $item (@$ARRAYREF) {</span>
<span class="cp">    # do something with $item</span>
<span class="cp">}</span>

<span class="cp">for ($i = 0; $i &lt;= $#$ARRAYREF; $i++) {</span>
<span class="cp">    # do something with $ARRAYREF-&gt;[$i]</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@fruits = ( &quot;Apple&quot;, &quot;Blackberry&quot; );</span>
<span class="cp">$fruit_ref = \@fruits;</span>
<span class="cp">foreach $fruit (@$fruit_ref) {</span>
<span class="cp">    print &quot;$fruit tastes good in a pie.\n&quot;;</span>
<span class="cp">}</span>
<span class="cp">Apple tastes good in a pie.</span>

<span class="cp">Blackberry tastes good in a pie.</span>
<span class="cp">#-----------------------------</span>
<span class="cp">for ($i=0; $i &lt;= $#$fruit_ref; $i++) {</span>
<span class="cp">    print &quot;$fruit_ref-&gt;[$i] tastes good in a pie.\n&quot;;</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">$namelist{felines} = \@rogue_cats;</span>
<span class="cp">foreach $cat ( @{ $namelist{felines} } ) {</span>
<span class="cp">    print &quot;$cat purrs hypnotically..\n&quot;;</span>
<span class="cp">}</span>
<span class="cp">print &quot;--More--\nYou are controlled.\n&quot;;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">for ($i=0; $i &lt;= $#{ $namelist{felines} }; $i++) {</span>
<span class="cp">    print &quot;$namelist{felines}[$i] purrs hypnotically.\n&quot;;</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN188"
>Extracting Unique Elements from a List</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">%seen = ();</span>
<span class="cp">@uniq = ();</span>
<span class="cp">foreach $item (@list) {</span>
<span class="cp">    unless ($seen{$item}) {</span>
<span class="cp">        # if we get here, we have not seen it before</span>
<span class="cp">        $seen{$item} = 1;</span>
<span class="cp">        push(@uniq, $item);</span>
<span class="cp">    }</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">%seen = ();</span>
<span class="cp">foreach $item (@list) {</span>
<span class="cp">    push(@uniq, $item) unless $seen{$item}++;</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">%seen = ();</span>
<span class="cp">foreach $item (@list) {</span>
<span class="cp">    some_func($item) unless $seen{$item}++;</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">%seen = ();</span>
<span class="cp">foreach $item (@list) {</span>
<span class="cp">    $seen{$item}++;</span>
<span class="cp">}</span>
<span class="cp">@uniq = keys %seen;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">%seen = ();</span>
<span class="cp">@uniqu = grep { ! $seen{$_} ++ } @list;</span>
<span class="cp">#-----------------------------</span>
<span class="cp"># generate a list of users logged in, removing duplicates</span>
<span class="cp">%ucnt = ();</span>
<span class="cp">for (`who`) {</span>
<span class="cp">    s/\s.*\n//;   # kill from first space till end-of-line, yielding username</span>
<span class="cp">    $ucnt{$_}++;  # record the presence of this user</span>
<span class="cp">}</span>
<span class="cp"># extract and print unique keys</span>
<span class="cp">@users = sort keys %ucnt;</span>
<span class="cp">print &quot;users logged in: @users\n&quot;;</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN191"
>Finding Elements in One Array but Not Another</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp"># assume @A and @B are already loaded</span>
<span class="cp">%seen = ();                  # lookup table to test membership of B</span>
<span class="cp">@aonly = ();                 # answer</span>

<span class="cp"># build lookup table</span>
<span class="cp">foreach $item (@B) { $seen{$item} = 1 }</span>

<span class="cp"># find only elements in @A and not in @B</span>
<span class="cp">foreach $item (@A) {</span>
<span class="cp">    unless ($seen{$item}) {</span>
<span class="cp">        # it&#39;s not in %seen, so add to @aonly</span>
<span class="cp">        push(@aonly, $item);</span>
<span class="cp">    }</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">my %seen; # lookup table</span>
<span class="cp">my @aonly;# answer</span>

<span class="cp"># build lookup table</span>
<span class="cp">@seen{@B} = ();</span>

<span class="cp">foreach $item (@A) {</span>
<span class="cp">    push(@aonly, $item) unless exists $seen{$item};</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">foreach $item (@A) {</span>
<span class="cp">    push(@aonly, $item) unless $seen{$item};</span>
<span class="cp">    $seen{$item} = 1;                       # mark as seen</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">$hash{&quot;key1&quot;} = 1;</span>
<span class="cp">$hash{&quot;key2&quot;} = 2;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@hash{&quot;key1&quot;, &quot;key2&quot;} = (1,2);</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@seen{@B} = ();</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@seen{@B} = (1) x @B;</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN194"
>Computing Union, Intersection, or Difference of Unique Lists</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">@a = (1, 3, 5, 6, 7, 8);</span>
<span class="cp">@b = (2, 3, 5, 7, 9);</span>

<span class="cp">@union = @isect = @diff = ();</span>
<span class="cp">%union = %isect = ();</span>
<span class="cp">%count = ();</span>
<span class="cp">#-----------------------------</span>
<span class="cp">foreach $e (@a) { $union{$e} = 1 }</span>

<span class="cp">foreach $e (@b) {</span>
<span class="cp">    if ( $union{$e} ) { $isect{$e} = 1 }</span>
<span class="cp">    $union{$e} = 1;</span>
<span class="cp">}</span>
<span class="cp">@union = keys %union;</span>
<span class="cp">@isect = keys %isect;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">foreach $e (@a, @b) { $union{$e}++ &amp;&amp; $isect{$e}++ }</span>

<span class="cp">@union = keys %union;</span>
<span class="cp">@isect = keys %isect;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">foreach $e (@a, @b) { $count{$e}++ }</span>

<span class="cp">foreach $e (keys %count) {</span>
<span class="cp">    push(@union, $e);</span>
<span class="cp">    if ($count{$e} == 2) {</span>
<span class="cp">        push @isect, $e;</span>
<span class="cp">    } else {</span>
<span class="cp">        push @diff, $e;</span>
<span class="cp">    }</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@isect = @diff = @union = ();</span>

<span class="cp">foreach $e (@a, @b) { $count{$e}++ }</span>

<span class="cp">foreach $e (keys %count) {</span>
<span class="cp">    push(@union, $e);</span>
<span class="cp">    push @{ $count{$e} == 2 ? \@isect : \@diff }, $e;</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN197"
>Appending One Array to Another</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp"># push</span>
<span class="cp">push(@ARRAY1, @ARRAY2);</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@ARRAY1 = (@ARRAY1, @ARRAY2);</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@members = (&quot;Time&quot;, &quot;Flies&quot;);</span>
<span class="cp">@initiates = (&quot;An&quot;, &quot;Arrow&quot;);</span>
<span class="cp">push(@members, @initiates);</span>
<span class="cp"># @members is now (&quot;Time&quot;, &quot;Flies&quot;, &quot;An&quot;, &quot;Arrow&quot;)</span>
<span class="cp">#-----------------------------</span>
<span class="cp">splice(@members, 2, 0, &quot;Like&quot;, @initiates);</span>
<span class="cp">print &quot;@members\n&quot;;</span>
<span class="cp">splice(@members, 0, 1, &quot;Fruit&quot;);</span>
<span class="cp">splice(@members, -2, 2, &quot;A&quot;, &quot;Banana&quot;);</span>
<span class="cp">print &quot;@members\n&quot;;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">Time Flies Like An Arrow</span>

<span class="cp">Fruit Flies Like A Banana</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN200"
>Reversing an Array</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp"># reverse @ARRAY into @REVERSED</span>
<span class="cp">@REVERSED = reverse @ARRAY;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">for ($i = $#ARRAY; $i &gt;= 0; $i--) {</span>
<span class="cp">    # do something with $ARRAY[$i]</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp"># two-step: sort then reverse</span>
<span class="cp">@ascending = sort { $a cmp $b } @users;</span>
<span class="cp">@descending = reverse @ascending;</span>

<span class="cp"># one-step: sort with reverse comparison</span>
<span class="cp">@descending = sort { $b cmp $a } @users;</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN203"
>Processing Multiple Elements of an Array</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp"># remove $N elements from front of @ARRAY (shift $N)</span>
<span class="cp">@FRONT = splice(@ARRAY, 0, $N);</span>

<span class="cp"># remove $N elements from the end of the array (pop $N)</span>
<span class="cp">@END = splice(@ARRAY, -$N);</span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub shift2 (\@) {</span>
<span class="cp">    return splice(@{$_[0]}, 0, 2);</span>
<span class="cp">}</span>

<span class="cp">sub pop2 (\@) {</span>
<span class="cp">    return splice(@{$_[0]}, -2);</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@friends = qw(Peter Paul Mary Jim Tim);</span>
<span class="cp">($this, $that) = shift2(@friends);</span>
<span class="cp"># $this contains Peter, $that has Paul, and</span>
<span class="cp"># @friends has Mary, Jim, and Tim</span>

<span class="cp">@beverages = qw(Dew Jolt Cola Sprite Fresca);</span>
<span class="cp">@pair = pop2(@beverages);</span>
<span class="cp"># $pair[0] contains Sprite, $pair[1] has Fresca,</span>
<span class="cp"># and @beverages has (Dew, Jolt, Cola)</span>
<span class="cp">#-----------------------------</span>
<span class="cp">$line[5] = \@list;</span>
<span class="cp">@got = pop2( @{ $line[5] } );</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN206"
>Finding the First List Element That Passes a Test</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">my($match, $found, $item);</span>
<span class="cp">foreach $item (@array) {</span>
<span class="cp">    if ($criterion) {</span>
<span class="cp">        $match = $item;  # must save</span>
<span class="cp">        $found = 1;</span>
<span class="cp">        last;</span>
<span class="cp">    }</span>
<span class="cp">}</span>
<span class="cp">if ($found) {</span>
<span class="cp">    ## do something with $match</span>
<span class="cp">} else {</span>
<span class="cp">    ## unfound</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">my($i, $match_idx);</span>
<span class="cp">for ($i = 0; $i &lt; @array; $i++) {</span>
<span class="cp">    if ($criterion) {</span>
<span class="cp">        $match_idx = $i;    # save the index</span>
<span class="cp">        last;</span>
<span class="cp">    }</span>
<span class="cp">}</span>

<span class="cp">if (defined $match_idx) {</span>
<span class="cp">    ## found in $array[$match_idx]</span>
<span class="cp">} else {</span>
<span class="cp">    ## unfound</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">foreach $employee (@employees) {</span>
<span class="cp">    if ( $employee-&gt;category() eq &#39;engineer&#39; ) {</span>
<span class="cp">        $highest_engineer = $employee;</span>
<span class="cp">        last;</span>
<span class="cp">    }</span>
<span class="cp">}</span>
<span class="cp">print &quot;Highest paid engineer is: &quot;, $highest_engineer-&gt;name(), &quot;\n&quot;;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">for ($i = 0; $i &lt; @ARRAY; $i++) {</span>
<span class="cp">    last if $criterion;</span>
<span class="cp">}</span>
<span class="cp">if ($i &lt; @ARRAY) {</span>
<span class="cp">    ## found and $i is the index</span>
<span class="cp">} else {</span>
<span class="cp">    ## not found</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN209"
>Finding All Elements in an Array Matching Certain Criteria</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">@MATCHING = grep { TEST ($_) } @LIST;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@matching = ();</span>
<span class="cp">foreach (@list) {</span>
<span class="cp">    push(@matching, $_) if TEST ($_);</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@bigs = grep { $_ &gt; 1_000_000 } @nums;</span>
<span class="cp">@pigs = grep { $users{$_} &gt; 1e7 } keys %users;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@matching = grep { /^gnat / } `who`;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@engineers = grep { $_-&gt;position() eq &#39;Engineer&#39; } @employees;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@secondary_assistance = grep { $_-&gt;income &gt;= 26_000 &amp;&amp;</span>
<span class="cp">                               $_-&gt;income &lt;  30_000 }</span>
<span class="cp">                        @applicants;</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN212"
>Sorting an Array Numerically</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">@sorted = sort { $a &lt;=&gt; $b } @unsorted;</span>
<span class="cp">#-----------------------------</span>
<span class="cp"># @pids is an unsorted array of process IDs</span>
<span class="cp">foreach my $pid (sort { $a &lt;=&gt; $b } @pids) {</span>
<span class="cp">    print &quot;$pid\n&quot;;</span>
<span class="cp">}</span>
<span class="cp">print &quot;Select a process ID to kill:\n&quot;;</span>
<span class="cp">chomp ($pid = &lt;&gt;);</span>
<span class="cp">die &quot;Exiting ... \n&quot; unless $pid &amp;&amp; $pid =~ /^\d+$/;</span>
<span class="cp">kill(&#39;TERM&#39;,$pid);</span>
<span class="cp">sleep 2;</span>
<span class="cp">kill(&#39;KILL&#39;,$pid);</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@descending = sort { $b &lt;=&gt; $a } @unsorted;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">package Sort_Subs;</span>
<span class="cp">sub revnum { $b &lt;=&gt; $a }</span>

<span class="cp">package Other_Pack;</span>
<span class="cp">@all = sort Sort_Subs::revnum 4, 19, 8, 3;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@all = sort { $b &lt;=&gt; $a } 4, 19, 8, 3;</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN215"
>Sorting a List by Computable Field</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">@ordered = sort { compare() } @unordered;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@precomputed = map { [compute(),$_] } @unordered;</span>
<span class="cp">@ordered_precomputed = sort { $a-&gt;[0] &lt;=&gt; $b-&gt;[0] } @precomputed;</span>
<span class="cp">@ordered = map { $_-&gt;[1] } @ordered_precomputed;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@ordered = map { $_-&gt;[1] }</span>
<span class="cp">           sort { $a-&gt;[0] &lt;=&gt; $b-&gt;[0] }</span>
<span class="cp">           map { [compute(), $_] }</span>
<span class="cp">           @unordered;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@ordered = sort { $a-&gt;name cmp $b-&gt;name } @employees;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">foreach $employee (sort { $a-&gt;name cmp $b-&gt;name } @employees) {</span>
<span class="cp">    print $employee-&gt;name, &quot; earns \$&quot;, $employee-&gt;salary, &quot;\n&quot;;</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@sorted_employees = sort { $a-&gt;name cmp $b-&gt;name } @employees;</span>
<span class="cp">foreach $employee (@sorted_employees) {</span>
<span class="cp">    print $employee-&gt;name, &quot; earns \$&quot;, $employee-&gt;salary, &quot;\n&quot;;</span>
<span class="cp">}</span>
<span class="cp"># load %bonus</span>
<span class="cp">foreach $employee (@sorted_employees) {</span>
<span class="cp">    if ( $bonus{ $employee-&gt;ssn } ) {</span>
<span class="cp">      print $employee-&gt;name, &quot; got a bonus!\n&quot;;</span>
<span class="cp">    }</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@sorted = sort { $a-&gt;name cmp $b-&gt;name</span>
<span class="cp">                           ||</span>
<span class="cp">                  $b-&gt;age &lt;=&gt; $a-&gt;age } @employees;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">use User::pwent qw(getpwent);</span>
<span class="cp">@users = ();</span>
<span class="cp"># fetch all users</span>
<span class="cp">while (defined($user = getpwent)) {</span>
<span class="cp">    push(@users, $user);</span>
<span class="cp">}</span>
<span class="cp">    @users = sort { $a-&gt;name cmp $b-&gt;name } @users;</span>
<span class="cp">foreach $user (@users) {</span>
<span class="cp">    print $user-&gt;name, &quot;\n&quot;;</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@sorted = sort { substr($a,1,1) cmp substr($b,1,1) } @names;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@sorted = sort { length $a &lt;=&gt; length $b } @strings;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@temp   = map  { [ length $_, $_ ] } @strings;</span>
<span class="cp">@temp   = sort { $a-&gt;[0] &lt;=&gt; $b-&gt;[0] } @temp;</span>
<span class="cp">@sorted = map  { $_-&gt;[1] } @temp;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@sorted = map  { $_-&gt;[1] }</span>
<span class="cp">          sort { $a-&gt;[0] &lt;=&gt; $b-&gt;[0] }</span>
<span class="cp">          map  { [ length $_, $_ ] }</span>
<span class="cp">          @strings;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@temp          = map  { [ /(\d+)/, $_ ] } @fields;</span>
<span class="cp">@sorted_temp   = sort { $a-&gt;[0] &lt;=&gt; $b-&gt;[0] } @temp;</span>
<span class="cp">@sorted_fields = map  { $_-&gt;[1] } @sorted_temp;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">@sorted_fields = map  { $_-&gt;[1] }</span>
<span class="cp">                 sort { $a-&gt;[0] &lt;=&gt; $b-&gt;[0] }</span>
<span class="cp">                 map  { [ /(\d+)/, $_ ] }</span>
<span class="cp">                 @fields;</span>
<span class="cp">#-----------------------------</span>
<span class="cp">print map  { $_-&gt;[0] }             # whole line</span>
<span class="cp">      sort {</span>
<span class="cp">              $a-&gt;[1] &lt;=&gt; $b-&gt;[1]  # gid</span>
<span class="cp">                      ||</span>
<span class="cp">              $a-&gt;[2] &lt;=&gt; $b-&gt;[2]  # uid</span>
<span class="cp">                      ||</span>
<span class="cp">              $a-&gt;[3] cmp $b-&gt;[3]  # login</span>
<span class="cp">      }</span>
<span class="cp">      map  { [ $_, (split /:/)[3,2,0] ] }</span>
<span class="cp">      `cat /etc/passwd`;</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN218"
>Implementing a Circular List</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">unshift(@circular, pop(@circular));  # the last shall be first</span>
<span class="cp">push(@circular, shift(@circular));   # and vice versa</span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub grab_and_rotate ( \@ ) {</span>
<span class="cp">    my $listref = shift;</span>
<span class="cp">    my $element = $listref-&gt;[0];</span>
<span class="cp">    push(@$listref, shift @$listref);</span>
<span class="cp">    return $element;</span>
<span class="cp">}</span>

<span class="cp">@processes = ( 1, 2, 3, 4, 5 );</span>
<span class="cp">while (1) {</span>
<span class="cp">    $process = grab_and_rotate(@processes);</span>
<span class="cp">    print &quot;Handling process $process\n&quot;;</span>
<span class="cp">    sleep 1;</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN221"
>Randomizing an Array</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp"># fisher_yates_shuffle( \@array ) : generate a random permutation</span>
<span class="cp"># of @array in place</span>
<span class="cp">sub fisher_yates_shuffle {</span>
<span class="cp">    my $array = shift;</span>
<span class="cp">    my $i;</span>
<span class="cp">    for ($i = @$array; --$i; ) {</span>
<span class="cp">        my $j = int rand ($i+1);</span>
<span class="cp">        next if $i == $j;</span>
<span class="cp">        @$array[$i,$j] = @$array[$j,$i];</span>
<span class="cp">    }</span>
<span class="cp">}</span>

<span class="cp">fisher_yates_shuffle( \@array );    # permutes @array in place</span>
<span class="cp">#-----------------------------</span>
<span class="cp">$permutations = factorial( scalar @array );</span>
<span class="cp">@shuffle = @array [ n2perm( 1+int(rand $permutations), $#array ) ];</span>
<span class="cp">#-----------------------------</span>
<span class="cp">sub naive_shuffle {                             # don&#39;t do this</span>
<span class="cp">    for (my $i = 0; $i &lt; @_; $i++) {</span>
<span class="cp">        my $j = int rand @_;                    # pick random element</span>
<span class="cp">        ($_[$i], $_[$j]) = ($_[$j], $_[$i]);    # swap &#39;em</span>
<span class="cp">    }</span>
<span class="cp">}</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN224"
>Program: words</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">awk      cp       ed       login    mount    rmdir    sum</span>
<span class="cp">basename csh      egrep    ls       mt       sed      sync</span>
<span class="cp">cat      date     fgrep    mail     mv       sh       tar</span>
<span class="cp">chgrp    dd       grep     mkdir    ps       sort     touch</span>
<span class="cp">chmod    df       kill     mknod    pwd      stty     vi</span>
<span class="cp">chown    echo     ln       more     rm       su</span>
<span class="cp">#-----------------------------</span>
<span class="cp"># <font size="-1"><a href="http://pleac.sourceforge.net/include/perl/ch04/words</span>">download the following standalone program</a></font>
<span class="cp">#!/usr/bin/perl -w</span>
<span class="cp"># words - gather lines, present in columns</span>

<span class="cp">use strict;</span>

<span class="cp">my ($item, $cols, $rows, $maxlen);</span>
<span class="cp">my ($xpixel, $ypixel, $mask, @data);</span>

<span class="cp">getwinsize();</span>

<span class="cp"># first gather up every line of input,</span>
<span class="cp"># remembering the longest line length seen</span>
<span class="cp">$maxlen = 1;        </span>
<span class="cp">while (&lt;&gt;) {</span>
<span class="cp">    my $mylen;</span>
<span class="cp">    s/\s+$//;</span>
<span class="cp">    $maxlen = $mylen if (($mylen = length) &gt; $maxlen);</span>
<span class="cp">    push(@data, $_);</span>
<span class="cp">}</span>

<span class="cp">$maxlen += 1;               # to make extra space</span>

<span class="cp"># determine boundaries of screen</span>
<span class="cp">$cols = int($cols / $maxlen) || 1;</span>
<span class="cp">$rows = int(($#data+$cols) / $cols);</span>

<span class="cp"># pre-create mask for faster computation</span>
<span class="cp">$mask = sprintf(&quot;%%-%ds &quot;, $maxlen-1);</span>

<span class="cp"># subroutine to check whether at last item on line</span>
<span class="cp">sub EOL { ($item+1) % $cols == 0 }  </span>

<span class="cp"># now process each item, picking out proper piece for this position</span>
<span class="cp">for ($item = 0; $item &lt; $rows * $cols; $item++) {</span>
<span class="cp">    my $target =  ($item % $cols) * $rows + int($item/$cols);</span>
<span class="cp">    my $piece = sprintf($mask, $target &lt; @data ? $data[$target] : &quot;&quot;);</span>
<span class="cp">    $piece =~ s/\s+$// if EOL();  # don&#39;t blank-pad to EOL</span>
<span class="cp">    print $piece;</span>
<span class="cp">    print &quot;\n&quot; if EOL();</span>
<span class="cp">}</span>

<span class="cp"># finish up if needed</span>
<span class="cp">print &quot;\n&quot; if EOL();</span>

<span class="cp"># not portable -- linux only</span>
<span class="cp">sub getwinsize {</span>
<span class="cp">    my $winsize = &quot;\0&quot; x 8;</span>
<span class="cp">    my $TIOCGWINSZ = 0x40087468;</span>
<span class="cp">    if (ioctl(STDOUT, $TIOCGWINSZ, $winsize)) {</span>
<span class="cp">        ($rows, $cols, $xpixel, $ypixel) = unpack(&#39;S4&#39;, $winsize);</span>
<span class="cp">    } else {</span>
<span class="cp">        $cols = 80;</span>
<span class="cp">    }</span>
<span class="cp">}</span>

<span class="cp">#-----------------------------</span>
<span class="cp">#Wrong       Right</span>
<span class="cp">#-----       -----</span>
<span class="cp">#1 2 3       1 4 7</span>
<span class="cp">#4 5 6       2 5 8</span>
<span class="cp">#7 8 9       3 6 9</span>
<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN227"
>Program: permute</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="cp"></span><span class="cp">#-----------------------------</span>
<span class="cp">#% echo man bites dog | permute</span>
<span class="cp">#dog bites man</span>
<span class="cp">#</span>
<span class="cp">#bites dog man</span>
<span class="cp">#</span>
<span class="cp">#dog man bites</span>
<span class="cp">#</span>
<span class="cp">#man dog bites</span>
<span class="cp">#</span>
<span class="cp">#bites man dog</span>
<span class="cp">#</span>
<span class="cp">#man bites dog</span>
<span class="cp">#-----------------------------</span>
<span class="cp">#Set Size            Permutations</span>
<span class="cp">#1                   1</span>
<span class="cp">#2                   2</span>
<span class="cp">#3                   6</span>
<span class="cp">#4                   24</span>
<span class="cp">#5                   120</span>
<span class="cp">#6                   720</span>
<span class="cp">#7                   5040</span>
<span class="cp">#8                   40320</span>
<span class="cp">#9                   362880</span>
<span class="cp">#10                  3628800</span>
<span class="cp">#11                  39916800</span>
<span class="cp">#12                  479001600</span>
<span class="cp">#13                  6227020800</span>
<span class="cp">#14                  87178291200</span>
<span class="cp">#15                  1307674368000</span>
<span class="cp">#-----------------------------</span>
<span class="cp">use Math::BigInt;</span>
<span class="cp">    sub factorial {</span>
<span class="cp">    my $n = shift;</span>
<span class="cp">    my $s = 1;</span>
<span class="cp">    $s *= $n-- while $n &gt; 0;</span>
<span class="cp">    return $s;</span>
<span class="cp">}</span>
<span class="cp">print factorial(Math::BigInt-&gt;new(&quot;500&quot;));</span>
<span class="cp">+1220136... (1035 digits total)</span>
<span class="cp">#-----------------------------</span>
<span class="cp"># <font size="-1"><a href="http://pleac.sourceforge.net/include/perl/ch04/permute</span>">download the following standalone program</a></font>
<span class="cp">#!/usr/bin/perl -n</span>
<span class="cp"># tsc_permute: permute each word of input</span>
<span class="cp">permute([split], []);</span>
<span class="cp">sub permute {</span>
<span class="cp">    my @items = @{ $_[0] };</span>
<span class="cp">    my @perms = @{ $_[1] };</span>
<span class="cp">    unless (@items) {</span>
<span class="cp">        print &quot;@perms\n&quot;;</span>
<span class="cp">    } else {</span>
<span class="cp">        my(@newitems,@newperms,$i);</span>
<span class="cp">        foreach $i (0 .. $#items) {</span>
<span class="cp">            @newitems = @items;</span>
<span class="cp">            @newperms = @perms;</span>
<span class="cp">            unshift(@newperms, splice(@newitems, $i, 1));</span>
<span class="cp">            permute([@newitems], [@newperms]);</span>
<span class="cp">        }</span>
<span class="cp">    }</span>
<span class="cp">}</span>

<span class="cp">#-----------------------------</span>
<span class="cp"># <font size="-1"><a href="http://pleac.sourceforge.net/include/perl/ch04/mjd_permute</span>">download the following standalone program</a></font>
<span class="cp">#!/usr/bin/perl -w</span>
<span class="cp"># mjd_permute: permute each word of input</span>
<span class="cp">use strict;</span>

<span class="cp">while (&lt;&gt;) {</span>
<span class="cp">    my @data = split;</span>
<span class="cp">    my $num_permutations = factorial(scalar @data);</span>
<span class="cp">    for (my $i=0; $i &lt; $num_permutations; $i++) {</span>
<span class="cp">        my @permutation = @data[n2perm($i, $#data)];</span>
<span class="cp">        print &quot;@permutation\n&quot;;</span>
<span class="cp">    }</span>
<span class="cp">}</span>

<span class="cp"># Utility function: factorial with memorizing</span>
<span class="cp">BEGIN {</span>
<span class="cp">  my @fact = (1);</span>
<span class="cp">  sub factorial($) {</span>
<span class="cp">      my $n = shift;</span>
<span class="cp">      return $fact[$n] if defined $fact[$n];</span>
<span class="cp">      $fact[$n] = $n * factorial($n - 1);</span>
<span class="cp">  }</span>
<span class="cp">}</span>

<span class="cp"># n2pat($N, $len) : produce the $N-th pattern of length $len</span>
<span class="cp">sub n2pat {</span>
<span class="cp">    my $i   = 1;</span>
<span class="cp">    my $N   = shift;</span>
<span class="cp">    my $len = shift;</span>
<span class="cp">    my @pat;</span>
<span class="cp">    while ($i &lt;= $len + 1) {   # Should really be just while ($N) { ...</span>
<span class="cp">        push @pat, $N % $i;</span>
<span class="cp">        $N = int($N/$i);</span>
<span class="cp">        $i++;</span>
<span class="cp">    }</span>
<span class="cp">    return @pat;</span>
<span class="cp">}</span>

<span class="cp"># pat2perm(@pat) : turn pattern returned by n2pat() into</span>
<span class="cp"># permutation of integers.  XXX: splice is already O(N)</span>
<span class="cp">sub pat2perm {</span>
<span class="cp">    my @pat    = @_;</span>
<span class="cp">    my @source = (0 .. $#pat);</span>
<span class="cp">    my @perm;</span>
<span class="cp">    push @perm, splice(@source, (pop @pat), 1) while @pat;</span>
<span class="cp">    return @perm;</span>
<span class="cp">}</span>

<span class="cp"># n2perm($N, $len) : generate the Nth permutation of S objects</span>
<span class="cp">sub n2perm {</span>
<span class="cp">    pat2perm(n2pat(@_));</span>
<span class="cp">}</span>

<span class="cp">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="datesandtimes.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="hashes.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Dates and Times</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Hashes</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>