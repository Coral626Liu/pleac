<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Hashes</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="PLEAC-Tcl"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="Arrays"
HREF="arrays.html"><LINK
REL="NEXT"
TITLE="Pattern Matching"
HREF="patternmatching.html"><style type="text/css">td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }

  </style></head
><BODY TEXT="#cecece" BGCOLOR="#4f6f6f" LINK="#f5deb3" VLINK="#d5ae83"
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PLEAC-Tcl</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="arrays.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="patternmatching.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="HASHES"
>5. Hashes</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN232"
>Introduction</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s2"></span>

<span class="s2">array set age {</span>
<span class="s2">    Nat   24</span>
<span class="s2">    Jules 25</span>
<span class="s2">    Josh  17</span>
<span class="s2">}</span>
<span class="s2"> </span>
<span class="s2">set age(Nat)   24</span>
<span class="s2">set age(Jules) 25</span>
<span class="s2">set age(Josh)  17</span>

<span class="s2"> </span>
<span class="s2">array set foodColor {</span>
<span class="s2">    Apple   red</span>
<span class="s2">    Banana  yellow</span>
<span class="s2">    Lemon   yellow</span>
<span class="s2">    Carrot  orange</span>
<span class="s2">}</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN235"
>Adding an Element to a Hash</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s2"></span>

<span class="s2">set array(foo) bar</span>
<span class="s2"> </span>
<span class="s2"># or</span>
<span class="s2"> </span>
<span class="s2">set key foo</span>
<span class="s2">set value bar</span>
<span class="s2">set array($key) $value</span>
<span class="s2"> </span>
<span class="s2"># or</span>
<span class="s2"> </span>
<span class="s2">array set array [list $key $value]</span>

<span class="s2"> </span>
<span class="s2"># foodColor defined per the introduction</span>
<span class="s2">set foodColor(Raspberry) pink</span>
<span class="s2">puts &quot;Known foods:&quot;</span>
<span class="s2">foreach food {[array names foodColor]} {</span>
<span class="s2">    puts $food</span>
<span class="s2">}</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN238"
>Testing for the Presence of a Key in a Hash</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s2"></span>

<span class="s2">if {[info exists array($key)]} {</span>
<span class="s2">    # it exists</span>
<span class="s2">} else {</span>
<span class="s2">    # it doesn&#39;t</span>
<span class="s2">}</span>

<span class="s2"> </span>
<span class="s2"># foodColor per the introduction</span>
<span class="s2">foreach name {Banana Martini} {</span>
<span class="s2">    if {[info exists foodColor($name)]} {</span>
<span class="s2">        puts &quot;$name is a food.&quot;</span>
<span class="s2">    } else {</span>
<span class="s2">        puts &quot;$name is a drink.&quot;;</span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2"> </span>
<span class="s2">array unset age</span>
<span class="s2">set age(Toddler)  3</span>
<span class="s2">set age(Unborn)   0</span>
<span class="s2">set age(Phantasm) false</span>

<span class="s2">foreach thing {Toddler Unborn Phantasm Relic} {</span>
<span class="s2">	set result &quot;$thing:&quot;</span>
<span class="s2">	if {[info exists age($thing)]} {</span>
<span class="s2">		append result &quot; Exists&quot;  </span>
<span class="s2">		if {$age($thing)} {</span>
<span class="s2">			append result &quot; True&quot;</span>
<span class="s2">		} </span>
<span class="s2">		if {$age($thing) != 0} {</span>
<span class="s2">			append result &quot; Non-zero&quot;</span>
<span class="s2">		}</span>
<span class="s2">	}</span>
<span class="s2">	puts $result</span>
<span class="s2">} ;# improved by Bob Techentin</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN241"
>Deleting from a Hash</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s2"></span>

<span class="s2"># remove $KEY and its value from ARRAY</span>
<span class="s2">array unset ARRAY $KEY</span>

<span class="s2"># foodColor as per Introduction</span>
<span class="s2">proc print-foods {} {</span>
<span class="s2">    variable foodColor</span>
<span class="s2">    set foods [array names foodColor]</span>
<span class="s2">    set food {}</span>
<span class="s2">     </span>
<span class="s2">    puts &quot;Keys: $foods&quot;</span>
<span class="s2">    puts -nonewline &quot;Values: &quot;</span>
<span class="s2">     </span>
<span class="s2">    foreach food $foods {</span>
<span class="s2">        set color $foodColor($food)</span>
<span class="s2">         </span>
<span class="s2">        if {$color ne {}} {</span>
<span class="s2">            puts -nonewline &quot;$color &quot;</span>
<span class="s2">        } else {</span>
<span class="s2">            puts -nonewline {(empty) }</span>
<span class="s2">        }</span>
<span class="s2">    }</span>
<span class="s2">    puts {}</span>
<span class="s2">}</span>
<span class="s2">puts &quot;Initially:&quot;</span>
<span class="s2">print-foods</span>
<span class="s2">puts &quot;\nWith Banana empty&quot;</span>
<span class="s2">set foodColor(Banana) {}</span>
<span class="s2">print-foods</span>
<span class="s2">puts &quot;\nWith Banana deleted&quot;</span>
<span class="s2">array unset foodColor Banana</span>
<span class="s2">print-foods</span>
<span class="s2"># =&gt; Initially:</span>
<span class="s2"># =&gt; Keys: Banana Apple Carrot Lemon</span>
<span class="s2"># =&gt; Values: yellow red orange yellow </span>
<span class="s2"># =&gt; </span>
<span class="s2"># =&gt; With Banana empty</span>
<span class="s2"># =&gt; Keys: Banana Apple Carrot Lemon</span>
<span class="s2"># =&gt; Values: (empty) red orange yellow </span>
<span class="s2"># =&gt; </span>
<span class="s2"># =&gt; With Banana deleted</span>
<span class="s2"># =&gt; Keys: Apple Carrot Lemon</span>
<span class="s2"># =&gt; Values: red orange yellow </span>

<span class="s2"># several members can be deleted in one</span>
<span class="s2"># go if their names match a glob pattern,</span>
<span class="s2"># otherwise the [array unset] command must</span>
<span class="s2"># be called once for each name.</span>
<span class="s2">array unset foodColor ?a*</span>
<span class="s2">print-foods</span>
<span class="s2"># =&gt; Keys: Apple Lemon</span>
<span class="s2"># =&gt; Values: red yellow </span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN244"
>Traversing a Hash</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s2"></span>

<span class="s2">foreach {key value} [array get ARRAY] {</span>
<span class="s2">    # do something with $key and $value</span>
<span class="s2">}</span>

<span class="s2"># another way</span>
<span class="s2">set searchId [array startsearch ARRAY]</span>
<span class="s2">while {[set key [array nextelement ARRAY $searchId]] ne {}} {</span>
<span class="s2">    set value $ARRAY($key)</span>
<span class="s2">    # do something with $key and $value</span>
<span class="s2">}</span>

<span class="s2">foreach {food color} [array get foodColor] {</span>
<span class="s2">    puts &quot;$food is $color.&quot;</span>
<span class="s2">}</span>
<span class="s2"># =&gt; Banana is yellow.</span>
<span class="s2"># =&gt; Apple is red.</span>
<span class="s2"># =&gt; Carrot is orange.</span>
<span class="s2"># =&gt; Lemon is yellow.</span>

<span class="s2">set searchId [array startsearch foodColor]</span>
<span class="s2">while {[set food [array nextelement foodColor $searchId]] ne {}} {</span>
<span class="s2">    set color $foodColor($food)</span>
<span class="s2">    puts &quot;$food is $color.&quot;</span>
<span class="s2">}</span>
<span class="s2"># =&gt; Banana is yellow.</span>
<span class="s2"># =&gt; Apple is red.</span>
<span class="s2"># =&gt; Carrot is orange.</span>
<span class="s2"># =&gt; Lemon is yellow.</span>


<span class="s2"># countfrom - count number of messages from each sender</span>
<span class="s2">if {[llength $argv] &gt; 0} {</span>
<span class="s2">    if {[catch {set f [open [lindex $argv 0]]} err]} {</span>
<span class="s2">        error $err</span>
<span class="s2">    }</span>
<span class="s2">} else {</span>
<span class="s2">    set f stdin</span>
<span class="s2">}</span>
<span class="s2"> </span>
<span class="s2">while {[gets $f line] &gt;= 0} {</span>
<span class="s2">    if {[regexp {^From: (.*)} $line --&gt; name]} {</span>
<span class="s2">        if {[info exists from($name)]} {</span>
<span class="s2">            incr from($name)</span>
<span class="s2">        } else {</span>
<span class="s2">            set from($name) 1</span>
<span class="s2">        }</span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2">if {[array size from] == 0} {</span>
<span class="s2">    puts &quot;No senders found&quot;</span>
<span class="s2">    exit</span>
<span class="s2">}</span>
<span class="s2"> </span>
<span class="s2">foreach person [lsort [array names from]] {</span>
<span class="s2">    puts &quot;$person: $from($person)&quot;</span>
<span class="s2">}</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN247"
>Printing a Hash</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s2"></span>

<span class="s2"># print each member of the array...</span>
<span class="s2">foreach {k v} [array get ARRAY] {</span>
<span class="s2">    puts &quot;$k =&gt; $v&quot;</span>
<span class="s2">}</span>

<span class="s2"># ...or print all of it at once...</span>
<span class="s2">puts [array get ARRAY]</span>

<span class="s2"># ...or copy it to a list variable and print that...</span>
<span class="s2">set temp [array get ARRAY]</span>
<span class="s2">puts $temp</span>

<span class="s2"># ...or use the inspection command [parray]</span>
<span class="s2">parray ARRAY</span>

<span class="s2"># print with sorted keys</span>
<span class="s2">foreach {k} [lsort [array names ARRAY]] {</span>
<span class="s2">    puts &quot;$k =&gt; $ARRAY($k)&quot;</span>
<span class="s2">}</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN250"
>Retrieving from a Hash in Insertion Order</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s2"></span><span class="s2"># @@INCOMPLETE@@</span>
<span class="s2"># @@INCOMPLETE@@</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN253"
>Hashes with Multiple Values Per Key</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s2"></span>

<span class="s2"># A list is a string in Tcl, so there is</span>
<span class="s2"># no problem storing multiple values as an</span>
<span class="s2"># array (&quot;hash&quot;) item.</span>



<span class="s2">array set ttys [list]</span>
<span class="s2"> </span>
<span class="s2">set WHO [open &quot;|who&quot;]</span>
<span class="s2">while {[gets $WHO line] &gt; -1} {</span>
<span class="s2">    foreach {user tty} [split $line] break</span>
<span class="s2">    lappend ttys($user) $tty</span>
<span class="s2">}</span>
<span class="s2">close $WHO</span>
<span class="s2"> </span>
<span class="s2">foreach user [lsort [array names ttys]] {</span>
<span class="s2">    puts &quot;$user: $ttys($user)&quot;</span>
<span class="s2">}</span>

<span class="s2"># dummy code; there is no getpwuid command</span>
<span class="s2">foreach user [lsort [array names ttys]] {</span>
<span class="s2">    puts &quot;$user: [llength $ttys($user)] ttys.&quot;</span>
<span class="s2">     </span>
<span class="s2">    foreach tty [lsort $ttys($user)] {</span>
<span class="s2">        if {![catch {file stat /dev/$tty stat}]} {</span>
<span class="s2">            set user [lindex [getpwuid $stat(uid)] 0]</span>
<span class="s2">        } else {</span>
<span class="s2">            set user &quot;(not available)&quot;</span>
<span class="s2">        }</span>
<span class="s2">        puts &quot;\t$tty (owned by $user)&quot; </span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2">proc multihash_delete {arrayname key value} {</span>
<span class="s2">    upvar $arrayname array</span>
<span class="s2">    set i {}</span>
<span class="s2">     </span>
<span class="s2">    set len [llength $array($key)]</span>
<span class="s2">    for {set i 0} {$i &lt; $len} {incr i} {</span>
<span class="s2">        if {[lindex $array($key) $i] eq $value} {</span>
<span class="s2">            lset array($key) [lreplace $array($key) $i $i]</span>
<span class="s2">            break</span>
<span class="s2">        }</span>
<span class="s2">    }</span>
<span class="s2">     </span>
<span class="s2">    if {[llength $array($key)] &lt;= 0} {</span>
<span class="s2">        array unset array $key</span>
<span class="s2">    }</span>
<span class="s2">}</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN256"
>Inverting a Hash</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s2"></span><span class="s2">#-----------------------------</span>
<span class="s2">package require struct 1.4</span>
<span class="s2">array set REVERSE [::struct::list reverse [array get LOOKUP]]</span>
<span class="s2">#-----------------------------</span>

<span class="s2"># foodfind - find match for food or color</span>
<span class="s2">package require struct 1.4</span>
<span class="s2">proc foodfind foodOrColor {</span>
<span class="s2">	array set color {</span>
<span class="s2">		Apple	red</span>
<span class="s2">		Banana	yellow</span>
<span class="s2">		Lemon	yellow</span>
<span class="s2">		Carrot	orange</span>
<span class="s2">	}</span>
<span class="s2">	array set food [::struct::list reverse [array get color]]</span>
<span class="s2">	if {[info exists color($foodOrColor)]} {</span>
<span class="s2">		puts &quot;$foodOrColor is a food with color $color($foodOrColor).&quot;</span>
<span class="s2">	}</span>
<span class="s2">	if {[info exists food($foodOrColor)]} {</span>
<span class="s2">		puts &quot;$food($foodOrColor) is a food with color $foodOrColor.&quot;</span>
<span class="s2">	}</span>
<span class="s2">}</span>

<span class="s2">foreach {f c} [array get color] {</span>
<span class="s2">	lappend food($c) $f</span>
<span class="s2">}</span>
<span class="s2">puts &quot;[join $food(yellow)] were yellow foods.&quot;</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN259"
>Sorting a Hash</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s2"></span><span class="s2">#-----------------------------</span>
<span class="s2"># a is the array to sort</span>
<span class="s2">set keys [lsort OPTIONS [array names a]]</span>
<span class="s2">foreach key $keys {</span>
<span class="s2">	set value $a($key)</span>
<span class="s2">	# do something with $key, $value</span>
<span class="s2">}</span>
<span class="s2">#-----------------------------</span>
<span class="s2">foreach food [lsort [array names foodColor]] {</span>
<span class="s2">	puts &quot;$food is $foodColor($food).&quot;</span>
<span class="s2">}</span>
<span class="s2">#-----------------------------</span>
<span class="s2">proc sortFoods {a b} {</span>
<span class="s2">	expr {[string length $a] - [string length $b]}</span>
<span class="s2">}</span>
<span class="s2">foreach food [lsort -command sortFoods [array names foodColor]] {</span>
<span class="s2">	lappend foods $food</span>
<span class="s2">}</span>
<span class="s2">foreach food $foods {</span>
<span class="s2">	puts &quot;$food is $foodColor($food).&quot;</span>
<span class="s2">}</span>
<span class="s2">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN262"
>Merging Hashes</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s2"></span><span class="s2">#-----------------------------</span>
<span class="s2">array set merged [concat [array get A] [array get B]]</span>
<span class="s2">#-----------------------------</span>
<span class="s2">array unset merged</span>
<span class="s2">foreach {k v} [array get A] {</span>
<span class="s2">	set merged($k) $v</span>
<span class="s2">}</span>
<span class="s2">foreach {k v} [array get B] {</span>
<span class="s2">	set merged($k) $v</span>
<span class="s2">}</span>
<span class="s2">#-----------------------------</span>
<span class="s2"># foodColor as per the introduction</span>
<span class="s2">array set drinkColor {</span>
<span class="s2">	Galliano	yellow</span>
<span class="s2">	&quot;Mai Tai&quot;	blue</span>
<span class="s2">}</span>
<span class="s2">array set ingestedColor [concat [array get drinkColor] [array get foodColor]]</span>
<span class="s2">#-----------------------------</span>
<span class="s2"># foodColor per the introduction, then</span>
<span class="s2">array set drinkColor {</span>
<span class="s2">	Galliano	yellow</span>
<span class="s2">	&quot;Mai Tai&quot;	blue</span>
<span class="s2">}</span>
<span class="s2">array unset ingestedColor</span>
<span class="s2">foreach {k v} [array get foodColor] {</span>
<span class="s2">	set ingestedColor($k) $v</span>
<span class="s2">}</span>
<span class="s2">foreach {k v} [array get drinkColor] {</span>
<span class="s2">	set ingestedColor($k) $v</span>
<span class="s2">}</span>
<span class="s2">#-----------------------------</span>
<span class="s2">foreach substanceref {foodColor drinkColor} {</span>
<span class="s2">	foreach {k v} [array get $substanceref] {</span>
<span class="s2">		set substanceColor($k) $v</span>
<span class="s2">	}</span>
<span class="s2">}</span>
<span class="s2">#-----------------------------</span>
<span class="s2">foreach substanceref {foodColor drinkColor} {</span>
<span class="s2">	foreach {k v} [array get $substanceref] {</span>
<span class="s2">		if {[info exists substanceColor($k)]} {</span>
<span class="s2">			puts &quot;Warning: $k seen twice.  Using the first definition.&quot;</span>
<span class="s2">			continue</span>
<span class="s2">		}</span>
<span class="s2">		set substanceColor($k) $v</span>
<span class="s2">	}</span>
<span class="s2">}</span>

<span class="s2">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN265"
>Finding Common or Different Keys in Two Hashes</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s2"></span><span class="s2">#-----------------------------</span>
<span class="s2">set common {}</span>
<span class="s2">foreach k [array names arr1] {</span>
<span class="s2">	if {[info exists arr2($k)]} {</span>
<span class="s2">		lappend common $k</span>
<span class="s2">	}</span>
<span class="s2">}</span>
<span class="s2"># common now contains common keys</span>
<span class="s2">#-----------------------------</span>
<span class="s2">set thisNotThat {}</span>
<span class="s2">foreach k [array names arr1] {</span>
<span class="s2">	if {![info exists arr2($k)]} {</span>
<span class="s2">		lappend thisNotThat $k</span>
<span class="s2">	}</span>
<span class="s2">}</span>
<span class="s2">#-----------------------------</span>
<span class="s2"># foodColor per the introduction</span>

<span class="s2"># citrusColor is an array mapping citrus food name to its color.</span>
<span class="s2">array set citrusColor {</span>
<span class="s2">	Lemon	yellow</span>
<span class="s2">	Orange	orange</span>
<span class="s2">	Lime	green</span>
<span class="s2">}</span>

<span class="s2"># build up a list of non-citrus foods</span>
<span class="s2">set nonCitrus {}</span>

<span class="s2">foreach k [array names foodColor] {</span>
<span class="s2">	if {![info exists citrusColor($k)]} {</span>
<span class="s2">		lappend nonCitrus $k</span>
<span class="s2">	}</span>
<span class="s2">}</span>
<span class="s2">#-----------------------------</span>

<span class="s2">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN268"
>Hashing References</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s2"></span><span class="s2">#-----------------------------</span>

<span class="s2"># @@INCOMPLETE@@</span>
<span class="s2"># @@INCOMPLETE@@</span>

<span class="s2">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN271"
>Presizing a Hash</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s2"></span><span class="s2">#-----------------------------</span>

<span class="s2"># @@INCOMPLETE@@</span>
<span class="s2"># @@INCOMPLETE@@</span>

<span class="s2">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN274"
>Finding the Most Common Anything</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s2"></span><span class="s2">#-----------------------------</span>

<span class="s2">array unset count</span>
<span class="s2">foreach element $LIST {</span>
<span class="s2">	if {![info exists count($element)]} {</span>
<span class="s2">		set count($element) 1</span>
<span class="s2">	} else {</span>
<span class="s2">		incr count($element)</span>
<span class="s2">	}</span>
<span class="s2">}</span>

<span class="s2">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN277"
>Representing Relationships Between Data</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s2"></span><span class="s2">#-----------------------------</span>

<span class="s2">array set father {</span>
<span class="s2">	Cain		Adam</span>
<span class="s2">	Abel		Adam</span>
<span class="s2">	Seth		Adam</span>
<span class="s2">	Enoch		Cain</span>
<span class="s2">	Irad		Enoch</span>
<span class="s2">	Mehujael	Irad</span>
<span class="s2">	Methusael	Mehujael</span>
<span class="s2">	Lamech		Methusael</span>
<span class="s2">	Jabal		Lamech</span>
<span class="s2">	Jubal		Lamech</span>
<span class="s2">	Tubalcain	Lamech</span>
<span class="s2">	Enos		Seth</span>
<span class="s2">}</span>
<span class="s2">#-----------------------------</span>
<span class="s2">foreach name {Adam Tubalcain Elvis Enos} {</span>
<span class="s2">	set fathers {}</span>
<span class="s2">	while {[info exists father($name)]} {    ;# if &lt;name&gt; has a father</span>
<span class="s2">		lappend fathers $name            ;# add it to the list</span>
<span class="s2">		set name $father($name)         ;# and check the father&#39;s father</span>
<span class="s2">	}</span>
<span class="s2">	puts $fathers</span>
<span class="s2">}</span>
<span class="s2">#-----------------------------</span>

<span class="s2">foreach {k v} [array get father] {</span>
<span class="s2">	lappend children($v) $k</span>
<span class="s2">}</span>
<span class="s2">set sep {, }                ;# separate output with commas</span>
<span class="s2">foreach name {Adam Tubalcain Elvis Lamech} {</span>
<span class="s2">	if {[info exists children($name)] &amp;&amp; [llength children($name)]} {</span>
<span class="s2">		set res $children($name)</span>
<span class="s2">	} else {</span>
<span class="s2">		set res nobody</span>
<span class="s2">	}</span>
<span class="s2">	puts &quot;$name begat [join $res $sep]&quot;</span>
<span class="s2">}</span>
<span class="s2">#-----------------------------</span>

<span class="s2">foreach file $files {</span>
<span class="s2">	if {[catch {open $file} F]} {</span>
<span class="s2">		puts stderr &quot;Couldn&#39;t read $file: $F; skipping.&quot;</span>
<span class="s2">		continue</span>
<span class="s2">	}</span>
<span class="s2">	while {[gets $F line] &gt;= 0} {</span>
<span class="s2">		if {![regexp {^\s*#\s*include\s*&lt;([^&gt;]+)&gt;} $line --&gt; name]} {</span>
<span class="s2">			continue</span>
<span class="s2">		}</span>
<span class="s2">		lappend includes($name) $file</span>
<span class="s2">	}</span>
<span class="s2">	close $F</span>
<span class="s2">}</span>
<span class="s2">#-----------------------------</span>

<span class="s2">set includeFree {}                  ;# list of files that don&#39;t include others</span>
<span class="s2">foreach k [array names includes] {</span>
<span class="s2">	set uniq($k) {}</span>
<span class="s2">}</span>
<span class="s2">forech file [lsort [array names uniq]] {</span>
<span class="s2">	if {![info exists includes($file)]} {</span>
<span class="s2">		lappend includeFree $file</span>
<span class="s2">	}</span>
<span class="s2">}</span>

<span class="s2">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN280"
>Program: dutree</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s2"></span><span class="s2">#-----------------------------</span>

<span class="s2"># @@INCOMPLETE@@</span>
<span class="s2"># @@INCOMPLETE@@</span>

<span class="s2">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="arrays.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="patternmatching.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Arrays</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Pattern Matching</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>