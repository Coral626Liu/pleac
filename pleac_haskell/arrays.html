<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Arrays</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="PLEAC-Haskell"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="Dates and Times"
HREF="datesandtimes.html"><LINK
REL="NEXT"
TITLE="Hashes"
HREF="hashes.html"><style type="text/css">td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }

  </style></head
><BODY TEXT="#cecece" BGCOLOR="#4f6f6f" LINK="#f5deb3" VLINK="#d5ae83"
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PLEAC-Haskell</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="datesandtimes.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="hashes.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="ARRAYS"
>4. Arrays</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN170"
>Introduction</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="nf">single_level</span> <span class="ow">=</span> <span class="p">[</span> <span class="s">&quot;this&quot;</span><span class="p">,</span> <span class="s">&quot;that&quot;</span><span class="p">,</span> <span class="s">&quot;the&quot;</span><span class="p">,</span> <span class="s">&quot;other&quot;</span> <span class="p">]</span>

<span class="c1">-- there is no non-homogeneous list. You can do things with tuples:</span>
<span class="nf">nested</span> <span class="ow">=</span> <span class="p">(</span><span class="s">&quot;this&quot;</span><span class="p">,</span> <span class="s">&quot;that&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;the&quot;</span><span class="p">,</span> <span class="s">&quot;other&quot;</span><span class="p">])</span> <span class="c1">-- (String, String, [String])</span>

<span class="c1">-- arrays are generally eschewed in Haskell, lists are prefered.</span>
<span class="c1">-- arrays are useful if you desperately need:</span>
<span class="c1">-- * huge amounts of raw data.</span>
<span class="c1">-- * constant (O(1)) lookup =&gt; use Data.Array</span>
<span class="c1">-- * constant (O(1)) update =&gt; use Data.Array.IO, Data.Array.ST or Data.Array.Storable</span>
<span class="c1">--                             (or even Data.Array.Diff)</span>
<span class="c1">-- see http://haskell.org/haskellwiki/Cookbook#Arrays</span>
<span class="c1">-- and http://www.haskell.org/haskellwiki/Modern_array_libraries for more</span>

<span class="c1">-- creating an Array from a list:</span>
<span class="kr">import</span> <span class="nn">Data.Array</span>
<span class="nf">listToArray</span> <span class="ow">::</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="kt">Array</span> <span class="kt">Int</span> <span class="n">a</span>
<span class="nf">listToArray</span> <span class="n">l</span> <span class="ow">=</span> <span class="n">listArray</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span> <span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="n">l</span>

<span class="nf">a1</span> <span class="ow">=</span> <span class="n">listToArray</span> <span class="n">l1</span>
<span class="c1">-- =&gt; array (0,3) [(0,&quot;Crosby&quot;),(1,&quot;Stills&quot;),(2,&quot;Nash&quot;),(3,&quot;Young&quot;)]</span>

<span class="c1">-- getting back the list</span>
<span class="nf">l1&#39;</span> <span class="ow">=</span> <span class="n">elems</span> <span class="n">a1</span>


<span class="c1">-- creating an IOArray from a list:</span>
<span class="kr">import</span> <span class="nn">Data.Array.IO</span>
<span class="nf">listToIOArray</span> <span class="ow">::</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="kt">IO</span> <span class="p">(</span><span class="kt">IOArray</span> <span class="kt">Int</span> <span class="n">a</span><span class="p">)</span>
<span class="nf">listToIOArray</span> <span class="n">l</span> <span class="ow">=</span> <span class="n">newListArray</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span> <span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="n">l</span>

<span class="nf">a1</span> <span class="ow">=</span> <span class="n">listToIOArray</span> <span class="n">l1</span>

<span class="nf">l1&#39;</span> <span class="ow">=</span> <span class="n">a1</span> <span class="o">&gt;&gt;=</span> <span class="n">getElems</span> </PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN173"
>Specifying a List In Your Program</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="nf">a</span>  <span class="ow">=</span> <span class="p">[</span> <span class="s">&quot;quick&quot;</span><span class="p">,</span> <span class="s">&quot;brown&quot;</span><span class="p">,</span> <span class="s">&quot;fox&quot;</span> <span class="p">]</span>
<span class="nf">a&#39;</span> <span class="ow">=</span> <span class="n">words</span> <span class="s">&quot;Why are you teasing me?&quot;</span>

<span class="nf">l</span> <span class="ow">=</span> <span class="n">lines</span> 
      <span class="s">&quot;The boy stood on the burning deck</span><span class="se">\n\</span>
<span class="se">      \</span><span class="s">It was as hot as glass.&quot;</span>

<span class="nf">big_array</span> <span class="ow">=</span> <span class="kr">do</span> <span class="n">s</span> <span class="ow">&lt;-</span> <span class="n">readFile</span> <span class="s">&quot;mydatafile&quot;</span>
               <span class="n">return</span> <span class="p">(</span><span class="n">lines</span> <span class="n">s</span><span class="p">)</span>
<span class="c1">-- more compact:</span>
<span class="nf">big_array</span> <span class="ow">=</span> <span class="n">fmap</span> <span class="n">lines</span> <span class="p">(</span><span class="n">readFile</span> <span class="s">&quot;mydatafile&quot;</span><span class="p">)</span>


<span class="c1">-- using readProcess from &quot;Helpers&quot;</span>
<span class="nf">his_host</span> <span class="ow">=</span> <span class="s">&quot;www.haskell.org&quot;</span>
<span class="nf">host_info</span> <span class="ow">=</span> <span class="kr">do</span> <span class="kt">Right</span> <span class="n">info</span> <span class="ow">&lt;-</span> <span class="n">readProcess</span> <span class="s">&quot;nslookup&quot;</span> <span class="p">[</span><span class="n">his_host</span><span class="p">]</span> <span class="s">&quot;&quot;</span>
               <span class="n">return</span> <span class="n">info</span>

<span class="c1">-- calling ps on our running process</span>
<span class="kr">import</span> <span class="nn">System</span>
<span class="kr">import</span> <span class="nn">System.Posix</span> <span class="p">(</span><span class="nf">getProcessID</span><span class="p">)</span>

<span class="nf">t</span> <span class="ow">=</span> <span class="kr">do</span> <span class="n">id</span> <span class="ow">&lt;-</span> <span class="n">getProcessID</span>
       <span class="n">system</span> <span class="p">(</span><span class="s">&quot;ps &quot;</span> <span class="o">++</span> <span class="n">show</span> <span class="n">id</span><span class="p">)</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN176"
>Printing a List with Commas</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="kr">import</span> <span class="nn">Data.List</span>
<span class="nf">commify_series</span> <span class="ow">::</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="kt">String</span>
<span class="nf">commify_series</span> <span class="kt">[]</span>  <span class="ow">=</span> <span class="s">&quot;&quot;</span>
<span class="nf">commify_series</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>  <span class="ow">=</span> <span class="n">x</span>
<span class="nf">commify_series</span> <span class="n">xs</span>  <span class="ow">=</span> <span class="n">intercalate</span> <span class="s">&quot;, &quot;</span> <span class="p">(</span><span class="n">init</span> <span class="n">xs</span><span class="p">)</span> <span class="o">++</span> <span class="s">&quot; and &quot;</span> <span class="o">++</span> <span class="p">(</span><span class="n">last</span> <span class="n">xs</span><span class="p">)</span>

<span class="nf">array</span> <span class="ow">=</span> <span class="p">[</span><span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="s">&quot;yellow&quot;</span><span class="p">,</span> <span class="s">&quot;green&quot;</span><span class="p">]</span>
<span class="nf">s1</span> <span class="ow">=</span> <span class="s">&quot;I have &quot;</span> <span class="o">++</span> <span class="n">commify_series</span> <span class="n">array</span> <span class="o">++</span> <span class="s">&quot; marbles&quot;</span> <span class="c1">-- I have red, yellow and green marbles</span>
<span class="nf">s2</span> <span class="ow">=</span> <span class="s">&quot;I have &quot;</span> <span class="o">++</span> <span class="n">concat</span>  <span class="n">array</span> <span class="o">++</span> <span class="s">&quot; marbles&quot;</span> <span class="c1">-- I have redyellowgreen marbles</span>
<span class="nf">s3</span> <span class="ow">=</span> <span class="s">&quot;I have &quot;</span> <span class="o">++</span> <span class="n">unwords</span> <span class="n">array</span> <span class="o">++</span> <span class="s">&quot; marbles&quot;</span> <span class="c1">-- I have red yellow green marbles</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN179"
>Changing Array Size</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">-- arrays can&#39;t be resized</span>
<span class="c1">-- similar behaviour for lists explained below</span>

<span class="nf">what_about_that_list</span> <span class="n">x</span> <span class="ow">=</span> <span class="n">unlines</span>
    <span class="p">[</span> <span class="s">&quot;The list now has &quot;</span> <span class="o">++</span> <span class="n">show</span> <span class="p">(</span><span class="n">length</span> <span class="n">x</span><span class="p">)</span> <span class="o">++</span> <span class="s">&quot; elements.&quot;</span>
    <span class="p">,</span> <span class="s">&quot;The index of the last element is &quot;</span> <span class="o">++</span> <span class="n">show</span> <span class="p">(</span><span class="n">length</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">++</span> <span class="s">&quot;.&quot;</span>
    <span class="p">,</span> <span class="s">&quot;Element .3 is`&quot;</span> <span class="o">++</span> <span class="n">x</span><span class="o">!!</span><span class="mi">3</span> <span class="o">++</span> <span class="s">&quot;&#39;.&quot;</span>
    <span class="p">]</span>

<span class="nf">l1</span> <span class="ow">=</span> <span class="p">[</span> <span class="s">&quot;Crosby&quot;</span><span class="p">,</span> <span class="s">&quot;Stills&quot;</span><span class="p">,</span> <span class="s">&quot;Nash&quot;</span><span class="p">,</span> <span class="s">&quot;Young&quot;</span> <span class="p">]</span>

<span class="c1">-- remove last element</span>
<span class="nf">l2</span> <span class="ow">=</span> <span class="n">init</span> <span class="n">l1</span>    <span class="c1">-- [&quot;Crosby&quot;, &quot;Stills&quot;, &quot;Nash&quot;]</span>

<span class="c1">-- keep 3 elements</span>
<span class="nf">l3</span> <span class="ow">=</span> <span class="n">take</span> <span class="mi">3</span> <span class="n">l1</span>  <span class="c1">-- [&quot;Crosby&quot;, &quot;Stills&quot;, &quot;Nash&quot;]</span>

<span class="c1">-- calling what_about_that_list on l2 or l3 would raise</span>
<span class="c1">--   *** Exception: Prelude.(!!): index too large</span>
<span class="c1">-- when accessing element .3</span>

<span class="c1">-- grow list</span>
<span class="nf">l4</span> <span class="ow">=</span> <span class="n">take</span> <span class="mi">10001</span> <span class="p">(</span><span class="n">l1</span> <span class="o">++</span> <span class="n">repeat</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="c1">-- same, but much less haskell&#39;ish, prefer above</span>
<span class="nf">l4&#39;</span> <span class="ow">=</span> <span class="n">l1</span> <span class="o">++</span> <span class="n">replicate</span> <span class="p">(</span><span class="mi">10001</span> <span class="o">-</span> <span class="n">length</span> <span class="n">l1</span><span class="p">)</span> <span class="s">&quot;&quot;</span>

<span class="c1">-- writing a function that grow and shrink a list is easy:</span>
<span class="nf">resize_list</span> <span class="n">n</span> <span class="n">default_val</span> <span class="n">l</span> <span class="ow">=</span> <span class="n">take</span> <span class="n">n</span> <span class="p">(</span><span class="n">l</span> <span class="o">++</span> <span class="n">repeat</span> <span class="n">default_val</span><span class="p">)</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN182"
>Doing Something with Every Element in a List</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="nf">bad_users</span> <span class="ow">=</span> <span class="n">filter</span> <span class="n">is_valid_user</span> <span class="n">all_users</span>

<span class="nf">t</span> <span class="ow">=</span> <span class="n">mapM_</span> <span class="n">complain</span> <span class="n">bad_users</span>

<span class="nf">t&#39;</span> <span class="ow">=</span> <span class="n">mapM_</span> <span class="n">do_it</span> <span class="n">all_users</span>
    <span class="kr">where</span> <span class="n">do_it</span> <span class="n">user</span> <span class="ow">=</span> <span class="kr">do</span> <span class="n">usage</span> <span class="ow">&lt;-</span> <span class="n">get_usage</span> <span class="n">user</span>
                          <span class="n">when</span> <span class="p">(</span><span class="n">usage</span> <span class="o">&gt;</span> <span class="n">max_quota</span><span class="p">)</span> <span class="p">(</span><span class="n">complain</span> <span class="n">user</span><span class="p">)</span>

<span class="c1">-- equivalent of &quot;env | sort&quot;</span>
<span class="kr">import</span> <span class="nn">System.Environment</span>
<span class="kr">import</span> <span class="nn">List</span>
<span class="nf">t</span> <span class="ow">=</span> <span class="n">getEnvironment</span> <span class="o">&gt;&gt;=</span> <span class="n">putStr</span> <span class="o">.</span> <span class="n">format</span>
    <span class="kr">where</span> <span class="n">format</span> <span class="ow">=</span> <span class="n">unlines</span> <span class="o">.</span> <span class="n">map</span> <span class="p">(</span><span class="nf">\</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="n">var</span> <span class="o">++</span> <span class="s">&quot;=&quot;</span> <span class="o">++</span> <span class="n">val</span><span class="p">)</span> <span class="o">.</span> <span class="n">sort</span>

<span class="c1">-- display lines from &quot;who&quot; matching &quot;simonpj&quot; (readProcess is in &quot;Helpers&quot;)</span>
<span class="nf">t</span> <span class="ow">=</span> <span class="kr">do</span> <span class="kt">Right</span> <span class="n">s</span> <span class="ow">&lt;-</span> <span class="n">readProcess</span> <span class="s">&quot;who&quot;</span> <span class="kt">[]</span> <span class="s">&quot;&quot;</span>
       <span class="n">mapM_</span> <span class="n">putStrLn</span> <span class="p">(</span><span class="n">filter</span> <span class="p">(</span><span class="s">&quot;simonpj&quot;</span> <span class="p">`</span><span class="n">isPrefixOf</span><span class="p">`)</span> <span class="o">$</span> <span class="n">lines</span> <span class="n">s</span><span class="p">)</span>

<span class="c1">-- print file with words reversed:</span>
<span class="nf">t</span> <span class="ow">=</span> <span class="n">readFile</span> <span class="s">&quot;/etc/fstab&quot;</span> <span class="o">&gt;&gt;=</span> <span class="n">putStr</span> <span class="o">.</span> <span class="n">reverse_words_of_each_line</span>
    <span class="kr">where</span> <span class="n">reverse_words_of_each_line</span> <span class="ow">=</span> <span class="n">unlines</span> <span class="o">.</span> <span class="n">map</span> <span class="p">(</span><span class="n">unwords</span> <span class="o">.</span> <span class="n">reverse</span> <span class="o">.</span> <span class="n">words</span><span class="p">)</span> <span class="o">.</span> <span class="n">lines</span>

<span class="c1">-- modify every element</span>
<span class="nf">l</span> <span class="ow">=</span> <span class="n">map</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span><span class="p">)</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>          <span class="c1">-- [0,1,2]</span>

<span class="c1">-- multiply everything in a and b by seven</span>
<span class="nf">l</span> <span class="ow">=</span> <span class="p">[</span> <span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="p">[</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">3</span> <span class="p">]),</span> <span class="p">(</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="p">])</span> <span class="p">]</span>
<span class="nf">l&#39;</span> <span class="ow">=</span> <span class="n">map</span> <span class="p">(</span><span class="nf">\</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">xs</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">map</span> <span class="p">(</span><span class="o">*</span> <span class="mi">7</span><span class="p">)</span> <span class="n">xs</span><span class="p">))</span> <span class="n">l</span>
<span class="c1">-- =&gt; [ (&quot;a&quot;, [ 3.5, 21 ]), (&quot;b&quot;, [ 0, 7 ]) ]</span>
<span class="c1">-- same using Arrow.second</span>
<span class="nf">l_&#39;</span> <span class="ow">=</span> <span class="n">map</span> <span class="p">(</span><span class="kt">Arrow</span><span class="o">.</span><span class="n">second</span> <span class="o">$</span> <span class="n">map</span> <span class="p">(</span><span class="o">*</span> <span class="mi">7</span><span class="p">))</span> <span class="n">l</span>
<span class="c1">-- for a more cryptic version, replace Arrow.second with fmap</span>

<span class="c1">-- same using Data.Map</span>
<span class="kr">import</span> <span class="k">qualified</span> <span class="nn">Data.Map</span> <span class="k">as</span> <span class="n">Map</span>
<span class="nf">m</span> <span class="ow">=</span> <span class="kt">Map</span><span class="o">.</span><span class="n">fromList</span> <span class="p">[</span> <span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="p">[</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">3</span> <span class="p">]),</span> <span class="p">(</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="p">])</span> <span class="p">]</span>
<span class="nf">m&#39;</span> <span class="ow">=</span> <span class="kt">Map</span><span class="o">.</span><span class="n">map</span> <span class="p">(</span><span class="n">map</span> <span class="p">(</span><span class="o">*</span> <span class="mi">7</span><span class="p">))</span> <span class="n">m</span> </PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN185"
>Iterating Over an Array by Reference</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">-- not relevant in haskell since we have always kind of references</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN188"
>Extracting Unique Elements from a List</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="nf">l</span> <span class="ow">=</span> <span class="n">nub</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span> <span class="p">]</span>  <span class="c1">-- [ 1, 2, 3, 5 ]</span>

<span class="c1">-- generate a list of users logged in, removing duplicates (readProcess is in &quot;Helpers&quot;)</span>
<span class="nf">t</span> <span class="ow">=</span> <span class="kr">do</span> <span class="kt">Right</span> <span class="n">s</span> <span class="ow">&lt;-</span> <span class="n">readProcess</span> <span class="s">&quot;who&quot;</span> <span class="kt">[]</span> <span class="s">&quot;&quot;</span>
       <span class="kr">let</span> <span class="n">users</span> <span class="ow">=</span> <span class="n">sort</span> <span class="o">$</span> <span class="n">nub</span> <span class="o">$</span> <span class="n">map</span> <span class="p">(</span><span class="n">head</span> <span class="o">.</span> <span class="n">words</span><span class="p">)</span> <span class="o">$</span> <span class="n">lines</span> <span class="n">s</span>
       <span class="n">putStrLn</span> <span class="p">(</span><span class="s">&quot;users logged in: &quot;</span> <span class="o">++</span> <span class="n">unwords</span> <span class="n">users</span><span class="p">)</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN191"
>Finding Elements in One Array but Not Another</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="nf">l</span> <span class="ow">=</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span> <span class="p">]</span> <span class="o">\\</span> <span class="p">[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span> <span class="p">]</span>         <span class="c1">-- [ 2 ]</span>

<span class="c1">-- beware of duplicates:</span>
<span class="nf">xs</span> <span class="ow">=</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span> <span class="p">]</span>
<span class="nf">ys</span> <span class="ow">=</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span> <span class="p">]</span>
<span class="nf">l1</span> <span class="ow">=</span> <span class="n">xs</span> <span class="o">\\</span> <span class="n">ys</span>                   <span class="c1">-- [ 1, 3, 3, 5 ]</span>
<span class="nf">l2</span> <span class="ow">=</span> <span class="n">nub</span> <span class="n">xs</span> <span class="o">\\</span> <span class="n">ys</span>               <span class="c1">-- [ 3, 5 ]</span>
<span class="nf">l3</span> <span class="ow">=</span> <span class="n">filter</span> <span class="p">(`</span><span class="n">notElem</span><span class="p">`</span> <span class="n">ys</span><span class="p">)</span> <span class="n">xs</span>   <span class="c1">-- [ 3, 3, 5 ]</span>

<span class="c1">-- for faster operations, use Data.Set:</span>
<span class="kr">import</span> <span class="k">qualified</span> <span class="nn">Data.Set</span> <span class="k">as</span> <span class="n">Set</span>
<span class="nf">l</span> <span class="ow">=</span> <span class="n">filter</span> <span class="p">(`</span><span class="kt">Set</span><span class="o">.</span><span class="n">notMember</span><span class="p">`</span> <span class="kt">Set</span><span class="o">.</span><span class="n">fromList</span> <span class="p">[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span> <span class="p">])</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span> <span class="p">]</span>
<span class="c1">-- =&gt; [ 2 ]</span>

<span class="nf">s1</span> <span class="ow">=</span> <span class="kt">Set</span><span class="o">.</span><span class="n">fromList</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span> <span class="p">]</span>
<span class="nf">s2</span> <span class="ow">=</span> <span class="kt">Set</span><span class="o">.</span><span class="n">fromList</span> <span class="p">[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span> <span class="p">]</span>
<span class="nf">s3</span> <span class="ow">=</span> <span class="kt">Set</span><span class="o">.\\</span> <span class="n">s1</span> <span class="n">s2</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN194"
>Computing Union, Intersection, or Difference of Unique Lists</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="nf">a</span> <span class="ow">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
<span class="nf">b</span> <span class="ow">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>

<span class="nf">l1</span> <span class="ow">=</span> <span class="n">a</span> <span class="p">`</span><span class="n">intersect</span><span class="p">`</span> <span class="n">b</span>            <span class="c1">-- [ 3, 5, 7 ]</span>
<span class="nf">l2</span> <span class="ow">=</span> <span class="n">a</span> <span class="p">`</span><span class="n">union</span><span class="p">`</span> <span class="n">b</span>                <span class="c1">-- [ 1, 3, 5, 6, 7, 8, 2, 9 ]</span>
<span class="nf">l3</span> <span class="ow">=</span> <span class="n">a</span> <span class="o">\\</span> <span class="n">b</span>                     <span class="c1">-- [ 1, 6, 8 ]</span>

<span class="c1">-- see also union and intersection in Data.Set</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN197"
>Appending One Array to Another</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="nf">l</span> <span class="ow">=</span> <span class="p">[</span> <span class="s">&quot;Time&quot;</span><span class="p">,</span> <span class="s">&quot;Flies&quot;</span> <span class="p">]</span>
<span class="nf">l2</span> <span class="ow">=</span> <span class="n">l</span> <span class="o">++</span> <span class="p">[</span> <span class="s">&quot;An&quot;</span><span class="p">,</span> <span class="s">&quot;Arrow&quot;</span> <span class="p">]</span>   <span class="c1">-- [&quot;Time&quot;, &quot;Flies&quot;, &quot;An&quot;, &quot;Arrow&quot;]</span>

<span class="nf">insertAt</span> <span class="n">n</span> <span class="n">e</span> <span class="n">l</span> <span class="ow">=</span> <span class="n">before</span> <span class="o">++</span> <span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">++</span> <span class="n">after</span>
    <span class="kr">where</span> <span class="p">(</span><span class="n">before</span><span class="p">,</span> <span class="n">after</span><span class="p">)</span> <span class="ow">=</span> <span class="n">splitAt</span> <span class="n">n</span> <span class="n">l</span>

<span class="nf">l3</span> <span class="ow">=</span> <span class="n">insertAt</span> <span class="mi">2</span> <span class="s">&quot;Like&quot;</span> <span class="n">l2</span> <span class="c1">-- [&quot;Time&quot;, &quot;Flies&quot;, &quot;Like&quot;, &quot;An&quot;, &quot;Arrow&quot;]</span>

<span class="nf">replaceAt</span> <span class="n">n</span> <span class="n">e</span> <span class="n">l</span> <span class="ow">=</span> <span class="n">before</span> <span class="o">++</span> <span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">++</span> <span class="n">tail</span> <span class="n">after</span>
    <span class="kr">where</span> <span class="p">(</span><span class="n">before</span><span class="p">,</span> <span class="n">after</span><span class="p">)</span> <span class="ow">=</span> <span class="n">splitAt</span> <span class="n">n</span> <span class="n">l</span>

<span class="nf">replaceAllAt</span> <span class="n">assoc</span> <span class="n">l</span> <span class="ow">=</span> <span class="n">foldr</span> <span class="p">(</span><span class="nf">\</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="n">replaceAt</span> <span class="n">n</span> <span class="n">e</span><span class="p">)</span> <span class="n">l</span> <span class="n">assoc</span>

<span class="nf">l4</span> <span class="ow">=</span> <span class="n">replaceAt</span> <span class="mi">0</span> <span class="s">&quot;Fruit&quot;</span> <span class="n">l3</span>
<span class="nf">l5</span> <span class="ow">=</span> <span class="n">replaceAllAt</span> <span class="p">[</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s">&quot;A&quot;</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s">&quot;Banana&quot;</span><span class="p">)</span> <span class="p">]</span> <span class="n">l4</span>
<span class="c1">-- =&gt; [&quot;Fruit&quot;, &quot;Flies&quot;, &quot;Like&quot;, &quot;A&quot;, &quot;Banana&quot;]</span>

<span class="c1">-- arrays are better suited for modifying an element,</span>
<span class="c1">-- but arrays are not suited for adding elements</span>
<span class="c1">-- (using listToArray from &quot;Helpers&quot;)</span>
<span class="nf">l3&#39;</span> <span class="ow">=</span> <span class="n">listToArray</span> <span class="n">l3</span>
<span class="nf">l4&#39;</span> <span class="ow">=</span> <span class="n">l3&#39;</span> <span class="kt">Array</span><span class="o">.//</span> <span class="p">[</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Fruit&quot;</span><span class="p">)</span> <span class="p">]</span>
<span class="nf">l5&#39;</span> <span class="ow">=</span> <span class="n">l4&#39;</span> <span class="kt">Array</span><span class="o">.//</span> <span class="p">[</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s">&quot;A&quot;</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s">&quot;Banana&quot;</span><span class="p">)</span> <span class="p">]</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN200"
>Reversing an Array</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="nf">l</span> <span class="ow">=</span> <span class="n">reverse</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">5</span><span class="p">]</span>       <span class="c1">-- [5,4,3,2,1]</span>

<span class="nf">reverse_sort</span>   <span class="ow">=</span> <span class="n">reverse</span> <span class="o">.</span> <span class="n">sort</span>
<span class="nf">reverse_sort&#39;</span>  <span class="ow">=</span> <span class="n">sortBy</span> <span class="p">(</span><span class="nf">\</span><span class="n">a</span> <span class="n">b</span> <span class="ow">-&gt;</span> <span class="n">b</span> <span class="o">&lt;=&gt;</span> <span class="n">a</span><span class="p">)</span>
<span class="nf">reverse_sort&#39;&#39;</span> <span class="ow">=</span> <span class="n">sortBy</span> <span class="p">(</span><span class="n">flip</span> <span class="p">(</span><span class="o">&lt;=&gt;</span><span class="p">))</span>

<span class="nf">l</span> <span class="ow">=</span> <span class="n">reverse_sort</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>      <span class="c1">-- [5,3,2,1]</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN203"
>Processing Multiple Elements of an Array</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">-- remove n elements from front of array</span>
<span class="p">(</span><span class="n">front</span><span class="p">,</span><span class="n">array&#39;</span><span class="p">)</span> <span class="ow">=</span> <span class="n">splitAt</span> <span class="n">array</span> <span class="n">n</span>

<span class="c1">-- remove n elements from the end of array</span>
<span class="p">(</span><span class="n">array&#39;</span><span class="p">,</span><span class="n">end</span><span class="p">)</span>  <span class="ow">=</span> <span class="n">splitAt</span> <span class="n">array</span> <span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">length</span> <span class="n">array</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span>

<span class="p">(</span><span class="n">this</span> <span class="kt">:</span> <span class="n">that</span> <span class="kt">:</span> <span class="n">friends&#39;</span><span class="p">)</span> <span class="ow">=</span> <span class="p">[</span> <span class="s">&quot;Peter&quot;</span><span class="p">,</span> <span class="s">&quot;Paul&quot;</span><span class="p">,</span> <span class="s">&quot;Mary&quot;</span><span class="p">,</span> <span class="s">&quot;Jim&quot;</span><span class="p">,</span> <span class="s">&quot;Tim&quot;</span> <span class="p">]</span>
<span class="c1">-- this contains &quot;Peter&quot;, that has &quot;Paul&quot;, and friends&#39; has &quot;Mary&quot;, &quot;Jim&quot;, and &quot;Tim&quot;</span>

<span class="nf">beverages</span> <span class="ow">=</span> <span class="n">words</span> <span class="s">&quot;Dew Jolt Cola Sprite Fresca&quot;</span>
<span class="p">(</span><span class="n">beverages&#39;</span><span class="p">,</span> <span class="n">pair</span><span class="p">)</span> <span class="ow">=</span> <span class="n">splitAt</span> <span class="p">(</span><span class="n">length</span> <span class="n">beverages</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="n">beverages</span> 
<span class="c1">-- pair contains [&quot;Sprite&quot;, &quot;Fresca&quot;]</span>
<span class="c1">-- and beverages&#39; has [&quot;Dew&quot;, &quot;Jolt&quot;, &quot;Cola&quot;]</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN206"
>Finding the First List Element That Passes a Test</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="kr">data</span> <span class="kt">Employee</span> <span class="ow">=</span> <span class="kt">Employee</span> <span class="p">{</span> <span class="n">name</span><span class="p">,</span> <span class="n">position</span> <span class="ow">::</span> <span class="kt">String</span>
                         <span class="p">,</span> <span class="n">salary</span> <span class="ow">::</span> <span class="kt">Int</span> <span class="p">}</span> <span class="kr">deriving</span> <span class="p">(</span><span class="kt">Show</span><span class="p">,</span><span class="kt">Eq</span><span class="p">)</span>

<span class="nf">employees</span> <span class="ow">=</span> <span class="p">[</span> <span class="kt">Employee</span> <span class="p">{</span> <span class="n">name</span><span class="ow">=</span><span class="s">&quot;Jim&quot;</span><span class="p">,</span>  <span class="n">position</span><span class="ow">=</span><span class="s">&quot;Manager&quot;</span><span class="p">,</span>  <span class="n">salary</span><span class="ow">=</span><span class="mi">26000</span> <span class="p">}</span>
            <span class="p">,</span> <span class="kt">Employee</span> <span class="p">{</span> <span class="n">name</span><span class="ow">=</span><span class="s">&quot;Jill&quot;</span><span class="p">,</span> <span class="n">position</span><span class="ow">=</span><span class="s">&quot;Engineer&quot;</span><span class="p">,</span> <span class="n">salary</span><span class="ow">=</span><span class="mi">24000</span> <span class="p">}</span>
            <span class="p">,</span> <span class="kt">Employee</span> <span class="p">{</span> <span class="n">name</span><span class="ow">=</span><span class="s">&quot;Jack&quot;</span><span class="p">,</span> <span class="n">position</span><span class="ow">=</span><span class="s">&quot;Engineer&quot;</span><span class="p">,</span> <span class="n">salary</span><span class="ow">=</span><span class="mi">22000</span> <span class="p">}</span> <span class="p">]</span>

<span class="p">(</span><span class="kt">Just</span> <span class="n">engineer</span><span class="p">)</span> <span class="ow">=</span> <span class="n">find</span> <span class="p">((</span><span class="o">==</span> <span class="s">&quot;Engineer&quot;</span><span class="p">)</span> <span class="o">.</span> <span class="n">position</span><span class="p">)</span> <span class="n">employees</span>

<span class="nf">s</span> <span class="ow">=</span> <span class="n">name</span> <span class="n">engineer</span> <span class="o">++</span> <span class="s">&quot; is engineer&quot;</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN209"
>Finding All Elements in an Array Matching Certain Criteria</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="nf">bigs</span> <span class="ow">=</span> <span class="n">filter</span> <span class="p">(</span><span class="o">&gt;</span> <span class="mi">1000000</span><span class="p">)</span> <span class="n">nums</span>

<span class="c1">-- display lines from &quot;who&quot; matching &quot;simonpj&quot; (readProcess is in &quot;Helpers&quot;)</span>
<span class="nf">t</span> <span class="ow">=</span> <span class="kr">do</span> <span class="kt">Right</span> <span class="n">s</span> <span class="ow">&lt;-</span> <span class="n">readProcess</span> <span class="s">&quot;who&quot;</span> <span class="kt">[]</span> <span class="s">&quot;&quot;</span>
       <span class="n">mapM_</span> <span class="n">putStrLn</span> <span class="p">(</span><span class="n">filter</span> <span class="p">(</span><span class="s">&quot;simonpj&quot;</span> <span class="p">`</span><span class="n">isPrefixOf</span><span class="p">`)</span> <span class="o">$</span> <span class="n">lines</span> <span class="n">s</span><span class="p">)</span>

<span class="c1">-- using employees defined in previous section</span>
<span class="nf">engineers</span>  <span class="ow">=</span> <span class="p">[</span> <span class="n">x</span> <span class="o">|</span> <span class="n">x</span> <span class="ow">&lt;-</span> <span class="n">employees</span><span class="p">,</span> <span class="n">position</span> <span class="n">x</span> <span class="o">==</span> <span class="s">&quot;Engineer&quot;</span><span class="p">]</span>
<span class="nf">engineers&#39;</span> <span class="ow">=</span> <span class="n">filter</span> <span class="p">((</span><span class="o">==</span> <span class="s">&quot;Engineer&quot;</span><span class="p">)</span> <span class="o">.</span> <span class="n">position</span><span class="p">)</span> <span class="n">employees</span>
<span class="c1">-- =&gt; [ Employee { name=&quot;Jill&quot;, ... }, Employee { name=&quot;Jack&quot;, ... } ]</span>

<span class="nf">secondary_assistance</span> <span class="ow">=</span> <span class="n">filter</span> <span class="p">((</span><span class="nf">\</span><span class="n">x</span> <span class="ow">-&gt;</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">26000</span> <span class="o">&amp;&amp;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">30000</span><span class="p">)</span> <span class="o">.</span> <span class="n">salary</span><span class="p">)</span> <span class="n">employees</span>
<span class="c1">-- =&gt; [ Employee { name=&quot;Jim&quot;, position=&quot;Manager&quot;, salary=26000 } ]</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN212"
>Sorting an Array Numerically</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">-- sort works for numbers</span>
<span class="nf">l1</span> <span class="ow">=</span> <span class="n">sort</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>          <span class="c1">-- [3, 20, 100]</span>
<span class="c1">-- strings representing numbers will be sorted alphabetically</span>
<span class="nf">l2</span> <span class="ow">=</span> <span class="n">sort</span> <span class="p">[</span><span class="s">&quot;100&quot;</span><span class="p">,</span> <span class="s">&quot;3&quot;</span><span class="p">,</span> <span class="s">&quot;20&quot;</span><span class="p">]</span>    <span class="c1">-- [&quot;100&quot;, &quot;20&quot;, &quot;3&quot;]</span>

<span class="c1">-- you may specify another sort method (not lexicographic ordering):</span>
<span class="c1">-- for comparing: import Data.Ord (comparing)</span>
<span class="nf">l3</span> <span class="ow">=</span> <span class="n">sortBy</span> <span class="p">(</span><span class="n">comparing</span> <span class="p">(</span><span class="n">read</span> <span class="ow">::</span> <span class="kt">String</span> <span class="ow">-&gt;</span> <span class="kt">Int</span><span class="p">))</span> <span class="p">[</span><span class="s">&quot;100&quot;</span><span class="p">,</span> <span class="s">&quot;3&quot;</span><span class="p">,</span> <span class="s">&quot;20&quot;</span><span class="p">]</span> <span class="c1">-- [&quot;3&quot;, &quot;20&quot;, &quot;100&quot;]</span>
<span class="c1">-- same, but may typically run faster</span>
<span class="nf">sortByKey</span> <span class="n">f</span> <span class="ow">=</span> <span class="n">map</span> <span class="n">snd</span> <span class="o">.</span> <span class="n">sortBy</span> <span class="p">(</span><span class="n">comparing</span> <span class="n">fst</span><span class="p">)</span> <span class="o">.</span> <span class="n">map</span> <span class="p">(</span><span class="nf">\</span><span class="n">x</span> <span class="ow">-&gt;</span> <span class="p">(</span><span class="n">f</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
<span class="nf">l3&#39;</span> <span class="ow">=</span> <span class="n">sortByKey</span> <span class="p">(</span><span class="n">read</span> <span class="ow">::</span> <span class="kt">String</span> <span class="ow">-&gt;</span> <span class="kt">Int</span><span class="p">)</span> <span class="p">[</span><span class="s">&quot;100&quot;</span><span class="p">,</span> <span class="s">&quot;3&quot;</span><span class="p">,</span> <span class="s">&quot;20&quot;</span><span class="p">]</span>

<span class="c1">-- more cryptic: replace (\x -&gt; (f x, x)) with (f Arrow.&amp;&amp;&amp; id)</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN215"
>Sorting a List by Computable Field</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="kr">data</span> <span class="kt">Employee</span> <span class="ow">=</span> <span class="kt">Employee</span> <span class="p">{</span> <span class="n">name</span><span class="p">,</span> <span class="n">position</span> <span class="ow">::</span> <span class="kt">String</span>
                         <span class="p">,</span> <span class="n">salary</span> <span class="ow">::</span> <span class="kt">Int</span> <span class="p">}</span> <span class="kr">deriving</span> <span class="p">(</span><span class="kt">Show</span><span class="p">,</span><span class="kt">Eq</span><span class="p">)</span>

<span class="nf">employees</span> <span class="ow">=</span> <span class="p">[</span> <span class="kt">Employee</span> <span class="p">{</span> <span class="n">name</span><span class="ow">=</span><span class="s">&quot;Jim&quot;</span><span class="p">,</span>  <span class="n">position</span><span class="ow">=</span><span class="s">&quot;Manager&quot;</span><span class="p">,</span>  <span class="n">salary</span><span class="ow">=</span><span class="mi">26000</span> <span class="p">}</span>
            <span class="p">,</span> <span class="kt">Employee</span> <span class="p">{</span> <span class="n">name</span><span class="ow">=</span><span class="s">&quot;Jill&quot;</span><span class="p">,</span> <span class="n">position</span><span class="ow">=</span><span class="s">&quot;Engineer&quot;</span><span class="p">,</span> <span class="n">salary</span><span class="ow">=</span><span class="mi">24000</span> <span class="p">}</span>
            <span class="p">,</span> <span class="kt">Employee</span> <span class="p">{</span> <span class="n">name</span><span class="ow">=</span><span class="s">&quot;Jack&quot;</span><span class="p">,</span> <span class="n">position</span><span class="ow">=</span><span class="s">&quot;Engineer&quot;</span><span class="p">,</span> <span class="n">salary</span><span class="ow">=</span><span class="mi">22000</span> <span class="p">}</span> <span class="p">]</span>

<span class="nf">employee_sorted</span> <span class="ow">=</span> <span class="n">sortBy</span> <span class="p">(</span><span class="n">comparing</span> <span class="n">name</span><span class="p">)</span> <span class="n">employees</span>
<span class="c1">-- =&gt; [ Employee { name=&quot;Jack&quot;, ... }, Employee { name=&quot;Jill&quot;, ... }, Employee { name=&quot;Jim&quot;, ... } ]</span>

<span class="nf">sortByKey</span> <span class="n">f</span> <span class="ow">=</span> <span class="n">map</span> <span class="n">snd</span> <span class="o">.</span> <span class="n">sortBy</span> <span class="p">(</span><span class="n">comparing</span> <span class="n">fst</span><span class="p">)</span> <span class="o">.</span> <span class="n">map</span> <span class="p">(</span><span class="nf">\</span><span class="n">x</span> <span class="ow">-&gt;</span> <span class="p">(</span><span class="n">f</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
<span class="nf">sortByKeyRev</span> <span class="n">f</span> <span class="ow">=</span> <span class="n">map</span> <span class="n">snd</span> <span class="o">.</span> <span class="n">sortBy</span> <span class="p">(</span><span class="n">flip</span> <span class="o">$</span> <span class="n">comparing</span> <span class="n">fst</span><span class="p">)</span> <span class="o">.</span> <span class="n">map</span> <span class="p">(</span><span class="nf">\</span><span class="n">x</span> <span class="ow">-&gt;</span> <span class="p">(</span><span class="n">f</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>

<span class="nf">employee_sorted&#39;</span> <span class="ow">=</span> <span class="n">sortByKey</span> <span class="n">name</span> <span class="n">employees</span>

<span class="nf">ordered</span>     <span class="ow">=</span> <span class="n">sortByKey</span>    <span class="n">abs</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span> <span class="p">]</span> <span class="c1">-- [ 1, 2, -3, 6 ]</span>
<span class="nf">ordered_rev</span> <span class="ow">=</span> <span class="n">sortByKeyRev</span> <span class="n">abs</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span> <span class="p">]</span> <span class="c1">-- [ 6, -3, 2, 1 ]</span>

<span class="nf">names</span> <span class="ow">=</span> <span class="p">[</span> <span class="s">&quot;Azzz&quot;</span><span class="p">,</span> <span class="s">&quot;Za&quot;</span><span class="p">,</span> <span class="s">&quot;Bbbbbbb&quot;</span> <span class="p">]</span>
<span class="nf">sort_by_2nd_char</span>  <span class="ow">=</span> <span class="n">sortByKey</span> <span class="p">(</span><span class="o">!!</span> <span class="mi">1</span><span class="p">)</span> <span class="n">names</span> <span class="c1">-- [&quot;Za&quot;,&quot;Bbbbbbb&quot;,&quot;Azzz&quot;]</span>
<span class="nf">sort_by_last_char</span> <span class="ow">=</span> <span class="n">sortByKey</span> <span class="n">last</span> <span class="n">names</span>   <span class="c1">-- [&quot;Za&quot;,&quot;Bbbbbbb&quot;,&quot;Azzz&quot;]</span>
<span class="nf">sort_by_length</span>    <span class="ow">=</span> <span class="n">sortByKey</span> <span class="n">length</span> <span class="n">names</span> <span class="c1">-- [&quot;Za&quot;,&quot;Azzz&quot;,&quot;Bbbbbbb&quot;]</span>

<span class="c1">--</span>
<span class="kr">import</span> <span class="nn">Text.Regex</span>
<span class="nf">m</span> <span class="ow">=</span> <span class="n">readFile</span> <span class="s">&quot;/etc/passwd&quot;</span> <span class="o">&gt;&gt;=</span> <span class="p">(</span><span class="n">putStr</span> <span class="o">.</span> <span class="n">unlines</span> <span class="o">.</span> <span class="n">sortByKey</span> <span class="n">key</span> <span class="o">.</span> <span class="n">lines</span><span class="p">)</span>
    <span class="kr">where</span> <span class="n">key</span> <span class="n">line</span> <span class="ow">=</span> <span class="kr">case</span> <span class="n">splitRegex</span> <span class="p">(</span><span class="n">mkRegex</span> <span class="s">&quot;:&quot;</span><span class="p">)</span> <span class="n">line</span> <span class="kr">of</span>
                       <span class="p">(</span><span class="n">name</span> <span class="kt">:</span> <span class="kr">_</span> <span class="kt">:</span> <span class="n">uid</span> <span class="kt">:</span> <span class="n">gid</span> <span class="kt">:</span> <span class="kr">_</span><span class="p">)</span> <span class="ow">-&gt;</span>
                           <span class="p">(</span><span class="n">read</span> <span class="n">gid</span> <span class="ow">::</span> <span class="kt">Int</span><span class="p">,</span> <span class="n">read</span> <span class="n">uid</span> <span class="ow">::</span> <span class="kt">Int</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> </PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN218"
>Implementing a Circular List</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="kr">import</span> <span class="nn">System.Posix</span> <span class="p">(</span><span class="nf">sleep</span><span class="p">)</span>

<span class="c1">-- circular lists are easily defined using infinite list</span>
<span class="nf">circular</span> <span class="ow">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span> <span class="o">++</span> <span class="n">circular</span>

<span class="nf">m</span> <span class="ow">=</span> <span class="n">mapM_</span> <span class="n">do_it</span> <span class="p">(</span><span class="n">take</span> <span class="mi">10</span> <span class="n">circular</span><span class="p">)</span>
    <span class="kr">where</span> <span class="n">do_it</span> <span class="n">n</span> <span class="ow">=</span> <span class="kr">do</span> <span class="n">putStrLn</span> <span class="p">(</span><span class="s">&quot;Handling process &quot;</span> <span class="o">++</span> <span class="n">show</span> <span class="n">n</span><span class="p">)</span>
		       <span class="n">sleep</span> <span class="mi">1</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN221"
>Randomizing an Array</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="nf">rand</span> <span class="ow">::</span> <span class="kt">Int</span> <span class="ow">-&gt;</span> <span class="kt">Int</span> <span class="ow">-&gt;</span> <span class="kt">IO</span> <span class="kt">Int</span>
<span class="nf">rand</span> <span class="n">low</span> <span class="n">high</span> <span class="ow">=</span> <span class="n">getStdRandom</span> <span class="p">(</span><span class="n">randomR</span> <span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">))</span>

<span class="nf">randomPermute</span> <span class="ow">::</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="kt">IO</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
<span class="nf">randomPermute</span> <span class="kt">[]</span>  <span class="ow">=</span> <span class="n">return</span> <span class="kt">[]</span>
<span class="nf">randomPermute</span> <span class="n">xs</span>  <span class="ow">=</span> 
    <span class="kr">do</span> <span class="n">n</span> <span class="ow">&lt;-</span> <span class="n">rand</span> <span class="mi">0</span> <span class="p">(</span><span class="n">length</span> <span class="n">xs</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
       <span class="kr">let</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">e</span> <span class="kt">:</span> <span class="n">b</span><span class="p">)</span> <span class="ow">=</span> <span class="n">splitAt</span> <span class="n">n</span> <span class="n">xs</span> <span class="c1">-- taking n-th element and putting it first</span>
       <span class="n">ab</span> <span class="ow">&lt;-</span> <span class="n">randomPermute</span> <span class="p">(</span><span class="n">a</span> <span class="o">++</span> <span class="n">b</span><span class="p">)</span>
       <span class="n">return</span> <span class="o">$</span> <span class="n">e</span> <span class="kt">:</span> <span class="n">ab</span>

<span class="nf">l</span> <span class="ow">=</span> <span class="n">randomPermute</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">5</span><span class="p">]</span>        <span class="c1">-- example of result: [2,3,5,1,4]</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN224"
>Program: words</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">-- using groupNelem from &quot;Helpers&quot;</span>
<span class="nf">make_columns</span> <span class="ow">::</span> <span class="kt">Int</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span>
<span class="nf">make_columns</span> <span class="n">screen_width</span> <span class="n">mylist</span> <span class="ow">=</span> 
    <span class="n">map</span> <span class="n">concat</span> <span class="o">$</span> <span class="n">transpose</span> <span class="o">$</span> <span class="n">groupNelem</span> <span class="n">rows</span> <span class="o">$</span> <span class="n">map</span> <span class="n">pad_it</span> <span class="n">mylist</span>
        <span class="kr">where</span> <span class="n">maxlen</span> <span class="ow">=</span> <span class="n">maximum</span><span class="p">(</span><span class="n">map</span> <span class="n">length</span> <span class="n">mylist</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1">-- 1 needed to make extra space</span>
              <span class="n">cols</span> <span class="ow">=</span> <span class="n">max</span> <span class="mi">1</span> <span class="p">(</span><span class="n">screen_width</span> <span class="p">`</span><span class="n">div</span><span class="p">`</span> <span class="n">maxlen</span><span class="p">)</span>
              <span class="n">rows</span> <span class="ow">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">length</span> <span class="n">mylist</span> <span class="p">`</span><span class="n">div</span><span class="p">`</span> <span class="n">cols</span><span class="p">)</span>
              <span class="n">pad_it</span> <span class="n">s</span> <span class="ow">=</span> <span class="n">take</span> <span class="n">maxlen</span> <span class="p">(</span><span class="n">s</span> <span class="o">++</span> <span class="n">repeat</span> <span class="sc">&#39; &#39;</span><span class="p">)</span>

<span class="c1">-- using external program &quot;resize -u&quot; to get terminal size (readProcess is in &quot;Helpers&quot;)</span>
<span class="nf">getTerminalSize</span> <span class="ow">::</span> <span class="kt">IO</span> <span class="p">(</span><span class="kt">Maybe</span> <span class="p">(</span><span class="kt">Int</span><span class="p">,</span> <span class="kt">Int</span><span class="p">))</span>
<span class="nf">getTerminalSize</span> <span class="ow">=</span>
    <span class="kr">do</span> <span class="kt">Right</span> <span class="n">s</span> <span class="ow">&lt;-</span> <span class="n">readProcess</span> <span class="s">&quot;resize&quot;</span> <span class="p">[</span><span class="s">&quot;-u&quot;</span><span class="p">]</span> <span class="s">&quot;&quot;</span>
       <span class="kr">let</span> <span class="n">vars</span> <span class="ow">=</span> <span class="n">parse_shell_vars</span> <span class="n">s</span>
       <span class="n">return</span> <span class="o">$</span> <span class="kr">do</span> <span class="n">x</span> <span class="ow">&lt;-</span> <span class="n">lookup</span> <span class="s">&quot;COLUMNS&quot;</span> <span class="n">vars</span>
                   <span class="n">y</span> <span class="ow">&lt;-</span> <span class="n">lookup</span> <span class="s">&quot;LINES&quot;</span> <span class="n">vars</span>
                   <span class="n">return</span> <span class="p">(</span><span class="n">read</span> <span class="n">x</span><span class="p">,</span> <span class="n">read</span> <span class="n">y</span><span class="p">)</span>
    <span class="kr">where</span> <span class="n">parse_shell_vars</span> <span class="ow">=</span> <span class="n">catMaybes</span> <span class="o">.</span> <span class="n">map</span> <span class="n">break_it</span> <span class="o">.</span> <span class="n">lines</span>
          <span class="n">break_it</span> <span class="n">s</span> <span class="ow">=</span> <span class="kr">case</span> <span class="n">break</span> <span class="p">(</span><span class="o">==</span> <span class="sc">&#39;=&#39;</span><span class="p">)</span> <span class="n">s</span> <span class="kr">of</span>
                         <span class="p">(</span><span class="kr">_</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="kt">Nothing</span>
                         <span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="kr">_</span><span class="kt">:</span><span class="n">val</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="kt">Just</span> <span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="kr">if</span> <span class="n">last</span> <span class="n">val</span> <span class="o">==</span> <span class="sc">&#39;;&#39;</span> <span class="kr">then</span> <span class="n">init</span> <span class="n">val</span> <span class="kr">else</span> <span class="n">val</span><span class="p">)</span>

<span class="nf">main</span> <span class="ow">=</span> <span class="kr">do</span> <span class="n">size</span> <span class="ow">&lt;-</span> <span class="n">getTerminalSize</span>
          <span class="kr">let</span> <span class="n">width</span> <span class="ow">=</span> <span class="n">maybe</span> <span class="mi">80</span> <span class="n">fst</span> <span class="n">size</span>
          <span class="n">interact</span> <span class="p">(</span><span class="n">unlines</span> <span class="o">.</span> <span class="n">make_columns</span> <span class="n">width</span> <span class="o">.</span> <span class="n">words</span><span class="p">)</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN227"
>Program: permute</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="nf">permutations</span> <span class="kt">[]</span>     <span class="ow">=</span>  <span class="p">[</span><span class="kt">[]</span><span class="p">]</span>
<span class="nf">permutations</span> <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span> <span class="ow">=</span> <span class="p">[</span><span class="n">zs</span> <span class="o">|</span> <span class="n">ys</span> <span class="ow">&lt;-</span> <span class="n">permutations</span> <span class="n">xs</span><span class="p">,</span> <span class="n">zs</span> <span class="ow">&lt;-</span> <span class="n">interleave</span> <span class="n">x</span> <span class="n">ys</span> <span class="p">]</span>
  <span class="kr">where</span> <span class="n">interleave</span> <span class="n">x</span> <span class="kt">[]</span>     <span class="ow">=</span>  <span class="p">[[</span><span class="n">x</span><span class="p">]]</span>
        <span class="n">interleave</span> <span class="n">x</span> <span class="p">(</span><span class="n">y</span><span class="kt">:</span><span class="n">ys</span><span class="p">)</span> <span class="ow">=</span>  <span class="p">[</span><span class="n">x</span><span class="kt">:</span><span class="n">y</span><span class="kt">:</span><span class="n">ys</span><span class="p">]</span> <span class="o">++</span> <span class="n">map</span> <span class="p">(</span><span class="n">y</span><span class="kt">:</span><span class="p">)</span> <span class="p">(</span><span class="n">interleave</span> <span class="n">x</span> <span class="n">ys</span><span class="p">)</span>
<span class="c1">-- the list comprehension can be replaced by: concatMap (interleave x) $ permutations xs</span>

<span class="nf">t</span> <span class="ow">=</span> <span class="n">mapM_</span> <span class="p">(</span><span class="n">putStrLn</span> <span class="o">.</span> <span class="n">unwords</span><span class="p">)</span> <span class="o">$</span> <span class="n">permutations</span> <span class="o">$</span> <span class="n">words</span> <span class="s">&quot;man bites dog&quot;</span> 
<span class="c1">-- man bites dog</span>
<span class="c1">-- bites man dog</span>
<span class="c1">-- bites dog man</span>
<span class="c1">-- man dog bites</span>
<span class="c1">-- dog man bites</span>
<span class="c1">-- dog bites man</span></PRE
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="datesandtimes.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="hashes.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Dates and Times</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Hashes</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>