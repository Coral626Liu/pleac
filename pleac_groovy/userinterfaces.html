<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>User Interfaces</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="PLEAC-Groovy"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="Database Access"
HREF="dbaccess.html"><LINK
REL="NEXT"
TITLE="Process Management and Communication"
HREF="processmanagementetc.html"><style type="text/css">td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }

  </style></head
><BODY TEXT="#cecece" BGCOLOR="#4f6f6f" LINK="#f5deb3" VLINK="#d5ae83"
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PLEAC-Groovy</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="dbaccess.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="processmanagementetc.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="USERINTERFACES"
>15. User Interfaces</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN792"
>Parsing Program Arguments</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// The are several Java options builder packages available. Some popular ones:</span>
<span class="c1">//   Apache Jakarta Commons CLI: http://jakarta.apache.org/commons/cli/</span>
<span class="c1">//   jopt-simple: http://jopt-simple.sourceforge.net</span>
<span class="c1">//   args4j: https://args4j.dev.java.net/ (requires Java 5 with annotations)</span>
<span class="c1">//   jargs: http://jargs.sourceforge.net/</span>
<span class="c1">//   te-code: http://te-code.sourceforge.net/article-20041121-cli.html</span>
<span class="c1">// Most of these can be used from Groovy with some Groovy code benefits.</span>
<span class="c1">// Groovy also has the CliBuilder built right in.</span>


<span class="c1">// CliBuilder example</span>
<span class="kt">def</span> <span class="n">cli</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CliBuilder</span><span class="o">()</span>
<span class="n">cli</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="nl">longOpt:</span> <span class="s1">&#39;verbose&#39;</span><span class="o">,</span> <span class="s1">&#39;verbose mode&#39;</span><span class="o">)</span>
<span class="n">cli</span><span class="o">.</span><span class="na">D</span><span class="o">(</span><span class="nl">longOpt:</span> <span class="s1">&#39;Debug&#39;</span><span class="o">,</span> <span class="s1">&#39;display debug info&#39;</span><span class="o">)</span>
<span class="n">cli</span><span class="o">.</span><span class="na">o</span><span class="o">(</span><span class="nl">longOpt:</span> <span class="s1">&#39;output&#39;</span><span class="o">,</span> <span class="s1">&#39;use/specify output file&#39;</span><span class="o">)</span>
<span class="kt">def</span> <span class="n">options</span> <span class="o">=</span> <span class="n">cli</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">args</span><span class="o">)</span>
<span class="k">if</span> <span class="o">(</span><span class="n">options</span><span class="o">.</span><span class="na">v</span><span class="o">)</span> <span class="c1">// ...</span>
<span class="k">if</span> <span class="o">(</span><span class="n">options</span><span class="o">.</span><span class="na">D</span><span class="o">)</span> <span class="n">println</span> <span class="s1">&#39;Debugging info available&#39;</span>
<span class="k">if</span> <span class="o">(</span><span class="n">options</span><span class="o">.</span><span class="na">o</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">println</span> <span class="s1">&#39;Output file flag was specified&#39;</span>
    <span class="n">println</span> <span class="s2">&quot;Output file is ${options.o}&quot;</span>
<span class="o">}</span>
<span class="c1">// ...</span>


<span class="c1">// jopt-simple example 1 (short form)</span>
<span class="n">cli</span> <span class="o">=</span> <span class="k">new</span> <span class="n">joptsimple</span><span class="o">.</span><span class="na">OptionParser</span><span class="o">(</span><span class="s2">&quot;vDo::&quot;</span><span class="o">)</span>
<span class="n">options</span> <span class="o">=</span> <span class="n">cli</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">args</span><span class="o">)</span>
<span class="k">if</span> <span class="o">(</span><span class="n">options</span><span class="o">.</span><span class="na">wasDetected</span><span class="o">(</span><span class="s1">&#39;o&#39;</span><span class="o">))</span> <span class="o">{</span>
    <span class="n">println</span> <span class="s1">&#39;Output file flag was specified.&#39;</span>
    <span class="n">println</span> <span class="s2">&quot;Output file is ${options.argumentsOf(&#39;o&#39;)}&quot;</span>
<span class="o">}</span>
<span class="c1">// ...</span>


<span class="c1">// jopt-simple example 2 (declarative form)</span>
<span class="n">op</span> <span class="o">=</span> <span class="k">new</span> <span class="n">joptsimple</span><span class="o">.</span><span class="na">OptionParser</span><span class="o">()</span>
<span class="n">VERBOSE</span> <span class="o">=</span> <span class="s1">&#39;v&#39;</span><span class="o">;</span>  <span class="n">op</span><span class="o">.</span><span class="na">accepts</span><span class="o">(</span> <span class="n">VERBOSE</span><span class="o">,</span>  <span class="s2">&quot;verbose mode&quot;</span> <span class="o">)</span>
<span class="n">DEBUG</span>   <span class="o">=</span> <span class="s1">&#39;D&#39;</span><span class="o">;</span>  <span class="n">op</span><span class="o">.</span><span class="na">accepts</span><span class="o">(</span> <span class="n">DEBUG</span><span class="o">,</span>    <span class="s2">&quot;display debug info&quot;</span> <span class="o">)</span>
<span class="n">OUTPUT</span>  <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="o">;</span>  <span class="n">op</span><span class="o">.</span><span class="na">accepts</span><span class="o">(</span> <span class="n">OUTPUT</span><span class="o">,</span>   <span class="s2">&quot;use/specify output file&quot;</span> <span class="o">).</span><span class="na">withOptionalArg</span><span class="o">().</span>
    <span class="n">describedAs</span><span class="o">(</span> <span class="s2">&quot;file&quot;</span> <span class="o">).</span><span class="na">ofType</span><span class="o">(</span> <span class="n">File</span><span class="o">.</span><span class="na">class</span> <span class="o">)</span>
<span class="n">options</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">args</span><span class="o">)</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="na">nonOptionArguments</span><span class="o">()</span>
<span class="k">if</span> <span class="o">(</span><span class="n">options</span><span class="o">.</span><span class="na">wasDetected</span><span class="o">(</span> <span class="n">DEBUG</span> <span class="o">))</span> <span class="n">println</span> <span class="s1">&#39;Debugging info available&#39;</span>
<span class="c1">// ...</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN795"
>Testing Whether a Program Is Running Interactively</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// Groovy like Java can be run in a variety of scenarios, not just interactive vs</span>
<span class="c1">// non-interative, e.g. within a servlet container. Sometimes InputStreams and other</span>
<span class="c1">// mechanisms are used to hide away differences between the different containers</span>
<span class="c1">// in which code is run; other times, code needs to be written purpose-built for</span>
<span class="c1">// the container in which it is running. In most situations where the latter applies</span>
<span class="c1">// the container will have specific lifecycle mechanisms to allow the code to</span>
<span class="c1">// access specific needs, e.g. javax.servlet.ServletRequest.getInputStream()</span>
<span class="c1">// rather than System.in</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN798"
>Clearing the Screen</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// Idiomatically Groovy encourages GUI over text-based applications where a rich</span>
<span class="c1">// interface is desirable. Libraries for richer text-based interfaces include:</span>
<span class="c1">// jline: http://jline.sourceforge.net</span>
<span class="c1">// jcurses: http://sourceforge.net/projects/javacurses/</span>
<span class="c1">// java-readline: http://java-readline.sourceforge.net</span>
<span class="c1">// enigma console: http://sourceforge.net/projects/enigma-shell/</span>
<span class="c1">// Note: Run examples using these libraries from command line not inside an IDE.</span>

<span class="c1">// If you are using a terminal/console that understands ANSI codes</span>
<span class="c1">// (excludes WinNT derivatives) you can just print the ANSI codes</span>
<span class="n">print</span> <span class="o">((</span><span class="kt">char</span><span class="o">)</span><span class="mi">27</span> <span class="o">+</span> <span class="s1">&#39;[2J&#39;</span><span class="o">)</span>

<span class="c1">// jline has constants for ANSI codes</span>
<span class="kn">import</span> <span class="nn">jline.ANSIBuffer</span>
<span class="n">print</span> <span class="n">ANSIBuffer</span><span class="o">.</span><span class="na">ANSICodes</span><span class="o">.</span><span class="na">clrscr</span><span class="o">()</span>
<span class="c1">// Also available through ConsoleReader.clearScreen()</span>

<span class="c1">// Using jcurses</span>
<span class="kn">import</span> <span class="nn">jcurses.system.*</span>
<span class="n">bg</span> <span class="o">=</span> <span class="n">CharColor</span><span class="o">.</span><span class="na">BLACK</span>
<span class="n">fg</span> <span class="o">=</span> <span class="n">CharColor</span><span class="o">.</span><span class="na">WHITE</span>
<span class="n">screenColors</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CharColor</span><span class="o">(</span><span class="n">bg</span><span class="o">,</span> <span class="n">fg</span><span class="o">)</span>
<span class="n">Toolkit</span><span class="o">.</span><span class="na">clearScreen</span><span class="o">(</span><span class="n">screenColors</span><span class="o">)</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN801"
>Determining Terminal or Window Size</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// Not idiomatic for Groovy to use text-based applications here.</span>

<span class="c1">// Using jcurses: http://sourceforge.net/projects/javacurses/</span>
<span class="c1">// use Toolkit.screenWidth and Toolkit.screenHeight</span>

<span class="c1">// &#39;barchart&#39; example</span>
<span class="kn">import</span> <span class="nn">jcurses.system.Toolkit</span>
<span class="n">numCols</span> <span class="o">=</span> <span class="n">Toolkit</span><span class="o">.</span><span class="na">screenWidth</span>
<span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">()</span>
<span class="k">if</span> <span class="o">(</span><span class="n">numCols</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="o">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="s2">&quot;You must have at least 20 characters&quot;</span><span class="o">)</span>
<span class="n">values</span> <span class="o">=</span> <span class="o">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">5</span><span class="o">).</span><span class="na">collect</span> <span class="o">{</span> <span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">20</span><span class="o">)</span> <span class="o">}</span>  <span class="c1">// generate rand values</span>
<span class="n">max</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="na">max</span><span class="o">()</span>
<span class="n">ratio</span> <span class="o">=</span> <span class="o">(</span><span class="n">numCols</span> <span class="o">-</span> <span class="mi">12</span><span class="o">)</span><span class="s">/max</span>
<span class="s">values.each{ i -&gt;</span>
<span class="s">    printf(&#39;%8.1f %s\n&#39;, [i as double, &quot;*&quot; * ratio * i])</span>
<span class="s">}</span>

<span class="s">// gives, for example:</span>
<span class="s">//   15.0 *******************************</span>
<span class="s">//   10.0 *********************</span>
<span class="s">//    5.0 **********</span>
<span class="s">//   14.0 *****************************</span>
<span class="s">//   18.0 **************************************</span>
<span class="s">// Run from command line not inside an IDE which may give false width/</span><span class="n">height</span> <span class="n">values</span><span class="o">.</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN804"
>Changing Text Color</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// Idiomatically Groovy encourages GUI over text-based applications where a rich</span>
<span class="c1">// interface is desirable. See 15.3 for richer text-based interface libraries.</span>
<span class="c1">// Note: Run examples using these libraries from command line not inside an IDE.</span>

<span class="c1">// If you are using a terminal/console that understands ANSI codes</span>
<span class="c1">// (excludes WinNT derivatives) you can just print the ANSI codes</span>
<span class="n">ESC</span> <span class="o">=</span> <span class="s2">&quot;${(char)27}&quot;</span>
<span class="n">redOnBlack</span> <span class="o">=</span> <span class="n">ESC</span> <span class="o">+</span> <span class="s1">&#39;[31;40m&#39;</span>
<span class="n">reset</span> <span class="o">=</span> <span class="n">ESC</span> <span class="o">+</span> <span class="s1">&#39;[0m&#39;</span>
<span class="n">println</span> <span class="o">(</span><span class="n">redOnBlack</span> <span class="o">+</span> <span class="s1">&#39;Danger, Will Robinson!&#39;</span> <span class="o">+</span> <span class="n">reset</span><span class="o">)</span>

<span class="c1">// jline has constants for ANSI codes</span>
<span class="kn">import</span> <span class="nn">jline.ANSIBuffer</span>
<span class="n">redOnBlack</span> <span class="o">=</span> <span class="n">ANSIBuffer</span><span class="o">.</span><span class="na">ANSICodes</span><span class="o">.</span><span class="na">attrib</span><span class="o">(</span><span class="mi">31</span><span class="o">)</span> <span class="o">+</span> <span class="n">ANSIBuffer</span><span class="o">.</span><span class="na">ANSICodes</span><span class="o">.</span><span class="na">attrib</span><span class="o">(</span><span class="mi">40</span><span class="o">)</span>
<span class="n">reset</span> <span class="o">=</span> <span class="n">ANSIBuffer</span><span class="o">.</span><span class="na">ANSICodes</span><span class="o">.</span><span class="na">attrib</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span>
<span class="n">println</span> <span class="n">redOnBlack</span> <span class="o">+</span> <span class="s1">&#39;Danger, Will Robinson!&#39;</span> <span class="o">+</span> <span class="n">reset</span>

<span class="c1">// Using JavaCurses</span>
<span class="kn">import</span> <span class="nn">jcurses.system.*</span>
<span class="kn">import</span> <span class="nn">jcurses.widgets.*</span>
<span class="n">whiteOnBlack</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CharColor</span><span class="o">(</span><span class="n">CharColor</span><span class="o">.</span><span class="na">BLACK</span><span class="o">,</span> <span class="n">CharColor</span><span class="o">.</span><span class="na">WHITE</span><span class="o">)</span>
<span class="n">Toolkit</span><span class="o">.</span><span class="na">clearScreen</span><span class="o">(</span><span class="n">whiteOnBlack</span><span class="o">)</span>
<span class="n">redOnBlack</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CharColor</span><span class="o">(</span><span class="n">CharColor</span><span class="o">.</span><span class="na">BLACK</span><span class="o">,</span> <span class="n">CharColor</span><span class="o">.</span><span class="na">RED</span><span class="o">)</span>
<span class="n">Toolkit</span><span class="o">.</span><span class="na">printString</span><span class="o">(</span><span class="s2">&quot;Danger, Will Robinson!&quot;</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">redOnBlack</span><span class="o">)</span>
<span class="n">Toolkit</span><span class="o">.</span><span class="na">printString</span><span class="o">(</span><span class="s2">&quot;This is just normal text.&quot;</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="n">whiteOnBlack</span><span class="o">)</span>
<span class="c1">// Blink not supported by JavaCurses</span>

<span class="c1">// Using jline constants for Blink</span>
<span class="n">blink</span> <span class="o">=</span> <span class="n">ANSIBuffer</span><span class="o">.</span><span class="na">ANSICodes</span><span class="o">.</span><span class="na">attrib</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span>
<span class="n">reset</span> <span class="o">=</span> <span class="n">ANSIBuffer</span><span class="o">.</span><span class="na">ANSICodes</span><span class="o">.</span><span class="na">attrib</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span>
<span class="n">println</span> <span class="o">(</span><span class="n">blink</span> <span class="o">+</span> <span class="s1">&#39;Do you hurt yet?&#39;</span> <span class="o">+</span> <span class="n">reset</span><span class="o">)</span>

<span class="c1">// Using jline constants for Coral snake rhyme</span>
<span class="kt">def</span> <span class="nf">ansi</span><span class="o">(</span><span class="n">code</span><span class="o">)</span> <span class="o">{</span> <span class="n">ANSIBuffer</span><span class="o">.</span><span class="na">ANSICodes</span><span class="o">.</span><span class="na">attrib</span><span class="o">(</span><span class="n">code</span><span class="o">)</span> <span class="o">}</span>
<span class="n">redOnBlack</span> <span class="o">=</span> <span class="n">ansi</span><span class="o">(</span><span class="mi">31</span><span class="o">)</span> <span class="o">+</span> <span class="n">ansi</span><span class="o">(</span><span class="mi">40</span><span class="o">)</span>
<span class="n">redOnYellow</span> <span class="o">=</span> <span class="n">ansi</span><span class="o">(</span><span class="mi">31</span><span class="o">)</span> <span class="o">+</span> <span class="n">ansi</span><span class="o">(</span><span class="mi">43</span><span class="o">)</span>
<span class="n">greenOnCyanBlink</span> <span class="o">=</span> <span class="n">ansi</span><span class="o">(</span><span class="mi">32</span><span class="o">)</span> <span class="o">+</span> <span class="n">ansi</span><span class="o">(</span><span class="mi">46</span><span class="o">)</span> <span class="o">+</span> <span class="n">ansi</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span>
<span class="n">reset</span> <span class="o">=</span> <span class="n">ansi</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span>
<span class="n">println</span> <span class="n">redOnBlack</span> <span class="o">+</span> <span class="s2">&quot;venom lack&quot;</span>
<span class="n">println</span> <span class="n">redOnYellow</span> <span class="o">+</span> <span class="s2">&quot;kill that fellow&quot;</span>
<span class="n">println</span> <span class="n">greenOnCyanBlink</span> <span class="o">+</span> <span class="s2">&quot;garish!&quot;</span> <span class="o">+</span> <span class="n">reset</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN807"
>Reading from the Keyboard</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// Default Java libraries buffer System.in by default.</span>

<span class="c1">// Using JavaCurses:</span>
<span class="kn">import</span> <span class="nn">jcurses.system.Toolkit</span>
<span class="n">print</span> <span class="s1">&#39;Press a key: &#39;</span>
<span class="n">println</span> <span class="s2">&quot;\nYou pressed the &#39;${Toolkit.readCharacter().character}&#39; key&quot;</span>

<span class="c1">// Also works for special keys:</span>
<span class="kn">import</span> <span class="nn">jcurses.system.InputChar</span>
<span class="n">print</span> <span class="s2">&quot;Press the &#39;End&#39; key to finish: &quot;</span>
<span class="n">ch</span> <span class="o">=</span> <span class="n">Toolkit</span><span class="o">.</span><span class="na">readCharacter</span><span class="o">()</span>
<span class="k">assert</span> <span class="n">ch</span><span class="o">.</span><span class="na">isSpecialCode</span><span class="o">()</span>
<span class="k">assert</span> <span class="n">ch</span><span class="o">.</span><span class="na">code</span> <span class="o">==</span> <span class="n">InputChar</span><span class="o">.</span><span class="na">KEY_END</span>

<span class="c1">// See also jline Terminal#readCharacter() and Terminal#readVirtualKey()</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN810"
>Ringing the Terminal Bell</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">print</span> <span class="s2">&quot;${(char)7}&quot;</span>

<span class="c1">// Using jline constant</span>
<span class="n">print</span> <span class="s2">&quot;${jline.ConsoleOperations.KEYBOARD_BELL}&quot;</span>
<span class="c1">// Also available through ConsoleReader.beep()</span>

<span class="c1">// Using JavaCurses (Works only with terminals that support &#39;beeps&#39;)</span>
<span class="kn">import</span> <span class="nn">jcurses.system.Toolkit</span>
<span class="n">Toolkit</span><span class="o">.</span><span class="na">beep</span><span class="o">()</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN813"
>Using POSIX termios</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// I think you would need to resort to platform specific calls here,</span>
<span class="c1">// E.g. on *nix systems call &#39;stty&#39; using execute().</span>
<span class="c1">// Some things can be set through the packages mentioned in 15.3, e.g.</span>
<span class="c1">// echo can be turned on and off, but others like setting the kill character</span>
<span class="c1">// didn&#39;t appear to be supported (presumably because it doesn&#39;t make</span>
<span class="c1">// sense for a cross-platform toolkit).</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN816"
>Checking for Waiting Input</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// Consider using Java&#39;s PushbackInputStream or PushbackReader</span>
<span class="c1">// Different functionality to original cookbook but can be used</span>
<span class="c1">// as an alternative for some scenarios.</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN819"
>Reading Passwords</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// If using Java 6, use Console.readPassword()</span>
<span class="c1">// Otherwise use jline (use 0 instead of mask character &#39;*&#39; for no echo):</span>
<span class="n">password</span> <span class="o">=</span> <span class="k">new</span> <span class="n">jline</span><span class="o">.</span><span class="na">ConsoleReader</span><span class="o">().</span><span class="na">readLine</span><span class="o">(</span><span class="k">new</span> <span class="n">Character</span><span class="o">(</span><span class="s1">&#39;*&#39;</span><span class="o">))</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN822"
>Editing Input</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// In Groovy (like Java) normal input is buffered so you can normally make</span>
<span class="c1">// edits before hitting &#39;Enter&#39;. For more control over editing (including completion</span>
<span class="c1">// and history etc.) use one of the packages mentioned in 15.3, e.g. jline.</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN825"
>Managing the Screen</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// Use javacurses or jline (see 15.3) for low level screen management.</span>
<span class="c1">// Java/Groovy would normally use a GUI for such functionality.</span>

<span class="c1">// Here is a slight variation to cookbook example. This repeatedly calls</span>
<span class="c1">// the command feedin on the command line, e.g. &quot;cmd /c dir&quot; on windows</span>
<span class="c1">// or &#39;ps -aux&#39; on Linux. Whenever a line changes, the old line is &quot;faded</span>
<span class="c1">// out&quot; using font colors from white through to black. Then the new line</span>
<span class="c1">// is faded in using the reverse process.</span>
<span class="kn">import</span> <span class="nn">jcurses.system.*</span>
<span class="n">color</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CharColor</span><span class="o">(</span><span class="n">CharColor</span><span class="o">.</span><span class="na">BLACK</span><span class="o">,</span> <span class="n">CharColor</span><span class="o">.</span><span class="na">WHITE</span><span class="o">)</span>
<span class="n">Toolkit</span><span class="o">.</span><span class="na">clearScreen</span><span class="o">(</span><span class="n">color</span><span class="o">)</span>
<span class="n">maxcol</span> <span class="o">=</span> <span class="n">Toolkit</span><span class="o">.</span><span class="na">screenWidth</span>
<span class="n">maxrow</span> <span class="o">=</span> <span class="n">Toolkit</span><span class="o">.</span><span class="na">screenHeight</span>
<span class="n">colors</span> <span class="o">=</span> <span class="o">[</span><span class="n">CharColor</span><span class="o">.</span><span class="na">WHITE</span><span class="o">,</span> <span class="n">CharColor</span><span class="o">.</span><span class="na">CYAN</span><span class="o">,</span> <span class="n">CharColor</span><span class="o">.</span><span class="na">YELLOW</span><span class="o">,</span> <span class="n">CharColor</span><span class="o">.</span><span class="na">GREEN</span><span class="o">,</span>
          <span class="n">CharColor</span><span class="o">.</span><span class="na">RED</span><span class="o">,</span> <span class="n">CharColor</span><span class="o">.</span><span class="na">BLUE</span><span class="o">,</span> <span class="n">CharColor</span><span class="o">.</span><span class="na">MAGENTA</span><span class="o">,</span> <span class="n">CharColor</span><span class="o">.</span><span class="na">BLACK</span><span class="o">]</span>
<span class="n">done</span> <span class="o">=</span> <span class="kc">false</span>
<span class="n">refresh</span> <span class="o">=</span> <span class="kc">false</span>
<span class="n">waittime</span> <span class="o">=</span> <span class="mi">8000</span>
<span class="n">oldlines</span> <span class="o">=</span> <span class="o">[]</span>
<span class="kt">def</span> <span class="nf">fade</span><span class="o">(</span><span class="n">line</span><span class="o">,</span> <span class="n">row</span><span class="o">,</span> <span class="n">colorList</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">i</span> <span class="k">in</span> <span class="mi">0</span><span class="o">..&lt;</span><span class="n">colorList</span><span class="o">.</span><span class="na">size</span><span class="o">())</span> <span class="o">{</span>
        <span class="n">Toolkit</span><span class="o">.</span><span class="na">printString</span><span class="o">(</span><span class="n">line</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">row</span><span class="o">,</span> <span class="k">new</span> <span class="n">CharColor</span><span class="o">(</span><span class="n">CharColor</span><span class="o">.</span><span class="na">BLACK</span><span class="o">,</span> <span class="n">colorList</span><span class="o">[</span><span class="n">i</span><span class="o">]))</span>
        <span class="n">sleep</span> <span class="mi">10</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="k">while</span><span class="o">(!</span><span class="n">done</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">waittime</span> <span class="o">&gt;</span> <span class="mi">9999</span> <span class="o">||</span> <span class="n">refresh</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">proc</span> <span class="o">=</span> <span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">execute</span><span class="o">()</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="na">text</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s1">&#39;\n&#39;</span><span class="o">)</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">r</span> <span class="k">in</span> <span class="mi">0</span><span class="o">..&lt;</span><span class="n">maxrow</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">r</span> <span class="o">&gt;=</span> <span class="n">lines</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">||</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="n">oldlines</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">||</span> <span class="n">lines</span><span class="o">[</span><span class="n">r</span><span class="o">]</span> <span class="o">!=</span> <span class="n">oldlines</span><span class="o">[</span><span class="n">r</span><span class="o">])</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">oldlines</span> <span class="o">!=</span> <span class="o">[])</span>
                    <span class="n">fade</span><span class="o">(</span><span class="n">r</span> <span class="o">&lt;</span> <span class="n">oldlines</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">?</span> <span class="n">oldlines</span><span class="o">[</span><span class="n">r</span><span class="o">]</span> <span class="o">:</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="n">maxcol</span><span class="o">,</span> <span class="n">r</span><span class="o">,</span> <span class="n">colors</span><span class="o">)</span>
                <span class="n">fade</span><span class="o">(</span><span class="n">r</span> <span class="o">&lt;</span> <span class="n">lines</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">?</span> <span class="n">lines</span><span class="o">[</span><span class="n">r</span><span class="o">]</span> <span class="o">:</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="n">maxcol</span><span class="o">,</span> <span class="n">r</span><span class="o">,</span> <span class="n">colors</span><span class="o">.</span><span class="na">reverse</span><span class="o">())</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="n">oldlines</span> <span class="o">=</span> <span class="n">lines</span>
        <span class="n">refresh</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="n">waittime</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="o">}</span>
    <span class="n">waittime</span> <span class="o">+=</span> <span class="mi">200</span>
    <span class="n">sleep</span> <span class="mi">200</span>
<span class="o">}</span>

<span class="c1">// Keyboard handling would be similar to 15.6.</span>
<span class="c1">// Something like below but need to synchronize as we are in different threads.</span>
<span class="n">Thread</span><span class="o">.</span><span class="na">start</span><span class="o">{</span>
    <span class="k">while</span><span class="o">(!</span><span class="n">done</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">ch</span> <span class="o">=</span> <span class="n">Toolkit</span><span class="o">.</span><span class="na">readCharacter</span><span class="o">()</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">ch</span><span class="o">.</span><span class="na">isSpecialCode</span><span class="o">()</span> <span class="o">||</span> <span class="n">ch</span><span class="o">.</span><span class="na">character</span> <span class="o">==</span> <span class="s1">&#39;q&#39;</span><span class="o">)</span> <span class="n">done</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="k">else</span> <span class="n">refresh</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN828"
>Controlling Another Program with Expect</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// These examples uses expectj, a pure Java Expect-like module.</span>
<span class="c1">// http://expectj.sourceforge.net/</span>
<span class="n">defaultTimeout</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c1">// infinite</span>
<span class="n">expect</span> <span class="o">=</span> <span class="k">new</span> <span class="n">expectj</span><span class="o">.</span><span class="na">ExpectJ</span><span class="o">(</span><span class="s2">&quot;logfile.log&quot;</span><span class="o">,</span> <span class="n">defaultTimeout</span><span class="o">)</span>
<span class="n">command</span> <span class="o">=</span> <span class="n">expect</span><span class="o">.</span><span class="na">spawn</span><span class="o">(</span><span class="s2">&quot;program to run&quot;</span><span class="o">)</span>
<span class="n">command</span><span class="o">.</span><span class="na">expect</span><span class="o">(</span><span class="s1">&#39;Password&#39;</span><span class="o">,</span> <span class="mi">10</span><span class="o">)</span>
<span class="c1">// expectj doesn&#39;t support regular expressions, but see readUntil</span>
<span class="c1">// in recipe 18.6 for how to manually code this</span>
<span class="n">command</span><span class="o">.</span><span class="na">expect</span><span class="o">(</span><span class="s1">&#39;invalid&#39;</span><span class="o">)</span>
<span class="n">command</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="s1">&#39;Hello, world\r&#39;</span><span class="o">)</span>
<span class="c1">// kill spawned process</span>
<span class="n">command</span><span class="o">.</span><span class="na">stop</span><span class="o">()</span>

<span class="c1">// expecting multiple choices</span>
<span class="c1">// expectj doesn&#39;t support multiple choices, but see readUntil</span>
<span class="c1">// in recipe 18.6 for how to manually code this</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN831"
>Creating Menus with Tk</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// Methods not shown for the edit menu items, they would be the same as for the</span>
<span class="c1">// file menu items.</span>
<span class="kn">import</span> <span class="nn">groovy.swing.SwingBuilder</span>
<span class="kt">def</span> <span class="nf">print</span><span class="o">()</span> <span class="o">{}</span>
<span class="kt">def</span> <span class="nf">save</span><span class="o">()</span> <span class="o">{}</span>
<span class="n">frame</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SwingBuilder</span><span class="o">().</span><span class="na">frame</span><span class="o">(</span><span class="nl">title:</span><span class="s1">&#39;Demo&#39;</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">menuBar</span> <span class="o">{</span>
        <span class="n">menu</span><span class="o">(</span><span class="nl">mnemonic:</span><span class="s1">&#39;F&#39;</span><span class="o">,</span> <span class="s1">&#39;File&#39;</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">menuItem</span> <span class="o">(</span><span class="nl">actionPerformed:</span><span class="k">this</span><span class="o">.&amp;</span><span class="n">print</span><span class="o">,</span> <span class="s1">&#39;Print&#39;</span><span class="o">)</span>
            <span class="n">separator</span><span class="o">()</span>
            <span class="n">menuItem</span> <span class="o">(</span><span class="nl">actionPerformed:</span><span class="k">this</span><span class="o">.&amp;</span><span class="n">save</span><span class="o">,</span> <span class="s1">&#39;Save&#39;</span><span class="o">)</span>
            <span class="n">menuItem</span> <span class="o">(</span><span class="nl">actionPerformed:</span><span class="o">{</span><span class="n">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">0</span><span class="o">)},</span> <span class="s1">&#39;Quit immediately&#39;</span><span class="o">)</span>
        <span class="o">}</span>
        <span class="n">menu</span><span class="o">(</span><span class="nl">mnemonic:</span><span class="s1">&#39;O&#39;</span><span class="o">,</span> <span class="s1">&#39;Options&#39;</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">checkBoxMenuItem</span> <span class="o">(</span><span class="s1">&#39;Create Debugging Info&#39;</span><span class="o">,</span> <span class="nl">state:</span><span class="kc">true</span><span class="o">)</span>
        <span class="o">}</span>
        <span class="n">menu</span><span class="o">(</span><span class="nl">mnemonic:</span><span class="s1">&#39;D&#39;</span><span class="o">,</span> <span class="s1">&#39;Debug&#39;</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">buttonGroup</span><span class="o">()</span>
            <span class="n">radioButtonMenuItem</span> <span class="o">(</span><span class="s1">&#39;Log Level 1&#39;</span><span class="o">,</span> <span class="nl">buttonGroup:</span><span class="n">group</span><span class="o">,</span> <span class="nl">selected:</span><span class="kc">true</span><span class="o">)</span>
            <span class="n">radioButtonMenuItem</span> <span class="o">(</span><span class="s1">&#39;Log Level 2&#39;</span><span class="o">,</span> <span class="nl">buttonGroup:</span><span class="n">group</span><span class="o">)</span>
            <span class="n">radioButtonMenuItem</span> <span class="o">(</span><span class="s1">&#39;Log Level 3&#39;</span><span class="o">,</span> <span class="nl">buttonGroup:</span><span class="n">group</span><span class="o">)</span>
        <span class="o">}</span>
        <span class="n">menu</span><span class="o">(</span><span class="nl">mnemonic:</span><span class="s1">&#39;F&#39;</span><span class="o">,</span> <span class="s1">&#39;Format&#39;</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">menu</span><span class="o">(</span><span class="s1">&#39;Font&#39;</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">group</span> <span class="o">=</span> <span class="n">buttonGroup</span><span class="o">()</span>
                <span class="n">radioButtonMenuItem</span> <span class="o">(</span><span class="s1">&#39;Times Roman&#39;</span><span class="o">,</span> <span class="nl">buttonGroup:</span><span class="n">group</span><span class="o">,</span> <span class="nl">selected:</span><span class="kc">true</span><span class="o">)</span>
                <span class="n">radioButtonMenuItem</span> <span class="o">(</span><span class="s1">&#39;Courier&#39;</span><span class="o">,</span> <span class="nl">buttonGroup:</span><span class="n">group</span><span class="o">)</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="n">menu</span><span class="o">(</span><span class="nl">mnemonic:</span><span class="s1">&#39;E&#39;</span><span class="o">,</span> <span class="s1">&#39;Edit&#39;</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">menuItem</span> <span class="o">(</span><span class="nl">actionPerformed:</span><span class="o">{},</span> <span class="s1">&#39;Copy&#39;</span><span class="o">)</span>
            <span class="n">menuItem</span> <span class="o">(</span><span class="nl">actionPerformed:</span><span class="o">{},</span> <span class="s1">&#39;Cut&#39;</span><span class="o">)</span>
            <span class="n">menuItem</span> <span class="o">(</span><span class="nl">actionPerformed:</span><span class="o">{},</span> <span class="s1">&#39;Paste&#39;</span><span class="o">)</span>
            <span class="n">menuItem</span> <span class="o">(</span><span class="nl">actionPerformed:</span><span class="o">{},</span> <span class="s1">&#39;Delete&#39;</span><span class="o">)</span>
            <span class="n">separator</span><span class="o">()</span>
            <span class="n">menu</span><span class="o">(</span><span class="s1">&#39;Object ...&#39;</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">menuItem</span> <span class="o">(</span><span class="nl">actionPerformed:</span><span class="o">{},</span> <span class="s1">&#39;Circle&#39;</span><span class="o">)</span>
                <span class="n">menuItem</span> <span class="o">(</span><span class="nl">actionPerformed:</span><span class="o">{},</span> <span class="s1">&#39;Square&#39;</span><span class="o">)</span>
                <span class="n">menuItem</span> <span class="o">(</span><span class="nl">actionPerformed:</span><span class="o">{},</span> <span class="s1">&#39;Point&#39;</span><span class="o">)</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="n">frame</span><span class="o">.</span><span class="na">pack</span><span class="o">()</span>
<span class="n">frame</span><span class="o">.</span><span class="na">show</span><span class="o">()</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN834"
>Creating Dialog Boxes with Tk</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// Registration Example</span>
<span class="kn">import</span> <span class="nn">groovy.swing.SwingBuilder</span>
<span class="kt">def</span> <span class="nf">cancel</span><span class="o">(</span><span class="n">event</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">println</span> <span class="s1">&#39;Sorry you decided not to register.&#39;</span>
    <span class="n">dialog</span><span class="o">.</span><span class="na">dispose</span><span class="o">()</span>
<span class="o">}</span>
<span class="kt">def</span> <span class="nf">register</span><span class="o">(</span><span class="n">event</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">swing</span><span class="o">.</span><span class="na">name</span><span class="o">?.</span><span class="na">text</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">println</span> <span class="s2">&quot;Welcome to the fold $swing.name.text&quot;</span>
        <span class="n">dialog</span><span class="o">.</span><span class="na">dispose</span><span class="o">()</span>
    <span class="o">}</span> <span class="k">else</span> <span class="n">println</span> <span class="s2">&quot;You didn&#39;t give me your name!&quot;</span>
<span class="o">}</span>
<span class="kt">def</span> <span class="nf">dialog</span><span class="o">(</span><span class="n">event</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">dialog</span> <span class="o">=</span> <span class="n">swing</span><span class="o">.</span><span class="na">createDialog</span><span class="o">(</span><span class="nl">title:</span><span class="s1">&#39;Entry&#39;</span><span class="o">)</span>
    <span class="kt">def</span> <span class="n">panel</span> <span class="o">=</span> <span class="n">swing</span><span class="o">.</span><span class="na">panel</span> <span class="o">{</span>
        <span class="n">vbox</span> <span class="o">{</span>
            <span class="n">hbox</span> <span class="o">{</span>
                <span class="n">label</span><span class="o">(</span><span class="nl">text:</span><span class="s1">&#39;Name&#39;</span><span class="o">)</span>
                <span class="n">textField</span><span class="o">(</span><span class="nl">columns:</span><span class="mi">20</span><span class="o">,</span> <span class="nl">id:</span><span class="s1">&#39;name&#39;</span><span class="o">)</span>
            <span class="o">}</span>
            <span class="n">hbox</span> <span class="o">{</span>
                <span class="n">button</span><span class="o">(</span><span class="s1">&#39;Register&#39;</span><span class="o">,</span> <span class="nl">actionPerformed:</span><span class="k">this</span><span class="o">.&amp;</span><span class="n">register</span><span class="o">)</span>
                <span class="n">button</span><span class="o">(</span><span class="s1">&#39;Cancel&#39;</span><span class="o">,</span> <span class="nl">actionPerformed:</span><span class="k">this</span><span class="o">.&amp;</span><span class="n">cancel</span><span class="o">)</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="n">dialog</span><span class="o">.</span><span class="na">getContentPane</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">panel</span><span class="o">)</span>
    <span class="n">dialog</span><span class="o">.</span><span class="na">pack</span><span class="o">()</span>
    <span class="n">dialog</span><span class="o">.</span><span class="na">show</span><span class="o">()</span>
<span class="o">}</span>
<span class="n">swing</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SwingBuilder</span><span class="o">()</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">swing</span><span class="o">.</span><span class="na">frame</span><span class="o">(</span><span class="nl">title:</span><span class="s1">&#39;Registration Example&#39;</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">panel</span> <span class="o">{</span>
        <span class="n">button</span><span class="o">(</span><span class="nl">actionPerformed:</span><span class="k">this</span><span class="o">.&amp;</span><span class="n">dialog</span><span class="o">,</span> <span class="s1">&#39;Click Here For Registration Form&#39;</span><span class="o">)</span>
        <span class="n">glue</span><span class="o">()</span>
        <span class="n">button</span><span class="o">(</span><span class="nl">actionPerformed:</span><span class="o">{</span><span class="n">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">0</span><span class="o">)},</span> <span class="s1">&#39;Quit&#39;</span><span class="o">)</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="n">frame</span><span class="o">.</span><span class="na">pack</span><span class="o">()</span>
<span class="n">frame</span><span class="o">.</span><span class="na">show</span><span class="o">()</span>


<span class="c1">// Error Example, slight variation to original cookbook</span>
<span class="kn">import</span> <span class="nn">groovy.swing.SwingBuilder</span>
<span class="kn">import</span> <span class="nn">javax.swing.WindowConstants</span> <span class="k">as</span> <span class="n">WC</span>
<span class="kn">import</span> <span class="nn">javax.swing.JOptionPane</span>
<span class="kt">def</span> <span class="nf">calculate</span><span class="o">(</span><span class="n">event</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">swing</span><span class="o">.</span><span class="na">result</span><span class="o">.</span><span class="na">text</span> <span class="o">=</span> <span class="n">evaluate</span><span class="o">(</span><span class="n">swing</span><span class="o">.</span><span class="na">expr</span><span class="o">.</span><span class="na">text</span><span class="o">)</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">JOptionPane</span><span class="o">.</span><span class="na">showMessageDialog</span><span class="o">(</span><span class="n">frame</span><span class="o">,</span> <span class="n">ex</span><span class="o">.</span><span class="na">message</span><span class="o">)</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="n">swing</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SwingBuilder</span><span class="o">()</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">swing</span><span class="o">.</span><span class="na">frame</span><span class="o">(</span><span class="nl">title:</span><span class="s1">&#39;Calculator Example&#39;</span><span class="o">,</span>
    <span class="nl">defaultCloseOperation:</span><span class="n">WC</span><span class="o">.</span><span class="na">EXIT_ON_CLOSE</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">panel</span> <span class="o">{</span>
        <span class="n">vbox</span> <span class="o">{</span>
            <span class="n">hbox</span> <span class="o">{</span>
                <span class="n">label</span><span class="o">(</span><span class="nl">text:</span><span class="s1">&#39;Expression&#39;</span><span class="o">)</span>
                <span class="n">hstrut</span><span class="o">()</span>
                <span class="n">textField</span><span class="o">(</span><span class="nl">columns:</span><span class="mi">12</span><span class="o">,</span> <span class="nl">id:</span><span class="s1">&#39;expr&#39;</span><span class="o">)</span>
            <span class="o">}</span>
            <span class="n">hbox</span> <span class="o">{</span>
                <span class="n">label</span><span class="o">(</span><span class="nl">text:</span><span class="s1">&#39;Result&#39;</span><span class="o">)</span>
                <span class="n">glue</span><span class="o">()</span>
                <span class="n">label</span><span class="o">(</span><span class="nl">id:</span><span class="s1">&#39;result&#39;</span><span class="o">)</span>
            <span class="o">}</span>
            <span class="n">hbox</span> <span class="o">{</span>
                <span class="n">button</span><span class="o">(</span><span class="s1">&#39;Calculate&#39;</span><span class="o">,</span> <span class="nl">actionPerformed:</span><span class="k">this</span><span class="o">.&amp;</span><span class="n">calculate</span><span class="o">)</span>
                <span class="n">button</span><span class="o">(</span><span class="s1">&#39;Quit&#39;</span><span class="o">,</span> <span class="nl">actionPerformed:</span><span class="o">{</span><span class="n">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">0</span><span class="o">)})</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="n">frame</span><span class="o">.</span><span class="na">pack</span><span class="o">()</span>
<span class="n">frame</span><span class="o">.</span><span class="na">show</span><span class="o">()</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN837"
>Responding to Tk Resize Events</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// Resizing in Groovy follows Java rules, i.e. is dependent on the layout manager.</span>
<span class="c1">// You can set preferred, minimum and maximum sizes (may be ignored by some layout managers).</span>
<span class="c1">// You can setResizable(false) for some components.</span>
<span class="c1">// You can specify a weight value for some layout managers, e.g. GridBagLayout</span>
<span class="c1">// which control the degree of scaling which occurs during resizing.</span>
<span class="c1">// Some layout managers, e.g. GridLayout, automaticaly resize their contained widgets.</span>
<span class="c1">// You can capture resize events and do everything manually yourself.</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN840"
>Removing the DOS Shell Window with Windows Perl/Tk</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// Removing DOS console on Windows:</span>
<span class="c1">// If you are using java.exe to start your Groovy script, use javaw.exe instead.</span>
<span class="c1">// If you are using groovy.exe to start your Groovy script, use groovyw.exe instead.</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN843"
>Program: Small termcap program</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// additions to original cookbook:</span>
<span class="c1">// random starting position</span>
<span class="c1">// color changes after each bounce</span>
<span class="kn">import</span> <span class="nn">jcurses.system.*</span>
<span class="n">color</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CharColor</span><span class="o">(</span><span class="n">CharColor</span><span class="o">.</span><span class="na">BLACK</span><span class="o">,</span> <span class="n">CharColor</span><span class="o">.</span><span class="na">WHITE</span><span class="o">)</span>
<span class="n">Toolkit</span><span class="o">.</span><span class="na">clearScreen</span><span class="o">(</span><span class="n">color</span><span class="o">)</span>
<span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">()</span>
<span class="n">maxrow</span> <span class="o">=</span> <span class="n">Toolkit</span><span class="o">.</span><span class="na">screenWidth</span>
<span class="n">maxcol</span> <span class="o">=</span> <span class="n">Toolkit</span><span class="o">.</span><span class="na">screenHeight</span>
<span class="n">rowinc</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">colinc</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">row</span> <span class="o">=</span> <span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">maxrow</span><span class="o">)</span>
<span class="n">col</span> <span class="o">=</span> <span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">maxcol</span><span class="o">)</span>
<span class="n">chars</span> <span class="o">=</span> <span class="s1">&#39;*-/|\\_&#39;</span>
<span class="n">colors</span> <span class="o">=</span> <span class="o">[</span><span class="n">CharColor</span><span class="o">.</span><span class="na">RED</span><span class="o">,</span> <span class="n">CharColor</span><span class="o">.</span><span class="na">BLUE</span><span class="o">,</span> <span class="n">CharColor</span><span class="o">.</span><span class="na">YELLOW</span><span class="o">,</span>
          <span class="n">CharColor</span><span class="o">.</span><span class="na">GREEN</span><span class="o">,</span> <span class="n">CharColor</span><span class="o">.</span><span class="na">CYAN</span><span class="o">,</span> <span class="n">CharColor</span><span class="o">.</span><span class="na">MAGENTA</span><span class="o">]</span>
<span class="n">delay</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">ch</span> <span class="o">=</span> <span class="kc">null</span>
<span class="kt">def</span> <span class="nf">nextChar</span><span class="o">(){</span>
    <span class="n">ch</span> <span class="o">=</span> <span class="n">chars</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
    <span class="n">chars</span> <span class="o">=</span> <span class="n">chars</span><span class="o">[</span><span class="mi">1</span><span class="o">..-</span><span class="mi">1</span><span class="o">]</span> <span class="o">+</span> <span class="n">chars</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
    <span class="n">color</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CharColor</span><span class="o">(</span><span class="n">CharColor</span><span class="o">.</span><span class="na">BLACK</span><span class="o">,</span> <span class="n">colors</span><span class="o">[</span><span class="mi">0</span><span class="o">])</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">colors</span><span class="o">[</span><span class="mi">1</span><span class="o">..-</span><span class="mi">1</span><span class="o">]</span> <span class="o">+</span> <span class="n">colors</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
<span class="o">}</span>
<span class="n">nextChar</span><span class="o">()</span>
<span class="k">while</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Toolkit</span><span class="o">.</span><span class="na">printString</span><span class="o">(</span><span class="n">ch</span><span class="o">,</span> <span class="n">row</span><span class="o">,</span> <span class="n">col</span><span class="o">,</span> <span class="n">color</span><span class="o">)</span>
    <span class="n">sleep</span> <span class="n">delay</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">row</span> <span class="o">+</span> <span class="n">rowinc</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">col</span> <span class="o">+</span> <span class="n">colinc</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">row</span> <span class="k">in</span> <span class="o">[</span><span class="mi">0</span><span class="o">,</span> <span class="n">maxrow</span><span class="o">])</span> <span class="o">{</span> <span class="n">nextChar</span><span class="o">();</span> <span class="n">rowinc</span> <span class="o">=</span> <span class="o">-</span><span class="n">rowinc</span> <span class="o">}</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">col</span> <span class="k">in</span> <span class="o">[</span><span class="mi">0</span><span class="o">,</span> <span class="n">maxcol</span><span class="o">])</span> <span class="o">{</span> <span class="n">nextChar</span><span class="o">();</span> <span class="n">colinc</span> <span class="o">=</span> <span class="o">-</span><span class="n">colinc</span> <span class="o">}</span>
<span class="o">}</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN846"
>Program: tkshufflepod</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// Variation to cookbook. Let&#39;s you reshuffle lines in a multi-line string</span>
<span class="c1">// by drag-n-drop.</span>
<span class="kn">import</span> <span class="nn">java.awt.*</span>
<span class="kn">import</span> <span class="nn">java.awt.datatransfer.*</span>
<span class="kn">import</span> <span class="nn">java.awt.dnd.*</span>
<span class="kn">import</span> <span class="nn">javax.swing.*</span>
<span class="kn">import</span> <span class="nn">javax.swing.ScrollPaneConstants</span> <span class="k">as</span> <span class="n">SPC</span>

<span class="kd">class</span> <span class="nc">DragDropList</span> <span class="kd">extends</span> <span class="n">JList</span> <span class="kd">implements</span>
        <span class="n">DragSourceListener</span><span class="o">,</span> <span class="n">DropTargetListener</span><span class="o">,</span> <span class="n">DragGestureListener</span> <span class="o">{</span>
    <span class="kt">def</span> <span class="n">dragSource</span>
    <span class="kt">def</span> <span class="n">dropTarget</span>
    <span class="kt">def</span> <span class="n">dropTargetCell</span>
    <span class="kt">int</span> <span class="n">draggedIndex</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="kt">def</span> <span class="n">localDataFlavor</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DataFlavor</span><span class="o">(</span><span class="n">DataFlavor</span><span class="o">.</span><span class="na">javaJVMLocalObjectMimeType</span><span class="o">)</span>
    <span class="kt">def</span> <span class="n">supportedFlavors</span> <span class="o">=</span> <span class="o">[</span><span class="n">localDataFlavor</span><span class="o">]</span> <span class="k">as</span> <span class="n">DataFlavor</span><span class="o">[]</span>

    <span class="kd">public</span> <span class="nf">DragDropList</span><span class="o">(</span><span class="n">model</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">()</span>
        <span class="n">setModel</span><span class="o">(</span><span class="n">model</span><span class="o">)</span>
        <span class="n">setCellRenderer</span><span class="o">(</span><span class="k">new</span> <span class="n">DragDropCellRenderer</span><span class="o">(</span><span class="k">this</span><span class="o">))</span>
        <span class="n">dragSource</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DragSource</span><span class="o">()</span>
        <span class="n">dragSource</span><span class="o">.</span><span class="na">createDefaultDragGestureRecognizer</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">DnDConstants</span><span class="o">.</span><span class="na">ACTION_MOVE</span><span class="o">,</span> <span class="k">this</span><span class="o">)</span>
        <span class="n">dropTarget</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DropTarget</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="k">this</span><span class="o">)</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dragGestureRecognized</span><span class="o">(</span><span class="n">DragGestureEvent</span> <span class="n">dge</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">locationToIndex</span><span class="o">(</span><span class="n">dge</span><span class="o">.</span><span class="na">dragOrigin</span><span class="o">)</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">index</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="n">index</span> <span class="o">==</span> <span class="n">model</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span> <span class="k">return</span>
        <span class="kt">def</span> <span class="n">trans</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CustomTransferable</span><span class="o">(</span><span class="n">model</span><span class="o">.</span><span class="na">getElementAt</span><span class="o">(</span><span class="n">index</span><span class="o">),</span> <span class="k">this</span><span class="o">)</span>
        <span class="n">draggedIndex</span> <span class="o">=</span> <span class="n">index</span>
        <span class="n">dragSource</span><span class="o">.</span><span class="na">startDrag</span><span class="o">(</span><span class="n">dge</span><span class="o">,</span> <span class="n">Cursor</span><span class="o">.</span><span class="na">defaultCursor</span><span class="o">,</span> <span class="n">trans</span><span class="o">,</span> <span class="k">this</span><span class="o">)</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dragDropEnd</span><span class="o">(</span><span class="n">DragSourceDropEvent</span> <span class="n">dsde</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">dropTargetCell</span> <span class="o">=</span> <span class="kc">null</span>
        <span class="n">draggedIndex</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">repaint</span><span class="o">()</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dragEnter</span><span class="o">(</span><span class="n">DragSourceDragEvent</span> <span class="n">dsde</span><span class="o">)</span> <span class="o">{</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dragExit</span><span class="o">(</span><span class="n">DragSourceEvent</span> <span class="n">dse</span><span class="o">)</span> <span class="o">{</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dragOver</span><span class="o">(</span><span class="n">DragSourceDragEvent</span> <span class="n">dsde</span><span class="o">)</span> <span class="o">{</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dropActionChanged</span><span class="o">(</span><span class="n">DragSourceDragEvent</span> <span class="n">dsde</span><span class="o">)</span> <span class="o">{</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dropActionChanged</span><span class="o">(</span><span class="n">DropTargetDragEvent</span> <span class="n">dtde</span><span class="o">)</span> <span class="o">{</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dragExit</span><span class="o">(</span><span class="n">DropTargetEvent</span> <span class="n">dte</span><span class="o">)</span> <span class="o">{</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dragEnter</span><span class="o">(</span><span class="n">DropTargetDragEvent</span> <span class="n">dtde</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">dtde</span><span class="o">.</span><span class="na">source</span> <span class="o">!=</span> <span class="n">dropTarget</span><span class="o">)</span> <span class="n">dtde</span><span class="o">.</span><span class="na">rejectDrag</span><span class="o">()</span>
        <span class="k">else</span> <span class="n">dtde</span><span class="o">.</span><span class="na">acceptDrag</span><span class="o">(</span><span class="n">DnDConstants</span><span class="o">.</span><span class="na">ACTION_COPY_OR_MOVE</span><span class="o">)</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dragOver</span><span class="o">(</span><span class="n">DropTargetDragEvent</span> <span class="n">dtde</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">dtde</span><span class="o">.</span><span class="na">source</span> <span class="o">!=</span> <span class="n">dropTarget</span><span class="o">)</span> <span class="n">dtde</span><span class="o">.</span><span class="na">rejectDrag</span><span class="o">()</span>
        <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">locationToIndex</span><span class="o">(</span><span class="n">dtde</span><span class="o">.</span><span class="na">location</span><span class="o">)</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">index</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="n">index</span> <span class="o">==</span> <span class="n">draggedIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span> <span class="n">dropTargetCell</span> <span class="o">=</span> <span class="kc">null</span>
        <span class="k">else</span> <span class="n">dropTargetCell</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="na">getElementAt</span><span class="o">(</span><span class="n">index</span><span class="o">)</span>
        <span class="n">repaint</span><span class="o">()</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">drop</span><span class="o">(</span><span class="n">DropTargetDropEvent</span> <span class="n">dtde</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">dtde</span><span class="o">.</span><span class="na">source</span> <span class="o">!=</span> <span class="n">dropTarget</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">dtde</span><span class="o">.</span><span class="na">rejectDrop</span><span class="o">()</span>
            <span class="k">return</span>
        <span class="o">}</span>
        <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">locationToIndex</span><span class="o">(</span><span class="n">dtde</span><span class="o">.</span><span class="na">location</span><span class="o">)</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">index</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="n">index</span> <span class="o">==</span> <span class="n">draggedIndex</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">dtde</span><span class="o">.</span><span class="na">rejectDrop</span><span class="o">()</span>
            <span class="k">return</span>
        <span class="o">}</span>
        <span class="n">dtde</span><span class="o">.</span><span class="na">acceptDrop</span><span class="o">(</span><span class="n">DnDConstants</span><span class="o">.</span><span class="na">ACTION_MOVE</span><span class="o">)</span>
        <span class="kt">def</span> <span class="n">dragged</span> <span class="o">=</span> <span class="n">dtde</span><span class="o">.</span><span class="na">transferable</span><span class="o">.</span><span class="na">getTransferData</span><span class="o">(</span><span class="n">localDataFlavor</span><span class="o">)</span>
        <span class="kt">boolean</span> <span class="n">sourceBeforeTarget</span> <span class="o">=</span> <span class="o">(</span><span class="n">draggedIndex</span> <span class="o">&lt;</span> <span class="n">index</span><span class="o">)</span>
        <span class="n">model</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">draggedIndex</span><span class="o">)</span>
        <span class="n">model</span><span class="o">.</span><span class="na">add</span><span class="o">((</span><span class="n">sourceBeforeTarget</span> <span class="o">?</span> <span class="n">index</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">:</span> <span class="n">index</span><span class="o">),</span> <span class="n">dragged</span><span class="o">)</span>
        <span class="n">dtde</span><span class="o">.</span><span class="na">dropComplete</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">CustomTransferable</span> <span class="kd">implements</span> <span class="n">Transferable</span> <span class="o">{</span>
    <span class="kt">def</span> <span class="n">object</span>
    <span class="kt">def</span> <span class="n">ddlist</span>

    <span class="kd">public</span> <span class="nf">CustomTransferable</span><span class="o">(</span><span class="n">object</span><span class="o">,</span> <span class="n">ddlist</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">object</span> <span class="o">=</span> <span class="n">object</span>
        <span class="k">this</span><span class="o">.</span><span class="na">ddlist</span> <span class="o">=</span> <span class="n">ddlist</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">getTransferData</span><span class="o">(</span><span class="n">DataFlavor</span> <span class="n">df</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">isDataFlavorSupported</span><span class="o">(</span><span class="n">df</span><span class="o">))</span> <span class="k">return</span> <span class="n">object</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isDataFlavorSupported</span><span class="o">(</span><span class="n">DataFlavor</span> <span class="n">df</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">ddlist</span><span class="o">.</span><span class="na">localDataFlavor</span><span class="o">)</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">DataFlavor</span><span class="o">[]</span> <span class="nf">getTransferDataFlavors</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">ddlist</span><span class="o">.</span><span class="na">supportedFlavors</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">DragDropCellRenderer</span> <span class="kd">extends</span> <span class="n">DefaultListCellRenderer</span> <span class="o">{</span>
    <span class="kt">boolean</span> <span class="n">isTargetCell</span>
    <span class="kt">def</span> <span class="n">ddlist</span>

    <span class="kd">public</span> <span class="nf">DragDropCellRenderer</span><span class="o">(</span><span class="n">ddlist</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">()</span>
        <span class="k">this</span><span class="o">.</span><span class="na">ddlist</span> <span class="o">=</span> <span class="n">ddlist</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Component</span> <span class="nf">getListCellRendererComponent</span><span class="o">(</span><span class="n">JList</span> <span class="n">list</span><span class="o">,</span> <span class="n">Object</span> <span class="n">value</span><span class="o">,</span>
            <span class="kt">int</span> <span class="n">index</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">isSelected</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">hasFocus</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">isTargetCell</span> <span class="o">=</span> <span class="o">(</span><span class="n">value</span> <span class="o">==</span> <span class="n">ddlist</span><span class="o">.</span><span class="na">dropTargetCell</span><span class="o">)</span>
        <span class="kt">boolean</span> <span class="n">showSelected</span> <span class="o">=</span> <span class="n">isSelected</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">isTargetCell</span>
        <span class="k">return</span> <span class="kd">super</span><span class="o">.</span><span class="na">getListCellRendererComponent</span><span class="o">(</span><span class="n">list</span><span class="o">,</span> <span class="n">value</span><span class="o">,</span> <span class="n">index</span><span class="o">,</span> <span class="n">showSelected</span><span class="o">,</span> <span class="n">hasFocus</span><span class="o">)</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">paintComponent</span><span class="o">(</span><span class="n">Graphics</span> <span class="n">g</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">paintComponent</span><span class="o">(</span><span class="n">g</span><span class="o">)</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">isTargetCell</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">g</span><span class="o">.</span><span class="na">setColor</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">black</span><span class="o">)</span>
            <span class="n">g</span><span class="o">.</span><span class="na">drawLine</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">size</span><span class="o">.</span><span class="na">width</span><span class="o">.</span><span class="na">intValue</span><span class="o">(),</span> <span class="mi">0</span><span class="o">)</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="n">lines</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">This is line 1</span>
<span class="s1">This is line 2</span>
<span class="s1">This is line 3</span>
<span class="s1">This is line 4</span>
<span class="s1">&#39;&#39;&#39;</span><span class="o">.</span><span class="na">trim</span><span class="o">().</span><span class="na">split</span><span class="o">(</span><span class="s1">&#39;\n&#39;</span><span class="o">)</span>
<span class="kt">def</span> <span class="n">listModel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultListModel</span><span class="o">()</span>
<span class="n">lines</span><span class="o">.</span><span class="na">each</span><span class="o">{</span> <span class="n">listModel</span><span class="o">.</span><span class="na">addElement</span><span class="o">(</span><span class="n">it</span><span class="o">)</span> <span class="o">}</span>
<span class="n">listModel</span><span class="o">.</span><span class="na">addElement</span><span class="o">(</span><span class="s1">&#39; &#39;</span><span class="o">)</span> <span class="c1">// dummy</span>
<span class="kt">def</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DragDropList</span><span class="o">(</span><span class="n">listModel</span><span class="o">)</span>
<span class="kt">def</span> <span class="n">sp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JScrollPane</span><span class="o">(</span><span class="n">list</span><span class="o">,</span> <span class="n">SPC</span><span class="o">.</span><span class="na">VERTICAL_SCROLLBAR_ALWAYS</span><span class="o">,</span> <span class="n">SPC</span><span class="o">.</span><span class="na">HORIZONTAL_SCROLLBAR_NEVER</span><span class="o">)</span>
<span class="kt">def</span> <span class="n">frame</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JFrame</span><span class="o">(</span><span class="s1">&#39;Line Shuffle Example&#39;</span><span class="o">)</span>
<span class="n">frame</span><span class="o">.</span><span class="na">setDefaultCloseOperation</span><span class="o">(</span><span class="n">WindowConstants</span><span class="o">.</span><span class="na">EXIT_ON_CLOSE</span><span class="o">)</span>
<span class="n">frame</span><span class="o">.</span><span class="na">contentPane</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">sp</span><span class="o">)</span>
<span class="n">frame</span><span class="o">.</span><span class="na">pack</span><span class="o">()</span>
<span class="n">frame</span><span class="o">.</span><span class="na">setVisible</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="dbaccess.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="processmanagementetc.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Database Access</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Process Management and Communication</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>