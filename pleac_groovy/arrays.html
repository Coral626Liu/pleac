<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Arrays</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="PLEAC-Groovy"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="Dates and Times"
HREF="datesandtimes.html"><LINK
REL="NEXT"
TITLE="Hashes"
HREF="hashes.html"><style type="text/css">td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }

  </style></head
><BODY TEXT="#cecece" BGCOLOR="#4f6f6f" LINK="#f5deb3" VLINK="#d5ae83"
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PLEAC-Groovy</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="datesandtimes.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="hashes.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="ARRAYS"
>4. Arrays</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN170"
>Introduction</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s"></span><span class="s">//----------------------------------------------------------------------------------</span>
<span class="s">simple = [ &quot;this&quot;, &quot;that&quot;, &quot;the&quot;, &quot;other&quot; ]</span>
<span class="s">nested = [ &quot;this&quot;, &quot;that&quot;, [ &quot;the&quot;, &quot;other&quot; ] ]</span>
<span class="s">assert nested.size() == 3</span>
<span class="s">assert nested[2].size() == 2</span>

<span class="s">flattenNestedToSimple = [ &quot;this&quot;, &quot;that&quot;, [ &quot;the&quot;, &quot;other&quot; ] ].flatten()</span>
<span class="s">assert flattenNestedToSimple.size() == 4</span>
<span class="s">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN173"
>Specifying a List In Your Program</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s"></span><span class="s">//----------------------------------------------------------------------------------</span>
<span class="s">a = [ &quot;quick&quot;, &quot;brown&quot;, &quot;fox&quot; ]</span>
<span class="s">assert a.size() == 3</span>
<span class="s">a = &#39;Why are you teasing me?&#39;.split(&#39; &#39;)</span>
<span class="s">assert a == [&quot;Why&quot;, &quot;are&quot;, &quot;you&quot;, &quot;teasing&quot;, &quot;me?&quot;]</span>

<span class="s">removeLeadingSpaces = { it.trim() }</span>
<span class="s">nonBlankLines = { it }</span>
<span class="s">lines = &#39;&#39;&#39;</span>
<span class="s">    The boy stood on the burning deck,</span>
<span class="s">    It was as hot as glass.</span>
<span class="s">&#39;&#39;&#39;.split(&#39;\n&#39;).collect(removeLeadingSpaces).findAll(nonBlankLines)</span>

<span class="s">assert lines == [&quot;The boy stood on the burning deck,&quot;,</span>
<span class="s">                 &quot;It was as hot as glass.&quot;]</span>

<span class="s">// initialiseListFromFileScript:</span>
<span class="s">lines = new File(&#39;mydata.txt&#39;).readLines()</span>

<span class="s">// processFileScript:</span>
<span class="s">new File(&#39;mydata.txt&#39;).eachLine{</span>
<span class="s">    // dosomething</span>
<span class="s">}</span>
<span class="s">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN176"
>Printing a List with Commas</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s"></span><span class="s">//----------------------------------------------------------------------------------</span>
<span class="s">marbleColors = [&#39;red&#39;, &#39;green&#39;, &#39;yellow&#39;]</span>
<span class="s">assert marbleColors.join(&#39;, &#39;) == &#39;red, green, yellow&#39;</span>

<span class="s">def commify(items) {</span>
<span class="s">    if (!items) return items</span>
<span class="s">    def sepchar = items.find{ it =~ /,/ } ? &#39;; &#39; : &#39;, &#39;</span>
<span class="s">    switch (items.size()) {</span>
<span class="s">        case 1: return items[0]</span>
<span class="s">        case 2: return items.join(&#39; and &#39;)</span>
<span class="s">    }</span>
<span class="s">    items[0..-2].join(sepchar) + sepchar + &#39;and &#39; + items[-1]</span>
<span class="s">}</span>

<span class="s">assert commify(marbleColors) == &#39;red, green, and yellow&#39;</span>

<span class="s">lists = [</span>
<span class="s">    [ &#39;just one thing&#39; ],</span>
<span class="s">    [ &#39;Mutt&#39;, &#39;Jeff&#39; ],</span>
<span class="s">    &#39;Peter Paul Mary&#39;.split(&#39; &#39;),</span>
<span class="s">    [ &#39;To our parents&#39;, &#39;Mother Theresa&#39;, &#39;God&#39; ],</span>
<span class="s">    [ &#39;pastrami&#39;, &#39;ham and cheese&#39;, &#39;peanut butter and jelly&#39;, &#39;tuna&#39; ],</span>
<span class="s">    [ &#39;recycle tired, old phrases&#39;, &#39;ponder big, happy thoughts&#39; ],</span>
<span class="s">    [ &#39;recycle tired, old phrases&#39;,</span>
<span class="s">      &#39;ponder big, happy thoughts&#39;,</span>
<span class="s">      &#39;sleep and dream peacefully&#39; ],</span>
<span class="s">]</span>

<span class="s">expected = &#39;&#39;&#39;</span>
<span class="s">just one thing</span>
<span class="s">Mutt and Jeff</span>
<span class="s">Peter, Paul, and Mary</span>
<span class="s">To our parents, Mother Theresa, and God</span>
<span class="s">pastrami, ham and cheese, peanut butter and jelly, and tuna</span>
<span class="s">recycle tired, old phrases and ponder big, happy thoughts</span>
<span class="s">recycle tired, old phrases; ponder big, happy thoughts; and sleep and dream peacefully</span>
<span class="s">&#39;&#39;&#39;</span>

<span class="s">assert expected == &#39;\n&#39; + lists.collect{commify(it)}.join(&#39;\n&#39;) + &#39;\n&#39;</span>
<span class="s">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN179"
>Changing Array Size</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s"></span><span class="s">//----------------------------------------------------------------------------------</span>
<span class="s">// In Groovy, lists and arrays are more or less interchangeable</span>
<span class="s">// here is the example using lists</span>
<span class="s">people = [&#39;Crosby&#39;, &#39;Stills&#39;, &#39;Nash&#39;]</span>
<span class="s">assert people.size() == 3</span>
<span class="s">people[3] = &#39;Young&#39;</span>
<span class="s">assert people.size() == 4</span>
<span class="s">assert people == [&#39;Crosby&#39;, &#39;Stills&#39;, &#39;Nash&#39;, &#39;Young&#39;]</span>
<span class="s">// to use arrays simply do &#39;people = peopleArray.toList()&#39; at the start</span>
<span class="s">// and &#39;peopleArray = people as String[]&#39; at the end</span>
<span class="s">// if you attempt to do extension on a Java array you will get an</span>
<span class="s">// ArrayIndexOutOfBoundsException - which is why Java has ArrayList et al</span>
<span class="s">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN182"
>Doing Something with Every Element in a List</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s"></span><span class="s">//----------------------------------------------------------------------------------</span>
<span class="s">// list to process</span>
<span class="s">people == [&#39;Crosby&#39;, &#39;Stills&#39;, &#39;Nash&#39;, &#39;Young&#39;]</span>
<span class="s">// helper</span>
<span class="s">startsWithCapital = { word -&gt; word[0] in &#39;A&#39;..&#39;Z&#39; }</span>

<span class="s">// various styles are possible for processing lists</span>
<span class="s">// closure style</span>
<span class="s">people.each { person -&gt; assert startsWithCapital(person) }</span>
<span class="s">// for loop style</span>
<span class="s">for (person in people) { assert startsWithCapital(person) }</span>

<span class="s">// unixScriptToFindAllUsersStartingWithLetterA:</span>
<span class="s">all = &#39;who&#39;.execute().text.replaceAll(&#39;\r&#39;, &#39;&#39;).split(&#39;\n&#39;)</span>
<span class="s">all.grep(~/^a.*/).each{ println it }</span>

<span class="s">// printFileWithWordsReversedScript:</span>
<span class="s">new File(&#39;Pleac/src/SlowCat.groovy&#39;).eachLine{ line -&gt;</span>
<span class="s">     line.split(&#39; &#39;).each{ print it.reverse() }</span>
<span class="s">}</span>

<span class="s">a = [0.5, 3]; b = [0, 1]</span>
<span class="s">assert [a, b].flatten().collect{ it * 7 } == [3.5, 21, 0, 7]</span>
<span class="s">// above doesn&#39;t modify original arrays</span>
<span class="s">// instead use a = a.collect{ ... }</span>
<span class="s">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN185"
>Iterating Over an Array by Reference</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s"></span><span class="s">//----------------------------------------------------------------------------------</span>
<span class="s">// not relevant in Groovy since we have always references</span>
<span class="s">items = []</span>
<span class="s">for (item in items) {</span>
<span class="s">    // do something with item</span>
<span class="s">}</span>
<span class="s">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN188"
>Extracting Unique Elements from a List</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s"></span><span class="s">//----------------------------------------------------------------------------------</span>
<span class="s">assert [ 1, 1, 2, 2, 3, 3, 3, 5 ].unique() == [ 1, 2, 3, 5 ]</span>
<span class="s">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN191"
>Finding Elements in One Array but Not Another</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s"></span><span class="s">//----------------------------------------------------------------------------------</span>
<span class="s">assert [ 1, 1, 2, 2, 3, 3, 3, 4, 5 ] - [ 1, 2, 4 ]  ==  [3, 3, 3, 5]</span>
<span class="s">assert [ 1, 1, 2, 2, 3, 3, 3, 4, 5 ].unique() - [ 1, 2, 4 ]  ==  [3, 5]</span>
<span class="s">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN194"
>Computing Union, Intersection, or Difference of Unique Lists</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s"></span><span class="s">//----------------------------------------------------------------------------------</span>
<span class="s">a = [1, 3, 5, 6, 7, 8]</span>
<span class="s">b = [2, 3, 5, 7, 9]</span>
<span class="s">// intersection</span>
<span class="s">assert a.intersect(b) == [3, 5, 7]</span>
<span class="s">// union</span>
<span class="s">assert (a + b).unique().sort() == [1, 2, 3, 5, 6, 7, 8, 9]</span>
<span class="s">// difference</span>
<span class="s">assert (a - b) == [1, 6, 8]</span>
<span class="s">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN197"
>Appending One Array to Another</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s"></span><span class="s">//----------------------------------------------------------------------------------</span>
<span class="s">members = [ &quot;Time&quot;, &quot;Flies&quot; ]</span>
<span class="s">initiates =  [ &quot;An&quot;, &quot;Arrow&quot; ]</span>
<span class="s">members += initiates</span>
<span class="s">assert members == [&quot;Time&quot;, &quot;Flies&quot;, &quot;An&quot;, &quot;Arrow&quot;]</span>

<span class="s">members.add(2, &quot;Like&quot;)</span>
<span class="s">assert members == [&quot;Time&quot;, &quot;Flies&quot;, &quot;Like&quot;, &quot;An&quot;, &quot;Arrow&quot;]</span>

<span class="s">members[0] = &quot;Fruit&quot;</span>
<span class="s">members[3..4] = [&quot;A&quot;, &quot;Banana&quot;]</span>
<span class="s">assert members == [&quot;Fruit&quot;, &quot;Flies&quot;, &quot;Like&quot;, &quot;A&quot;, &quot;Banana&quot;]</span>
<span class="s">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN200"
>Reversing an Array</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s"></span><span class="s">//----------------------------------------------------------------------------------</span>
<span class="s">items = [&quot;the&quot;, &quot;quick&quot;, &quot;brown&quot;, &quot;fox&quot;]</span>
<span class="s">assert items.reverse() == [&quot;fox&quot;, &quot;brown&quot;, &quot;quick&quot;, &quot;the&quot;]</span>

<span class="s">firstLetters = []</span>
<span class="s">items.reverseEach{ firstLetters += it[0] }</span>
<span class="s">assert firstLetters.join() == &#39;fbqt&#39;</span>

<span class="s">descending = items.sort().reverse()</span>
<span class="s">assert descending == [&quot;the&quot;, &quot;quick&quot;, &quot;fox&quot;, &quot;brown&quot;]</span>
<span class="s">descendingBySecondLastLetter = items.sort { a,b -&gt; b[-2] &lt;=&gt; a[-2] }</span>
<span class="s">assert descendingBySecondLastLetter == [&quot;brown&quot;, &quot;fox&quot;, &quot;the&quot;, &quot;quick&quot;]</span>
<span class="s">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN203"
>Processing Multiple Elements of an Array</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s"></span><span class="s">//----------------------------------------------------------------------------------</span>
<span class="s">// warning: not an exact equivalent, idiomatic use would return copies</span>
<span class="s">def shift2 = {one = friends[0]; two = friends[1]; 2.times{friends.remove(0)}}</span>
<span class="s">friends = &#39;Peter Paul Mary Jim Tim&#39;.split(&#39; &#39;).toList()</span>
<span class="s">shift2()</span>
<span class="s">assert one == &#39;Peter&#39;</span>
<span class="s">assert two == &#39;Paul&#39;</span>
<span class="s">assert friends == [&quot;Mary&quot;, &quot;Jim&quot;, &quot;Tim&quot;]</span>

<span class="s">def pop2(items) { items[0..1] }</span>
<span class="s">beverages = &#39;Dew Jolt Cola Sprite Fresca&#39;.split(&#39; &#39;).toList()</span>
<span class="s">pair = pop2(beverages)</span>
<span class="s">assert pair == [&quot;Dew&quot;, &quot;Jolt&quot;]</span>
<span class="s">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN206"
>Finding the First List Element That Passes a Test</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s"></span><span class="s">//----------------------------------------------------------------------------------</span>
<span class="s">class Employee {</span>
<span class="s">    def name</span>
<span class="s">    def position</span>
<span class="s">    def salary</span>
<span class="s">}</span>
<span class="s">staff = [new Employee(name:&#39;Jim&#39;,position:&#39;Manager&#39;,salary:26000),</span>
<span class="s">         new Employee(name:&#39;Jill&#39;,position:&#39;Engineer&#39;,salary:24000),</span>
<span class="s">         new Employee(name:&#39;Jack&#39;,position:&#39;Engineer&#39;,salary:22000)]</span>
<span class="s">highestEngineer = staff.find { emp -&gt; emp.position == &#39;Engineer&#39; }</span>
<span class="s">assert highestEngineer.salary == 24000</span>
<span class="s">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN209"
>Finding All Elements in an Array Matching Certain Criteria</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s"></span><span class="s">//----------------------------------------------------------------------------------</span>
<span class="s">engineers = staff.findAll { e -&gt; e.position == &#39;Engineer&#39; }</span>
<span class="s">assert engineers.size() == 2</span>

<span class="s">highPaid = staff.findAll { e -&gt; e.salary &gt; 23000 }</span>
<span class="s">assert highPaid*.name == [&quot;Jim&quot;, &quot;Jill&quot;]</span>
<span class="s">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN212"
>Sorting an Array Numerically</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s"></span><span class="s">//----------------------------------------------------------------------------------</span>
<span class="s">// sort works for numbers</span>
<span class="s">assert [100, 3, 20].sort() == [3, 20, 100]</span>
<span class="s">// strings representing numbers will be sorted alphabetically</span>
<span class="s">assert [&#39;100&#39;, &#39;3&#39;, &#39;20&#39;].sort() == [&quot;100&quot;, &quot;20&quot;, &quot;3&quot;]</span>
<span class="s">// closure style sorting allows arbitrary expressions for the comparison</span>
<span class="s">assert [&#39;100&#39;, &#39;3&#39;, &#39;20&#39;].sort{ a,b -&gt; a.toLong() &lt;=&gt; b.toLong()} == [&quot;3&quot;, &quot;20&quot;, &quot;100&quot;]</span>

<span class="s">// obtain the following on unix systems using: &#39;ps ux&#39;.execute().text</span>
<span class="s">processInput = &#39;&#39;&#39;</span>
<span class="s">      PID    PPID    PGID     WINPID  TTY  UID    STIME COMMAND</span>
<span class="s">     3868       1    3868       3868  con 1005 06:23:34 /usr/bin/bash</span>
<span class="s">     3456    3868    3456       3528  con 1005 06:23:39 /usr/bin/ps</span>
<span class="s">&#39;&#39;&#39;</span>
<span class="s">nonEmptyLines = {it.trim()}</span>
<span class="s">lines = processInput.split(&quot;\n&quot;).findAll(nonEmptyLines)[1..-1]</span>
<span class="s">def col(n, s) { s.tokenize()[n] }</span>
<span class="s">commandIdx = 7</span>
<span class="s">pidIdx = 0</span>
<span class="s">ppidIdx = 1</span>
<span class="s">linesByPid = lines.sort{ col(pidIdx,it).toLong() }</span>
<span class="s">assert col(commandIdx, linesByPid[0]) == &#39;/usr/bin/ps&#39;</span>
<span class="s">linesByPpid = lines.sort{ col(ppidIdx,it).toLong() }</span>
<span class="s">assert col(commandIdx, linesByPpid[0]) == &#39;/usr/bin/bash&#39;</span>
<span class="s">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN215"
>Sorting a List by Computable Field</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s"></span><span class="s">//----------------------------------------------------------------------------------</span>
<span class="s">// sort staff from 4.12 by name</span>
<span class="s">assert staff.sort { a,b -&gt; a.name &lt;=&gt; b.name }*.name == [&quot;Jack&quot;, &quot;Jill&quot;, &quot;Jim&quot;]</span>
<span class="s">// sort by first two characters of name and if equal by descending salary</span>
<span class="s">assert staff.sort { a,b -&gt;</span>
<span class="s">    astart = a.name[0..1]</span>
<span class="s">    bstart = b.name[0..1]</span>
<span class="s">    if (astart == bstart) return b.salary &lt;=&gt; a.salary</span>
<span class="s">    return astart &lt;=&gt; bstart</span>
<span class="s">}*.name == [&quot;Jack&quot;, &quot;Jim&quot;, &quot;Jill&quot;]</span>
<span class="s">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN218"
>Implementing a Circular List</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s"></span><span class="s">//----------------------------------------------------------------------------------</span>
<span class="s">items = [1, 2, 3, 4, 5]</span>
<span class="s">processed = []</span>
<span class="s">10.times{</span>
<span class="s">    processed &lt;&lt; items[0]</span>
<span class="s">    items = items[1..-1] + items[0]</span>
<span class="s">}</span>
<span class="s">assert processed == [1, 2, 3, 4, 5, 1, 2, 3, 4, 5]</span>
<span class="s">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN221"
>Randomizing an Array</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s"></span><span class="s">//----------------------------------------------------------------------------------</span>
<span class="s">import java.text.DateFormatSymbols as Symbols</span>
<span class="s">items = new Symbols().shortWeekdays.toList()[1..7]</span>
<span class="s">assert items == [&quot;Sun&quot;, &quot;Mon&quot;, &quot;Tue&quot;, &quot;Wed&quot;, &quot;Thu&quot;, &quot;Fri&quot;, &quot;Sat&quot;]</span>
<span class="s">// not as random as you might expect</span>
<span class="s">println items.sort{ Math.random() }</span>
<span class="s">// =&gt; [&quot;Sat&quot;, &quot;Tue&quot;, &quot;Sun&quot;, &quot;Wed&quot;, &quot;Mon&quot;, &quot;Thu&quot;, &quot;Fri&quot;]</span>
<span class="s">// better to use the built-in method for this purpose</span>
<span class="s">Collections.shuffle(items)</span>
<span class="s">println items</span>
<span class="s">// =&gt; [&quot;Wed&quot;, &quot;Tue&quot;, &quot;Fri&quot;, &quot;Sun&quot;, &quot;Sat&quot;, &quot;Thu&quot;, &quot;Mon&quot;]</span>
<span class="s">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN224"
>Program: words</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s"></span><span class="s">//----------------------------------------------------------------------------------</span>
<span class="s">symbols = new Symbols()</span>
<span class="s">words = symbols.weekdays.toList()[1..7] +</span>
<span class="s">    symbols.months.toList()[0..11] +</span>
<span class="s">    symbols.eras.toList() +</span>
<span class="s">    symbols.amPmStrings.toList()</span>

<span class="s">expected = //</span>
<span class="s">&#39;AD        August    February  July      May       October   September Tuesday   \n&#39; +</span>
<span class="s">&#39;AM        BC        Friday    June      Monday    PM        Sunday    Wednesday \n&#39; +</span>
<span class="s">&#39;April     December  January   March     November  Saturday  Thursday  \n&#39;</span>

<span class="s">class WordFormatter {</span>
<span class="s">    def cols</span>

<span class="s">    def process(list) {</span>
<span class="s">        def sb = new StringBuffer()</span>
<span class="s">        def colWidth = list.max{it.size()}.size() + 1</span>
<span class="s">        int columns = [cols/colWidth, 1].max()</span>
<span class="s">        def numWords = list.size()</span>
<span class="s">        int rows = (numWords + columns - 1) / columns</span>
<span class="s">        for (row in 0..&lt;rows) {</span>
<span class="s">            for (col in 0..&lt;columns) {</span>
<span class="s">                def target = row + col * rows</span>
<span class="s">                if (target &lt; numWords)</span>
<span class="s">                    sb &lt;&lt; list[target].padRight(colWidth)</span>
<span class="s">            }</span>
<span class="s">            sb &lt;&lt; &#39;\n&#39;</span>
<span class="s">        }</span>
<span class="s">        return sb.toString()</span>
<span class="s">    }</span>
<span class="s">}</span>

<span class="s">// get nr of chars that fit in window or console, see PLEAC 15.4</span>
<span class="s">// hard-coded here but several packages are available, e.g. in JLine</span>
<span class="s">// use a concrete implementation of Terminal.getTerminalWidth()</span>
<span class="s">def getWinCharWidth() { 80 }</span>

<span class="s">// main script</span>
<span class="s">actual = new WordFormatter(cols:getWinCharWidth()).process(words.sort())</span>
<span class="s">assert actual == expected</span>
<span class="s">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN227"
>Program: permute</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="s"></span><span class="s">//----------------------------------------------------------------------------------</span>
<span class="s">// recursive version is simplest but can be inefficient</span>
<span class="s">def fact(n) { (n == 1) ? 1 : n * fact(n-1)}</span>
<span class="s">assert fact(10) == 3628800</span>
<span class="s">// unwrapped version: note use of BigInteger</span>
<span class="s">def factorial(n) {</span>
<span class="s">    def result = 1G // 1 as BigInteger</span>
<span class="s">    while (n &gt; 0) {</span>
<span class="s">        result *= n</span>
<span class="s">        n -= 1</span>
<span class="s">    }</span>
<span class="s">    return result</span>
<span class="s">}</span>
<span class="s">expected = 93326215443944152681699238856266700490715968264381621468592963895217599993229915608941463976156518286253697920827223758251185210916864000000000000000000000000</span>
<span class="s">assert expected == factorial(100)</span>
<span class="s">// println factorial(10000)</span>
<span class="s">// =&gt; 284625... (greater than 35,000 digits)</span>

<span class="s">// simple version but less efficient</span>
<span class="s">def simplePermute(items, perms) {</span>
<span class="s">    if (items.size() == 0)</span>
<span class="s">        println perms.join(&#39; &#39;)</span>
<span class="s">    else</span>
<span class="s">        for (i in items) {</span>
<span class="s">            newitems = items.clone()</span>
<span class="s">            newperms = perms.clone()</span>
<span class="s">            newperms.add(i)</span>
<span class="s">            newitems.remove(i)</span>
<span class="s">            simplePermute(newitems, newperms)</span>
<span class="s">        }</span>
<span class="s">}</span>
<span class="s">simplePermute([&#39;dog&#39;, &#39;bites&#39;, &#39;man&#39;], [])</span>
<span class="s">// =&gt;</span>
<span class="s">//dog bites man</span>
<span class="s">//dog man bites</span>
<span class="s">//bites dog man</span>
<span class="s">//bites man dog</span>
<span class="s">//man dog bites</span>
<span class="s">//man bites dog</span>

<span class="s">// optimised version below</span>
<span class="s">expected = &#39;&#39;&#39;</span>
<span class="s">man bites dog</span>
<span class="s">man dog bites</span>
<span class="s">bites man dog</span>
<span class="s">bites dog man</span>
<span class="s">dog man bites</span>
<span class="s">dog bites man</span>
<span class="s">&#39;&#39;&#39;</span>

<span class="s">// n2pat(n, len): produce the N-th pattern of length len</span>
<span class="s">def n2pat(n, length) {</span>
<span class="s">    def pat = []</span>
<span class="s">    int i = 1</span>
<span class="s">    while (i &lt;= length) {</span>
<span class="s">        pat &lt;&lt; (n % i)</span>
<span class="s">        n = n.intdiv(i)</span>
<span class="s">        i += 1</span>
<span class="s">    }</span>
<span class="s">    pat</span>
<span class="s">}</span>

<span class="s">// pat2perm(pat): turn pattern returned by n2pat() into</span>
<span class="s">// permutation of integers.</span>
<span class="s">def pat2perm(pat) {</span>
<span class="s">    def source = (0 ..&lt; pat.size()).collect{ it/*.toString()*/ }</span>
<span class="s">    def perm = []</span>
<span class="s">    while (pat.size() &gt; 0) {</span>
<span class="s">        def next = pat.remove(pat.size()-1)</span>
<span class="s">        perm &lt;&lt; source[next]</span>
<span class="s">        source.remove(next)</span>
<span class="s">    }</span>
<span class="s">    perm</span>
<span class="s">}</span>

<span class="s">def n2perm(n, len) {</span>
<span class="s">    pat2perm(n2pat((int)n,len))</span>
<span class="s">}</span>

<span class="s">data = [&#39;man&#39;, &#39;bites&#39;, &#39;dog&#39;]</span>
<span class="s">sb = new StringBuffer()</span>
<span class="s">numPermutations = fact(data.size())</span>
<span class="s">for (j in 0..&lt;numPermutations) {</span>
<span class="s">    def permutation = n2perm(j, data.size()).collect { k -&gt; data[k] }</span>
<span class="s">    sb &lt;&lt; permutation.join(&#39; &#39;) + &#39;\n&#39;</span>
<span class="s">}</span>
<span class="s">assert &#39;\n&#39; + sb.toString() == expected</span>
<span class="s">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="datesandtimes.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="hashes.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Dates and Times</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Hashes</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>