<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Hashes</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="PLEAC-Python"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="Arrays"
HREF="arrays.html"><LINK
REL="NEXT"
TITLE="Pattern Matching"
HREF="patternmatching.html"><style type="text/css">td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }

  </style></head
><BODY TEXT="#cecece" BGCOLOR="#4f6f6f" LINK="#f5deb3" VLINK="#d5ae83"
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PLEAC-Python</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="arrays.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="patternmatching.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="HASHES"
>5. Hashes</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN232"
>Introduction</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c"># dictionaries</span>
<span class="n">age</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;Nat&quot;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
       <span class="s">&quot;Jules&quot;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
       <span class="s">&quot;Josh&quot;</span><span class="p">:</span> <span class="mi">17</span><span class="p">}</span>
<span class="c">#-----------------------------</span>
<span class="n">age</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">age</span><span class="p">[</span><span class="s">&quot;Nat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span>
<span class="n">age</span><span class="p">[</span><span class="s">&quot;Jules&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">age</span><span class="p">[</span><span class="s">&quot;Josh&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">17</span>
<span class="c">#-----------------------------</span>
<span class="n">food_color</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;Apple&quot;</span><span class="p">:</span>  <span class="s">&quot;red&quot;</span><span class="p">,</span>
              <span class="s">&quot;Banana&quot;</span><span class="p">:</span> <span class="s">&quot;yellow&quot;</span><span class="p">,</span>
              <span class="s">&quot;Lemon&quot;</span><span class="p">:</span>  <span class="s">&quot;yellow&quot;</span><span class="p">,</span>
              <span class="s">&quot;Carrot&quot;</span><span class="p">:</span> <span class="s">&quot;orange&quot;</span>
             <span class="p">}</span>
<span class="c">#-----------------------------</span>
<span class="c"># NOTE: keys must be quoted in Python</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN235"
>Adding an Element to a Hash</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="n">mydict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<span class="c">#-----------------------------</span>
<span class="c"># food_color defined per the introduction</span>
<span class="n">food_color</span><span class="p">[</span><span class="s">&quot;Raspberry&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;pink&quot;</span>
<span class="k">print</span> <span class="s">&quot;Known foods:&quot;</span>
<span class="k">for</span> <span class="n">food</span> <span class="ow">in</span> <span class="n">food_color</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">food</span>

<span class="c">#=&gt; Known foods:</span>
<span class="c">#=&gt; Raspberry</span>
<span class="c">#=&gt; Carrot</span>
<span class="c">#=&gt; Lemon</span>
<span class="c">#=&gt; Apple</span>
<span class="c">#=&gt; Banana</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN238"
>Testing for the Presence of a Key in a Hash</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c"># does mydict have a value for key?</span>
<span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">mydict</span><span class="p">:</span>
    <span class="k">pass</span> <span class="c"># it exists</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">pass</span> <span class="c"># it doesn&#39;t</span>

<span class="c">#-----------------------------</span>
<span class="c"># food_color per the introduction</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;Banana&quot;</span><span class="p">,</span> <span class="s">&quot;Martini&quot;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">food_color</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">name</span><span class="p">,</span> <span class="s">&quot;is a food.&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">name</span><span class="p">,</span> <span class="s">&quot;is a drink.&quot;</span>

<span class="c">#=&gt; Banana is a food.</span>
<span class="c">#=&gt; Martini is a drink.</span>
<span class="c">#-----------------------------</span>
<span class="n">age</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">age</span><span class="p">[</span><span class="s">&quot;Toddler&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">age</span><span class="p">[</span><span class="s">&quot;Unborn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">age</span><span class="p">[</span><span class="s">&quot;Phantasm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

<span class="k">for</span> <span class="n">thing</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;Toddler&quot;</span><span class="p">,</span> <span class="s">&quot;Unborn&quot;</span><span class="p">,</span> <span class="s">&quot;Phantasm&quot;</span><span class="p">,</span> <span class="s">&quot;Relic&quot;</span><span class="p">):</span>
    <span class="k">print</span> <span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">:&quot;</span><span class="o">%</span><span class="n">thing</span><span class="p">),</span>
    <span class="k">if</span> <span class="n">thing</span> <span class="ow">in</span> <span class="n">age</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;Exists&quot;</span><span class="p">,</span>
        <span class="k">if</span> <span class="n">age</span><span class="p">[</span><span class="n">thing</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;Defined&quot;</span><span class="p">,</span>
        <span class="k">if</span> <span class="n">age</span><span class="p">[</span><span class="n">thing</span><span class="p">]:</span>
            <span class="k">print</span> <span class="s">&quot;True&quot;</span><span class="p">,</span>
    <span class="k">print</span>
<span class="c">#=&gt; Toddler: Exists Defined True</span>
<span class="c">#=&gt; Unborn: Exists Defined</span>
<span class="c">#=&gt; Phantasm: Exists</span>
<span class="c">#=&gt; Relic:</span>
<span class="c">#-----------------------------</span>
<span class="c"># Get file sizes for the requested filenames</span>
<span class="kn">import</span> <span class="nn">fileinput</span><span class="o">,</span> <span class="nn">os</span>
<span class="n">size</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fileinput</span><span class="o">.</span><span class="n">input</span><span class="p">():</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">size</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="n">size</span><span class="p">[</span><span class="n">filename</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN241"
>Deleting from a Hash</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c"># remove key and its value from mydict</span>
<span class="k">del</span> <span class="n">mydict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="c">#-----------------------------</span>
<span class="c"># food_color as per Introduction</span>
<span class="k">def</span> <span class="nf">print_foods</span><span class="p">():</span>
    <span class="n">foods</span> <span class="o">=</span> <span class="n">food_color</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

    <span class="k">print</span> <span class="s">&quot;Keys:&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">foods</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&quot;Values:&quot;</span><span class="p">,</span>

    <span class="k">for</span> <span class="n">food</span> <span class="ow">in</span> <span class="n">foods</span><span class="p">:</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">food_color</span><span class="p">[</span><span class="n">food</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">print</span> <span class="n">color</span><span class="p">,</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;(undef)&quot;</span><span class="p">,</span>
    <span class="k">print</span>

<span class="k">print</span> <span class="s">&quot;Initially:&quot;</span>
<span class="n">print_foods</span><span class="p">()</span>

<span class="k">print</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">With Banana set to None&quot;</span>
<span class="n">food_color</span><span class="p">[</span><span class="s">&quot;Banana&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">print_foods</span><span class="p">()</span>

<span class="k">print</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">With Banana deleted&quot;</span>
<span class="k">del</span> <span class="n">food_color</span><span class="p">[</span><span class="s">&quot;Banana&quot;</span><span class="p">]</span>
<span class="n">print_foods</span><span class="p">()</span>

<span class="c">#=&gt; Initially:</span>
<span class="c">#=&gt; Keys: Carrot Lemon Apple Banana</span>
<span class="c">#=&gt; Values: orange yellow red yellow</span>
<span class="c">#=&gt; </span>
<span class="c">#=&gt; With Banana set to None</span>
<span class="c">#=&gt; Keys: Carrot Lemon Apple Banana</span>
<span class="c">#=&gt; Values: orange yellow red (undef)</span>
<span class="c">#=&gt; </span>
<span class="c">#=&gt; With Banana deleted</span>
<span class="c">#=&gt; Keys: Carrot Lemon Apple</span>
<span class="c">#=&gt; Values: orange yellow red</span>
<span class="c">#-----------------------------</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;Banana&quot;</span><span class="p">,</span> <span class="s">&quot;Apple&quot;</span><span class="p">,</span> <span class="s">&quot;Cabbage&quot;</span><span class="p">]:</span>
    <span class="k">del</span> <span class="n">food_color</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN244"
>Traversing a Hash</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">mydict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>  
    <span class="k">pass</span> <span class="c"># do something with key and value</span>

<span class="c"># If mydict is large, use iteritems() instead</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">mydict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>  
    <span class="k">pass</span> <span class="c"># do something with key and value</span>

<span class="c">#-----------------------------</span>
<span class="c"># DON&#39;T DO THIS:</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">mydict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">mydict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="c"># do something with key and value</span>
<span class="c">#-----------------------------</span>
<span class="c"># food_color per the introduction</span>
<span class="k">for</span> <span class="n">food</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">food_color</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> is </span><span class="si">%s</span><span class="s">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">food</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>

<span class="c"># DON&#39;T DO THIS:</span>
<span class="k">for</span> <span class="n">food</span> <span class="ow">in</span> <span class="n">food_color</span><span class="p">:</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">food_color</span><span class="p">[</span><span class="n">food</span><span class="p">]</span>
    <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> is </span><span class="si">%s</span><span class="s">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">food</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>

<span class="c">#-----------------------------</span>
<span class="k">print</span> <span class="s">&quot;&quot;&quot;</span><span class="si">%(food)s</span><span class="s"></span>

<span class="s">is</span>

<span class="si">%(color)s</span><span class="s">.</span>
<span class="s">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="nb">vars</span><span class="p">()</span>
<span class="c">#-----------------------------</span>
<span class="k">for</span> <span class="n">food</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">food_color</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> is </span><span class="si">%s</span><span class="s">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">food</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>

<span class="c">#-----------------------------</span>
<span class="c">#!/usr/bin/env python</span>
<span class="c"># countfrom - count number of messages from each sender</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">infile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">infile</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span>

<span class="n">counts</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">infile</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;From: &quot;</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">counts</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

<span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">counts</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>

<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN247"
>Printing a Hash</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">mydict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">print</span> <span class="n">key</span><span class="p">,</span> <span class="s">&quot;=&gt;&quot;</span><span class="p">,</span> <span class="n">val</span>
<span class="c">#-----------------------------</span>
<span class="k">print</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> =&gt; </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">mydict</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
<span class="c">#-----------------------------</span>
<span class="k">print</span> <span class="n">mydict</span>
<span class="c">#=&gt; {&#39;firstname&#39;: &#39;Andrew&#39;, &#39;login&#39;: &#39;dalke&#39;, &#39;state&#39;: &#39;New Mexico&#39;, &#39;lastname&#39;: &#39;Dalke&#39;}</span>
<span class="c">#-----------------------------</span>
<span class="kn">import</span> <span class="nn">pprint</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
<span class="c">#=&gt; {&#39;firstname&#39;: &#39;Andrew&#39;,</span>
<span class="c">#=&gt;  &#39;lastname&#39;: &#39;Dalke&#39;,</span>
<span class="c">#=&gt;  &#39;login&#39;: &#39;dalke&#39;,</span>
<span class="c">#=&gt;  &#39;state&#39;: &#39;New Mexico&#39;}</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN250"
>Retrieving from a Hash in Insertion Order</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="k">class</span> <span class="nc">SequenceDict</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dictionary that remembers the insertion order.</span>
<span class="sd">    The lists returned by keys(), values() and items() are</span>
<span class="sd">    in the insertion order.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_keys</span><span class="o">=</span><span class="p">{}</span> <span class="c"># key --&gt; id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ids</span><span class="o">=</span><span class="p">{}</span>      <span class="c"># id  --&gt; key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_next_id</span><span class="o">=</span><span class="mi">0</span>
        
    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_keys</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_next_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ids</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_next_id</span><span class="p">]</span><span class="o">=</span><span class="n">key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_next_id</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="n">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_keys</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">del</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_keys</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">del</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ids</span><span class="p">[</span><span class="nb">id</span><span class="p">])</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="n">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">values</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">ids</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ids</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="n">ids</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">:</span>
            <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">values</span>

    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">items</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">ids</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ids</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="n">ids</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">:</span>
            <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">items</span>

    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ids</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ids</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="n">ids</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">keys</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">:</span>
            <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">keys</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="n">value</span>

    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">dict</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_keys</span><span class="o">=</span><span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ids</span><span class="o">=</span><span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_next_id</span><span class="o">=</span><span class="mi">0</span>
        
<span class="k">def</span> <span class="nf">testSequenceDict</span><span class="p">():</span>
    <span class="n">sd</span><span class="o">=</span><span class="n">SequenceDict</span><span class="p">()</span>

    <span class="c"># First Test</span>
    <span class="n">sd</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="s">&quot;first&quot;</span>
    <span class="n">sd</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="s">&quot;second&quot;</span>
    <span class="n">sd</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s">&quot;third&quot;</span>
    <span class="k">print</span> <span class="n">sd</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="k">print</span> <span class="n">sd</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="k">print</span> <span class="n">sd</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

    <span class="k">del</span><span class="p">(</span><span class="n">sd</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">del</span><span class="p">(</span><span class="n">sd</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">del</span><span class="p">(</span><span class="n">sd</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

    <span class="k">print</span> <span class="n">sd</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">sd</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">sd</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="k">print</span> <span class="n">sd</span><span class="o">.</span><span class="n">_ids</span><span class="p">,</span> <span class="n">sd</span><span class="o">.</span><span class="n">_keys</span>

    <span class="k">print</span> <span class="s">&quot;---------------&quot;</span>
    <span class="c"># Second Test</span>
    <span class="n">sd</span><span class="p">[</span><span class="s">&quot;b&quot;</span><span class="p">]</span><span class="o">=</span><span class="s">&quot;first&quot;</span>
    <span class="n">sd</span><span class="p">[</span><span class="s">&quot;a&quot;</span><span class="p">]</span><span class="o">=</span><span class="s">&quot;second&quot;</span>
    <span class="n">sd</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">&quot;c&quot;</span><span class="p">:</span> <span class="s">&quot;third&quot;</span><span class="p">})</span>
    <span class="k">print</span> <span class="n">sd</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="k">print</span> <span class="n">sd</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="k">print</span> <span class="n">sd</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

    <span class="k">del</span><span class="p">(</span><span class="n">sd</span><span class="p">[</span><span class="s">&quot;b&quot;</span><span class="p">])</span>
    <span class="k">del</span><span class="p">(</span><span class="n">sd</span><span class="p">[</span><span class="s">&quot;a&quot;</span><span class="p">])</span>
    <span class="k">del</span><span class="p">(</span><span class="n">sd</span><span class="p">[</span><span class="s">&quot;c&quot;</span><span class="p">])</span>

    <span class="k">print</span> <span class="n">sd</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">sd</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">sd</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="k">print</span> <span class="n">sd</span><span class="o">.</span><span class="n">_ids</span><span class="p">,</span> <span class="n">sd</span><span class="o">.</span><span class="n">_keys</span>

<span class="k">def</span> <span class="nf">likePerlCookbook</span><span class="p">():</span>
    <span class="n">food_color</span><span class="o">=</span><span class="n">SequenceDict</span><span class="p">()</span>
    <span class="n">food_color</span><span class="p">[</span><span class="s">&quot;Banana&quot;</span><span class="p">]</span><span class="o">=</span><span class="s">&quot;Yellow&quot;</span><span class="p">;</span>
    <span class="n">food_color</span><span class="p">[</span><span class="s">&quot;Apple&quot;</span><span class="p">]</span><span class="o">=</span><span class="s">&quot;Green&quot;</span><span class="p">;</span>
    <span class="n">food_color</span><span class="p">[</span><span class="s">&quot;Lemon&quot;</span><span class="p">]</span><span class="o">=</span><span class="s">&quot;Yellow&quot;</span>
    <span class="k">print</span> <span class="s">&quot;In insertion order, the foods&#39; color are:&quot;</span>
    <span class="k">for</span> <span class="n">food</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">food_color</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> is colored </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">food</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c">#testSequenceDict()</span>
    <span class="n">likePerlCookbook</span><span class="p">()</span>
    </PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN253"
>Hashes with Multiple Values Per Key</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">ttys</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">who</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="s">&quot;who&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">who</span><span class="p">:</span>
    <span class="n">user</span><span class="p">,</span> <span class="n">tty</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">ttys</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tty</span><span class="p">)</span>

<span class="k">for</span> <span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">tty_list</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ttys</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="k">print</span> <span class="n">user</span> <span class="o">+</span> <span class="s">&quot;: &quot;</span> <span class="o">+</span> <span class="s">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tty_list</span><span class="p">)</span>
<span class="c">#-----------------------------</span>
<span class="kn">import</span> <span class="nn">pwd</span>
<span class="k">for</span> <span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">tty_list</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ttys</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">print</span> <span class="n">user</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tty_list</span><span class="p">),</span> <span class="s">&quot;ttys.&quot;</span>
    <span class="k">for</span> <span class="n">tty</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">tty_list</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">uid</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="s">&quot;/dev/&quot;</span> <span class="o">+</span> <span class="n">tty</span><span class="p">)</span><span class="o">.</span><span class="n">st_uid</span>
            <span class="n">user</span> <span class="o">=</span> <span class="n">pwd</span><span class="o">.</span><span class="n">getpwuid</span><span class="p">(</span><span class="n">uid</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span> <span class="n">os</span><span class="o">.</span><span class="n">error</span><span class="p">:</span>
            <span class="n">user</span> <span class="o">=</span> <span class="s">&quot;(not available)&quot;</span>
        <span class="k">print</span> <span class="s">&quot;</span><span class="se">\t</span><span class="si">%s</span><span class="s"> (owned by </span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">tty</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN256"
>Inverting a Hash</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c"># lookup_dict maps keys to values</span>
<span class="n">reverse</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">val</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="ow">in</span> <span class="n">lookup_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
<span class="c">#-----------------------------</span>
<span class="n">surname</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;Mickey&quot;</span><span class="p">:</span> <span class="s">&quot;Mantle&quot;</span><span class="p">,</span> <span class="s">&quot;Babe&quot;</span><span class="p">:</span> <span class="s">&quot;Ruth&quot;</span><span class="p">}</span>
<span class="n">first_name</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">last</span><span class="p">,</span> <span class="n">first</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">last</span><span class="p">)</span> <span class="ow">in</span> <span class="n">surname</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>

<span class="k">print</span> <span class="n">first_name</span><span class="p">[</span><span class="s">&quot;Mantle&quot;</span><span class="p">]</span>
<span class="c">#=&gt; Mickey</span>
<span class="c">#-----------------------------</span>
<span class="c">#!/usr/bin/perl -w</span>
<span class="c"># foodfind - find match for food or color</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">(</span><span class="s">&quot;usage: foodfind food_or_color&quot;</span><span class="p">)</span>
<span class="n">given</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">color_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;Apple&quot;</span><span class="p">:</span>  <span class="s">&quot;red&quot;</span><span class="p">,</span>
              <span class="s">&quot;Banana&quot;</span><span class="p">:</span> <span class="s">&quot;yellow&quot;</span><span class="p">,</span>
              <span class="s">&quot;Lemon&quot;</span><span class="p">:</span>  <span class="s">&quot;yellow&quot;</span><span class="p">,</span>
              <span class="s">&quot;Carrot&quot;</span><span class="p">:</span> <span class="s">&quot;orange&quot;</span><span class="p">,</span>
             <span class="p">}</span>
<span class="n">food_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">color</span><span class="p">,</span> <span class="n">food</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">food</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span> <span class="ow">in</span> <span class="n">color_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>

<span class="k">if</span> <span class="n">given</span> <span class="ow">in</span> <span class="n">color_dict</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">given</span><span class="p">,</span> <span class="s">&quot;is a food with color&quot;</span><span class="p">,</span> <span class="n">color_dict</span><span class="p">[</span><span class="n">given</span><span class="p">]</span>
<span class="k">elif</span> <span class="n">given</span> <span class="ow">in</span> <span class="n">food_dict</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">food_dict</span><span class="p">[</span><span class="n">given</span><span class="p">],</span> <span class="s">&quot;is a food with color&quot;</span><span class="p">,</span> <span class="n">given</span>
<span class="c">#-----------------------------</span>
<span class="c"># food_color as per the introduction</span>
<span class="n">foods_with_color</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">food</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">food_color</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">foods_with_color</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">food</span><span class="p">)</span>

<span class="k">print</span> <span class="s">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">foods_with_color</span><span class="p">[</span><span class="s">&quot;yellow&quot;</span><span class="p">]),</span> <span class="s">&quot;were yellow foods.&quot;</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN259"
>Sorting a Hash</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c"># mydict is the hash to sort</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">mydict</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="c"># do something with key, value</span>
<span class="c">#-----------------------------</span>
<span class="c"># food_color as per section 5.8</span>
<span class="k">for</span> <span class="n">food</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">food_color</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> is </span><span class="si">%s</span><span class="s">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">food</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
<span class="c">#-----------------------------</span>
<span class="c"># NOTE: alternative version</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">food_color</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> is </span><span class="si">%s</span><span class="s">.&quot;</span> <span class="o">%</span> <span class="n">item</span>
<span class="c">#-----------------------------</span>
<span class="c"># NOTE: alternative version showing a user-defined function</span>
<span class="k">def</span> <span class="nf">food_cmp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">cmp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="k">for</span> <span class="n">food</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">food_color</span><span class="p">,</span> <span class="nb">cmp</span><span class="o">=</span><span class="n">food_cmp</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> is </span><span class="si">%s</span><span class="s">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">food</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
<span class="c">#-----------------------------</span>
<span class="k">def</span> <span class="nf">food_len_cmp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">cmp</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>

<span class="k">for</span> <span class="n">food</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">food_color</span><span class="p">,</span> <span class="nb">cmp</span><span class="o">=</span><span class="n">food_len_cmp</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> is </span><span class="si">%s</span><span class="s">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">food</span><span class="p">,</span> <span class="n">food_color</span><span class="p">[</span><span class="n">food</span><span class="p">])</span>

<span class="c"># In this instance, however, the following is both simpler and faster:</span>
<span class="k">for</span> <span class="n">food</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">food_color</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">len</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> is </span><span class="si">%s</span><span class="s">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">food</span><span class="p">,</span> <span class="n">food_color</span><span class="p">[</span><span class="n">food</span><span class="p">])</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN262"
>Merging Hashes</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="n">merged</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">merged</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">a_dict</span><span class="p">)</span>
<span class="n">merged</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">b_dict</span><span class="p">)</span>

<span class="c">#-----------------------------</span>
<span class="c"># NOTE: alternative version</span>
<span class="n">merged</span> <span class="o">=</span> <span class="n">a_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">merged</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">b_dict</span><span class="p">)</span>
<span class="c">#-----------------------------</span>
<span class="c"># DON&#39;T DO THIS:</span>

<span class="n">merged</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">a_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">merged</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">b_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">merged</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<span class="c">#-----------------------------</span>
<span class="c"># food_color as per section 5.8</span>
<span class="n">drink_color</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;Galliano&quot;</span><span class="p">:</span> <span class="s">&quot;yellow&quot;</span><span class="p">,</span>
               <span class="s">&quot;Mai Tai&quot;</span><span class="p">:</span> <span class="s">&quot;blue&quot;</span><span class="p">}</span>

<span class="n">ingested_color</span> <span class="o">=</span> <span class="n">drink_color</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">ingested_color</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">food_color</span><span class="p">)</span>
<span class="c">#-----------------------------</span>
<span class="c"># DON&#39;T DO THIS:</span>
<span class="n">drink_color</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;Galliano&quot;</span><span class="p">:</span> <span class="s">&quot;yellow&quot;</span><span class="p">,</span>
               <span class="s">&quot;Mai Tai&quot;</span><span class="p">:</span> <span class="s">&quot;blue&quot;</span><span class="p">}</span>

<span class="n">substance_color</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">food_color</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">substance_color</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">drink_color</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">substance_color</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<span class="c">#-----------------------------</span>
<span class="c"># DON&#39;T DO THIS:</span>
<span class="n">substance_color</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">mydict</span> <span class="ow">in</span> <span class="p">(</span><span class="n">food_color</span><span class="p">,</span> <span class="n">drink_color</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mydict</span><span class="p">:</span>
        <span class="n">substance_color</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<span class="c">#-----------------------------</span>
<span class="c"># DON&#39;T DO THIS:</span>
<span class="n">substance_color</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">food_color</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="o">+</span> <span class="n">drink_color</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mydict</span><span class="p">:</span>
        <span class="n">substance_color</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<span class="c">#-----------------------------</span>
<span class="n">substance_color</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">mydict</span> <span class="ow">in</span> <span class="p">(</span><span class="n">food_color</span><span class="p">,</span> <span class="n">drink_color</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mydict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">substance_color</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
            <span class="k">print</span> <span class="s">&quot;Warning:&quot;</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="s">&quot;seen twice.  Using the first definition.&quot;</span>
            <span class="k">continue</span>
        <span class="n">substance_color</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

<span class="c"># I think it&#39;s a copy, in which case</span>
<span class="n">all_colors</span> <span class="o">=</span> <span class="n">new_colors</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN265"
>Finding Common or Different Keys in Two Hashes</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="n">common</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dict1</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dict2</span><span class="p">]</span>
<span class="c">#-----------------------------</span>
<span class="n">this_not_that</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dict1</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict2</span><span class="p">]</span>
<span class="c">#-----------------------------</span>
<span class="c"># citrus_color is a dict mapping citrus food name to its color.</span>
<span class="n">citrus_color</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;Lemon&quot;</span><span class="p">:</span>  <span class="s">&quot;yellow&quot;</span><span class="p">,</span>
                <span class="s">&quot;Orange&quot;</span><span class="p">:</span> <span class="s">&quot;orange&quot;</span><span class="p">,</span>
                <span class="s">&quot;Lime&quot;</span><span class="p">:</span>   <span class="s">&quot;green&quot;</span><span class="p">}</span>

<span class="c"># build up a list of non-citrus foods</span>
<span class="n">non_citrus</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">food_color</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">citruscolor</span><span class="p">]</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN268"
>Hashing References</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c"># references as keys of dictionaries is no pb in python</span>

<span class="n">name</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;/etc/termcap&quot;</span><span class="p">,</span> <span class="s">&quot;/vmunix&quot;</span><span class="p">,</span> <span class="s">&quot;/bin/cat&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">myfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">names</span><span class="p">[</span><span class="n">myfile</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>

<span class="k">print</span> <span class="s">&quot;open files:&quot;</span><span class="p">,</span> <span class="s">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">name</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>       <span class="c"># seek to the end</span>
    <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> is </span><span class="si">%d</span><span class="s"> bytes long.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">tell</span><span class="p">())</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN271"
>Presizing a Hash</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c"># Python doesn&#39;t allow presizing of dicts, but hashing is efficient -</span>
<span class="c"># it only re-sizes at intervals, not every time an item is added.</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN274"
>Finding the Most Common Anything</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="n">count</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">mylist</span><span class="p">:</span>
    <span class="n">count</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN277"
>Representing Relationships Between Data</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="kn">import</span> <span class="nn">fileinput</span>

<span class="n">father</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;Cain&#39;</span><span class="p">:</span> <span class="s">&#39;Adam&#39;</span><span class="p">,</span>
          <span class="s">&#39;Abel&#39;</span><span class="p">:</span> <span class="s">&#39;Adam&#39;</span><span class="p">,</span>
          <span class="s">&#39;Seth&#39;</span><span class="p">:</span> <span class="s">&#39;Adam&#39;</span><span class="p">,</span>
          <span class="s">&#39;Enoch&#39;</span><span class="p">:</span> <span class="s">&#39;Cain&#39;</span><span class="p">,</span>
          <span class="s">&#39;Irad&#39;</span><span class="p">:</span> <span class="s">&#39;Enoch&#39;</span><span class="p">,</span>
          <span class="s">&#39;Mehujael&#39;</span><span class="p">:</span> <span class="s">&#39;Irad&#39;</span><span class="p">,</span>
          <span class="s">&#39;Methusael&#39;</span><span class="p">:</span> <span class="s">&#39;Mehujael&#39;</span><span class="p">,</span>
          <span class="s">&#39;Lamech&#39;</span><span class="p">:</span> <span class="s">&#39;Methusael&#39;</span><span class="p">,</span>
          <span class="s">&#39;Jabal&#39;</span><span class="p">:</span> <span class="s">&#39;Lamech&#39;</span><span class="p">,</span>
          <span class="s">&#39;Tubalcain&#39;</span><span class="p">:</span> <span class="s">&#39;Lamech&#39;</span><span class="p">,</span>
          <span class="s">&#39;Enos&#39;</span><span class="p">:</span> <span class="s">&#39;Seth&#39;</span><span class="p">,</span>
         <span class="p">}</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fileinput</span><span class="o">.</span><span class="n">input</span><span class="p">():</span>
    <span class="n">person</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
    <span class="k">while</span> <span class="n">person</span><span class="p">:</span>                    <span class="c"># as long as we have people,</span>
        <span class="k">print</span> <span class="n">person</span><span class="p">,</span>                <span class="c"># print the current name</span>
        <span class="n">person</span> <span class="o">=</span> <span class="n">father</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">person</span><span class="p">)</span>  <span class="c"># set the person to the person&#39;s father</span>
    <span class="k">print</span>

<span class="c">#-----------------------------</span>
<span class="kn">import</span> <span class="nn">fileinput</span>

<span class="n">children</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">father</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">children</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fileinput</span><span class="o">.</span><span class="n">input</span><span class="p">():</span>
    <span class="n">person</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
    <span class="n">kids</span> <span class="o">=</span> <span class="n">children</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">person</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;nobody&quot;</span><span class="p">])</span>
    <span class="k">print</span> <span class="n">person</span><span class="p">,</span> <span class="s">&quot;begat&quot;</span><span class="p">,</span> <span class="s">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">kids</span><span class="p">)</span>

<span class="c">#-----------------------------</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">re</span>
<span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&#39;^\s*#\s*include\s*&lt;([^&gt;]+)&#39;</span><span class="p">)</span>
<span class="n">includes</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">infile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">IOError</span><span class="p">,</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">print</span><span class="o">&gt;&gt;</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="n">err</span>
        <span class="k">continue</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">infile</span><span class="p">:</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
            <span class="n">includes</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="c">#-----------------------------</span>
<span class="c"># list of files that don&#39;t include others</span>
<span class="n">mydict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">includes</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">includes</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
        <span class="n">mydict</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">include_free</span> <span class="o">=</span> <span class="n">mydict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="n">include_free</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN280"
>Program: dutree</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c">#!/usr/bin/env python -w</span>
<span class="c"># dutree - print sorted indented rendition of du output</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span>

<span class="k">def</span> <span class="nf">get_input</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="c"># NOTE: This is insecure - use only from trusted code!</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="s">&quot;du &quot;</span> <span class="o">+</span> <span class="s">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="n">infile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

    <span class="n">dirsize</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">kids</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">infile</span><span class="p">:</span>
        <span class="n">size</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">dirsize</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">kids</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="c"># Remove the last field added, which is the root</span>
    <span class="n">kids</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">kids</span><span class="p">[</span><span class="n">parent</span><span class="p">]:</span> 
        <span class="k">del</span> <span class="n">kids</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">name</span><span class="p">,</span> <span class="n">dirsize</span><span class="p">,</span> <span class="n">kids</span>

<span class="k">def</span> <span class="nf">getdots</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">dirsize</span><span class="p">,</span> <span class="n">kids</span><span class="p">):</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">cursize</span> <span class="o">=</span> <span class="n">dirsize</span><span class="p">[</span><span class="n">root</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">kids</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">kid</span> <span class="ow">in</span> <span class="n">kids</span><span class="p">[</span><span class="n">root</span><span class="p">]:</span>
            <span class="n">cursize</span> <span class="o">-=</span> <span class="n">dirsize</span><span class="p">[</span><span class="n">kid</span><span class="p">]</span>
            <span class="n">getdots</span><span class="p">(</span><span class="n">kid</span><span class="p">,</span> <span class="n">dirsize</span><span class="p">,</span> <span class="n">kids</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">size</span> <span class="o">!=</span> <span class="n">cursize</span><span class="p">:</span>
        <span class="n">dot</span> <span class="o">=</span> <span class="n">root</span> <span class="o">+</span> <span class="s">&quot;/.&quot;</span>
        <span class="n">dirsize</span><span class="p">[</span><span class="n">dot</span><span class="p">]</span> <span class="o">=</span> <span class="n">cursize</span>
        <span class="n">kids</span><span class="p">[</span><span class="n">root</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dot</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">output</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">dirsize</span><span class="p">,</span> <span class="n">kids</span><span class="p">,</span> <span class="n">prefix</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">dirsize</span><span class="p">[</span><span class="n">root</span><span class="p">]</span>
    <span class="n">fmt</span> <span class="o">=</span> <span class="s">&quot;%&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">width</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;d </span><span class="si">%s</span><span class="s">&quot;</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">fmt</span> <span class="o">%</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">prefix</span> <span class="o">+</span> <span class="n">line</span>

    <span class="n">prefix</span> <span class="o">+=</span> <span class="p">(</span><span class="s">&quot; &quot;</span> <span class="o">*</span> <span class="p">(</span><span class="n">width</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="s">&quot;| &quot;</span>  <span class="o">+</span> <span class="p">(</span><span class="s">&quot; &quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">kids</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
        <span class="n">kid_list</span> <span class="o">=</span> <span class="n">kids</span><span class="p">[</span><span class="n">root</span><span class="p">]</span>
        <span class="n">kid_list</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">dirsize</span><span class="o">=</span><span class="n">dirsize</span><span class="p">:</span>
                          <span class="nb">cmp</span><span class="p">(</span><span class="n">dirsize</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">dirsize</span><span class="p">[</span><span class="n">y</span><span class="p">]))</span>
        <span class="n">width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">dirsize</span><span class="p">[</span><span class="n">kid_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]))</span>
        <span class="k">for</span> <span class="n">kid</span> <span class="ow">in</span> <span class="n">kid_list</span><span class="p">:</span>
            <span class="n">output</span><span class="p">(</span><span class="n">kid</span><span class="p">,</span> <span class="n">dirsize</span><span class="p">,</span> <span class="n">kids</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">root</span><span class="p">,</span> <span class="n">dirsize</span><span class="p">,</span> <span class="n">kids</span> <span class="o">=</span> <span class="n">get_input</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">getdots</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">dirsize</span><span class="p">,</span> <span class="n">kids</span><span class="p">)</span>
    <span class="n">output</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">dirsize</span><span class="p">,</span> <span class="n">kids</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span></PRE
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="arrays.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="patternmatching.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Arrays</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Pattern Matching</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>