<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Strings</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="PLEAC-Python"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="PLEAC-Python"
HREF="index.html"><LINK
REL="NEXT"
TITLE="Numbers"
HREF="numbers.html"><style type="text/css">td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }

  </style></head
><BODY TEXT="#cecece" BGCOLOR="#4f6f6f" LINK="#f5deb3" VLINK="#d5ae83"
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PLEAC-Python</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="index.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="numbers.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="STRINGS"
>1. Strings</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN14"
>Introduction</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="n">mystr</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>   <span class="c"># a newline character</span>
<span class="n">mystr</span> <span class="o">=</span> <span class="s">r&quot;\n&quot;</span>  <span class="c"># two characters, \ and n</span>
<span class="c">#-----------------------------</span>
<span class="n">mystr</span> <span class="o">=</span> <span class="s">&quot;Jon &#39;Maddog&#39; Orwant&quot;</span>  <span class="c"># literal single quote inside double quotes</span>
<span class="n">mystr</span> <span class="o">=</span> <span class="s">&#39;Jon &quot;Maddog&quot; Orwant&#39;</span>  <span class="c"># literal double quote inside single quotes</span>
<span class="c">#-----------------------------</span>
<span class="n">mystr</span> <span class="o">=</span> <span class="s">&#39;Jon </span><span class="se">\&#39;</span><span class="s">Maddog</span><span class="se">\&#39;</span><span class="s"> Orwant&#39;</span>  <span class="c"># escaped single quote</span>
<span class="n">mystr</span> <span class="o">=</span> <span class="s">&quot;Jon </span><span class="se">\&quot;</span><span class="s">Maddog</span><span class="se">\&quot;</span><span class="s"> Orwant&quot;</span>  <span class="c"># escaped double quote</span>
<span class="c">#-----------------------------</span>
<span class="n">mystr</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">This is a multiline string literal</span>
<span class="s">enclosed in triple double quotes.</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="n">mystr</span> <span class="o">=</span> <span class="s">&#39;&#39;&#39;</span>
<span class="s">And this is a multiline string literal</span>
<span class="s">enclosed in triple single quotes.</span>
<span class="s">&#39;&#39;&#39;</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN17"
>Accessing Substrings</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>

<span class="c"># get a 5-char string, skip 3, then grab 2 8-char strings, then the rest</span>
<span class="c"># Note that struct.unpack cannot use * for an unknown length.</span>
<span class="c"># See http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/65224</span>
<span class="kn">import</span> <span class="nn">struct</span>
<span class="p">(</span><span class="n">lead</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">),</span> <span class="n">tail</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">&quot;5s 3x 8s 8s&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">[:</span><span class="mi">24</span><span class="p">]),</span> <span class="n">data</span><span class="p">[</span><span class="mi">24</span><span class="p">:]</span>

<span class="c"># split at five-char boundaries</span>
<span class="n">fivers</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">&quot;5s&quot;</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">//</span><span class="mi">5</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">fivers</span> <span class="o">=</span> <span class="k">print</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">5</span><span class="p">:</span><span class="n">i</span><span class="o">*</span><span class="mi">5</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">)]</span>

<span class="c"># chop string into individual characters</span>
<span class="n">chars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="c">#-----------------------------</span>
<span class="n">mystr</span> <span class="o">=</span> <span class="s">&quot;This is what you have&quot;</span>
<span class="c">#       +012345678901234567890  Indexing forwards  (left to right)</span>
<span class="c">#        109876543210987654321- Indexing backwards (right to left)</span>
<span class="c">#         note that 0 means 10 or 20, etc. above</span>

<span class="n">first</span> <span class="o">=</span> <span class="n">mystr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                            <span class="c"># &quot;T&quot;</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">mystr</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span>                          <span class="c"># &quot;is&quot;</span>
<span class="n">rest</span> <span class="o">=</span> <span class="n">mystr</span><span class="p">[</span><span class="mi">13</span><span class="p">:]</span>                           <span class="c"># &quot;you have&quot;</span>
<span class="n">last</span> <span class="o">=</span> <span class="n">mystr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>                            <span class="c"># &quot;e&quot;</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">mystr</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span>                            <span class="c"># &quot;have&quot;</span>
<span class="n">piece</span> <span class="o">=</span> <span class="n">mystr</span><span class="p">[</span><span class="o">-</span><span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span>                        <span class="c"># &quot;you&quot;</span>
<span class="c">#-----------------------------</span>
<span class="c"># Python strings are immutable.</span>
<span class="c"># In general, you should just do piecemeal reallocation:</span>
<span class="n">mystr</span> <span class="o">=</span> <span class="s">&quot;This is what you have&quot;</span>
<span class="n">mystr</span> <span class="o">=</span> <span class="n">mystr</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;wasn&#39;t&quot;</span> <span class="o">+</span> <span class="n">mystr</span><span class="p">[</span><span class="mi">7</span><span class="p">:]</span>

<span class="c"># Or replace and reallocate</span>
<span class="n">mystr</span> <span class="o">=</span> <span class="s">&quot;This is what you have&quot;</span>
<span class="n">mystr</span> <span class="o">=</span> <span class="n">mystr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot; is &quot;</span><span class="p">,</span> <span class="s">&quot; wasn&#39;t &quot;</span><span class="p">)</span>

<span class="c"># DON&#39;T DO THIS: In-place modification could be done using character arrays</span>
<span class="kn">import</span> <span class="nn">array</span>
<span class="n">mystr</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="s">&quot;This is what you have&quot;</span><span class="p">)</span>
<span class="n">mystr</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="s">&quot;wasn&#39;t&quot;</span><span class="p">)</span>
<span class="c"># mystr is now array(&#39;c&#39;, &quot;This wasn&#39;t what you have&quot;)</span>

<span class="c"># DON&#39;T DO THIS: It could also be done using MutableString </span>
<span class="kn">from</span> <span class="nn">UserString</span> <span class="kn">import</span> <span class="n">MutableString</span>
<span class="n">mystr</span> <span class="o">=</span> <span class="n">MutableString</span><span class="p">(</span><span class="s">&quot;This is what you have&quot;</span><span class="p">)</span>
<span class="n">mystr</span><span class="p">[</span><span class="o">-</span><span class="mi">12</span><span class="p">:]</span> <span class="o">=</span> <span class="s">&quot;ondrous&quot;</span>
<span class="c"># mystr is now &quot;This is wondrous&quot;</span>
<span class="c">#-----------------------------</span>
<span class="c"># you can test simple substrings with &quot;in&quot; (for regex matching see ch.6):</span>
<span class="k">if</span> <span class="n">txt</span> <span class="ow">in</span> <span class="n">mystr</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]:</span>
    <span class="k">print</span> <span class="s">&quot;&#39;</span><span class="si">%s</span><span class="s">&#39; found in last 10 characters&quot;</span><span class="o">%</span><span class="n">txt</span>

<span class="c"># Or use the startswith() and endswith() string methods:</span>
<span class="k">if</span> <span class="n">mystr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">txt</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> starts with </span><span class="si">%s</span><span class="s">.&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">mystr</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span>
<span class="k">if</span> <span class="n">mystr</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">txt</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> ends with </span><span class="si">%s</span><span class="s">.&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">mystr</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span>

<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN20"
>Establishing a Default Value</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c"># Introductory Note: quite a bit of this section is not terribly Pythonic</span>
<span class="c"># as names must be set before being used. For instance, unless myvar has </span>
<span class="c"># been previously defined, these next lines will all raise NameError:</span>
<span class="n">myvar</span> <span class="o">=</span> <span class="n">myvar</span> <span class="ow">or</span> <span class="n">some_default</span>
<span class="n">myvar2</span> <span class="o">=</span> <span class="n">myvar</span> <span class="ow">or</span> <span class="n">some_default</span>
<span class="n">myvar</span> <span class="o">|=</span> <span class="n">some_default</span>          <span class="c"># bitwise-or, not logical-or - for demo</span>

<span class="c"># The standard way of setting a default is often:</span>
<span class="n">myvar</span> <span class="o">=</span> <span class="n">default_value</span>
<span class="k">if</span> <span class="n">some_condition</span><span class="p">:</span>
    <span class="k">pass</span>                     <span class="c"># code which may set myvar to something else</span>

<span class="c"># if myvar is returned from a function and may be empty/None, then use:</span>
<span class="n">myvar</span> <span class="o">=</span> <span class="n">somefunc</span><span class="p">()</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">myvar</span><span class="p">:</span>
    <span class="n">myvar</span> <span class="o">=</span> <span class="n">default_value</span>

<span class="c"># If you want a default value that can be overridden by the person calling </span>
<span class="c"># your code, you can often wrap it in a function with a named parameter:</span>
<span class="k">def</span> <span class="nf">myfunc</span><span class="p">(</span><span class="n">myvar</span><span class="o">=</span><span class="s">&quot;a&quot;</span><span class="p">):</span>
   <span class="k">return</span> <span class="n">myvar</span> <span class="o">+</span> <span class="s">&quot;b&quot;</span>
<span class="k">print</span> <span class="n">myfunc</span><span class="p">(),</span> <span class="n">myfunc</span><span class="p">(</span><span class="s">&quot;c&quot;</span><span class="p">)</span>
<span class="c">#=&gt; ab cb</span>

<span class="c"># Note, though, that this won&#39;t work for mutable objects such as lists or</span>
<span class="c"># dicts that are mutated in the function as the object is only created once </span>
<span class="c"># and repeated calls to the same function will return the same object.  This</span>
<span class="c"># can be desired behaviour however - see section 10.3, for instance.</span>
<span class="k">def</span> <span class="nf">myfunc</span><span class="p">(</span><span class="n">myvar</span><span class="o">=</span><span class="p">[]):</span>
    <span class="n">myvar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">myvar</span>
<span class="k">print</span> <span class="n">myfunc</span><span class="p">(),</span> <span class="n">myfunc</span><span class="p">()</span>
<span class="c">#=&gt; [&#39;x&#39;] [&#39;x&#39;, &#39;x&#39;]</span>

<span class="c"># You need to do:</span>
<span class="k">def</span> <span class="nf">myfunc</span><span class="p">(</span><span class="n">myvar</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">myvar</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">myvar</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">myvar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">myvar</span>
<span class="k">print</span> <span class="n">myfunc</span><span class="p">(),</span> <span class="n">myfunc</span><span class="p">()</span>
<span class="c">#=&gt; [&#39;x&#39;] [&#39;x&#39;]</span>

<span class="c">#=== Perl Equivalencies start here</span>
<span class="c"># use b if b is true, otherwise use c</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">b</span> <span class="ow">or</span> <span class="n">c</span>

<span class="c"># as that is a little tricksy, the following may be preferred:</span>
<span class="k">if</span> <span class="n">b</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">b</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">c</span>

<span class="c"># set x to y unless x is already true</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">y</span>
<span class="c">#-----------------------------</span>
<span class="c"># use b if b is defined, else c</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">b</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">c</span>
<span class="c">#-----------------------------</span>
<span class="n">foo</span> <span class="o">=</span> <span class="n">bar</span> <span class="ow">or</span> <span class="s">&quot;DEFAULT VALUE&quot;</span>
<span class="c">#-----------------------------</span>
<span class="c"># To get a user (for both UNIX and Windows), use:</span>
<span class="kn">import</span> <span class="nn">getpass</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getuser</span><span class="p">()</span>

<span class="c"># DON&#39;T DO THIS: find the user name on Unix systems </span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;USER&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;LOGNAME&quot;</span><span class="p">)</span>
<span class="c">#-----------------------------</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">starting_point</span><span class="p">:</span>
    <span class="n">starting_point</span> <span class="o">=</span> <span class="s">&quot;Greenwich&quot;</span>
<span class="c">#-----------------------------</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">a</span><span class="p">:</span>         <span class="c"># copy only if empty</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">b</span>

<span class="k">if</span> <span class="n">b</span><span class="p">:</span>             <span class="c"># assign b if nonempty, else c</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">b</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">c</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN23"
>Exchanging Values Without Using Temporary Variables</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="n">v1</span><span class="p">,</span> <span class="n">v2</span> <span class="o">=</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v1</span>
<span class="c">#-----------------------------</span>
<span class="c"># DON&#39;T DO THIS:</span>
<span class="n">temp</span> <span class="o">=</span> <span class="n">a</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">b</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">temp</span>
<span class="c">#-----------------------------</span>
<span class="n">a</span> <span class="o">=</span> <span class="s">&quot;alpha&quot;</span>
<span class="n">b</span> <span class="o">=</span> <span class="s">&quot;omega&quot;</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span>   <span class="c"># the first shall be last -- and versa vice </span>
<span class="c">#-----------------------------</span>
<span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">production</span> <span class="o">=</span> <span class="s">&quot;January March August&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">production</span> <span class="o">=</span> <span class="n">beta</span><span class="p">,</span> <span class="n">production</span><span class="p">,</span> <span class="n">alpha</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN26"
>Converting Between ASCII Characters and Values</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="n">num</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
<span class="n">char</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
<span class="c">#-----------------------------</span>
<span class="n">char</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%c</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">num</span>
<span class="k">print</span> <span class="s">&quot;Number </span><span class="si">%d</span><span class="s"> is character </span><span class="si">%c</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Number </span><span class="si">%(n)d</span><span class="s"> is character </span><span class="si">%(n)c</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">{</span><span class="s">&quot;n&quot;</span><span class="p">:</span> <span class="n">num</span><span class="p">}</span>
<span class="k">print</span> <span class="s">&quot;Number </span><span class="si">%(num)d</span><span class="s"> is character </span><span class="si">%(num)c</span><span class="s">&quot;</span> <span class="o">%</span> <span class="nb">locals</span><span class="p">()</span>
<span class="c">#=&gt; Number 101 is character e</span>
<span class="c">#-----------------------------</span>
<span class="n">ascii_character_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="s">&quot;sample&quot;</span><span class="p">]</span>
<span class="k">print</span> <span class="n">ascii_character_numbers</span>
<span class="c">#=&gt; [115, 97, 109, 112, 108, 101]</span>

<span class="n">word</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">ascii_character_numbers</span><span class="p">])</span>
<span class="n">word</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">115</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">101</span><span class="p">]])</span>
<span class="k">print</span> <span class="n">word</span>
<span class="c">#=&gt; sample</span>
<span class="c">#-----------------------------</span>
<span class="n">hal</span> <span class="o">=</span> <span class="s">&quot;HAL&quot;</span>
<span class="n">ibm</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">hal</span><span class="p">])</span> <span class="c"># add one to each ASCII value</span>
<span class="k">print</span> <span class="n">ibm</span>   
<span class="c">#=&gt; IBM</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN29"
>Processing a String One Character at a Time</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="n">mylist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mystr</span><span class="p">)</span>
<span class="c">#-----------------------------</span>
<span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">mystr</span><span class="p">:</span>
    <span class="k">pass</span> <span class="c"># do something with char</span>
<span class="c">#-----------------------------</span>
<span class="n">mystr</span> <span class="o">=</span> <span class="s">&quot;an apple a day&quot;</span>
<span class="n">uniq</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">mystr</span><span class="p">))</span>
<span class="k">print</span> <span class="s">&quot;unique chars are: &#39;</span><span class="si">%s</span><span class="s">&#39;&quot;</span> <span class="o">%</span> <span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">uniq</span><span class="p">)</span>
<span class="c">#=&gt; unique chars are: &#39; adelnpy&#39;</span>
<span class="c">#-----------------------------</span>
<span class="n">ascvals</span> <span class="o">=</span> <span class="p">[</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">mystr</span><span class="p">]</span>
<span class="k">print</span> <span class="s">&quot;total is </span><span class="si">%s</span><span class="s"> for &#39;</span><span class="si">%s</span><span class="s">&#39;.&quot;</span><span class="o">%</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">ascvals</span><span class="p">),</span> <span class="n">mystr</span><span class="p">)</span>
<span class="c">#=&gt; total is 1248 for &#39;an apple a day&#39;.</span>
<span class="c">#-----------------------------</span>
<span class="c"># sysv checksum</span>
<span class="k">def</span> <span class="nf">checksum</span><span class="p">(</span><span class="n">myfile</span><span class="p">):</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">myfile</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">line</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="o">%</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">16</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

<span class="kn">import</span> <span class="nn">fileinput</span>
<span class="k">print</span> <span class="n">checksum</span><span class="p">(</span><span class="n">fileinput</span><span class="o">.</span><span class="n">input</span><span class="p">())</span>   <span class="c"># data from sys.stdin</span>

<span class="c"># Using a function means any iterable can be checksummed:</span>
<span class="k">print</span> <span class="n">checksum</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;C:/test.txt&quot;</span><span class="p">)</span>  <span class="c"># data from file</span>
<span class="k">print</span> <span class="n">checksum</span><span class="p">(</span><span class="s">&quot;sometext&quot;</span><span class="p">)</span>          <span class="c"># data from string</span>
<span class="c">#-----------------------------</span>
<span class="c">#!/usr/bin/python</span>
<span class="c"># slowcat - emulate a   s l o w  line printer</span>
<span class="c"># usage: slowcat [- DELAY] [files ...]</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">select</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="n">DELAY</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s">&quot;^-\d+$&quot;</span><span class="p">,</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">DELAY</span><span class="o">=-</span><span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">del</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="n">fileinput</span><span class="o">.</span><span class="n">input</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ln</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="n">select</span><span class="o">.</span><span class="n">select</span><span class="p">([],[],[],</span> <span class="mf">0.005</span> <span class="o">*</span> <span class="n">DELAY</span><span class="p">)</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN32"
>Reversing a String by Word or Character</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c"># 2.3+ only</span>
<span class="n">revchars</span> <span class="o">=</span> <span class="n">mystr</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c"># extended slice - step is -1</span>
<span class="n">revwords</span> <span class="o">=</span> <span class="s">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mystr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="c"># pre 2.3 version:</span>
<span class="n">mylist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mystr</span><span class="p">)</span>
<span class="n">mylist</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
<span class="n">revbytes</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mylist</span><span class="p">)</span>

<span class="n">mylist</span> <span class="o">=</span> <span class="n">mystr</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">mylist</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
<span class="n">revwords</span> <span class="o">=</span> <span class="s">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mylist</span><span class="p">)</span>

<span class="c"># Alternative version using reversed():</span>
<span class="n">revchars</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">mystr</span><span class="p">))</span>
<span class="n">revwords</span> <span class="o">=</span> <span class="s">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">mystr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)))</span>

<span class="c"># reversed() makes an iterator, which means that the reversal</span>
<span class="c"># happens as it is consumed.  This means that &quot;print reversed(mystr)&quot; is not</span>
<span class="c"># the same as mystr[::-1].  Standard usage is:</span>
<span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">mystr</span><span class="p">):</span>
   <span class="k">pass</span>  <span class="c"># ... do something</span>
<span class="c">#-----------------------------</span>
<span class="c"># 2.3+ only</span>
<span class="n">word</span> <span class="o">=</span> <span class="s">&quot;reviver&quot;</span>
<span class="n">is_palindrome</span> <span class="o">=</span> <span class="p">(</span><span class="n">word</span> <span class="o">==</span> <span class="n">word</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="c">#-----------------------------</span>
<span class="c"># Generator version</span>
<span class="k">def</span> <span class="nf">get_palindromes</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
        <span class="n">word</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="ow">and</span> <span class="n">word</span> <span class="o">==</span> <span class="n">word</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">yield</span> <span class="n">word</span>
<span class="n">long_palindromes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">get_palindromes</span><span class="p">(</span><span class="s">&quot;/usr/share/dict/words&quot;</span><span class="p">))</span>

<span class="c"># Simpler old-style version using 2.2 string reversal</span>
<span class="k">def</span> <span class="nf">rev_string</span><span class="p">(</span><span class="n">mystr</span><span class="p">):</span>
    <span class="n">mylist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mystr</span><span class="p">)</span>
    <span class="n">mylist</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
    <span class="k">return</span> <span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mylist</span><span class="p">)</span>

<span class="n">long_palindromes</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;/usr/share/dict/words&quot;</span><span class="p">):</span>
    <span class="n">word</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="ow">and</span> <span class="n">word</span> <span class="o">==</span> <span class="n">rev_string</span><span class="p">(</span><span class="n">word</span><span class="p">):</span>
        <span class="n">long_palindromes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<span class="k">print</span> <span class="n">long_palindromes</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN35"
>Expanding and Compressing Tabs</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="n">mystr</span><span class="o">.</span><span class="n">expandtabs</span><span class="p">()</span>
<span class="n">mystr</span><span class="o">.</span><span class="n">expandtabs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN38"
>Expanding Variables in User Input</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="n">text</span> <span class="o">=</span> <span class="s">&quot;I am </span><span class="si">%(rows)s</span><span class="s"> high and </span><span class="si">%(cols)s</span><span class="s"> long&quot;</span><span class="o">%</span><span class="p">{</span><span class="s">&quot;rows&quot;</span><span class="p">:</span><span class="mi">24</span><span class="p">,</span> <span class="s">&quot;cols&quot;</span><span class="p">:</span><span class="mi">80</span><span class="p">)</span>
<span class="k">print</span> <span class="n">text</span>
<span class="c">#=&gt; I am 24 high and 80 long</span>

<span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">80</span>
<span class="n">text</span> <span class="o">=</span> <span class="s">&quot;I am </span><span class="si">%(rows)s</span><span class="s"> high and </span><span class="si">%(cols)s</span><span class="s"> long&quot;</span><span class="o">%</span><span class="nb">locals</span><span class="p">()</span>
<span class="k">print</span> <span class="n">text</span>
<span class="c">#=&gt; I am 24 high and 80 long</span>
<span class="c">#-----------------------------</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="k">print</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&quot;\d+&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">))),</span> <span class="s">&quot;I am 17 years old&quot;</span><span class="p">)</span>
<span class="c">#=&gt; I am 34 years old</span>
<span class="c">#-----------------------------</span>
<span class="c"># expand variables in text, but put an error message in</span>
<span class="c"># if the variable isn&#39;t defined</span>
<span class="k">class</span> <span class="nc">SafeDict</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&quot;[No Variable: </span><span class="si">%s</span><span class="s">]&quot;</span><span class="o">%</span><span class="n">key</span><span class="p">)</span>
    
<span class="n">hi</span> <span class="o">=</span> <span class="s">&quot;Hello&quot;</span>
<span class="n">text</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%(hi)s</span><span class="s"> and </span><span class="si">%(bye)s</span><span class="s">!&quot;</span><span class="o">%</span><span class="n">SafeDict</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span>
<span class="k">print</span> <span class="n">text</span>
<span class="c">#=&gt; Hello and [No Variable: bye]!</span>

<span class="c">#If you don&#39;t need a particular error message, just use the Template class:</span>
<span class="kn">from</span> <span class="nn">string</span> <span class="kn">import</span> <span class="n">Template</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Template</span><span class="p">(</span><span class="s">&quot;$hi and $bye!&quot;</span><span class="p">)</span>
<span class="n">hi</span> <span class="o">=</span> <span class="s">&quot;Hello&quot;</span>
<span class="k">print</span> <span class="n">x</span><span class="o">.</span><span class="n">safe_substitute</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span>
<span class="c">#=&gt; Hello and $bye!</span>
<span class="k">print</span> <span class="n">x</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span> <span class="c"># will throw a KeyError</span>

<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN41"
>Controlling Case</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="n">mystr</span> <span class="o">=</span> <span class="s">&quot;bo peep&quot;</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>  <span class="c"># BO PEEP</span>
<span class="n">mystr</span> <span class="o">=</span> <span class="n">mystr</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>      <span class="c"># bo peep</span>
<span class="n">mystr</span> <span class="o">=</span> <span class="n">mystr</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="c"># Bo peep</span>
<span class="c">#-----------------------------</span>
<span class="n">beast</span> <span class="o">=</span> <span class="s">&quot;python&quot;</span>
<span class="n">caprest</span> <span class="o">=</span> <span class="n">beast</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="o">.</span><span class="n">swapcase</span><span class="p">()</span> <span class="c"># pYTHON</span>
<span class="c">#-----------------------------</span>
<span class="k">print</span> <span class="s">&quot;thIS is a loNG liNE&quot;</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>
<span class="c">#=&gt; This Is A Long Line</span>
<span class="c">#-----------------------------</span>
<span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="n">b</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
    <span class="k">print</span> <span class="s">&quot;a and b are the same&quot;</span>
<span class="c">#-----------------------------</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="k">def</span> <span class="nf">randcase_one</span><span class="p">(</span><span class="n">letter</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>   <span class="c"># True on 1, 2, 3, 4</span>
        <span class="k">return</span> <span class="n">letter</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">letter</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">randcase</span><span class="p">(</span><span class="n">myfile</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">myfile</span><span class="p">:</span>
        <span class="k">yield</span> <span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">randcase_one</span><span class="p">(</span><span class="n">letter</span><span class="p">)</span> <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">line</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">randcase</span><span class="p">(</span><span class="n">myfile</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">line</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN44"
>Interpolating Functions and Expressions Within Strings</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="s">&quot;I have </span><span class="si">%d</span><span class="s"> guanacos.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;I have&quot;</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;guanacos.&quot;</span>
<span class="c">#-----------------------------</span>
<span class="c">#Python templates disallow in-string calculations (see PEP 292)</span>
<span class="kn">from</span> <span class="nn">string</span> <span class="kn">import</span> <span class="n">Template</span>

<span class="n">email_template</span> <span class="o">=</span> <span class="n">Template</span><span class="p">(</span><span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">To: $address</span>
<span class="s">From: Your Bank</span>
<span class="s">CC: $cc_number</span>
<span class="s">Date: $date</span>

<span class="s">Dear $name,</span>

<span class="s">Today you bounced check number $checknum to us.</span>
<span class="s">Your account is now closed.</span>

<span class="s">Sincerely,</span>
<span class="s">the management</span>
<span class="s">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="n">person</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;address&quot;</span><span class="p">:</span><span class="s">&quot;Joe@somewhere.com&quot;</span><span class="p">,</span>
          <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;Joe&quot;</span><span class="p">,</span>
          <span class="s">&quot;cc_number&quot;</span> <span class="p">:</span> <span class="mi">1234567890</span><span class="p">,</span>
          <span class="s">&quot;checknum&quot;</span> <span class="p">:</span> <span class="mi">500</span><span class="o">+</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">99</span><span class="p">)}</span>

<span class="k">print</span> <span class="n">email_template</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">person</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN47"
>Indenting Here Documents</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c"># indenting here documents</span>
<span class="c">#</span>
<span class="c"># in python multiline strings can be used as here documents</span>
<span class="n">var</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">      your text</span>
<span class="s">      goes here</span>
<span class="s">      &quot;&quot;&quot;</span>

<span class="c"># using regular expressions</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="n">re_leading_blanks</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&quot;^\s+&quot;</span><span class="p">,</span><span class="n">re</span><span class="o">.</span><span class="n">MULTILINE</span><span class="p">)</span>
<span class="n">var1</span> <span class="o">=</span> <span class="n">re_leading_blanks</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">var</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c"># using string methods </span>
<span class="c"># split into lines, use every line except first and last, left strip and rejoin.</span>
<span class="n">var2</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">var</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">poem</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">       Here&#39;s your poem:</span>
<span class="s">       Now far ahead the Road has gone,</span>
<span class="s">          And I must follow, if I can,</span>
<span class="s">       Pursuing it with eager feet,</span>
<span class="s">          Until it joins some larger way</span>
<span class="s">       Where many paths and errand meet.</span>
<span class="s">          And whither then? I cannot say.</span>
<span class="s">               --Bilbo in /usr/src/perl/pp_ctl.c  </span>
<span class="s">       &quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">textwrap</span>
<span class="k">print</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="n">poem</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="c">#-----------------------------</span>
    </PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN50"
>Reformatting Paragraphs</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="kn">from</span> <span class="nn">textwrap</span> <span class="kn">import</span> <span class="n">wrap</span> 
<span class="n">output</span> <span class="o">=</span> <span class="n">wrap</span><span class="p">(</span><span class="n">para</span><span class="p">,</span>
              <span class="n">initial_indent</span><span class="o">=</span><span class="n">leadtab</span>
              <span class="n">subsequent_indent</span><span class="o">=</span><span class="n">nexttab</span><span class="p">)</span>
<span class="c">#-----------------------------</span>
<span class="c">#!/usr/bin/env python</span>
<span class="c"># wrapdemo - show how textwrap works</span>

<span class="n">txt</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">Folding and splicing is the work of an editor,</span>
<span class="s">not a mere collection of silicon</span>
<span class="s">and</span>
<span class="s">mobile electrons!</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">textwrap</span> <span class="kn">import</span> <span class="n">TextWrapper</span>

<span class="n">wrapper</span> <span class="o">=</span> <span class="n">TextWrapper</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                      <span class="n">initial_indent</span><span class="o">=</span><span class="s">&quot; &quot;</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span>
                      <span class="n">subsequent_indent</span><span class="o">=</span><span class="s">&quot; &quot;</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>

<span class="k">print</span> <span class="s">&quot;0123456789&quot;</span> <span class="o">*</span> <span class="mi">2</span>
<span class="k">print</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>

<span class="c">#-----------------------------</span>
<span class="sd">&quot;&quot;&quot;Expected result:</span>

<span class="sd">01234567890123456789</span>
<span class="sd">    Folding and</span>
<span class="sd">  splicing is the</span>
<span class="sd">  work of an editor,</span>
<span class="sd">  not a mere</span>
<span class="sd">  collection of</span>
<span class="sd">  silicon and mobile</span>
<span class="sd">  electrons!</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c">#-----------------------------</span>
<span class="c"># merge multiple lines into one, then wrap one long line</span>

<span class="kn">from</span> <span class="nn">textwrap</span> <span class="kn">import</span> <span class="n">fill</span>
<span class="kn">import</span> <span class="nn">fileinput</span>

<span class="k">print</span> <span class="n">fill</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fileinput</span><span class="o">.</span><span class="n">input</span><span class="p">()))</span>

<span class="c">#-----------------------------</span>
<span class="c"># Term::ReadKey::GetTerminalSize() isn&#39;t in the Perl standard library. </span>
<span class="c"># It isn&#39;t in the Python standard library either. Michael Hudson&#39;s </span>
<span class="c"># recipe from python-list #530228 is shown here.</span>
<span class="c"># (http://aspn.activestate.com/ASPN/Mail/Message/python-list/530228)</span>
<span class="c"># Be aware that this will work on Unix but not on Windows.</span>

<span class="kn">from</span> <span class="nn">termwrap</span> <span class="kn">import</span> <span class="n">wrap</span>
<span class="kn">import</span> <span class="nn">struct</span><span class="o">,</span> <span class="nn">fcntl</span>
<span class="k">def</span> <span class="nf">getheightwidth</span><span class="p">():</span>
    <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span>
        <span class="s">&quot;hhhh&quot;</span><span class="p">,</span> <span class="n">fcntl</span><span class="o">.</span><span class="n">ioctl</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">TERMIOS</span><span class="o">.</span><span class="n">TIOCGWINSZ</span> <span class="p">,</span><span class="s">&quot;</span><span class="se">\000</span><span class="s">&quot;</span><span class="o">*</span><span class="mi">8</span><span class="p">))[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span>

<span class="c"># PERL &lt;&gt;, $/, $\ emulation</span>
<span class="kn">import</span> <span class="nn">fileinput</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="n">_</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">getheightwidth</span><span class="p">()</span>
<span class="k">for</span> <span class="n">para</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">r&quot;\n{2,}&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fileinput</span><span class="o">.</span><span class="n">input</span><span class="p">())):</span>
    <span class="k">print</span> <span class="n">fill</span><span class="p">(</span><span class="n">para</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN53"
>Escaping Characters</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="n">mystr</span> <span class="o">=</span> <span class="s">&#39;&#39;&#39;Mom said, &quot;Don&#39;t do that.&quot;&#39;&#39;&#39;</span>  <span class="c">#&quot;</span>
<span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&quot;[&#39;</span><span class="se">\&quot;</span><span class="s">]&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">&quot;</span> <span class="o">+</span> <span class="n">i</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">mystr</span><span class="p">)</span>
<span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&quot;[A-Z]&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">&quot;</span> <span class="o">+</span> <span class="n">i</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">mystr</span><span class="p">)</span>
<span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&quot;\W&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">&quot;</span> <span class="o">+</span> <span class="n">i</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="s">&quot;is a test!&quot;</span><span class="p">)</span> <span class="c"># no function like quotemeta?</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN56"
>Trimming Blanks from the Ends of a String</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="n">mystr</span> <span class="o">=</span> <span class="n">mystr</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span> <span class="c"># left</span>
<span class="n">mystr</span> <span class="o">=</span> <span class="n">mystr</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="c"># right</span>
<span class="n">mystr</span> <span class="o">=</span> <span class="n">mystr</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>  <span class="c"># both ends</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN59"
>Parsing Comma-Separated Data</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="k">def</span> <span class="nf">parse_csv</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
    <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">([</span><span class="n">line</span><span class="p">],</span> <span class="n">escapechar</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">reader</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

<span class="n">line</span> <span class="o">=</span> <span class="s">&#39;&#39;&#39;XYZZY,&quot;&quot;,&quot;O&#39;Reilly, Inc&quot;,&quot;Wall, Larry&quot;,&quot;a </span><span class="se">\\</span><span class="s">&quot;glug</span><span class="se">\\</span><span class="s">&quot; bit,&quot;,5,&quot;Error, Core Dumped,&quot;,&#39;&#39;&#39;</span> <span class="c">#&quot;</span>

<span class="n">fields</span> <span class="o">=</span> <span class="n">parse_csv</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fields</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&quot;</span><span class="si">%d</span><span class="s"> : </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>

<span class="c"># pre-2.3 version of parse_csv</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="k">def</span> <span class="nf">parse_csv</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;&#39;&#39;&quot;([^&quot;</span><span class="se">\\</span><span class="s">\]*(?:</span><span class="se">\\</span><span class="s">\.[^&quot;</span><span class="se">\\</span><span class="s">\]*)*)&quot;,?|([^,]+),?|,&#39;&#39;&#39;</span><span class="p">)</span>
    <span class="n">mylist</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span> 
              <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">text</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">text</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;,&quot;</span><span class="p">:</span> 
        <span class="n">mylist</span> <span class="o">+=</span> <span class="p">[</span><span class="s">&#39;&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">mylist</span>

<span class="c"># cvs.reader is meant to work for many lines, something like:</span>
<span class="c"># (NB: in Python default, quotechar is *not* escaped by backslash,</span>
<span class="c">#      but doubled instead. That&#39;s what Excel does.)</span>
<span class="k">for</span> <span class="n">fields</span> <span class="ow">in</span> <span class="n">cvs</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">dialect</span><span class="o">=</span><span class="s">&quot;some&quot;</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">num</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fields</span><span class="p">):</span>
        <span class="k">print</span> <span class="n">num</span><span class="p">,</span> <span class="s">&quot;:&quot;</span><span class="p">,</span> <span class="n">field</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN62"
>Soundex Matching</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="k">def</span> <span class="nf">soundex</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; soundex module conforming to Knuth&#39;s algorithm</span>
<span class="sd">        implementation 2000-12-24 by Gregory Jorgensen</span>
<span class="sd">        public domain</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c"># digits holds the soundex values for the alphabet</span>
    <span class="n">digits</span> <span class="o">=</span> <span class="s">&#39;01230120022455012623010202&#39;</span>
    <span class="n">sndx</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="n">fc</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>

    <span class="c"># translate alpha chars in name to soundex digits</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">isalpha</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">fc</span><span class="p">:</span> 
                <span class="n">fc</span> <span class="o">=</span> <span class="n">c</span>   <span class="c"># remember first letter</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">digits</span><span class="p">[</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">-</span><span class="nb">ord</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">)]</span>
            <span class="c"># duplicate consecutive soundex digits are skipped</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">sndx</span> <span class="ow">or</span> <span class="p">(</span><span class="n">d</span> <span class="o">!=</span> <span class="n">sndx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">sndx</span> <span class="o">+=</span> <span class="n">d</span>

    <span class="c"># replace first digit with first alpha character</span>
    <span class="n">sndx</span> <span class="o">=</span> <span class="n">fc</span> <span class="o">+</span> <span class="n">sndx</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="c"># remove all 0s from the soundex code</span>
    <span class="n">sndx</span> <span class="o">=</span> <span class="n">sndx</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">)</span>

    <span class="c"># return soundex code padded to len characters</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">sndx</span> <span class="o">+</span> <span class="p">(</span><span class="nb">len</span> <span class="o">*</span> <span class="s">&#39;0&#39;</span><span class="p">))[:</span><span class="nb">len</span><span class="p">]</span>

<span class="n">user</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Lookup user: &quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">user</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">SystemExit</span>

<span class="n">name_code</span> <span class="o">=</span> <span class="n">soundex</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;/etc/passwd&quot;</span><span class="p">):</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">piece</span> <span class="ow">in</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">name_code</span> <span class="o">==</span> <span class="n">soundex</span><span class="p">(</span><span class="n">piece</span><span class="p">):</span>
            <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">: </span><span class="si">%s</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN65"
>Program: fixstyle</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">fileinput</span><span class="o">,</span> <span class="nn">re</span>

<span class="n">data</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s">analysed        =&gt; analyzed</span>
<span class="s">built-in        =&gt; builtin</span>
<span class="s">chastized       =&gt; chastised</span>
<span class="s">commandline     =&gt; command-line</span>
<span class="s">de-allocate     =&gt; deallocate</span>
<span class="s">dropin          =&gt; drop-in</span>
<span class="s">hardcode        =&gt; hard-code</span>
<span class="s">meta-data       =&gt; metadata</span>
<span class="s">multicharacter  =&gt; multi-character</span>
<span class="s">multiway        =&gt; multi-way</span>
<span class="s">non-empty       =&gt; nonempty</span>
<span class="s">non-profit      =&gt; nonprofit</span>
<span class="s">non-trappable   =&gt; nontrappable</span>
<span class="s">pre-define      =&gt; predefine</span>
<span class="s">preextend       =&gt; pre-extend</span>
<span class="s">re-compiling    =&gt; recompiling</span>
<span class="s">reenter         =&gt; re-enter</span>
<span class="s">turnkey         =&gt; turn-key</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="n">mydict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
        <span class="k">continue</span>
    <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;=&gt;&quot;</span><span class="p">)]</span>
    <span class="n">mydict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<span class="n">pattern_text</span> <span class="o">=</span> <span class="s">&quot;(&quot;</span> <span class="o">+</span> <span class="s">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">re</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">mydict</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span>
<span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">pattern_text</span><span class="p">)</span>

<span class="n">args</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">if</span> <span class="n">args</span> <span class="ow">and</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;-v&quot;</span><span class="p">:</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">: Reading from stdin</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fileinput</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">backup</span><span class="o">=</span><span class="s">&quot;.orig&quot;</span><span class="p">):</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="n">line</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span>
            <span class="k">break</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="n">line</span><span class="p">[</span><span class="n">pos</span><span class="p">:</span><span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span> <span class="o">+</span> <span class="n">mydict</span><span class="p">[</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN68"
>Program: psgrep</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c">#!/usr/bin/python</span>
<span class="c"># psgrep - print selected lines of ps output by</span>
<span class="c">#          compiling user queries into code.</span>
<span class="c">#</span>
<span class="c"># examples :</span>
<span class="c"># psgrep &quot;uid&lt;10&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">re</span>

<span class="k">class</span> <span class="nc">PsLineMatch</span><span class="p">:</span>
    <span class="c"># each field from the PS header</span>
    <span class="n">fieldnames</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;flags&quot;</span><span class="p">,</span><span class="s">&quot;uid&quot;</span><span class="p">,</span><span class="s">&quot;pid&quot;</span><span class="p">,</span><span class="s">&quot;ppid&quot;</span><span class="p">,</span><span class="s">&quot;pri&quot;</span><span class="p">,</span><span class="s">&quot;nice&quot;</span><span class="p">,</span><span class="s">&quot;size&quot;</span><span class="p">,</span> \
                  <span class="s">&quot;rss&quot;</span><span class="p">,</span><span class="s">&quot;wchan&quot;</span><span class="p">,</span><span class="s">&quot;stat&quot;</span><span class="p">,</span><span class="s">&quot;tty&quot;</span><span class="p">,</span><span class="s">&quot;time&quot;</span><span class="p">,</span><span class="s">&quot;command&quot;</span><span class="p">)</span>
    <span class="n">numeric_fields</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;flags&quot;</span><span class="p">,</span><span class="s">&quot;uid&quot;</span><span class="p">,</span><span class="s">&quot;pid&quot;</span><span class="p">,</span><span class="s">&quot;ppid&quot;</span><span class="p">,</span><span class="s">&quot;pri&quot;</span><span class="p">,</span><span class="s">&quot;nice&quot;</span><span class="p">,</span><span class="s">&quot;size&quot;</span><span class="p">,</span><span class="s">&quot;rss&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">new_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ln</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ln</span> <span class="o">=</span> <span class="n">ln</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
        <span class="c"># ps header for option &quot;wwaxl&quot; (different than in the perl code)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">          F   UID   PID  PPID PRI  NI   VSZ  RSS WCHAN  STAT TTY        TIME COMMAND&quot;</span>
<span class="sd">        004     0     1     0  15   0   448  236 schedu S    ?          0:07 init&quot;</span>
<span class="sd">        .   .     .     .     .   .   .     .    .      .    .    .          .</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># because only the last entry might contain blanks, splitting</span>
        <span class="c"># is safe</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ln</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">fn</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">fn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">numeric_fields</span><span class="p">:</span>  <span class="c"># make numbers integer </span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="p">[</span><span class="n">fn</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="p">[</span><span class="n">fn</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span>

    <span class="k">def</span> <span class="nf">set_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="c"># assume args: &quot;uid==500&quot;, &quot;command ~ ^wm&quot;</span>
        <span class="n">conds</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&quot;(\w+)([=&lt;&gt;]+)(.+)&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="p">(</span><span class="n">field</span><span class="p">,</span><span class="n">op</span><span class="p">,</span><span class="n">val</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&quot;can&#39;t understand query </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">SystemExit</span>
            <span class="k">if</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">numeric_fields</span><span class="p">:</span>
                <span class="n">conds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">conds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s%s</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">&#39;&quot;</span><span class="p">,(</span><span class="n">field</span><span class="p">,</span><span class="n">op</span><span class="p">,</span><span class="n">val</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_desirable</span> <span class="o">=</span> <span class="nb">compile</span><span class="p">(</span><span class="s">&quot;((&quot;</span><span class="o">+</span><span class="s">&quot;)and(&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">conds</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;))&quot;</span><span class="p">,</span> <span class="s">&quot;&lt;string&gt;&quot;</span><span class="p">,</span><span class="s">&quot;eval&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_desirable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_desirable</span><span class="p">,</span> <span class="p">{},</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># to allow &quot;print&quot;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ln</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">&quot;&quot;&quot;usage: </span><span class="si">%s</span><span class="s"> criterion ...</span>
<span class="s">    Each criterion is a Perl expression involving: </span>
<span class="s">    </span><span class="si">%s</span><span class="s"></span>
<span class="s">    All criteria must be met for a line to be printed.&quot;&quot;&quot;</span> \
    <span class="o">%</span> <span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PsLineMatch</span><span class="p">()</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">))</span>
    <span class="k">raise</span> <span class="ne">SystemExit</span>

<span class="n">psln</span> <span class="o">=</span> <span class="n">PsLineMatch</span><span class="p">()</span>
<span class="n">psln</span><span class="o">.</span><span class="n">set_query</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="s">&quot;ps wwaxl&quot;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">p</span><span class="o">.</span><span class="n">readline</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>        <span class="c"># emit header line</span>
<span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
    <span class="n">psln</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="n">ln</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">psln</span><span class="o">.</span><span class="n">is_desirable</span><span class="p">():</span>
        <span class="k">print</span> <span class="n">psln</span>
<span class="n">p</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c"># alternatively one could consider every argument being a string and</span>
<span class="c"># support wildcards: &quot;uid==500&quot; &quot;command~^wm&quot; by means of re, but this</span>
<span class="c"># does not show dynamic python code generation, although re.compile</span>
<span class="c"># also precompiles.</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="numbers.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>PLEAC-Python</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Numbers</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>