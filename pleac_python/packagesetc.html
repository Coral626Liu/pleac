<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Packages, Libraries, and Modules</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="PLEAC-Python"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="References and Records"
HREF="referencesandrecords.html"><LINK
REL="NEXT"
TITLE="Classes, Objects, and Ties"
HREF="classesetc.html"><style type="text/css">td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }

  </style></head
><BODY TEXT="#cecece" BGCOLOR="#4f6f6f" LINK="#f5deb3" VLINK="#d5ae83"
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PLEAC-Python</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="referencesandrecords.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="classesetc.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="PACKAGESETC"
>12. Packages, Libraries, and Modules</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN642"
>Introduction</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c">## Python&#39;s &quot;module&quot; is the closest equivalent to Perl&#39;s &quot;package&quot;</span>


<span class="c">#=== In the file &quot;Alpha.py&quot;</span>
<span class="n">name</span> <span class="o">=</span> <span class="s">&quot;first&quot;</span>

<span class="c">#=== End of file</span>

<span class="c">#=== In the file &quot;Omega.py&quot;</span>

<span class="n">name</span> <span class="o">=</span> <span class="s">&quot;last&quot;</span>
<span class="c">#=== End of file</span>

<span class="kn">import</span> <span class="nn">Alpha</span><span class="o">,</span> <span class="nn">Omega</span>
<span class="k">print</span> <span class="s">&quot;Alpha is </span><span class="si">%s</span><span class="s">, Omega is </span><span class="si">%s</span><span class="s">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Alpha</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Omega</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="c">#&gt; Alpha is first, Omega is last.</span>
<span class="c">#-----------------------------</span>
<span class="c"># Python does not have an equivalent to &quot;compile-time load&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c"># Depending on the implementation, this could use a builtin</span>
<span class="c"># module or load a file with the extension .py, .pyc, pyo, .pyd,</span>
<span class="c"># .so, .dll, or (with imputils) load from other files.</span>
<span class="kn">import</span> <span class="nn">Cards.Poker</span>

<span class="c">#-----------------------------</span>
<span class="c">#=== In the file Cards/Poker.py</span>
<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;card_deck&quot;</span><span class="p">,</span> <span class="s">&quot;shuffle&quot;</span><span class="p">]</span>  <span class="c"># not usually needed</span>
<span class="n">card_deck</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">def</span> <span class="nf">shuffle</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN645"
>Defining a Module's Interface</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c">#== In the file &quot;YourModule.py&quot;</span>

<span class="n">__version__</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>          <span class="c"># Or higher</span>
<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;...&quot;</span><span class="p">,</span> <span class="s">&quot;...&quot;</span><span class="p">]</span>      <span class="c"># Override names included in &quot;... import *&quot;</span>
                              <span class="c">#   Note: &#39;import *&#39; is considered poor style</span>
                              <span class="c">#   and it is rare to use this variable.</span>
<span class="c">########################</span>
<span class="c"># your code goes here</span>
<span class="c">########################</span>

<span class="c">#-----------------------------</span>
<span class="kn">import</span> <span class="nn">YourModule</span>             <span class="c"># Import the module into my package</span>
                              <span class="c">#  (does not import any of its symbols)</span>

<span class="kn">import</span> <span class="nn">YourModule</span> <span class="kn">as</span> <span class="nn">Module</span>   <span class="c"># Use a different name for the module</span>

<span class="kn">from</span> <span class="nn">YourModule</span> <span class="kn">import</span> <span class="o">*</span>      <span class="c"># Import all module symbols not starting</span>
                              <span class="c">#  with an underscore (default); if __all__</span>
                              <span class="c">#  is defined, only imports those symbols.</span>
                              <span class="c"># Using this is discouraged unless the </span>
                              <span class="c">#  module is specifically designed for it.</span>

<span class="kn">from</span> <span class="nn">YourModule</span> <span class="kn">import</span> <span class="n">name1</span><span class="p">,</span> <span class="n">name2</span><span class="p">,</span> <span class="n">xxx</span>
                              <span class="c"># Import the named symbols from the module</span>

<span class="kn">from</span> <span class="nn">YourModule</span> <span class="kn">import</span> <span class="n">name1</span> <span class="k">as</span> <span class="n">name2</span>
                              <span class="c"># Import the named object, but use a</span>
                              <span class="c">#  different name to access it locally.</span>

<span class="c">#-----------------------------</span>
<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;F1&quot;</span><span class="p">,</span> <span class="s">&quot;F2&quot;</span><span class="p">,</span> <span class="s">&quot;List&quot;</span><span class="p">]</span>
<span class="c">#-----------------------------</span>
<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;Op_Func&quot;</span><span class="p">,</span> <span class="s">&quot;Table&quot;</span><span class="p">]</span>
<span class="c">#-----------------------------</span>
<span class="kn">from</span> <span class="nn">YourModule</span> <span class="kn">import</span> <span class="n">Op_Func</span><span class="p">,</span> <span class="n">Table</span><span class="p">,</span> <span class="n">F1</span>
<span class="c">#-----------------------------</span>
<span class="kn">from</span> <span class="nn">YourModule</span> <span class="kn">import</span> <span class="n">Functions</span><span class="p">,</span> <span class="n">Table</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN648"
>Trapping Errors in require or use</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c"># no import</span>
<span class="n">mod</span> <span class="o">=</span> <span class="s">&quot;module&quot;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="nb">__import__</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">,</span> <span class="n">err</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s">&quot;couldn&#39;t load </span><span class="si">%s</span><span class="s">: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">err</span><span class="p">))</span>

<span class="c"># imports into current package</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">module</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">,</span> <span class="n">err</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s">&quot;couldn&#39;t load &#39;module&#39;: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="p">))</span>

<span class="c"># imports into current package, if the name is known</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">module</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">,</span> <span class="n">err</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s">&quot;couldn&#39;t load &#39;module&#39;: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="p">))</span>

<span class="c"># Use a fixed local name for a named module</span>
<span class="n">mod</span> <span class="o">=</span> <span class="s">&quot;module&quot;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">local_name</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">,</span> <span class="n">err</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s">&quot;couldn&#39;t load </span><span class="si">%s</span><span class="s">: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">err</span><span class="p">))</span>

<span class="c"># Use the given name for the named module.</span>
<span class="c"># (You probably don&#39;t need to do this.)</span>
<span class="n">mod</span> <span class="o">=</span> <span class="s">&quot;module&quot;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="nb">globals</span><span class="p">()[</span><span class="n">mod</span><span class="p">]</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">,</span> <span class="n">err</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s">&quot;couldn&#39;t load </span><span class="si">%s</span><span class="s">: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">err</span><span class="p">))</span>

<span class="c">#-----------------------------</span>
<span class="n">DBs</span> <span class="o">=</span> <span class="s">&quot;Giant.Eenie Giant.Meanie Mouse.Mynie Moe&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="k">for</span> <span class="n">mod</span> <span class="ow">in</span> <span class="n">DBs</span><span class="o">.</span><span class="n">split</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">loaded_module</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="c"># __import__ returns a reference to the top-most module</span>
    <span class="c"># Need to get the actual submodule requested.</span>
    <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">mod</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">loaded_module</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">loaded_module</span><span class="p">,</span> <span class="n">term</span><span class="p">)</span>
    <span class="k">break</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s">&quot;None of </span><span class="si">%s</span><span class="s"> loaded&quot;</span> <span class="o">%</span> <span class="n">DBs</span><span class="p">)</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN651"
>Delaying use Until Run Time</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> \
                          <span class="ow">or</span> <span class="ow">not</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">(</span><span class="s">&quot;usage: </span><span class="si">%s</span><span class="s"> num1 num2&quot;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="kn">import</span> <span class="nn">Some.Module</span>
<span class="kn">import</span> <span class="nn">More.Modules</span>
<span class="c">#-----------------------------</span>
<span class="k">if</span> <span class="n">opt_b</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">math</span>
<span class="c">#-----------------------------</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">O_EXCL</span><span class="p">,</span> <span class="n">O_CREAT</span><span class="p">,</span> <span class="n">O_RDWR</span>

<span class="c">#-----------------------------</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">O_EXCL</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">O_EXCL</span>
<span class="n">O_CREAT</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">O_CREAT</span>
<span class="n">O_RDWR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">O_RDWR</span>
<span class="c">#-----------------------------</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">O_EXCL</span><span class="p">,</span> <span class="n">O_CREAT</span><span class="p">,</span> <span class="n">O_RDWR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">O_EXCL</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">O_CREAT</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">O_RDWR</span>
<span class="c">#-----------------------------</span>
<span class="n">load_module</span><span class="p">(</span><span class="s">&#39;os&#39;</span><span class="p">,</span> <span class="s">&quot;O_EXCL O_CREAT O_RDWR&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>

<span class="k">def</span> <span class="nf">load_module</span><span class="p">(</span><span class="n">module_name</span><span class="p">,</span> <span class="n">symbols</span><span class="p">):</span>
    <span class="n">module</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">:</span>
        <span class="nb">globals</span><span class="p">()[</span><span class="n">symbol</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">symbol</span><span class="p">)</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN654"
>Making Variables Private to a Module</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c"># Python doesn&#39;t have Perl-style packages</span>

<span class="c"># Flipper.py</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;flip_boundary&quot;</span><span class="p">,</span> <span class="s">&quot;flip_words&quot;</span><span class="p">]</span>

<span class="n">Separatrix</span> <span class="o">=</span> <span class="s">&#39; &#39;</span>  <span class="c"># default to blank</span>

<span class="k">def</span> <span class="nf">flip_boundary</span><span class="p">(</span><span class="n">sep</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
    <span class="n">prev_sep</span> <span class="o">=</span> <span class="n">Separatrix</span>
    <span class="k">if</span> <span class="n">sep</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">global</span> <span class="n">Separatrix</span>
        <span class="n">Separatrix</span> <span class="o">=</span> <span class="n">sep</span>
    <span class="k">return</span> <span class="n">prev_sep</span>

<span class="k">def</span> <span class="nf">flip_words</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">Separatrix</span><span class="p">)</span>
    <span class="n">words</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">Separatrix</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN657"
>Determining the Caller's Package</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="n">this_pack</span> <span class="o">=</span> <span class="n">__name__</span>
<span class="c">#-----------------------------</span>
<span class="n">that_pack</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">_getframe</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">f_globals</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;__name__&quot;</span><span class="p">,</span> <span class="s">&quot;&lt;string&gt;&quot;</span><span class="p">)</span>
<span class="c">#-----------------------------</span>
<span class="k">print</span> <span class="s">&quot;I am in package&quot;</span><span class="p">,</span> <span class="n">__name__</span>
<span class="c">#-----------------------------</span>
<span class="k">def</span> <span class="nf">nreadline</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">myfile</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">count</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Count must be &gt; 0&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">myfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">myfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;/etc/termcap&quot;</span><span class="p">)</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">nreadline</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">myfile</span><span class="p">)</span>
    <span class="n">myfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>

<span class="c"># DON&#39;T DO THIS:</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">def</span> <span class="nf">nreadline</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">handle_name</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;count must be &gt; 0&quot;</span>
    <span class="nb">locals</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">_getframe</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">f_locals</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">locals</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">handle_name</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s">&quot;need open filehandle&quot;</span><span class="p">)</span>
    <span class="n">infile</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">[</span><span class="n">handle_name</span><span class="p">]</span>
    <span class="n">retlist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">infile</span><span class="p">:</span>
        <span class="n">retlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="n">count</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">retlist</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">FH</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;/etc/termcap&quot;</span><span class="p">)</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">nreadline</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s">&quot;FH&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN660"
>Automating Module Clean-Up</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c">## There is no direct equivalent in Python to an END block</span>
<span class="kn">import</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span>

<span class="c"># Tricks to ensure the needed functions exist during module cleanup</span>
<span class="k">def</span> <span class="nf">_getgmtime</span><span class="p">(</span><span class="n">asctime</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">asctime</span><span class="p">,</span> <span class="n">gmtime</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">gmtime</span><span class="p">,</span>
               <span class="n">t</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">asctime</span><span class="p">(</span><span class="n">gmtime</span><span class="p">(</span><span class="n">t</span><span class="p">()))</span>

<span class="k">class</span> <span class="nc">Logfile</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">file</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="nb">file</span>

    <span class="k">def</span> <span class="nf">_logmsg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">argv0</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pid</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">(),</span>
                <span class="n">_getgmtime</span><span class="o">=</span><span class="n">_getgmtime</span><span class="p">):</span>
        <span class="c"># more tricks to keep all needed references</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">_getgmtime</span><span class="p">()</span>
        <span class="k">print</span><span class="o">&gt;&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">,</span> <span class="n">argv0</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">now</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span><span class="p">,</span> <span class="n">msg</span>

    <span class="k">def</span> <span class="nf">logmsg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logmsg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logmsg</span><span class="p">(</span><span class="s">&quot;shutdown&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="c"># forward everything else to the file handle</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>

<span class="c"># 0 means unbuffered</span>
<span class="n">LF</span> <span class="o">=</span> <span class="n">Logfile</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;/tmp/mylog&quot;</span><span class="p">,</span> <span class="s">&quot;a+&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">logmsg</span> <span class="o">=</span> <span class="n">LF</span><span class="o">.</span><span class="n">logmsg</span>

<span class="c">#-----------------------------</span>
<span class="c">## It is more appropriate to use try/finally around the</span>
<span class="c">## main code, so the order of initialization and finalization</span>
<span class="c">## can be specified.</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">logger</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="s">&quot;/tmp/mylog&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">main</span><span class="p">()</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN663"
>Keeping Your Own Module Directory</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c">#% python -c &#39;import sys\</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">xrange</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">maxint</span><span class="p">),</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">):</span>\
    <span class="k">print</span> <span class="n">i</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<span class="c">#&gt; 0 &#39;&#39;</span>
<span class="c">#&gt; 1 &#39;/usr/lib/python2.2&#39;</span>
<span class="c">#&gt; 2 &#39;/usr/lib/python2.2/plat-linux2&#39;</span>
<span class="c">#&gt; 3 &#39;/usr/lib/python2.2/lib-tk&#39;</span>
<span class="c">#-----------------------------</span>
<span class="c"># syntax for sh, bash, ksh, or zsh</span>
<span class="c">#$ export PYTHONPATH=$HOME/pythonlib</span>

<span class="c"># syntax for csh or tcsh</span>
<span class="c">#% setenv PYTHONPATH ~/pythonlib</span>
<span class="c">#-----------------------------</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;/projects/spectre/lib&quot;</span><span class="p">)</span>
<span class="c">#-----------------------------</span>
<span class="kn">import</span> <span class="nn">FindBin</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">FindBin</span><span class="o">.</span><span class="n">Bin</span><span class="p">)</span>
<span class="c">#-----------------------------</span>
<span class="kn">import</span> <span class="nn">FindBin</span>
<span class="n">Bin</span> <span class="o">=</span> <span class="s">&quot;Name&quot;</span>
<span class="nb">bin</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">FindBin</span><span class="p">,</span> <span class="n">Bin</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">bin</span> <span class="o">+</span> <span class="s">&quot;/../lib&quot;</span><span class="p">)</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN666"
>Preparing a Module for Distribution</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c">#% h2xs -XA -n Planets</span>
<span class="c">#% h2xs -XA -n Astronomy::Orbits</span>
<span class="c">#-----------------------------</span>
<span class="c"># @@INCOMPLETE@@</span>
<span class="c"># @@INCOMPLETE@@</span>
<span class="c"># Need a distutils example</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN669"
>Speeding Module Loading with SelfLoader</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c"># Python compiles a file to bytecode the first time it is imported and </span>
<span class="c"># stores this compiled form in a .pyc file.  There is thus less need for</span>
<span class="c"># incremental compilation as once there is a .pyc file, the sourcecode</span>
<span class="c"># is only recompiled if it is modified.  </span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN672"
>Speeding Up Module Loading with Autoloader</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c"># See previous section</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN675"
>Overriding Built-In Functions</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c">## Any definition in a Python module overrides the builtin</span>
<span class="c">## for that module</span>

<span class="c">#=== In MyModule</span>
<span class="k">def</span> <span class="nf">open</span><span class="p">():</span>
    <span class="k">pass</span> <span class="c"># TBA</span>
<span class="c">#-----------------------------</span>
<span class="kn">from</span> <span class="nn">MyModule</span> <span class="kn">import</span> <span class="nb">open</span>
<span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">()</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN678"
>Reporting Errors and Warnings Like Built-Ins</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="k">def</span> <span class="nf">even_only</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>     <span class="c"># one way to test</span>
        <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> is not even&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n</span><span class="p">,))</span>
    <span class="c">#....</span>

<span class="c">#-----------------------------</span>
<span class="k">def</span> <span class="nf">even_only</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>    <span class="c"># here&#39;s another</span>
        <span class="c"># choice of exception depends on the problem</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> is not even&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n</span><span class="p">,))</span>
    <span class="c">#....</span>

<span class="c">#-----------------------------</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="k">def</span> <span class="nf">even_only</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>           <span class="c"># test whether odd number</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> is not even, continuing&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="c">#....</span>
<span class="c">#-----------------------------</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s">&quot;ignore&quot;</span><span class="p">)</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN681"
>Referring to Packages Indirectly</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="n">val</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="nb">__import__</span><span class="p">(</span><span class="n">packname</span><span class="p">),</span> <span class="n">varname</span><span class="p">)</span>
<span class="n">vals</span> <span class="o">=</span>  <span class="nb">getattr</span><span class="p">(</span><span class="nb">__import__</span><span class="p">(</span><span class="n">packname</span><span class="p">),</span> <span class="n">aryname</span><span class="p">)</span>
<span class="nb">getattr</span><span class="p">(</span><span class="nb">__import__</span><span class="p">(</span><span class="n">packname</span><span class="p">),</span> <span class="n">funcname</span><span class="p">)(</span><span class="s">&quot;args&quot;</span><span class="p">)</span>

<span class="c">#-----------------------------</span>
<span class="c"># DON&#39;T DO THIS [Use math.log(val, base) instead]</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="k">def</span> <span class="nf">make_log</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
   <span class="k">def</span> <span class="nf">logn</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
   <span class="k">return</span> <span class="n">logn</span>

<span class="c"># Modifying the global dictionary - this could also be done</span>
<span class="c"># using locals(), or someobject.__dict__</span>
<span class="n">globaldict</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">):</span>
    <span class="n">globaldict</span><span class="p">[</span><span class="s">&quot;log</span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_log</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="c"># DON&#39;T DO THIS</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1000</span><span class="p">):</span>
    <span class="k">exec</span> <span class="s">&quot;log</span><span class="si">%s</span><span class="s"> = make_log(i)&quot;</span><span class="o">%</span><span class="n">i</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">()</span>
    
<span class="k">print</span> <span class="n">log20</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
<span class="c">#=&gt;2.0</span>
<span class="c">#-----------------------------</span>
<span class="n">blue</span> <span class="o">=</span> <span class="n">colours</span><span class="o">.</span><span class="n">blue</span>
<span class="n">someobject</span><span class="o">.</span><span class="n">blue</span> <span class="o">=</span> <span class="n">colours</span><span class="o">.</span><span class="n">azure</span>  <span class="c"># someobject could be a module...</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN684"
>Using h2ph to Translate C #include Files</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c"># Python extension modules can be imported and used just like</span>
<span class="c"># a pure python module.</span>
<span class="c">#</span>
<span class="c"># See http://www.cosc.canterbury.ac.nz/~greg/python/Pyrex/ for</span>
<span class="c"># information on how to create extension modules in Pyrex [a</span>
<span class="c"># language that&#39;s basically Python with type definitions which</span>
<span class="c"># converts to compiled C code]</span>
<span class="c">#</span>
<span class="c"># See http://www.boost.org/libs/python/doc/ for information on how</span>
<span class="c"># to create extension modules in C++.</span>
<span class="c">#</span>
<span class="c"># See http://www.swig.org/Doc1.3/Python.html for information on how</span>
<span class="c"># to create extension modules in C/C++</span>
<span class="c">#</span>
<span class="c"># See http://docs.python.org/ext/ext.html for information on how to</span>
<span class="c"># create extension modules in C/C++ (manual reference count management).</span>
<span class="c">#</span>
<span class="c"># See http://cens.ioc.ee/projects/f2py2e/ for information on how to</span>
<span class="c"># create extension modules in Fortran</span>
<span class="c">#</span>
<span class="c"># See http://www.scipy.org/Weave for information on how to </span>
<span class="c"># include inline C code in Python code.</span>
<span class="c">#</span>
<span class="c"># @@INCOMPLETE@@ Need examples of FineTime extensions using the different methods...</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN687"
>Using h2xs to Make a Module with C Code</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c"># See previous section</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN690"
>Documenting Your Module with Pod</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c"># To document code, use docstrings. A docstring is a bare string that</span>
<span class="c"># is placed at the beginning of a module or immediately after the </span>
<span class="c"># definition line of a class, method, or function. Normally, the</span>
<span class="c"># first line is a brief description of the object; if a longer</span>
<span class="c"># description is needed, it commences on the third line (the second</span>
<span class="c"># line being left blank).  Multiline comments should use triple</span>
<span class="c"># quoted strings.</span>
<span class="c"># </span>
<span class="c"># Docstrings are automagically assigned to an object&#39;s __doc__ property.</span>
<span class="c">#</span>
<span class="c"># In other words these three classes are identical:</span>
<span class="k">class</span> <span class="nc">Foo</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="s">&quot;A class demonstrating docstrings.&quot;</span>

<span class="k">class</span> <span class="nc">Foo</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">__doc__</span> <span class="o">=</span> <span class="s">&quot;A class demonstrating docstrings.&quot;</span>

<span class="k">class</span> <span class="nc">Foo</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">pass</span>
<span class="n">Foo</span><span class="o">.</span><span class="n">__doc__</span> <span class="o">=</span> <span class="s">&quot;A class demonstrating docstrings.&quot;</span>

<span class="c"># as are these two functions:</span>
<span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="s">&quot;A function demonstrating docstrings.&quot;</span>

<span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="k">pass</span>
<span class="n">foo</span><span class="o">.</span><span class="n">__doc__</span> <span class="o">=</span> <span class="s">&quot;A function demonstrating docstrings.&quot;</span>

<span class="c"># the pydoc module is used to display a range of information about </span>
<span class="c"># an object including its docstrings:</span>
<span class="kn">import</span> <span class="nn">pydoc</span> 
<span class="k">print</span> <span class="n">pydoc</span><span class="o">.</span><span class="n">getdoc</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">pydoc</span><span class="o">.</span><span class="n">help</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c"># In the interactive interpreter, objects&#39; documentation can be </span>
<span class="c"># using the help function:</span>
<span class="n">help</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN693"
>Building and Installing a CPAN Module</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c"># Recent Python distributions are built and installed with disutils.</span>
<span class="c"># </span>
<span class="c"># To build and install under unix</span>
<span class="c"># </span>
<span class="c"># % python setup.py install</span>
<span class="c"># </span>
<span class="c"># If you want to build under one login and install under another</span>
<span class="c"># </span>
<span class="c"># % python setup.py build</span>
<span class="c"># $ python setup.py install</span>
<span class="c"># </span>
<span class="c"># A package may also be available prebuilt, eg, as an RPM or Windows</span>
<span class="c"># installer.  Details will be specific to the operating system.</span>

<span class="c">#-----------------------------</span>
<span class="c"># % python setup.py --prefix ~/python-lib</span>
<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN696"
>Example: Module Template</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c">#== File Some/Module.py</span>

<span class="c"># There are so many differences between Python and Perl that</span>
<span class="c"># it isn&#39;t worthwhile trying to come up with an equivalent to</span>
<span class="c"># this Perl code.  The Python code is much smaller, and there&#39;s</span>
<span class="c"># no need to have a template.</span>

<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN699"
>Program: Finding Versions and Descriptions of Installed Modules</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="c">#-----------------------------</span>
<span class="c">#% pmdesc</span>
<span class="c">#-----------------------------</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">pydoc</span>

<span class="k">def</span> <span class="nf">print_module_info</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">modname</span><span class="p">,</span> <span class="n">desc</span><span class="p">):</span>
   <span class="c"># Skip files starting with &quot;test_&quot;</span>
   <span class="k">if</span> <span class="n">modname</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;test_&quot;</span><span class="p">):</span>
       <span class="k">return</span>
   <span class="k">try</span><span class="p">:</span>
       <span class="c"># This assumes the modules are safe for importing,</span>
       <span class="c"># in that they don&#39;t have side effects.  Could also</span>
       <span class="c"># grep the file for the __version__ line.</span>
       <span class="n">mod</span> <span class="o">=</span> <span class="n">pydoc</span><span class="o">.</span><span class="n">safeimport</span><span class="p">(</span><span class="n">modname</span><span class="p">)</span>
   <span class="k">except</span> <span class="n">pydoc</span><span class="o">.</span><span class="n">ErrorDuringImport</span><span class="p">:</span>
       <span class="k">return</span>
   <span class="n">version</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="s">&quot;__version__&quot;</span><span class="p">,</span> <span class="s">&quot;unknown&quot;</span><span class="p">)</span>
   <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">version</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)):</span>
       <span class="c"># Use the string if it&#39;s given</span>
       <span class="k">pass</span>
   <span class="k">else</span><span class="p">:</span>
       <span class="c"># Assume it&#39;s a list of version numbers, from major to minor</span>
       <span class="s">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">version</span><span class="p">))</span>
   <span class="n">synopsis</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">pydoc</span><span class="o">.</span><span class="n">splitdoc</span><span class="p">(</span><span class="n">desc</span><span class="p">)</span>
   <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> (</span><span class="si">%s</span><span class="s">) - </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">modname</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">synopsis</span><span class="p">)</span>

<span class="n">scanner</span> <span class="o">=</span> <span class="n">pydoc</span><span class="o">.</span><span class="n">ModuleScanner</span><span class="p">()</span>
<span class="n">scanner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">print_module_info</span><span class="p">)</span>

<span class="c">#-----------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="referencesandrecords.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="classesetc.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>References and Records</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Classes, Objects, and Ties</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>