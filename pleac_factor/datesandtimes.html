<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Dates and Times</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="PLEAC-Factor"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="Numbers"
HREF="numbers.html"><LINK
REL="NEXT"
TITLE="Arrays"
HREF="arrays.html"><style type="text/css">td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }

  </style></head
><BODY TEXT="#cecece" BGCOLOR="#4f6f6f" LINK="#f5deb3" VLINK="#d5ae83"
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PLEAC-Factor</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="numbers.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="arrays.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="DATESANDTIMES"
>3. Dates and Times</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN132"
>Introduction</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="nb"></span><span class="c">! -----------------------------</span><span class="nb"></span>
<span class="c">! All examples use the &quot;calendar&quot; vocabulary</span><span class="nb"></span>
<span class="kn">USE:</span> <span class="nn">calendar</span><span class="nb"></span>

[<span class="nb"> </span><span class="s">&quot;Today is day &quot;</span><span class="nb"> </span>%<span class="nb"> </span>now<span class="nb"> </span>day-of-year<span class="nb"> </span>#<span class="nb"> </span><span class="s">&quot; of the current year.&quot;</span><span class="nb"> </span>%<span class="nb"> </span>]<span class="nb"> </span><span class="s">&quot;&quot;</span><span class="nb"> </span>make<span class="nb"> print</span>
<span class="c">! Today is day 132 of the current year.</span><span class="nb"></span>
<span class="c">! -----------------------------</span><span class="nb"></span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN135"
>Finding Today's Date</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="nb"></span><span class="c">! -----------------------------</span><span class="nb"></span>
now<span class="nb"> </span><span class="c">! puts timestamp on stack</span><span class="nb"></span>

<span class="c">! accessing day</span><span class="nb"></span>
day&gt;&gt;<span class="nb"></span>
<span class="c">! -----------------------------</span><span class="nb"></span>

<span class="c">! Formatting the date with &quot;calender.format&quot; vocabulary</span><span class="nb"></span>
<span class="kn">USE:</span> <span class="nn">calendar.format</span><span class="nb"></span>

now<span class="nb"> </span>timestamp&gt;rfc3339<span class="nb"></span>
<span class="c">! Top of stack: &quot;2008-05-11T22:39:01+02:00&quot;</span><span class="nb"></span>

now<span class="nb"> </span>timestamp&gt;ymd<span class="nb"></span>
<span class="c">! Top of stack: &quot;2008-05-11&quot;</span><span class="nb"></span>
<span class="c">! -----------------------------</span><span class="nb"></span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN138"
>Converting DMYHMS to Epoch Seconds</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="nb"></span><span class="c">! -----------------------------</span><span class="nb"></span>
<span class="c">! Epoch milliseconds</span><span class="nb"></span>
now<span class="nb"> </span>timestamp&gt;millis<span class="nb"></span>
<span class="c">! Top of stack: 1210538827773</span><span class="nb"></span>

<span class="c">! Calculate seconds</span><span class="nb"></span>
<span class="mi">1000 </span><span class="o">/ </span><span class="nb">&gt;integer</span>
<span class="c">! -----------------------------</span><span class="nb"></span>

<span class="c">! GMT milliseconds</span><span class="nb"></span>
gmt<span class="nb"> </span>timestamp&gt;millis<span class="nb"></span>
<span class="c">! Top of Stack: 1210539018199</span><span class="nb"></span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN141"
>Converting Epoch Seconds to DMYHMS</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="nb"></span><span class="c">! -----------------------------</span><span class="nb"></span>
<span class="c">! Epoch milliseconds to timestamp</span><span class="nb"></span>
<span class="mi">1210538827773 </span>millis&gt;timestamp<span class="nb"></span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN144"
>Adding to or Subtracting from a Date</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="nb"></span><span class="c">! -----------------------------</span><span class="nb"></span>
<span class="c">! Durations can be added and substracted with the words &quot;time+&quot; and &quot;time-&quot;</span><span class="nb"></span>
now<span class="nb"> </span><span class="mi">5 </span>days<span class="nb"> </span>time+<span class="nb"> </span>timestamp&gt;ymd<span class="nb"> print</span>
<span class="c">! 2008-05-17</span><span class="nb"></span>
now<span class="nb"> </span><span class="mi">5 </span>days<span class="nb"> </span>time-<span class="nb"> </span>timestamp&gt;ymd<span class="nb"> print</span>
<span class="c">! 2008-05-07</span><span class="nb"></span>
<span class="c">! -----------------------------</span><span class="nb"></span>
<span class="mi">1973 1 18 3 45 50 </span>gmt-offset-duration<span class="nb"> </span>&lt;timestamp&gt;<span class="nb">   </span><span class="c">! Birthtime</span><span class="nb"></span>
<span class="nb">    </span><span class="mi">0 0 55 2 17 5 </span>&lt;duration&gt;<span class="nb">                        </span><span class="c">! Interval</span><span class="nb"></span>
<span class="nb">    </span>time+<span class="nb"></span>
<span class="nb">    </span>timestamp&gt;string<span class="nb"> </span><span class="s">&quot;Then is &quot;</span><span class="nb"> swap append print</span>
<span class="c">! Then is Wed, 14 Mar 1973 06:02:55</span><span class="nb"></span>
<span class="c">! -----------------------------</span><span class="nb"></span>
<span class="s">&quot;Nat was 55 days old on: &quot;</span><span class="nb"> </span><span class="mi">1973 1 18 </span>&lt;date&gt;<span class="nb"> </span><span class="mi">55 </span>days<span class="nb"> </span>time+<span class="nb"> </span>timestamp&gt;ymd<span class="nb"> append print</span>
<span class="c">! Nat was 55 days old on: 1973-03-14</span><span class="nb"></span>
<span class="c">! -----------------------------</span><span class="nb"></span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN147"
>Difference of Two Dates</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c"></span><span class="nb"></span><span class="c">! -----------------------------</span><span class="nb"></span>
<span class="c">! Timestamps can be substracted from each other with &quot;time-&quot;. You get a duration,</span><span class="nb"></span>
<span class="c">! which can be converted to the number of seconds, minutes, etc.</span><span class="nb"></span>
now<span class="nb"> </span><span class="mi">5 </span>days<span class="nb"> </span>time-<span class="nb">        </span><span class="c">! 5 days before</span><span class="nb"></span>
<span class="nb">    </span>now<span class="nb"> </span><span class="mi">5 </span>days<span class="nb"> </span>time+<span class="nb">    </span><span class="c">! in 5 days</span><span class="nb"></span>
<span class="nb">    </span>time-<span class="nb">               </span><span class="c">! substracting the two timestamps</span><span class="nb"></span>
<span class="nb">    </span>dt&gt;days<span class="nb"> </span>.<span class="nb">           </span><span class="c">! converting duration to number of days and prettyprinting it.</span><span class="nb"></span>
<span class="c">! -10</span><span class="nb"></span>
<span class="c">! -----------------------------</span><span class="nb"></span>
<span class="c">! Putting duration since lunar landing onto the stack:</span><span class="nb"></span>
now<span class="nb"></span>
<span class="nb">    </span><span class="mi">1969 7 20 20 17 40 </span>instant<span class="nb"> </span>&lt;timestamp&gt;<span class="nb">   </span><span class="c">! 1969-07-20 20:17:40 UTC</span><span class="nb"></span>
<span class="nb">    </span>time-<span class="nb"></span>
<span class="c">! -----------------------------</span><span class="nb"></span>
<span class="kn">USING:</span> <span class="nn">calendar</span> <span class="nn">math.parser</span> <span class="k">;</span><span class="nb"></span>
<span class="mi">1981 6 16 4 35 25 </span>instant<span class="nb"> </span>&lt;timestamp&gt;<span class="nb">   </span><span class="c">! 16 Jun 1981, 4:35:25 UTC, Bree</span><span class="nb"></span>
<span class="mi">1973 1 18 3 45 50 </span>instant<span class="nb"> </span>&lt;timestamp&gt;<span class="nb">   </span><span class="c">! 18 Jan 1973, 3:45:50 UTC, Nat</span><span class="nb"></span>
time-<span class="nb"></span>
dt&gt;seconds<span class="nb"></span>
<span class="nb">dup     </span><span class="c">! Duplicates top of stack so we can use it later again.</span><span class="nb"></span>

[<span class="nb"> </span><span class="s">&quot;There were &quot;</span><span class="nb"> </span>%<span class="nb"> </span>#<span class="nb"> </span><span class="s">&quot; seconds between Nat and Bree&quot;</span><span class="nb"> </span>%<span class="nb"> </span>]<span class="nb"> </span><span class="s">&quot;&quot;</span><span class="nb"> </span>make<span class="nb"> print</span>
<span class="c">! There were 265337375 seconds between Nat and Bree</span><span class="nb"></span>

[<span class="nb"> dup </span><span class="mi">60 </span><span class="nb">mod dup </span>,<span class="nb"> </span><span class="c">! seconds</span><span class="nb"></span>
<span class="nb">  </span><span class="o">- </span><span class="mi">60 </span><span class="o">/ </span><span class="nb"> </span><span class="c">! rest in minutes</span><span class="nb"></span>
<span class="nb">  dup </span><span class="mi">60 </span><span class="nb">mod dup </span>,<span class="nb"> </span><span class="c">! minutes</span><span class="nb"></span>
<span class="nb">  </span><span class="o">- </span><span class="mi">60 </span><span class="o">/ </span><span class="nb"> </span><span class="c">! rest in hours</span><span class="nb"></span>
<span class="nb">  dup </span><span class="mi">24 </span><span class="nb">mod dup </span>,<span class="nb"> </span><span class="c">! hours</span><span class="nb"></span>
<span class="nb">  </span><span class="o">- </span><span class="mi">24 </span><span class="o">/ </span><span class="nb"> </span><span class="c">! rest in days</span><span class="nb"></span>
<span class="nb">  dup </span><span class="mi">7 </span><span class="nb">mod dup </span>,<span class="nb"> </span><span class="c">! days</span><span class="nb"></span>
<span class="nb">  </span><span class="o">- </span><span class="mi">7 </span><span class="o">/ </span>,<span class="nb"> </span><span class="c">! weeks</span><span class="nb"></span>
]<span class="nb"> </span>{<span class="nb"> </span>}<span class="nb"> </span>make<span class="nb"></span>

[<span class="nb"> </span>[<span class="nb"> </span><span class="s">&quot;(&quot;</span><span class="nb"> </span>%<span class="nb"> </span>#<span class="nb"> </span><span class="s">&quot; weeks, &quot;</span><span class="nb"> </span>%<span class="nb"> </span>#<span class="nb"> </span><span class="s">&quot; days, &quot;</span><span class="nb"> </span>%<span class="nb"> </span>#<span class="nb"> </span><span class="s">&quot;:&quot;</span><span class="nb"> </span>%<span class="nb"> </span>#<span class="nb"> </span><span class="s">&quot;:&quot;</span><span class="nb"> </span>%<span class="nb"> </span>#<span class="nb"> </span><span class="s">&quot;)&quot;</span><span class="nb"> </span>%<span class="nb"> </span>]<span class="nb"> </span><span class="s">&quot;&quot;</span><span class="nb"> </span>make<span class="nb"> </span>]<span class="nb"> with-datastack</span>
<span class="nb">first print</span>
<span class="c">! (438 weeks, 5 days, 0:49:35)</span><span class="nb"></span>

<span class="c">! -----------------------------</span><span class="nb"></span>
<span class="mi">1981 6 16 </span>&lt;date&gt;<span class="nb">    </span><span class="c">! 16 Jun 1981, Bree</span><span class="nb"></span>
<span class="mi">1973 1 18 </span>&lt;date&gt;<span class="nb">    </span><span class="c">! 18 Jan 1973, Nat</span><span class="nb"></span>
time-<span class="nb"></span>
dt&gt;days<span class="nb"></span>
[<span class="nb"> </span><span class="s">&quot;There were &quot;</span><span class="nb"> </span>%<span class="nb"> </span>#<span class="nb"> </span><span class="s">&quot; days between Nat and Bree&quot;</span><span class="nb"> </span>%<span class="nb"> </span>]<span class="nb"> </span><span class="s">&quot;&quot;</span><span class="nb"> </span>make<span class="nb"> print</span>
<span class="c">! There were 3071 days between Nat and Bree</span><span class="nb"></span>
<span class="c">! -----------------------------</span><span class="nb"></span>
</pre></div>
</body>
</html></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN150"
>Day in a Week/Month/Year or Week Number</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN153"
>Parsing Dates and Times from Strings</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN156"
>Printing a Date</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN159"
>High-Resolution Timers</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN162"
>Short Sleeps</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN165"
>Program: hopdelta</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="numbers.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="arrays.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Numbers</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Arrays</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>