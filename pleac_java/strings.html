<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Strings</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="PLEAC-Java"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="PLEAC-Java"
HREF="index.html"><LINK
REL="NEXT"
TITLE="Numbers"
HREF="numbers.html"><style type="text/css">td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }

  </style></head
><BODY TEXT="#cecece" BGCOLOR="#4f6f6f" LINK="#f5deb3" VLINK="#d5ae83"
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PLEAC-Java</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="index.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="numbers.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="STRINGS"
>1. Strings</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN14"
>Introduction</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// character are simple values, and use single quotes are delimiters</span>
<span class="kt">char</span> <span class="n">c</span> <span class="o">=</span> <span class="sc">&#39;\n&#39;</span><span class="o">;</span>                           <span class="c1">// a newline character</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// strings are immutable objects, and use double quotes as delimiters</span>
<span class="n">String</span> <span class="n">s1</span> <span class="o">=</span> <span class="s">&quot;\n&quot;</span><span class="o">;</span>                    <span class="c1">// a string containing only a newline</span>
<span class="n">String</span> <span class="n">s2</span> <span class="o">=</span> <span class="s">&quot;Jon \&quot;Maddog\&quot; Orwant&quot;</span><span class="o">;</span> <span class="c1">// a string containing double quotes</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// use concatenation for multiline string declation</span>
<span class="n">String</span> <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;This is a multiline string declaration &quot;</span>
         <span class="o">+</span> <span class="s">&quot;using the concatenation operator &quot;</span>
         <span class="o">+</span> <span class="s">&quot;to append separate parts.&quot;</span><span class="o">;</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN17"
>Accessing Substrings</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// accessing substrings</span>
<span class="n">String</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">start</span><span class="o">,</span> <span class="n">end</span><span class="o">);</span>
<span class="n">String</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">start</span><span class="o">);</span>
	    
<span class="c1">// String instances are immutable character sequences</span>
<span class="c1">// recreating them on the fly is unefficient</span>
<span class="n">String</span> <span class="n">variableString</span> <span class="o">=</span> <span class="n">data</span><span class="o">;</span>
<span class="n">variableString</span> <span class="o">=</span> <span class="n">variableString</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">start</span><span class="o">)</span> <span class="o">+</span> <span class="n">newMiddle</span>
    <span class="o">+</span> <span class="n">variableString</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">start</span><span class="o">);</span>
<span class="n">variableString</span> <span class="o">=</span> <span class="n">variableString</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">start</span><span class="o">)</span> <span class="o">+</span> <span class="n">newTail</span><span class="o">;</span>

<span class="c1">// StringBuffer instances are mutable character sequences</span>
<span class="c1">// they provides efficient modification methods</span>
<span class="n">StringBuffer</span> <span class="n">variableStringBuffer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="o">(</span><span class="n">data</span><span class="o">);</span>
<span class="n">variableStringBuffer</span><span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="n">start</span><span class="o">,</span> <span class="n">end</span><span class="o">,</span> <span class="n">newMiddle</span><span class="o">);</span>
<span class="n">variableStringBuffer</span><span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="n">start</span><span class="o">,</span> <span class="n">variableStringBuffer</span><span class="o">.</span><span class="na">length</span><span class="o">(),</span> <span class="n">newTail</span><span class="o">);</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// No real pack/unpack equivalent exist in Java. Exemples here use a custom</span>
<span class="c1">// implementation to split an original string into chunks of specified length</span>

<span class="c1">// get a 5-characters string, skip 3, then grab 2 8-characters strings,</span>
<span class="c1">// then the rest</span>
<span class="k">try</span> <span class="o">{</span> 
    <span class="n">String</span><span class="o">[]</span> <span class="n">a</span> <span class="o">=</span> <span class="n">unpack</span><span class="o">(</span><span class="s">&quot;A5 x3 A8 A8 A*&quot;</span><span class="o">,</span> <span class="n">data</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ParseException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{}</span>

<span class="c1">// split at five characters boundaries</span>
<span class="k">try</span> <span class="o">{</span> 
    <span class="n">String</span><span class="o">[]</span> <span class="n">fivers</span> <span class="o">=</span> <span class="n">unpack</span><span class="o">(</span><span class="n">aggregate</span><span class="o">(</span><span class="s">&quot;A5 &quot;</span><span class="o">,</span> <span class="n">data</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">/</span> <span class="mi">5</span><span class="o">),</span> <span class="n">data</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ParseException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{}</span>

<span class="c1">// chop string into unique character strings</span>
<span class="k">try</span> <span class="o">{</span> 
    <span class="n">String</span><span class="o">[]</span> <span class="n">chars</span> <span class="o">=</span> <span class="n">unpack</span><span class="o">(</span><span class="n">aggregate</span><span class="o">(</span><span class="s">&quot;A1 &quot;</span><span class="o">,</span> <span class="n">data</span><span class="o">.</span><span class="na">length</span><span class="o">()),</span> <span class="n">data</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ParseException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{}</span>

<span class="cm">/**</span>
<span class="cm"> * Unpacks a string into a string array following a given format.</span>
<span class="cm"> */</span>
<span class="n">String</span><span class="o">[]</span> <span class="nf">unpack</span><span class="o">(</span><span class="n">String</span> <span class="n">format</span><span class="o">,</span> <span class="n">String</span> <span class="n">data</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ParseException</span> <span class="o">{</span>
    <span class="n">ArrayList</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>
    <span class="kt">int</span> <span class="n">formatOffset</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">dataOffset</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">minDataOffset</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">maxDataOffset</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">length</span><span class="o">();</span>
    
    <span class="n">StringTokenizer</span> <span class="n">tokenizer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringTokenizer</span><span class="o">(</span><span class="n">format</span><span class="o">);</span>
    <span class="k">while</span> <span class="o">(</span><span class="n">tokenizer</span><span class="o">.</span><span class="na">hasMoreTokens</span><span class="o">())</span> <span class="o">{</span>
	<span class="n">String</span> <span class="n">token</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="na">nextToken</span><span class="o">();</span>
	<span class="kt">int</span> <span class="n">tokenLen</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="na">length</span><span class="o">();</span>
	
	<span class="c1">// count determination</span>
	<span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
	<span class="k">if</span> <span class="o">(</span><span class="n">tokenLen</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span>
	    <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
	<span class="k">else</span> <span class="nf">if</span> <span class="o">(</span><span class="n">token</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">==</span> <span class="sc">&#39;*&#39;</span><span class="o">)</span>
	    <span class="n">count</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
	<span class="k">else</span> <span class="o">{</span>
	    <span class="k">try</span> <span class="o">{</span>
		<span class="n">count</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Integer</span><span class="o">(</span><span class="n">token</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">1</span><span class="o">)).</span><span class="na">intValue</span><span class="o">();</span>
	    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">NumberFormatException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">throw</span> <span class="k">new</span> <span class="nf">ParseException</span><span class="o">(</span><span class="s">&quot;Unknown count token&quot;</span><span class="o">,</span> <span class="n">formatOffset</span><span class="o">);</span>
	    <span class="o">}</span>
	<span class="o">}</span>
	
	<span class="c1">// action determination</span>
	<span class="kt">char</span> <span class="n">action</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
	<span class="k">switch</span> <span class="o">(</span><span class="n">action</span><span class="o">)</span> <span class="o">{</span>
	    <span class="k">case</span> <span class="sc">&#39;A&#39;</span><span class="o">:</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">count</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
		    <span class="kt">int</span> <span class="n">start</span> <span class="o">=</span> <span class="o">(</span><span class="n">dataOffset</span> <span class="o">&lt;</span> <span class="n">maxDataOffset</span><span class="o">)</span> <span class="o">?</span>
			<span class="n">dataOffset</span> <span class="o">:</span> <span class="n">maxDataOffset</span><span class="o">;</span>
		    <span class="n">result</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">start</span><span class="o">));</span>
		    <span class="n">dataOffset</span> <span class="o">=</span> <span class="n">maxDataOffset</span><span class="o">;</span>
		<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
		    <span class="kt">int</span> <span class="n">start</span> <span class="o">=</span> <span class="o">(</span><span class="n">dataOffset</span> <span class="o">&lt;</span> <span class="n">maxDataOffset</span><span class="o">)</span> <span class="o">?</span>
			<span class="n">dataOffset</span> <span class="o">:</span> <span class="n">maxDataOffset</span><span class="o">;</span>
		    <span class="kt">int</span> <span class="n">end</span> <span class="o">=</span> <span class="o">(</span><span class="n">dataOffset</span> <span class="o">+</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">maxDataOffset</span><span class="o">)</span> <span class="o">?</span>
			<span class="n">dataOffset</span> <span class="o">+</span> <span class="n">count</span> <span class="o">:</span> <span class="n">maxDataOffset</span><span class="o">;</span>
		    <span class="n">result</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">start</span><span class="o">,</span> <span class="n">end</span><span class="o">));</span>
		    <span class="n">dataOffset</span> <span class="o">+=</span> <span class="n">count</span><span class="o">;</span>
		<span class="o">}</span>
		<span class="k">break</span><span class="o">;</span>
	    <span class="k">case</span> <span class="sc">&#39;x&#39;</span><span class="o">:</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">count</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span>
		    <span class="n">dataOffset</span> <span class="o">=</span> <span class="n">maxDataOffset</span><span class="o">;</span>
		<span class="k">else</span>
		    <span class="n">dataOffset</span> <span class="o">+=</span> <span class="n">count</span><span class="o">;</span>
		<span class="k">break</span><span class="o">;</span>
	    <span class="k">case</span> <span class="sc">&#39;X&#39;</span><span class="o">:</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">count</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span>
		    <span class="n">dataOffset</span> <span class="o">=</span> <span class="n">minDataOffset</span><span class="o">;</span>
		<span class="k">else</span>
		    <span class="n">dataOffset</span> <span class="o">-=</span> <span class="n">count</span><span class="o">;</span>
		<span class="k">break</span><span class="o">;</span>
	    <span class="k">default</span><span class="o">:</span>
		<span class="k">throw</span> <span class="k">new</span> <span class="nf">ParseException</span><span class="o">(</span><span class="s">&quot;Unknown action token&quot;</span><span class="o">,</span> <span class="n">formatOffset</span><span class="o">);</span>
	<span class="o">}</span>
	<span class="n">formatOffset</span> <span class="o">+=</span> <span class="n">tokenLen</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="o">(</span><span class="n">String</span><span class="o">[])</span> <span class="n">result</span><span class="o">.</span><span class="na">toArray</span><span class="o">(</span><span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="n">result</span><span class="o">.</span><span class="na">size</span><span class="o">()]);</span>
<span class="o">}</span>

<span class="cm">/**</span>
<span class="cm"> * Aggregates repetitly a basic pattern.</span>
<span class="cm"> */</span>
<span class="n">String</span> <span class="nf">aggregate</span><span class="o">(</span><span class="n">String</span> <span class="n">pattern</span><span class="o">,</span> <span class="kt">int</span> <span class="n">count</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">StringBuffer</span> <span class="n">buffer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="o">();</span>
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">count</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
	<span class="n">buffer</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">pattern</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">buffer</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
<span class="o">}</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">String</span> <span class="n">data</span> <span class="o">=</span> <span class="s">&quot;This is what you have&quot;</span><span class="o">;</span>
<span class="c1">// forward    +012345678901234567890 </span>
<span class="c1">// backward    109876543210987654321-</span>

<span class="c1">// backward indexing doesn&#39;t exist, but can easily be translated into forward</span>
<span class="c1">// indexing: forward = data.length() - backward;</span>

<span class="n">String</span> <span class="n">first</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">);</span>
<span class="c1">// &quot;T&quot;</span>
<span class="n">String</span> <span class="n">start</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="mi">7</span><span class="o">);</span>
<span class="c1">// &quot;is&quot;</span>
<span class="n">String</span> <span class="n">rest</span>  <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">13</span><span class="o">);</span>
<span class="c1">// &quot;you have&quot;</span>
<span class="n">String</span> <span class="n">last</span>  <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
<span class="c1">// &quot;e&quot;</span>
<span class="n">String</span> <span class="n">end</span>   <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="mi">4</span><span class="o">);</span>
<span class="c1">// &quot;have&quot;</span>
<span class="n">String</span> <span class="n">piece</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="mi">8</span><span class="o">,</span> <span class="n">data</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="mi">5</span><span class="o">);</span>
<span class="c1">// &quot;you&quot;</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">String</span> <span class="n">data</span> <span class="o">=</span> <span class="s">&quot;This is what you have&quot;</span><span class="o">;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span> <span class="o">+</span> <span class="s">&quot;wasn&#39;t&quot;</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">7</span><span class="o">);</span>
<span class="c1">// &quot;This wasn&#39;t what you have&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">data</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="mi">12</span><span class="o">)</span> <span class="o">+</span> <span class="s">&quot;ondrous&quot;</span><span class="o">;</span>
<span class="c1">// &quot;This wasn&#39;t wondrous&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="c1">// &quot;his wasn&#39;t wondrous&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">data</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="mi">10</span><span class="o">);</span>
<span class="c1">// &quot;his wasn&#39;&quot;</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="kn">import</span> <span class="nn">org.apache.oro.text.perl.Perl5Util</span><span class="o">;</span>

<span class="n">Perl5Util</span> <span class="n">util</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Perl5Util</span><span class="o">();</span>
<span class="c1">// you can test substrings with match() method</span>
<span class="k">if</span> <span class="o">(</span><span class="n">util</span><span class="o">.</span><span class="na">match</span><span class="o">(</span><span class="s">&quot;/pattern/&quot;</span><span class="o">,</span> <span class="n">data</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="mi">10</span><span class="o">)))</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Pattern matches in last 10 characters&quot;</span><span class="o">);</span>

<span class="c1">// substitute &quot;at&quot; for &quot;is&quot;, restricted to first five characters</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="na">substitute</span><span class="o">(</span><span class="s">&quot;s/is/at/g&quot;</span><span class="o">,</span> <span class="n">data</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">5</span><span class="o">))</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">5</span><span class="o">);</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// exchange the first and last letters in a string</span>
<span class="n">String</span> <span class="n">data</span> <span class="o">=</span> <span class="s">&quot;make a hat&quot;</span><span class="o">;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">data</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span>
    <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span> <span class="c1">// &quot;take a ham&quot;</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// extract column with unpack</span>
<span class="n">String</span> <span class="n">data</span> <span class="o">=</span> <span class="s">&quot;To be or not to be&quot;</span><span class="o">;</span>

<span class="c1">// skip 6, grab 6</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">String</span><span class="o">[]</span> <span class="n">a1</span> <span class="o">=</span> <span class="n">unpack</span><span class="o">(</span><span class="s">&quot;x6 A6&quot;</span><span class="o">,</span> <span class="n">data</span><span class="o">);</span>       <span class="c1">// {&quot;or not&quot;}</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ParseException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{}</span>

<span class="c1">// forward 6, grab 2, backward 5, grab 2</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">String</span><span class="o">[]</span> <span class="n">a2</span> <span class="o">=</span> <span class="n">unpack</span><span class="o">(</span><span class="s">&quot;x6 A2 X5 A2&quot;</span><span class="o">,</span> <span class="n">data</span><span class="o">);</span> <span class="c1">// {&quot;or&quot;, &quot;be&quot;}</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ParseException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{}</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="cm">/**</span>
<span class="cm"> * Creates a format suitable for unpack method.</span>
<span class="cm"> */</span>
<span class="n">String</span> <span class="nf">cut2fmt</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">positions</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">StringBuffer</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="o">();</span>
    <span class="kt">int</span> <span class="n">end</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">positions</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
        <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;A&quot;</span><span class="o">);</span>
        <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">positions</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">-</span> <span class="n">end</span><span class="o">);</span>
        <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&quot; &quot;</span><span class="o">);</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">positions</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
    <span class="o">}</span>
    <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;A*&quot;</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">sb</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
<span class="o">}</span>

<span class="n">String</span> <span class="n">fmt</span> <span class="o">=</span> <span class="n">cut2fmt</span><span class="o">(</span><span class="k">new</span> <span class="kt">int</span><span class="o">[]</span> <span class="o">{</span><span class="mi">8</span><span class="o">,</span> <span class="mi">14</span><span class="o">,</span> <span class="mi">20</span><span class="o">,</span> <span class="mi">26</span><span class="o">,</span> <span class="mi">30</span><span class="o">});</span> <span class="c1">// &quot;A7 A6 A6 A6 A4 A*&quot;</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN20"
>Establishing a Default Value</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// truth only concern boolean values</span>

<span class="c1">// use b if b is true, else c</span>
<span class="kt">boolean</span>  <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">;</span>
<span class="c1">// [..]</span>
<span class="kt">boolean</span> <span class="n">a</span> <span class="o">=</span> <span class="o">(</span><span class="n">b</span> <span class="o">||</span> <span class="n">c</span><span class="o">);</span>              

<span class="c1">// set x to y unless x is already true</span>
<span class="kt">boolean</span> <span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">;</span>
<span class="c1">// [..]</span>
<span class="n">x</span> <span class="o">=</span> <span class="o">(</span><span class="n">x</span> <span class="o">||</span> <span class="n">y</span><span class="o">);</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// other types must test default value</span>
<span class="c1">// only instance variables have default values, depending of their type:</span>
<span class="c1">// object -&gt; null</span>
<span class="c1">// int -&gt; 0</span>
<span class="c1">// char -&gt; ?</span>
<span class="c1">// boolean -&gt; ?</span>
<span class="c1">// local variables must always be explicitly initialised</span>

<span class="c1">// creating a new variable: ternary operator</span>
<span class="c1">//use b if b is not null, else c</span>
<span class="n">Object</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">;</span>
<span class="c1">// [..]</span>
<span class="n">Object</span> <span class="n">a</span> <span class="o">=</span> <span class="o">(</span><span class="n">b</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">?</span> <span class="n">b</span> <span class="o">:</span> <span class="n">c</span><span class="o">;</span>

<span class="c1">// reallocating a variable: direct test</span>
<span class="c1">// set x to y unless x is already true</span>
<span class="n">Object</span> <span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">;</span>
<span class="c1">// [..]</span>
<span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">y</span><span class="o">;</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// strings are objects, so you must use the ternary operator</span>
<span class="n">String</span> <span class="n">foo</span> <span class="o">=</span> <span class="o">(</span><span class="n">bar</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">?</span> <span class="n">bar</span> <span class="o">:</span> <span class="s">&quot;DEFAULT VALUE&quot;</span><span class="o">;</span>
<span class="c1">// you may also consider the empty string case</span>
<span class="c1">// you must first test for nullity, to prevent a potential NullPointerException</span>
<span class="n">String</span> <span class="n">foo</span> <span class="o">=</span> <span class="o">((</span><span class="n">bar</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">bar</span><span class="o">.</span><span class="na">length</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">))</span> <span class="o">?</span> <span class="n">bar</span> <span class="o">:</span> <span class="s">&quot;DEFAULT VALUE&quot;</span><span class="o">;</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
<span class="c1">// lazy evaluation prevents various exceptions to occurs</span>
<span class="n">String</span> <span class="n">dir</span> <span class="o">=</span> <span class="o">((</span><span class="n">args</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="n">index</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
    <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="n">index</span><span class="o">].</span><span class="na">length</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">))</span> <span class="o">?</span> <span class="n">args</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="o">:</span> <span class="s">&quot;/tmp&quot;</span><span class="o">;</span>
<span class="n">index</span><span class="o">++;</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
<span class="c1">// lazy evaluation prevents various exceptions to occurs</span>
<span class="n">String</span> <span class="n">dir</span> <span class="o">=</span> <span class="o">((</span><span class="n">args</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="n">index</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
    <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="n">index</span><span class="o">].</span><span class="na">length</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">))</span> <span class="o">?</span> <span class="n">args</span><span class="o">[</span><span class="n">index</span><span class="o">++]</span> <span class="o">:</span> <span class="s">&quot;/tmp&quot;</span><span class="o">;</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">String</span> <span class="n">dir</span> <span class="o">=</span> <span class="o">((</span><span class="n">args</span><span class="o">.</span><span class="na">length</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">))</span> <span class="o">?</span> <span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">:</span> <span class="s">&quot;/tmp&quot;</span><span class="o">;</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// Collection contains only objects, so values must be wrapped</span>
<span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="o">(</span><span class="n">shell</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">?</span> <span class="n">shell</span> <span class="o">:</span> <span class="s">&quot;/bin/sh&quot;</span><span class="o">;</span>
<span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
<span class="k">if</span> <span class="o">(</span><span class="n">count</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">key</span><span class="o">))</span>
    <span class="n">value</span> <span class="o">=</span> <span class="o">((</span><span class="n">Integer</span><span class="o">)</span> <span class="n">count</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">)).</span><span class="na">intValue</span><span class="o">();</span>
<span class="n">count</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="k">new</span> <span class="n">Integer</span><span class="o">(++</span><span class="n">value</span><span class="o">));</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// chained conditional allocations can test preceding allocation value</span>

<span class="c1">// find the user name on Unix systems</span>
<span class="n">String</span> <span class="n">user</span><span class="o">;</span>
<span class="n">Properties</span> <span class="n">environment</span> <span class="o">=</span> <span class="n">getEnvironment</span><span class="o">();</span>
<span class="kt">int</span> <span class="n">UID</span> <span class="o">=</span> <span class="n">getUID</span><span class="o">();</span>
<span class="k">if</span> <span class="o">((</span><span class="n">user</span> <span class="o">=</span> <span class="n">environment</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">&quot;USER&quot;</span><span class="o">))</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
    <span class="k">if</span> <span class="o">((</span><span class="n">user</span> <span class="o">=</span> <span class="n">environment</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">&quot;LOGNAME&quot;</span><span class="o">))</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
        <span class="k">if</span> <span class="o">((</span><span class="n">user</span> <span class="o">=</span> <span class="n">getLogin</span><span class="o">())</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
            <span class="k">if</span> <span class="o">((</span><span class="n">user</span> <span class="o">=</span> <span class="n">getPWUID</span><span class="o">(</span><span class="n">UID</span><span class="o">)[</span><span class="mi">0</span><span class="o">])</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
                <span class="n">user</span> <span class="o">=</span> <span class="s">&quot;Unknown uid number &quot;</span> <span class="o">+</span> <span class="n">UID</span><span class="o">;</span>

<span class="cm">/**</span>
<span class="cm"> * Returns current environment.</span>
<span class="cm"> */</span>
<span class="n">Properties</span> <span class="nf">getEnvironment</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">Properties</span> <span class="n">environment</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Properties</span><span class="o">();</span>
    <span class="k">try</span> <span class="o">{</span>
	<span class="n">Process</span> <span class="n">process</span> <span class="o">=</span> <span class="n">Runtime</span><span class="o">.</span><span class="na">getRuntime</span><span class="o">().</span><span class="na">exec</span><span class="o">(</span><span class="s">&quot;env&quot;</span><span class="o">);</span>
	<span class="n">BufferedReader</span> <span class="n">input</span> <span class="o">=</span>
	    <span class="k">new</span> <span class="nf">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">InputStreamReader</span><span class="o">(</span><span class="n">process</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">()));</span>
	<span class="n">String</span> <span class="n">line</span><span class="o">;</span>
	<span class="k">while</span> <span class="o">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">input</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
	    <span class="kt">int</span> <span class="n">limit</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="sc">&#39;=&#39;</span><span class="o">);</span>
	    <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">limit</span><span class="o">);</span>
	    <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">limit</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
	    <span class="n">environment</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
	<span class="o">}</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Error occured while processing environment&quot;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">environment</span><span class="o">;</span>
<span class="o">}</span>

<span class="cm">/**</span>
<span class="cm"> * Returns current login.</span>
<span class="cm"> */</span>
<span class="n">String</span> <span class="nf">getLogin</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">login</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
    <span class="k">try</span> <span class="o">{</span>
	<span class="n">Process</span> <span class="n">process</span> <span class="o">=</span> <span class="n">Runtime</span><span class="o">.</span><span class="na">getRuntime</span><span class="o">().</span><span class="na">exec</span><span class="o">(</span><span class="s">&quot;cat /etc/utmp&quot;</span><span class="o">);</span>
	<span class="n">BufferedReader</span> <span class="n">input</span> <span class="o">=</span> 
	    <span class="k">new</span> <span class="nf">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">InputStreamReader</span><span class="o">(</span><span class="n">process</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">()));</span>
	<span class="n">login</span> <span class="o">=</span> <span class="n">input</span><span class="o">.</span><span class="na">readLine</span><span class="o">();</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Error occured while processing login&quot;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">login</span><span class="o">;</span>
<span class="o">}</span>

<span class="cm">/**</span>
<span class="cm"> * Returns current UID.</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="nf">getUID</span><span class="o">()</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">uid</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="k">try</span> <span class="o">{</span>
	<span class="n">Process</span> <span class="n">process</span> <span class="o">=</span> <span class="n">Runtime</span><span class="o">.</span><span class="na">getRuntime</span><span class="o">().</span><span class="na">exec</span><span class="o">(</span><span class="s">&quot;id -u&quot;</span><span class="o">);</span>
	<span class="n">BufferedReader</span> <span class="n">input</span> <span class="o">=</span>
	    <span class="k">new</span> <span class="nf">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">InputStreamReader</span><span class="o">(</span><span class="n">process</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">()));</span>
	<span class="n">uid</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Integer</span><span class="o">(</span><span class="n">input</span><span class="o">.</span><span class="na">readLine</span><span class="o">()).</span><span class="na">intValue</span><span class="o">();</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Error occured while processing login&quot;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">uid</span><span class="o">;</span>
<span class="o">}</span>

<span class="cm">/**</span>
<span class="cm"> * Returns /etc/passwd line relative to given UID.</span>
<span class="cm"> */</span>
<span class="n">String</span><span class="o">[]</span> <span class="nf">getPWUID</span><span class="o">(</span><span class="kt">int</span> <span class="n">uid</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">ArrayList</span> <span class="n">pwuid</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>
    <span class="k">try</span> <span class="o">{</span>
	<span class="n">Process</span> <span class="n">process</span> <span class="o">=</span>
	    <span class="n">Runtime</span><span class="o">.</span><span class="na">getRuntime</span><span class="o">().</span><span class="na">exec</span><span class="o">(</span><span class="s">&quot;grep ^[^:]*:[^:]*:&quot;</span> <span class="o">+</span> <span class="n">uid</span> <span class="o">+</span> <span class="s">&quot; /etc/passwd&quot;</span><span class="o">);</span>
	<span class="n">BufferedReader</span> <span class="n">input</span> <span class="o">=</span>
	    <span class="k">new</span> <span class="nf">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">InputStreamReader</span><span class="o">(</span><span class="n">process</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">()));</span>
	<span class="n">StringTokenizer</span> <span class="n">tokenizer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringTokenizer</span><span class="o">(</span><span class="n">input</span><span class="o">.</span><span class="na">readLine</span><span class="o">(),</span> <span class="s">&quot;:&quot;</span><span class="o">);</span>
	<span class="k">while</span> <span class="o">(</span><span class="n">tokenizer</span><span class="o">.</span><span class="na">hasMoreTokens</span><span class="o">())</span>
	    <span class="n">pwuid</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">tokenizer</span><span class="o">.</span><span class="na">nextToken</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Error occured while processing login&quot;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="o">(</span><span class="n">String</span><span class="o">[])</span> <span class="n">pwuid</span><span class="o">.</span><span class="na">toArray</span><span class="o">(</span><span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="n">pwuid</span><span class="o">.</span><span class="na">size</span><span class="o">()]);</span>
<span class="o">}</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// test for nullity then for emptyness</span>
<span class="k">if</span> <span class="o">((</span><span class="n">startingPoint</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">||</span> <span class="o">(</span><span class="n">startingPoint</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">==</span> <span class="mi">0</span><span class="o">))</span>
    <span class="n">startingPoint</span> <span class="o">=</span> <span class="s">&quot;Greenwich&quot;</span><span class="o">;</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">Object</span><span class="o">[]</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">;</span>

<span class="c1">// copy only if empty</span>
<span class="c1">// test for nullity then for emptyness</span>
<span class="k">if</span> <span class="o">((</span><span class="n">a</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">||</span> <span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">length</span> <span class="o">==</span> <span class="mi">0</span><span class="o">))</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">b</span><span class="o">;</span>

<span class="c1">// assign b if nonempty, else c</span>
<span class="c1">// test for nullity then for emptyness</span>
<span class="n">a</span> <span class="o">=</span> <span class="o">((</span><span class="n">b</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">b</span><span class="o">.</span><span class="na">length</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">))</span> <span class="o">?</span> <span class="n">b</span> <span class="o">:</span> <span class="n">c</span><span class="o">;</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN23"
>Exchanging Values Without Using Temporary Variables</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// Not possible in Java</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN26"
>Converting Between ASCII Characters and Values</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// char and int are interchangables, apart precision difference</span>
<span class="c1">// char use 16 bits while int use 32, requiring a cast from int to char</span>
<span class="kt">int</span> <span class="n">num</span><span class="o">;</span>
<span class="kt">char</span> <span class="n">ch</span><span class="o">;</span>
<span class="n">num</span> <span class="o">=</span> <span class="n">ch</span><span class="o">;</span>        <span class="c1">// no problem </span>
<span class="n">ch</span> <span class="o">=</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="n">num</span><span class="o">;</span> <span class="c1">// needs an explicit cast</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Number &quot;</span> <span class="o">+</span> <span class="n">num</span> <span class="o">+</span> <span class="s">&quot; is character &quot;</span> <span class="o">+</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="n">num</span><span class="o">);</span>
<span class="c1">// Number 101 is character e</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Character &quot;</span> <span class="o">+</span> <span class="n">ch</span> <span class="o">+</span> <span class="s">&quot; is number &quot;</span> <span class="o">+</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">ch</span><span class="o">);</span>
<span class="c1">// Character e is number 101</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="kt">char</span><span class="o">[]</span> <span class="n">ascii</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">();</span>
<span class="n">String</span> <span class="n">string</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">ascii</span><span class="o">);</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="kt">int</span> <span class="n">value</span>      <span class="o">=</span> <span class="sc">&#39;e&#39;</span><span class="o">;</span> <span class="c1">// now 101</span>
<span class="kt">char</span> <span class="n">character</span> <span class="o">=</span> <span class="mi">101</span><span class="o">;</span> <span class="c1">// now &quot;e&quot;</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Number &quot;</span> <span class="o">+</span> <span class="mi">101</span> <span class="o">+</span> <span class="s">&quot; is character &quot;</span> <span class="o">+</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="mi">101</span><span class="o">);</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="kt">char</span><span class="o">[]</span> <span class="n">ascii</span> <span class="o">=</span> <span class="s">&quot;sample&quot;</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">();</span>
<span class="c1">// {115, 97, 109, 112, 108, 101}</span>
<span class="n">String</span> <span class="n">s1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">ascii</span><span class="o">);</span>
<span class="c1">// &quot;sample&quot;</span>
<span class="n">String</span> <span class="n">s2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="k">new</span> <span class="kt">char</span><span class="o">[]</span> <span class="o">{</span><span class="mi">115</span><span class="o">,</span> <span class="mi">97</span><span class="o">,</span> <span class="mi">109</span><span class="o">,</span> <span class="mi">112</span><span class="o">,</span> <span class="mi">108</span><span class="o">,</span> <span class="mi">101</span><span class="o">});</span>
<span class="c1">// &quot;sample&quot;</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">String</span> <span class="n">hal</span> <span class="o">=</span> <span class="s">&quot;HAL&quot;</span><span class="o">;</span>
<span class="kt">char</span><span class="o">[]</span> <span class="n">ascii</span> <span class="o">=</span> <span class="n">hal</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">();</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">ascii</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
    <span class="n">ascii</span><span class="o">[</span><span class="n">i</span><span class="o">]++;</span>                 <span class="c1">// add one to each ASCII value</span>
<span class="n">String</span> <span class="n">ibm</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">ascii</span><span class="o">);</span> <span class="c1">// IBM</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN29"
>Processing a String One Character at a Time</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// You can process a string either by character or by string element:</span>
<span class="c1">// using character is more efficient, as they are values</span>
<span class="c1">// using string allow to use object-based methods, as collections </span>

<span class="c1">// splitting a string into elementary characters</span>
<span class="kt">char</span><span class="o">[]</span> <span class="n">charArray</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">();</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="na">length</span><span class="o">();</span>
<span class="c1">// processing a string by elementary strings</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">size</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">s</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
    <span class="c1">// do something with s</span>
<span class="o">}</span>
<span class="c1">// processing a string by elementary characters</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">size</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="kt">char</span> <span class="n">ch</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
    <span class="c1">// do something with s</span>
<span class="o">}</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// with an array, using chars</span>
<span class="n">String</span> <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;an apple a day&quot;</span><span class="o">;</span>
<span class="kt">boolean</span><span class="o">[]</span> <span class="n">seen</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">boolean</span><span class="o">[</span><span class="mi">256</span><span class="o">];</span>
<span class="n">Arrays</span><span class="o">.</span><span class="na">fill</span><span class="o">(</span><span class="n">seen</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>

<span class="kt">char</span><span class="o">[]</span> <span class="n">array</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">();</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">array</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
    <span class="n">seen</span><span class="o">[</span><span class="n">array</span><span class="o">[</span><span class="n">i</span><span class="o">]]</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>

<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">&quot;unique chars are: &quot;</span><span class="o">);</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">seen</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">seen</span><span class="o">[</span><span class="n">i</span><span class="o">])</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">((</span><span class="kt">char</span><span class="o">)</span> <span class="n">i</span><span class="o">);</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span> 

<span class="c1">//=&gt; unique chars are:  adelnpy</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// with a loop, using strings</span>
<span class="n">String</span> <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;an apple a day&quot;</span><span class="o">;</span>
<span class="n">TreeSet</span> <span class="n">seen</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TreeSet</span><span class="o">();</span>

<span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="na">length</span><span class="o">();</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">size</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
    <span class="n">seen</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">string</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">));</span>

<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">&quot;unique chars are: &quot;</span><span class="o">);</span>
<span class="n">Iterator</span> <span class="n">it</span> <span class="o">=</span> <span class="n">seen</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
<span class="k">while</span> <span class="o">(</span><span class="n">it</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>

<span class="c1">//=&gt; unique chars are:  adelnpy</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
<span class="kt">char</span><span class="o">[]</span> <span class="n">chars</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">();</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">chars</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
    <span class="n">sum</span> <span class="o">+=</span> <span class="n">chars</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;sum is &quot;</span> <span class="o">+</span> <span class="n">sum</span><span class="o">);</span>

<span class="c1">// prints &quot;1248&quot; if string was &quot;an apple a day&quot;</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="cm">/*</span>
<span class="cm"> * Sum.java</span>
<span class="cm"> */</span>
<span class="kn">package</span> <span class="n">pleac</span><span class="o">.</span><span class="na">ch01</span><span class="o">.</span><span class="na">part05</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
<span class="cm">/**</span>
<span class="cm"> * Compute 16-bit checksum of input file</span>
<span class="cm"> * Usage: java pleac.ch01.part05.Sum &lt;file&gt;</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Sum</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[])</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">args</span><span class="o">.</span><span class="na">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Usage: java pleac.ch01.part05.Sum &lt;file&gt;&quot;</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span>
        
        <span class="kt">int</span> <span class="n">checksum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">Reader</span> <span class="n">input</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
            <span class="kt">int</span> <span class="n">ch</span><span class="o">;</span>
            <span class="k">while</span> <span class="o">((</span><span class="n">ch</span> <span class="o">=</span> <span class="n">input</span><span class="o">.</span><span class="na">read</span><span class="o">())</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span>
                <span class="n">checksum</span> <span class="o">+=</span> <span class="n">ch</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Exception occured: &quot;</span> <span class="o">+</span> <span class="n">ex</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">checksum</span> <span class="o">%=</span> <span class="o">(</span><span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Math</span><span class="o">.</span><span class="na">pow</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">16</span><span class="o">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span> 

        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">checksum</span><span class="o">);</span>
    <span class="o">}</span>
    
<span class="o">}</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">//=&gt; % java Sum /etc/termcap</span>
<span class="c1">//=&gt; 53651</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">//=&gt; % sum --sysv /etc/termcap</span>
<span class="c1">//=&gt; 53651 1373 /etc/termcap</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="cm">/*</span>
<span class="cm"> * Slowcat.java</span>
<span class="cm"> */</span>
<span class="kn">package</span> <span class="n">pleac</span><span class="o">.</span><span class="na">ch01</span><span class="o">.</span><span class="na">part05</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
<span class="cm">/**</span>
<span class="cm"> * Emulate a  s l o w line printer</span>
<span class="cm"> * Usage: java pleac.ch01.part05.Slowcat &lt;file&gt;</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Slowcat</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[])</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">args</span><span class="o">.</span><span class="na">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Usage: java pleac.ch01.part05.Slowcat &lt;file&gt; [delay]&quot;</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="kt">long</span> <span class="n">delay</span> <span class="o">=</span> <span class="o">((</span><span class="n">args</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">))</span> <span class="o">?</span>
	    <span class="mi">1000</span> <span class="o">*</span> <span class="k">new</span> <span class="n">Long</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">1</span><span class="o">]).</span><span class="na">longValue</span><span class="o">()</span> <span class="o">:</span> <span class="mi">1000</span><span class="o">;</span>
        
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">Reader</span> <span class="n">input</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
            <span class="kt">int</span> <span class="n">ch</span><span class="o">;</span>
            <span class="k">while</span> <span class="o">((</span><span class="n">ch</span> <span class="o">=</span> <span class="n">input</span><span class="o">.</span><span class="na">read</span><span class="o">())</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">((</span><span class="kt">char</span><span class="o">)</span> <span class="n">ch</span><span class="o">);</span>
                <span class="k">try</span> <span class="o">{</span>
                <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">delay</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{}</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Exception occured: &quot;</span> <span class="o">+</span> <span class="n">ex</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
<span class="o">}</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN32"
>Reversing a String by Word or Character</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">String</span> <span class="nf">reverseCharacters</span><span class="o">(</span><span class="n">String</span> <span class="n">string</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="na">length</span><span class="o">();</span>
    <span class="kt">char</span><span class="o">[]</span> <span class="n">chars</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">();</span>
    <span class="kt">char</span><span class="o">[]</span> <span class="n">revChars</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="o">[</span><span class="n">length</span><span class="o">];</span>
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
	<span class="n">revChars</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">chars</span><span class="o">[</span><span class="n">length</span> <span class="o">-</span> <span class="n">i</span><span class="o">];</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">String</span><span class="o">(</span><span class="n">revChars</span><span class="o">);</span>
<span class="o">}</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">String</span> <span class="nf">reverseWords</span><span class="o">(</span><span class="n">String</span> <span class="n">string</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">StringTokenizer</span> <span class="n">tokenizer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringTokenizer</span><span class="o">(</span><span class="n">string</span><span class="o">,</span> <span class="s">&quot; &quot;</span><span class="o">);</span>
    <span class="n">StringBuffer</span> <span class="n">buffer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="o">();</span>
    <span class="k">while</span> <span class="o">(</span><span class="n">tokenizer</span><span class="o">.</span><span class="na">hasMoreTokens</span><span class="o">())</span>
	<span class="n">buffer</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">tokenizer</span><span class="o">.</span><span class="na">nextToken</span><span class="o">()</span> <span class="o">+</span> <span class="s">&quot; &quot;</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">buffer</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
<span class="o">}</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">String</span> <span class="n">string</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">Yoda</span> <span class="n">said</span><span class="o">,</span> <span class="s">&quot;can you see this?&quot;</span><span class="err">&#39;</span><span class="o">;</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">reverseWords</span><span class="o">(</span><span class="n">string</span><span class="o">));</span>

<span class="k">this</span><span class="o">?</span><span class="s">&quot; see you &quot;</span><span class="n">can</span> <span class="n">said</span><span class="o">,</span> <span class="n">Yoda</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// normalize whitespace</span>
<span class="n">StringTokenizer</span> <span class="n">tokenizer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringTokenizer</span><span class="o">(</span><span class="n">string</span><span class="o">,</span> <span class="s">&quot; &quot;</span><span class="o">);</span>
<span class="n">StringBuffer</span> <span class="n">buffer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="o">();</span>
<span class="k">while</span> <span class="o">(</span><span class="n">tokenizer</span><span class="o">.</span><span class="na">hasMoreTokens</span><span class="o">())</span>
    <span class="n">buffer</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">tokenizer</span><span class="o">.</span><span class="na">nextToken</span><span class="o">()</span> <span class="o">+</span> <span class="s">&quot; &quot;</span><span class="o">);</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// preserve whitespace</span>
<span class="n">StringTokenizer</span> <span class="n">tokenizer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringTokenizer</span><span class="o">(</span><span class="n">string</span><span class="o">,</span> <span class="s">&quot; &quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
<span class="n">StringBuffer</span> <span class="n">buffer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="o">();</span>
<span class="k">while</span> <span class="o">(</span><span class="n">tokenizer</span><span class="o">.</span><span class="na">hasMoreTokens</span><span class="o">())</span>
    <span class="n">buffer</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">tokenizer</span><span class="o">.</span><span class="na">nextToken</span><span class="o">());</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">String</span> <span class="n">word</span> <span class="o">=</span> <span class="s">&quot;reviver&quot;</span><span class="o">;</span>
<span class="kt">boolean</span> <span class="n">isPalindrome</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">reverseCharacters</span><span class="o">(</span><span class="n">word</span><span class="o">));</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">String</span> <span class="n">file</span> <span class="o">=</span> <span class="s">&quot;/usr/share/dict/words&quot;</span><span class="o">;</span>
<span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">5</span><span class="o">;</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">BufferedReader</span> <span class="n">input</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="n">file</span><span class="o">));</span>
    <span class="n">String</span> <span class="n">word</span><span class="o">;</span>
    <span class="k">while</span> <span class="o">((</span><span class="n">word</span> <span class="o">=</span> <span class="n">input</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
	<span class="k">if</span> <span class="o">((</span><span class="n">word</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;</span> <span class="n">length</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">word</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">reverseCharacters</span><span class="o">(</span><span class="n">word</span><span class="o">))))</span>
	    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">word</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Exception occured: &quot;</span> <span class="o">+</span> <span class="n">ex</span><span class="o">);</span>
<span class="o">}</span>
<span class="c1">//=&gt; redder</span>
<span class="c1">//=&gt; reviver</span>
<span class="c1">//=&gt; rotator</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN35"
>Expanding and Compressing Tabs</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">String</span> <span class="nf">expand</span><span class="o">(</span><span class="n">String</span> <span class="n">string</span><span class="o">,</span> <span class="kt">int</span> <span class="n">tabStop</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="sc">&#39;\t&#39;</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">index</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span>
        <span class="k">return</span> <span class="n">string</span><span class="o">;</span>
    <span class="k">else</span> <span class="o">{</span>
	<span class="n">StringBuffer</span> <span class="n">buffer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="o">(</span><span class="n">string</span><span class="o">);</span>
	<span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="n">tabStop</span> <span class="o">-</span> <span class="n">index</span> <span class="o">%</span> <span class="n">tabStop</span><span class="o">;</span>
	<span class="n">buffer</span><span class="o">.</span><span class="na">deleteCharAt</span><span class="o">(</span><span class="n">index</span><span class="o">);</span>
	<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">count</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
	    <span class="n">buffer</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="n">index</span><span class="o">,</span> <span class="s">&quot; &quot;</span><span class="o">);</span>
	<span class="k">return</span> <span class="nf">expand</span><span class="o">(</span><span class="n">buffer</span><span class="o">.</span><span class="na">toString</span><span class="o">(),</span> <span class="n">tabStop</span><span class="o">);</span>	
    <span class="o">}</span>
<span class="o">}</span>

<span class="n">String</span> <span class="nf">unexpand</span><span class="o">(</span><span class="n">String</span> <span class="n">string</span><span class="o">,</span> <span class="kt">int</span> <span class="n">tabStop</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">StringBuffer</span> <span class="n">buffer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="o">(</span><span class="n">string</span><span class="o">);</span>
    <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="k">while</span> <span class="o">(</span><span class="n">index</span> <span class="o">+</span> <span class="n">tabStop</span> <span class="o">&lt;</span> <span class="n">buffer</span><span class="o">.</span><span class="na">length</span><span class="o">())</span> <span class="o">{</span>
	<span class="c1">// cut original string in tabstop-length pieces</span>
	<span class="n">String</span> <span class="n">piece</span> <span class="o">=</span> <span class="n">buffer</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">index</span><span class="o">,</span> <span class="n">index</span> <span class="o">+</span> <span class="n">tabStop</span><span class="o">);</span>
	<span class="c1">// count trailing whitespace characters</span>
	<span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
	<span class="k">while</span> <span class="o">((</span><span class="n">count</span> <span class="o">&lt;</span> <span class="n">tabStop</span><span class="o">)</span>
	    <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">Character</span><span class="o">.</span><span class="na">isWhitespace</span><span class="o">(</span><span class="n">piece</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">tabStop</span> <span class="o">-</span> <span class="o">(</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)))))</span>
	    <span class="n">count</span><span class="o">++;</span>
	<span class="c1">// replace in original string if any whitespace was found</span>
	<span class="k">if</span> <span class="o">(</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
	    <span class="n">piece</span> <span class="o">=</span> <span class="n">piece</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">tabStop</span> <span class="o">-</span> <span class="n">count</span><span class="o">)</span> <span class="o">+</span> <span class="sc">&#39;\t&#39;</span><span class="o">;</span>
	    <span class="n">buffer</span><span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="n">index</span><span class="o">,</span> <span class="n">index</span> <span class="o">+</span> <span class="n">tabStop</span><span class="o">,</span> <span class="n">piece</span><span class="o">);</span>
	    <span class="n">index</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="n">tabStop</span> <span class="o">-</span> <span class="o">(</span><span class="n">count</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
	<span class="o">}</span> <span class="k">else</span> 
	    <span class="n">index</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="n">tabStop</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">buffer</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
<span class="o">}</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">BufferedReader</span> <span class="n">input</span><span class="o">;</span>
<span class="n">String</span> <span class="n">line</span><span class="o">;</span>
<span class="c1">// [..]</span>
<span class="k">while</span> <span class="o">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">input</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">expand</span><span class="o">(</span><span class="n">line</span><span class="o">),</span> <span class="mi">4</span><span class="o">);</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">BufferedReader</span> <span class="n">input</span><span class="o">;</span>
<span class="n">String</span> <span class="n">line</span><span class="o">;</span>
<span class="c1">// [..]</span>
<span class="k">while</span> <span class="o">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">input</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">unexpand</span><span class="o">(</span><span class="n">line</span><span class="o">),</span> <span class="mi">8</span><span class="o">);</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN38"
>Expanding Variables in User Input</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// No interpolation in Java</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN41"
>Controlling Case</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">String</span> <span class="n">big</span> <span class="o">=</span> <span class="n">little</span><span class="o">.</span><span class="na">toUpperCase</span><span class="o">();</span> <span class="c1">// &quot;bo peep&quot; -&gt; &quot;BO PEEP&quot;</span>
<span class="n">String</span> <span class="n">little</span> <span class="o">=</span> <span class="n">big</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">();</span> <span class="c1">// &quot;JOHN&quot;    -&gt; &quot;john&quot;</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">String</span> <span class="n">big</span> <span class="o">=</span> <span class="n">little</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">).</span><span class="na">toUpperCase</span><span class="o">()</span> <span class="o">+</span> <span class="n">little</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="c1">// &quot;bo&quot;      -&gt; &quot;Bo&quot;</span>
<span class="n">String</span> <span class="n">little</span> <span class="o">=</span> <span class="n">big</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">).</span><span class="na">toLowerCase</span><span class="o">()</span> <span class="o">+</span> <span class="n">big</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="c1">// &quot;BoPeep&quot; -&gt; &quot;boPeep&quot;</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">String</span> <span class="n">beast</span>   <span class="o">=</span> <span class="s">&quot;dromedary&quot;</span><span class="o">;</span>
<span class="c1">// capitalize various parts of beast</span>
<span class="n">String</span> <span class="n">capit1</span>   <span class="o">=</span> <span class="n">beast</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">).</span><span class="na">toUpperCase</span><span class="o">()</span>
    <span class="o">+</span> <span class="n">beast</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">toLowerCase</span><span class="o">();</span>
<span class="c1">// Dromedary</span>
<span class="n">String</span> <span class="n">capit2</span>   <span class="o">=</span> <span class="n">Character</span><span class="o">.</span><span class="na">toUpperCase</span><span class="o">(</span><span class="n">beast</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">0</span><span class="o">))</span>
    <span class="o">+</span> <span class="n">beast</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">toLowerCase</span><span class="o">();</span>
<span class="c1">// Dromedary</span>
<span class="n">String</span> <span class="n">capall</span>   <span class="o">=</span> <span class="n">beast</span><span class="o">.</span><span class="na">toUpperCase</span><span class="o">();</span>
<span class="c1">// DROMEDARY</span>
<span class="n">String</span> <span class="n">caprest1</span> <span class="o">=</span> <span class="n">beast</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">).</span><span class="na">toLowerCase</span><span class="o">()</span>
    <span class="o">+</span> <span class="n">beast</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">toUpperCase</span><span class="o">();</span>
<span class="c1">// dROMEDARY</span>
<span class="n">String</span> <span class="n">caprest2</span> <span class="o">=</span> <span class="n">Character</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">(</span><span class="n">beast</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">0</span><span class="o">))</span>
    <span class="o">+</span> <span class="n">beast</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">toUpperCase</span><span class="o">();</span>
<span class="c1">// dROMEDARY</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// capitalize each word&#39;s first character, downcase the rest</span>
<span class="n">String</span> <span class="n">text</span> <span class="o">=</span> <span class="s">&quot;thIS is a loNG liNE&quot;</span><span class="o">;</span>
<span class="n">StringTokenizer</span> <span class="n">tokenizer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringTokenizer</span><span class="o">(</span><span class="n">text</span><span class="o">);</span>
<span class="k">while</span> <span class="o">(</span><span class="n">tokenizer</span><span class="o">.</span><span class="na">hasMoreTokens</span><span class="o">())</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">word</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="na">nextToken</span><span class="o">();</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">word</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">).</span><span class="na">toUpperCase</span><span class="o">()</span> 
                   <span class="o">+</span> <span class="n">word</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">toLowerCase</span><span class="o">()</span>
		   <span class="o">+</span> <span class="s">&quot; &quot;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="c1">//=&gt; This Is A Long Line</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">String</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">;</span>
<span class="k">if</span> <span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="n">b</span><span class="o">))</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;a and b are the same&quot;</span><span class="o">);</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="kd">private</span> <span class="n">Random</span> <span class="n">rand</span><span class="o">;</span>
<span class="kt">char</span> <span class="nf">randomCase</span><span class="o">(</span><span class="kt">char</span> <span class="n">ch</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="o">(</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">100</span><span class="o">)</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="o">)</span> <span class="o">?</span> <span class="n">Character</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">(</span><span class="n">ch</span><span class="o">):</span> <span class="n">ch</span><span class="o">;</span>
<span class="o">}</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN44"
>Interpolating Functions and Expressions Within Strings</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// No interpolation in Java</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN47"
>Indenting Here Documents</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// No here-document in Java</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN50"
>Reformatting Paragraphs</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="kn">import</span> <span class="nn">java.text.BreakIterator</span><span class="o">();</span>
<span class="n">BreakIterator</span> <span class="n">boundary</span> <span class="o">=</span> <span class="n">BreakIterator</span><span class="o">.</span><span class="na">getLineInstance</span><span class="o">();</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="cm">/**</span>
<span class="cm"> * WrapDemo.java</span>
<span class="cm"> */</span>
<span class="kn">package</span> <span class="n">pleac</span><span class="o">.</span><span class="na">ch01</span><span class="o">.</span><span class="na">part12</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.text.BreakIterator</span><span class="o">;</span>
<span class="cm">/**</span>
<span class="cm"> * Show how BreakIterator works</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WrapDemo</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="n">BreakIterator</span> <span class="n">iterator</span> <span class="o">=</span> <span class="n">BreakIterator</span><span class="o">.</span><span class="na">getLineInstance</span><span class="o">();</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">input</span> <span class="o">=</span> <span class="s">&quot;Folding and splicing is the work of an editor,&quot;</span>
                 <span class="o">+</span> <span class="s">&quot; not a mere collection of silicon&quot;</span>
                 <span class="o">+</span> <span class="s">&quot; and&quot;</span>
                 <span class="o">+</span> <span class="s">&quot; mobile electrons!&quot;</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">column</span> <span class="o">=</span> <span class="mi">20</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">leadTab</span> <span class="o">=</span> <span class="s">&quot;    &quot;</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">nextTab</span> <span class="o">=</span> <span class="s">&quot;  &quot;</span><span class="o">;</span>

        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;01234567890123456789&quot;</span><span class="o">);</span>
        <span class="n">input</span> <span class="o">=</span> <span class="n">wrapLine</span><span class="o">(</span><span class="n">leadTab</span> <span class="o">+</span> <span class="n">input</span><span class="o">,</span> <span class="n">column</span><span class="o">);</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">input</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
            <span class="n">input</span> <span class="o">=</span> <span class="n">wrapLine</span><span class="o">(</span><span class="n">nextTab</span> <span class="o">+</span> <span class="n">input</span><span class="o">,</span> <span class="n">column</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">wrapLine</span><span class="o">(</span><span class="n">String</span> <span class="n">line</span><span class="o">,</span> <span class="kt">int</span> <span class="n">width</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">iterator</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">line</span><span class="o">);</span>
        <span class="kt">int</span> <span class="n">end</span> <span class="o">=</span> <span class="n">iterator</span><span class="o">.</span><span class="na">first</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">((</span><span class="n">end</span> <span class="o">!=</span> <span class="n">BreakIterator</span><span class="o">.</span><span class="na">DONE</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">end</span> <span class="o">&lt;=</span> <span class="n">width</span><span class="o">))</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">iterator</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">end</span> <span class="o">==</span> <span class="n">BreakIterator</span><span class="o">.</span><span class="na">DONE</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">line</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">iterator</span><span class="o">.</span><span class="na">previous</span><span class="o">();</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">line</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">end</span><span class="o">));</span>
            <span class="k">return</span> <span class="n">line</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">end</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN53"
>Escaping Characters</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">Perl5Util</span> <span class="n">util</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Perl5Util</span><span class="o">();</span>
<span class="c1">// backslash</span>
<span class="n">var</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="na">substitute</span><span class="o">(</span><span class="s">&quot;s/([CHARLIST])/\\\\$1/g&quot;</span><span class="o">,</span> <span class="n">var</span><span class="o">);</span>

<span class="c1">// double</span>
<span class="n">var</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="na">substitute</span><span class="o">(</span><span class="s">&quot;s/([CHARLIST])/$1$1/g&quot;</span><span class="o">,</span> <span class="n">var</span><span class="o">);</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">string</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="na">substitute</span><span class="o">(</span><span class="s">&quot;s/%/%%/g&quot;</span><span class="o">,</span> <span class="n">string</span><span class="o">);</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">string</span> <span class="o">=</span> <span class="s">&quot;Mom said, \&quot;Don&#39;t do that.\&quot;&quot;</span><span class="o">;</span>
<span class="n">string</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="na">substitute</span><span class="o">(</span><span class="s">&quot;s/([&#39;\&quot;])/\\\\$1/g&quot;</span><span class="o">,</span> <span class="n">string</span><span class="o">);</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">string</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="na">substitute</span><span class="o">(</span><span class="s">&quot;s/([^A-Z])/\\\\$1/g&quot;</span><span class="o">,</span> <span class="n">string</span><span class="o">);</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN56"
>Trimming Blanks from the Ends of a String</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="na">trim</span><span class="o">();</span>
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// print what&#39;s typed, but surrounded by &gt;&lt; symbols</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">BufferedReader</span> <span class="n">input</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">InputStreamReader</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">in</span><span class="o">));</span>
    <span class="n">String</span> <span class="n">line</span><span class="o">;</span>
    <span class="k">while</span><span class="o">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">input</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="na">trim</span><span class="o">();</span>
	<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;&gt;&quot;</span> <span class="o">+</span> <span class="n">line</span> <span class="o">+</span> <span class="s">&quot;&lt;&quot;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Exception occured: &quot;</span> <span class="o">+</span> <span class="n">ex</span><span class="o">);</span>
<span class="o">}</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN59"
>Parsing Comma-Separated Data</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">PATTERN</span> <span class="o">=</span>
    <span class="s">&quot;m/\&quot;([^\\\&quot;\\\\]*(?:\\\\.[^\\\&quot;\\\\]*)*)\&quot;,? | ([^,]+),? | ,/x&quot;</span><span class="o">;</span>
<span class="n">Perl5Util</span> <span class="n">util</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Perl5Util</span><span class="o">();</span>

<span class="n">Iterator</span> <span class="nf">parseCSV</span><span class="o">(</span><span class="n">String</span> <span class="n">text</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">ArrayList</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>
    <span class="k">while</span> <span class="o">(</span><span class="n">util</span><span class="o">.</span><span class="na">match</span><span class="o">(</span><span class="n">PATTERN</span><span class="o">,</span> <span class="n">text</span><span class="o">))</span> <span class="o">{</span>
	<span class="c1">// find which group matched</span>
	<span class="k">if</span> <span class="o">(</span><span class="n">util</span><span class="o">.</span><span class="na">group</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
	    <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">util</span><span class="o">.</span><span class="na">group</span><span class="o">(</span><span class="mi">1</span><span class="o">));</span>
	<span class="k">else</span> <span class="nf">if</span> <span class="o">(</span><span class="n">util</span><span class="o">.</span><span class="na">group</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
	    <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">util</span><span class="o">.</span><span class="na">group</span><span class="o">(</span><span class="mi">2</span><span class="o">));</span>
	<span class="k">else</span>
	    <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
	<span class="c1">// loop on post-match string</span>
	<span class="n">text</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="na">postMatch</span><span class="o">();</span>
       <span class="o">};</span>
       <span class="k">return</span> <span class="n">list</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
<span class="o">}</span>  
<span class="c1">//----------------------------------------------------------------------------------</span>
<span class="n">String</span> <span class="n">line</span> <span class="o">=</span> 
    <span class="s">&quot;XYZZY,\&quot;\&quot;,\&quot;O&#39;Reilly, Inc\&quot;,\&quot;Wall, Larry\&quot;,\&quot;a \\\&quot;glug\\\&quot; bit,\&quot;,5,\&quot;Error, Core Dumped\&quot;&quot;</span><span class="o">;</span>
<span class="n">Iterator</span> <span class="n">it</span> <span class="o">=</span> <span class="n">parseCSV</span><span class="o">(</span><span class="n">line</span><span class="o">);</span>
<span class="k">while</span> <span class="o">(</span><span class="n">it</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">count</span><span class="o">++</span> <span class="o">+</span> <span class="s">&quot; : &quot;</span> <span class="o">+</span> <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>

<span class="c1">//=&gt; 0 : XYZZY</span>
<span class="c1">//=&gt; 1 :</span>
<span class="c1">//=&gt; 2 : O&#39;Reilly, Inc</span>
<span class="c1">//=&gt; 3 : Wall, Larry</span>
<span class="c1">//=&gt; 4 : a \&quot;glug\&quot; bit,</span>
<span class="c1">//=&gt; 5 : 5</span>
<span class="c1">//=&gt; 6 : Error, Core Dumped</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN62"
>Soundex Matching</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// Sorry, no java soundex implementation found </span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN65"
>Program: fixstyle</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="cm">/*</span>
<span class="cm"> * FixStyle.java</span>
<span class="cm"> */</span>
<span class="kn">package</span> <span class="n">pleac</span><span class="o">.</span><span class="na">ch01</span><span class="o">.</span><span class="na">part17</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="cm">/**</span>
<span class="cm"> * Switch first set of strings from to second set according to STYLE_FILE</span>
<span class="cm"> * Usage: see derived classes</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">FixStyle</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">STYLE_FILE</span> <span class="o">=</span> <span class="s">&quot;pleac/ch01/part17/style&quot;</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">BACKUP_SUFFIX</span> <span class="o">=</span> <span class="s">&quot;.orig&quot;</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">VERBOSE_FLAG</span> <span class="o">=</span> <span class="s">&quot;-v&quot;</span><span class="o">;</span>

    <span class="n">Properties</span> <span class="n">changes</span><span class="o">;</span>

    <span class="n">FixStyle</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">changes</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Properties</span><span class="o">();</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">InputStream</span> <span class="n">input</span> <span class="o">=</span>
		<span class="n">getClass</span><span class="o">().</span><span class="na">getClassLoader</span><span class="o">().</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">STYLE_FILE</span><span class="o">);</span>
            <span class="n">changes</span><span class="o">.</span><span class="na">load</span><span class="o">(</span><span class="n">input</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Style loading failed: &quot;</span> <span class="o">+</span> <span class="n">ex</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kt">void</span> <span class="nf">fix</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">args</span><span class="o">.</span><span class="na">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;usage: java &quot;</span> <span class="o">+</span> <span class="n">getClass</span><span class="o">().</span><span class="na">getName</span><span class="o">()</span>
		<span class="o">+</span> <span class="s">&quot; &lt;file&gt; [-v]&quot;</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">String</span> <span class="n">file</span> <span class="o">=</span> <span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
        <span class="kt">boolean</span> <span class="n">verbose</span> <span class="o">=</span> <span class="o">((</span><span class="n">args</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
	    <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">1</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="n">VERBOSE_FLAG</span><span class="o">)))</span> <span class="o">?</span> <span class="kc">true</span><span class="o">:</span> <span class="kc">false</span><span class="o">;</span>
        <span class="n">fixFile</span><span class="o">(</span><span class="n">file</span><span class="o">,</span> <span class="n">verbose</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kt">void</span> <span class="nf">fixFile</span><span class="o">(</span><span class="n">String</span> <span class="n">file</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">verbose</span><span class="o">)</span> <span class="o">{</span>
         <span class="k">try</span> <span class="o">{</span>
            <span class="n">BufferedReader</span> <span class="n">input</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="n">file</span><span class="o">));</span>
            <span class="n">BufferedWriter</span> <span class="n">output</span> <span class="o">=</span>
		<span class="k">new</span> <span class="nf">BufferedWriter</span><span class="o">(</span><span class="k">new</span> <span class="n">FileWriter</span><span class="o">(</span><span class="n">file</span> <span class="o">+</span> <span class="n">BACKUP_SUFFIX</span><span class="o">));</span>
            <span class="n">String</span> <span class="n">line</span><span class="o">;</span>
            <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="k">while</span> <span class="o">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">input</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">output</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">fixLine</span><span class="o">(</span><span class="n">line</span><span class="o">,</span> <span class="o">++</span><span class="n">count</span><span class="o">,</span> <span class="n">verbose</span><span class="o">));</span>
                <span class="n">output</span><span class="o">.</span><span class="na">newLine</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="n">output</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
             <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Exception occured: &quot;</span> <span class="o">+</span> <span class="n">ex</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">abstract</span> <span class="n">String</span> <span class="nf">fixLine</span><span class="o">(</span><span class="n">String</span> <span class="n">line</span><span class="o">,</span> <span class="kt">int</span> <span class="n">count</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">verbose</span><span class="o">);</span>

<span class="o">}</span>

<span class="cm">/*</span>
<span class="cm"> * FixStyle1.java</span>
<span class="cm"> */</span>
<span class="kn">package</span> <span class="n">pleac</span><span class="o">.</span><span class="na">ch01</span><span class="o">.</span><span class="na">part17</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.oro.text.perl.Perl5Util</span><span class="o">;</span>
<span class="cm">/**</span>
<span class="cm"> * Fix style using substitutions</span>
<span class="cm"> * Usage: java pleac.ch01.part17.FixStyle1 &lt;file&gt; [-v]</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FixStyle1</span> <span class="kd">extends</span> <span class="n">FixStyle</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="n">Perl5Util</span> <span class="n">util</span><span class="o">;</span>

    <span class="n">FixStyle1</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">util</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Perl5Util</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="n">String</span> <span class="nf">fixLine</span><span class="o">(</span><span class="n">String</span> <span class="n">line</span><span class="o">,</span> <span class="kt">int</span> <span class="n">count</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">verbose</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Enumeration</span> <span class="kd">enum</span> <span class="o">=</span> <span class="n">changes</span><span class="o">.</span><span class="na">propertyNames</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">(</span><span class="kd">enum</span><span class="o">.</span><span class="na">hasMoreElements</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">oldWord</span> <span class="o">=</span> <span class="o">(</span><span class="n">String</span><span class="o">)</span> <span class="kd">enum</span><span class="o">.</span><span class="na">nextElement</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">util</span><span class="o">.</span><span class="na">match</span><span class="o">(</span><span class="s">&quot;/&quot;</span> <span class="o">+</span> <span class="n">oldWord</span> <span class="o">+</span> <span class="s">&quot;/&quot;</span><span class="o">,</span> <span class="n">line</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">String</span> <span class="n">newWord</span> <span class="o">=</span> <span class="n">changes</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="n">oldWord</span><span class="o">);</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">verbose</span><span class="o">)</span>
                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;substituting &quot;</span> <span class="o">+</span> <span class="n">newWord</span> <span class="o">+</span> <span class="s">&quot; to &quot;</span>
			<span class="o">+</span> <span class="n">oldWord</span> <span class="o">+</span> <span class="s">&quot; in line &quot;</span> <span class="o">+</span> <span class="n">count</span><span class="o">);</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="na">substitute</span><span class="o">(</span><span class="s">&quot;s/&quot;</span> <span class="o">+</span> <span class="n">oldWord</span> <span class="o">+</span> <span class="s">&quot;/&quot;</span> <span class="o">+</span> <span class="n">newWord</span> <span class="o">+</span> <span class="s">&quot;/g&quot;</span><span class="o">,</span> <span class="n">line</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">line</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">FixStyle</span> <span class="n">fixer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FixStyle1</span><span class="o">();</span>
        <span class="n">fixer</span><span class="o">.</span><span class="na">fix</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>

<span class="cm">/*</span>
<span class="cm"> * FixStyle2.java</span>
<span class="cm"> */</span>
<span class="kn">package</span> <span class="n">pleac</span><span class="o">.</span><span class="na">ch01</span><span class="o">.</span><span class="na">part17</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.text.BreakIterator</span><span class="o">;</span>
<span class="cm">/**</span>
<span class="cm"> * Fix style using a break iterator</span>
<span class="cm"> * Usage: java pleac.ch01.part17.FixStyle2 &lt;file&gt; [-v]</span>
<span class="cm"> */</span>  
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FixStyle2</span> <span class="kd">extends</span> <span class="n">FixStyle</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">BreakIterator</span> <span class="n">iterator</span><span class="o">;</span>

    <span class="n">FixStyle2</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">iterator</span> <span class="o">=</span> <span class="n">BreakIterator</span><span class="o">.</span><span class="na">getWordInstance</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="n">String</span> <span class="nf">fixLine</span><span class="o">(</span><span class="n">String</span> <span class="n">line</span><span class="o">,</span> <span class="kt">int</span> <span class="n">count</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">verbose</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// use a mutable string buffer to performs string modifications</span>
        <span class="n">StringBuffer</span> <span class="n">buffer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="o">(</span><span class="n">line</span><span class="o">);</span>
	<span class="c1">// use a break iterator to performs initial string analysis</span>
        <span class="n">iterator</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">line</span><span class="o">);</span>
	<span class="c1">// and keep track of offset between them</span>
        <span class="kt">int</span> <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

        <span class="kt">int</span> <span class="n">start</span> <span class="o">=</span> <span class="n">iterator</span><span class="o">.</span><span class="na">first</span><span class="o">();</span>
        <span class="kt">int</span> <span class="n">end</span> <span class="o">=</span> <span class="n">iterator</span><span class="o">.</span><span class="na">first</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">((</span><span class="n">end</span> <span class="o">=</span> <span class="n">iterator</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">!=</span> <span class="n">BreakIterator</span><span class="o">.</span><span class="na">DONE</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">oldWord</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">start</span><span class="o">,</span> <span class="n">end</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">changes</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">oldWord</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">String</span> <span class="n">newWord</span> <span class="o">=</span> <span class="n">changes</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="n">oldWord</span><span class="o">);</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">verbose</span><span class="o">)</span>
                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;substituting &quot;</span> <span class="o">+</span> <span class="n">newWord</span> <span class="o">+</span> <span class="s">&quot; to &quot;</span>
			<span class="o">+</span> <span class="n">oldWord</span> <span class="o">+</span> <span class="s">&quot; in line &quot;</span> <span class="o">+</span> <span class="n">count</span><span class="o">);</span>
                <span class="n">buffer</span><span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">offset</span><span class="o">,</span> <span class="n">end</span> <span class="o">+</span> <span class="n">offset</span><span class="o">,</span> <span class="n">newWord</span><span class="o">);</span>
                <span class="n">offset</span> <span class="o">+=</span> <span class="n">newWord</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="n">oldWord</span><span class="o">.</span><span class="na">length</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">end</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">buffer</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">FixStyle</span> <span class="n">fixer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FixStyle2</span><span class="o">();</span>
        <span class="n">fixer</span><span class="o">.</span><span class="na">fix</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN68"
>Program: psgrep</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//----------------------------------------------------------------------------------</span>
<span class="c1">// To do...</span>
<span class="c1">// @@INCOMPLETE@@</span>
<span class="c1">// @@INCOMPLETE@@</span>
<span class="c1">//----------------------------------------------------------------------------------</span></PRE
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="numbers.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>PLEAC-Java</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Numbers</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>