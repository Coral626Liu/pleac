<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Directories</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="PLEAC-C/Posix/GNU"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="File Contents"
HREF="filecontents.html"><LINK
REL="NEXT"
TITLE="Subroutines"
HREF="subroutines.html"><style type="text/css">td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }

  </style></head
><BODY TEXT="#cecece" BGCOLOR="#4f6f6f" LINK="#f5deb3" VLINK="#d5ae83"
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PLEAC-C/Posix/GNU</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="filecontents.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="subroutines.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="DIRECTORIES"
>9. Directories</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN495"
>Introduction</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//------------------------------------------------------------------</span>
<span class="cp">#include &lt;stdio.h&gt; </span><span class="c1">// perror(), fprintf()</span>
<span class="cp">#include &lt;unistd.h&gt; </span><span class="c1">// stat(), fstat(), lstat()</span>
<span class="cp">#include &lt;sys/stat.h&gt; </span><span class="c1">// struct stat</span>

<span class="p">...</span>

<span class="k">struct</span> <span class="n">stat</span> <span class="n">entry</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span> <span class="n">stat</span><span class="p">(</span><span class="s">&quot;/usr/bin/vi&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">entry</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">)</span>
  <span class="n">perror</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="n">S_ISREG</span><span class="p">(</span><span class="n">entry</span><span class="p">.</span><span class="n">st_mode</span><span class="p">)</span> <span class="p">)</span>
  <span class="n">fprintf</span><span class="p">(</span> <span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;file</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>

<span class="p">...</span>

<span class="c1">//------------------------------------------------------------------</span>
<span class="cp">#include &lt;stdio.h&gt; </span><span class="c1">// perror(), fprintf()</span>
<span class="cp">#include &lt;unistd.h&gt; </span><span class="c1">// stat(), fstat(), lstat()</span>
<span class="cp">#include &lt;sys/stat.h&gt; </span><span class="c1">// struct stat</span>

<span class="p">...</span>

<span class="k">struct</span> <span class="n">stat</span> <span class="n">entry</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span> <span class="n">stat</span><span class="p">(</span><span class="s">&quot;/usr/bin&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">entry</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">)</span>
  <span class="n">perror</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="n">S_ISDIR</span><span class="p">(</span> <span class="n">entry</span><span class="p">.</span><span class="n">st_mode</span><span class="p">)</span> <span class="p">)</span>
  <span class="n">fprintf</span><span class="p">(</span> <span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;directory</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>

<span class="p">...</span>

<span class="c1">//------------------------------------------------------------------</span>
<span class="c1">// we can&#39;t access the inode of a file with a stream as parameter</span>
<span class="c1">// we need to pass a file descriptor parameter to fstat</span>
<span class="cp">#include &lt;stdio.h&gt; </span><span class="c1">// perror(), fprintf()</span>
<span class="cp">#include &lt;unistd.h&gt; </span><span class="c1">// stat(), fstat(), lstat()</span>
<span class="cp">#include &lt;sys/stat.h&gt; </span><span class="c1">// struct stat</span>
<span class="cp">#include &lt;fcntl.h&gt; </span><span class="c1">//open()</span>

<span class="p">...</span>

<span class="k">struct</span> <span class="n">stat</span> <span class="n">entry</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">fd</span><span class="p">;</span> <span class="c1">// file descriptor</span>
<span class="kt">FILE</span> <span class="o">*</span> <span class="n">fp</span><span class="p">;</span>  <span class="c1">// stream</span>

<span class="k">if</span><span class="p">((</span><span class="n">fd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="s">&quot;/etc/group&quot;</span><span class="p">,</span> <span class="n">O_RDONLY</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
  <span class="n">perror</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>

<span class="k">if</span><span class="p">(</span> <span class="n">fstat</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">entry</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">)</span>
  <span class="n">perror</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>

<span class="k">if</span><span class="p">((</span><span class="n">fp</span> <span class="o">=</span> <span class="n">fdopen</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="s">&quot;r&quot;</span> <span class="p">))</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span> <span class="c1">// we attach the file descriptor to a stream</span>
  <span class="n">perror</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>

<span class="p">...</span>

<span class="c1">//------------------------------------------------------------------</span>
<span class="cp">#include &lt;stdio.h&gt; </span><span class="c1">// perror()</span>
<span class="cp">#include &lt;unistd.h&gt; </span><span class="c1">// stat(), fstat(), lstat()</span>
<span class="cp">#include &lt;sys/stat.h&gt; </span><span class="c1">// struct stat</span>
<span class="cp">#include &lt;sys/types.h&gt; </span><span class="c1">// off_t</span>

<span class="p">...</span>

<span class="k">struct</span> <span class="n">stat</span> <span class="n">entry</span><span class="p">;</span>

<span class="kt">time_t</span> <span class="n">ctime</span><span class="p">;</span>
<span class="kt">off_t</span> <span class="n">size</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span> <span class="n">stat</span><span class="p">(</span><span class="s">&quot;/usr/bin/vi&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">entry</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">)</span>
  <span class="n">perror</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>

<span class="n">ctime</span> <span class="o">=</span> <span class="n">entry</span><span class="p">.</span><span class="n">st_ctime</span><span class="p">;</span>
<span class="n">size</span> <span class="o">=</span> <span class="n">entry</span><span class="p">.</span><span class="n">st_size</span><span class="p">;</span>
<span class="c1">//fprintf( stdout, &quot;ctime: %ld\nsize: %ld\n&quot;, ctime, size );</span>

<span class="p">...</span>

<span class="c1">//------------------------------------------------------------------</span>
<span class="c1">// No equivalent in C ANSI/POSIX/GNU for -T (file is a text file)?</span>
<span class="cm">/*</span>
<span class="cm"># -s for filesize (test if nonzero)</span>
<span class="cm">unless (-s F &amp;&amp; -T _) {</span>
<span class="cm">  die &quot;$filename doesn&#39;t have text in it.\n&quot;;</span>
<span class="cm">}</span>
<span class="cm">*/</span>

<span class="c1">//------------------------------------------------------------------</span>
<span class="cp">#include &lt;stdio.h&gt;</span>
<span class="cp">#include &lt;dirent.h&gt; </span><span class="c1">// struct dirent, opendir(), readdir(), closedir()</span>
<span class="cp">#include &lt;sys/types.h&gt; </span><span class="c1">// DIR type</span>

<span class="p">...</span>

<span class="kt">DIR</span> <span class="o">*</span> <span class="n">dir</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">dirent</span> <span class="o">*</span> <span class="n">entry</span><span class="p">;</span>

<span class="n">dir</span> <span class="o">=</span> <span class="n">opendir</span><span class="p">(</span><span class="s">&quot;/usr/bin&quot;</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="n">dir</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
  <span class="n">perror</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="k">while</span><span class="p">((</span><span class="n">entry</span> <span class="o">=</span> <span class="n">readdir</span><span class="p">(</span><span class="n">dir</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span>
  <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot;Inside /usr/bin is something called %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">entry</span><span class="o">-&gt;</span><span class="n">d_name</span><span class="p">);</span>
<span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="n">closedir</span><span class="p">(</span><span class="n">dir</span><span class="p">);</span>

<span class="p">...</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN498"
>Getting and Setting Timestamps</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN501"
>Deleting a File</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN504"
>Copying or Moving a File</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN507"
>Recognizing Two Names for the Same File</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN510"
>Processing All Files in a Directory</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN513"
>Globbing, or Getting a List of Filenames Matching a Pattern</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN516"
>Processing All Files in a Directory Recursively</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN519"
>Removing a Directory and Its Contents</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN522"
>Renaming Files</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN525"
>Splitting a Filename into Its Component Parts</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
><font color="#f5deb3" size="+1"><span class="c1"></span><span class="c1">//------------------------------------------------------------------</span>

<span class="c1">//  we use the XPG version of basename which overrides</span>
<span class="c1">//  the GNU version (not portable) if libgen.h is included</span>
<span class="c1">//  /!\ do not call basename or dirname with a static string (bugs in glibc)</span>

<span class="cp">#include &lt;stdio.h&gt; </span><span class="c1">// fprintf()</span>
<span class="cp">#include &lt;stdlib.h&gt; </span><span class="c1">// free()</span>
<span class="cp">#include &lt;string.h&gt;  </span><span class="c1">// strdup(), strrchr()</span>
<span class="cp">#include &lt;libgen.h&gt;  </span><span class="c1">// basename(), dirname()</span>

<span class="p">...</span>
 <span class="kt">char</span> <span class="o">*</span> <span class="n">dir</span><span class="p">,</span> <span class="o">*</span> <span class="n">file</span><span class="p">,</span> <span class="o">*</span> <span class="n">ext</span><span class="p">;</span>
<span class="kt">char</span> <span class="o">*</span> <span class="n">tmp_dirname</span><span class="p">,</span> <span class="o">*</span> <span class="n">tmp_file</span><span class="p">;</span>
<span class="kt">char</span> <span class="o">*</span> <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;/usr/lib/libc.a&quot;</span><span class="p">;</span>

<span class="n">tmp_dirname</span> <span class="o">=</span> <span class="n">strdup</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>
<span class="n">tmp_file</span> <span class="o">=</span> <span class="n">strdup</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>
   <span class="n">dir</span> <span class="o">=</span> <span class="n">dirname</span><span class="p">(</span><span class="n">tmp_dirname</span><span class="p">);</span>
<span class="n">file</span> <span class="o">=</span> <span class="n">basename</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">);</span>
<span class="n">ext</span> <span class="o">=</span> <span class="n">strrchr</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="sc">&#39;.&#39;</span><span class="p">);</span> <span class="c1">// extension as everything after the last &#39;.&#39;</span>

<span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot;dir is %s, file is %s, ext is %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">dir</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">ext</span><span class="p">);</span>
<span class="c1">// dir is /usr/lib, file is libc.a, ext is .a</span>
 <span class="n">free</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">);</span>
<span class="n">free</span><span class="p">(</span><span class="n">tmp_dirname</span><span class="p">);</span>

<span class="p">...</span>

<span class="c1">//------------------------------------------------------------------</span>
<span class="cp">#include &lt;stdio.h&gt; </span><span class="c1">// fprintf()</span>
<span class="cp">#include &lt;stdlib.h&gt; </span><span class="c1">// free()</span>
<span class="cp">#include &lt;string.h&gt;  </span><span class="c1">// strdup()</span>
<span class="cp">#include &lt;libgen.h&gt;  </span><span class="c1">// basename(), dirname()</span>

<span class="p">...</span>

<span class="kt">char</span> <span class="o">*</span> <span class="n">file</span><span class="p">,</span> <span class="o">*</span> <span class="n">dir</span><span class="p">,</span> <span class="o">*</span> <span class="n">tmp_file</span><span class="p">,</span> <span class="o">*</span> <span class="n">tmp_dirname</span><span class="p">;</span>
<span class="kt">char</span> <span class="o">*</span> <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;/usr/lib/libc.a&quot;</span><span class="p">;</span>

<span class="n">tmp_file</span> <span class="o">=</span> <span class="n">strdup</span><span class="p">(</span> <span class="n">path</span> <span class="p">);</span>
<span class="n">tmp_dirname</span> <span class="o">=</span> <span class="n">strdup</span><span class="p">(</span> <span class="n">path</span> <span class="p">);</span>
<span class="n">dir</span> <span class="o">=</span> <span class="n">dirname</span><span class="p">(</span> <span class="n">tmp_dirname</span> <span class="p">);</span>
<span class="n">file</span> <span class="o">=</span> <span class="n">basename</span><span class="p">(</span> <span class="n">tmp_file</span> <span class="p">);</span>

<span class="n">fprintf</span><span class="p">(</span> <span class="n">stdout</span><span class="p">,</span> <span class="s">&quot;dir is %s, file is %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">dir</span><span class="p">,</span> <span class="n">file</span> <span class="p">);</span>
<span class="c1">// dir is /usr/lib, file is libc.a</span>
<span class="n">free</span><span class="p">(</span><span class="n">tmp_dirname</span><span class="p">);</span>
<span class="n">free</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">);</span>
 <span class="p">...</span>

<span class="c1">//------------------------------------------------------------------</span>
<span class="c1">// no equivalent in C for fileparse() but we can</span>
<span class="c1">//  implement a (very basic) similar function</span>

<span class="cp">#include &lt;stdio.h&gt; </span><span class="c1">// fprintf()</span>
<span class="cp">#include &lt;stdlib.h&gt; </span><span class="c1">// free()</span>
<span class="cp">#include &lt;string.h&gt;  </span><span class="c1">// strdup(), strrchr(), strlen()</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">Pathname_</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="o">*</span> <span class="n">dirname</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span> <span class="n">filename</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span> <span class="n">extension</span><span class="p">;</span>
<span class="p">}</span><span class="n">Pathname</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">fileparse</span><span class="p">(</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">path</span><span class="p">,</span> <span class="n">Pathname</span> <span class="o">*</span> <span class="n">split_path</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="o">*</span> <span class="n">tmp_path</span><span class="p">,</span> <span class="o">*</span> <span class="n">ptr</span><span class="p">,</span> <span class="o">*</span> <span class="n">extension</span><span class="p">;</span>

  <span class="n">tmp_path</span> <span class="o">=</span> <span class="n">strdup</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>
 <span class="n">ptr</span><span class="o">=</span> <span class="n">strrchr</span><span class="p">(</span> <span class="n">tmp_path</span><span class="p">,</span> <span class="sc">&#39;/&#39;</span><span class="p">);</span>
  <span class="o">*</span><span class="n">ptr</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
  <span class="n">ptr</span><span class="o">++</span><span class="p">;</span>

  <span class="c1">// dirname</span>
  <span class="n">split_path</span><span class="o">-&gt;</span><span class="n">dirname</span> <span class="o">=</span> <span class="n">strdup</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">);</span>
  <span class="c1">// filename</span>
  <span class="n">split_path</span><span class="o">-&gt;</span><span class="n">filename</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="n">strlen</span><span class="p">(</span><span class="n">ptr</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
  <span class="n">strcpy</span><span class="p">(</span><span class="n">split_path</span><span class="o">-&gt;</span><span class="n">filename</span><span class="p">,</span> <span class="n">ptr</span><span class="p">);</span>

  <span class="c1">// extension</span>
  <span class="n">extension</span> <span class="o">=</span> <span class="n">strrchr</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="sc">&#39;.&#39;</span><span class="p">);</span> <span class="c1">// extension as everything</span>
<span class="n">after</span> <span class="n">the</span> <span class="n">last</span> <span class="sc">&#39;.&#39;</span>
  <span class="n">split_path</span><span class="o">-&gt;</span><span class="n">extension</span> <span class="o">=</span> <span class="n">strdup</span><span class="p">(</span><span class="n">extension</span><span class="p">);</span>

  <span class="n">free</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">);</span>
 <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span> <span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">argv</span><span class="p">[]</span> <span class="p">)</span> <span class="p">{</span>

  <span class="n">Pathname</span> <span class="n">fparsed</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span> <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;/usr/lib/libc.a&quot;</span><span class="p">;</span>
 <span class="n">fileparse</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">fparsed</span><span class="p">);</span>
 <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot;dir is %s, file is %s, ext is %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
      <span class="n">fparsed</span><span class="p">.</span><span class="n">dirname</span><span class="p">,</span>
      <span class="n">fparsed</span><span class="p">.</span><span class="n">filename</span><span class="p">,</span>
      <span class="n">fparsed</span><span class="p">.</span><span class="n">extension</span><span class="p">);</span>
  <span class="c1">// dir is /usr/lib, file is libc.a, ext is .a</span>
 <span class="n">free</span><span class="p">(</span><span class="n">fparsed</span><span class="p">.</span><span class="n">dirname</span><span class="p">);</span>
  <span class="n">free</span><span class="p">(</span><span class="n">fparsed</span><span class="p">.</span><span class="n">filename</span><span class="p">);</span>
  <span class="n">free</span><span class="p">(</span><span class="n">fparsed</span><span class="p">.</span><span class="n">extension</span><span class="p">);</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//------------------------------------------------------------------</span>
<span class="c1">//  we are Unix centric so no equivalent for fileparse_set_fstype(&quot;MacOS&quot;);</span>

<span class="c1">//------------------------------------------------------------------</span>
<span class="kt">char</span> <span class="o">*</span> <span class="nf">extension</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">path</span><span class="p">){</span>
  <span class="kt">char</span> <span class="o">*</span> <span class="n">ext</span><span class="p">;</span>
  <span class="n">ext</span> <span class="o">=</span> <span class="n">strrchr</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="sc">&#39;.&#39;</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="n">ext</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>

  <span class="k">return</span> <span class="n">ext</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// fprintf(stdout, &quot;ext is %s\n&quot;, extension(path));</span>
<span class="c1">// ext is .a</span></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN528"
>Program: symirror</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN531"
>Program: lst</A
></H2
><TABLE
BORDER="0"
BGCOLOR="#2F4F4F"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
></PRE
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="filecontents.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="subroutines.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>File Contents</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Subroutines</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>